<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>P2: Extensible Hash Table</title>
      <link href="/2024/03/05/cmu15445/23fall-p2/"/>
      <url>/2024/03/05/cmu15445/23fall-p2/</url>
      
        <content type="html"><![CDATA[<h2 id="task-1---readwrite-page-guards">Task #1 - Read/Write PageGuards</h2><p>åœ¨Project1çš„BufferPoolManagerä¸­ï¼ŒFetchPageå’ŒNewPageè¿™ä¸¤ä¸ªAPIéƒ½æ˜¯ç›´æ¥è¿”å›<code>Page *</code>æŒ‡é’ˆã€‚ç„¶åé€šè¿‡ç¨‹åºå‘˜æ‰‹åŠ¨åœ°è°ƒç”¨<code>UnpinPage</code>æ–¹æ³•æ¥ä½¿å¾—é¡µé¢ä¼šå¤„äºEvictableçš„çŠ¶æ€ï¼Œä¸€æ—¦ç¨‹åºå‘˜åœ¨ä½¿ç”¨å®Œé¡µé¢ä¹‹åå¿˜è®°è°ƒç”¨<code>UnpinPage</code>æ–¹æ³•ï¼Œå¯èƒ½å°±ä¼šå¯¼è‡´è¿™ä¸ªé¡µé¢ä¸€ç›´å¤„äºUnevictableçš„çŠ¶æ€è€Œä¸€ç›´ç•™åœ¨BufferPoolä¸­ã€‚</p><p>ä¸ºäº†å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå°±é‡‡ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„å°†<code>Page *</code>æŒ‡é’ˆåŒ…è£¹èµ·æ¥â€”â€”<code>XXPageGuard</code>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicPageGuard</span> &#123;<br>    BufferPoolManager *bpm_&#123;<span class="hljs-literal">nullptr</span>&#125;;<br>    Page *page_&#123;<span class="hljs-literal">nullptr</span>&#125;;<br>    <span class="hljs-type">bool</span> is_dirty_&#123;<span class="hljs-literal">false</span>&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡<code>PageGuard</code>ä¸­çš„APIå®ç°ï¼š1ã€å½“Pageç¦»å¼€å…¶ä½œç”¨åŸŸï¼Œä¸èƒ½å†è¢«è®¿é—®åˆ°çš„æ—¶å€™ï¼Œ<code>PageGuard</code>é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨<code>UnpinPage</code>ï¼›2ã€ç¨‹åºå‘˜å¯ä»¥ä¸»åŠ¨è°ƒç”¨<code>Drop()</code>æ–¹æ³•å‘Šè¯‰BufferPoolManagerï¼Œå°†ä¸å†ä½¿ç”¨è¿™ä¸ªé¡µé¢ã€‚</p><blockquote><p>ğŸš€æ³¨æ„ï¼šç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼å‡½æ•°çš„åŒºåˆ«ï¼</p><p>ç§»åŠ¨èµ‹å€¼å‡½æ•°ï¼Œèµ‹å€¼ç­‰å·å·¦è¾¹çš„PageGuardå¯èƒ½å·²ç»åˆå§‹åŒ–ï¼Œæ­£åœ¨guardä¸€ä¸ªpageï¼›</p><p>ä½†æ˜¯å¯¹äºç§»åŠ¨æ„é€ å‡½æ•°åˆ™ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï½</p></blockquote><h2 id="task-2---extendible-hash-table-pages">Task #2 - Extendible HashTable Pages</h2><p>å¦‚å›¾æ‰€ç¤ºæ˜¯ä¸€ä¸ªextendible hash tableï¼Œå®ƒçš„headerpageçš„æœ€å¤§æ·±åº¦ä¸º2ï¼Œdirectory pageçš„æœ€å¤§æ·±åº¦ä¸º2ï¼Œè€Œä¸”bucketpagesæœ€åå­˜æ”¾ä¸¤ä¸ªentryã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20231121130310745.png"alt="extensible hash table" /><figcaption aria-hidden="true">extensible hash table</figcaption></figure><h3 id="hash-table-header-page">Hash Table Header Page</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Header page format:</span><br><span class="hljs-comment"> *  ---------------------------------------------------</span><br><span class="hljs-comment"> * | DirectoryPageIds(2048) | MaxDepth (4) | Free(2044)</span><br><span class="hljs-comment"> *  ---------------------------------------------------</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><p>ç”±äºæœ€å¤§æ·±åº¦æ˜¯4ï¼Œæ‰€ä»¥åœ¨headerpageä¸­å®é™…ä¸Šæœ€å¤šåªèƒ½å­˜æ”¾16<code>(1&lt;&lt;4)</code>ä¸ªæŒ‡å‘directorypageçš„page idã€‚</p><h3 id="hash-table-directory-page">Hash Table Directory Page</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Directory page format:</span><br><span class="hljs-comment"> *  --------------------------------------------------------------------------------------</span><br><span class="hljs-comment"> * | MaxDepth (4) | GlobalDepth (4) | LocalDepths (512) | BucketPageIds(2048) | Free(1528)</span><br><span class="hljs-comment"> *  --------------------------------------------------------------------------------------</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><ul><li>MaxDepthï¼šdirectory pageçš„æœ€å¤§æ·±åº¦</li><li>GlobalDepthï¼šå½“å‰directory pageçš„å…¨å±€æ·±åº¦ï¼Œä½¿ç”¨äº†å‡ ä¸ªbitä½</li><li>LocalDepthsï¼šå¯¹äºå…¶ä¸­ä¸€ä¸ªbucket pageï¼Œä½¿ç”¨çš„bitä½æ•°</li><li>BucketPageIdsï¼šå­˜æ”¾æŒ‡å‘bucket pageçš„page id</li><li>ä¸‹å›¾å±•ç¤ºäº†è¿™äº›æ¦‚å¿µçš„å«ä¹‰ï¼š</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20231121130354461.png"alt="direcotry page" /><figcaption aria-hidden="true">direcotry page</figcaption></figure><h3 id="hash-table-bucket-page">Hash Table Bucket Page</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Bucket page format:</span><br><span class="hljs-comment"> *  ----------------------------------------------------------------------------</span><br><span class="hljs-comment"> * | METADATA | KEY(1) + VALUE(1) | KEY(2) + VALUE(2) | ... | KEY(n) + VALUE(n)</span><br><span class="hljs-comment"> *  ----------------------------------------------------------------------------</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * Metadata format (size in byte, 8 bytes in total):</span><br><span class="hljs-comment"> *  --------------------------------</span><br><span class="hljs-comment"> * | CurrentSize (4) | MaxSize (4)</span><br><span class="hljs-comment"> *  --------------------------------</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><ul><li><code>Remove()</code>çš„å®ç°ï¼šè€ƒè™‘ä¸¤ç§ï¼š1ã€åœ¨ç§»é™¤äº†key-valueä¹‹åï¼Œåšcompressionï¼Œä½¿å¾—<code>[0, size)</code>ä¸­å§‹ç»ˆéƒ½æ˜¯æœ‰æ•ˆçš„é”®å€¼å¯¹ï¼›2ã€åªç§»é™¤é”®å€¼å¯¹ï¼Œä¸åšcompressionï¼Œåœ¨<code>[0, max_size_)</code>è¿›è¡ŒLookupå’ŒInsertï¼ˆå¦‚ä½•åˆ¤æ–­æŸä¸ªentryæ˜¯ç©ºçš„ï¼Ÿï¼‰<ul><li><u>ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€ç§</u></li><li><font color='green'>åé¢åœ¨ä¼˜åŒ–çš„æ—¶å€™é€‰æ‹©äº†ç¬¬äºŒç§</font></li></ul></li></ul><h2 id="task-3---extendible-hashing-implementation">Task #3 - ExtendibleHashing Implementation</h2><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20231121130310745.png"alt="extensible hash table" /><figcaption aria-hidden="true">extensible hash table</figcaption></figure><blockquote><p><ahref="https://www.geeksforgeeks.org/extendible-hashing-dynamic-approach-to-dbms/">ExtendibleHashing (Dynamic approach to DBMS) - GeeksforGeeks</a></p></blockquote><p>éœ€è¦å®ç°ä¸‰ä¸ªAPIï¼š</p><ul><li><code>GetValue</code>ï¼šåªéœ€è¦ä»HeaderPageå¼€å§‹å‘ä¸‹æ£€ç´¢å³å¯ã€‚</li><li><code>Remove</code>ï¼š<ul><li>MergeBucketï¼šå¦‚æœåšå®ŒRemoveæ“ä½œä¹‹åï¼ŒPageå˜ä¸ºç©ºï¼Œåˆ™éœ€è¦è¿›è¡ŒMergeï¼›Mergeä¹‹åè¿˜å¯èƒ½éœ€è¦è¿›è¡ŒDirectoryShrinkã€‚</li><li><strong>MergeBucketåªä¼šå‡ºç°åœ¨<code>local_depth==global_depth</code>çš„bucketä¸Š</strong><ul><li>è¿™ä¸ªæ˜¯é”™è¯¯çš„ï¼Œå¯¼è‡´è¿™ä¸ªæƒ³æ³•çš„æœ¬è´¨åŸå› æ˜¯GetSplitImageIndexçš„é”™è¯¯å®ç°ï¼ï¼ï¼</li></ul></li></ul></li><li><code>Insert</code>ï¼šéœ€è¦è€ƒè™‘å‡ ç§æƒ…å†µ<ul><li>ç”±äºHashTableåˆå§‹åŒ–å®Œä¹‹åï¼Œåªæœ‰ä¸€ä¸ªHeaderPageï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæ’å…¥çš„Key-Valueï¼Œéœ€è¦æ–°å»ºDirectoryPageå’ŒBucketPageã€‚</li><li>å¦‚æœBucketPageæ»¡äº†çš„è¯ï¼Œéœ€è¦è¿›è¡ŒBucket Splitå’ŒDirectoryExpansionã€‚</li></ul></li><li>æ³¨æ„ç‚¹<ul><li>ä¸€æ¬¡SplitBucketå¯èƒ½ä¸èƒ½è¾¾åˆ°ç›®çš„ï¼ŒSplitä¹‹åï¼Œè¦æ’å…¥çš„é¡µé¢å¯èƒ½è¿˜æ˜¯æ»¡çš„ï¼Œéœ€è¦whileå¾ªç¯ç›´åˆ°èƒ½å¤Ÿé¡ºåˆ©æ’å…¥</li><li>æ³¨æ„GetValueå’ŒRemoveæ–¹æ³•ä¸­å–å‡ºæ¥çš„directory_page_idå’Œbucket_page_idä¸ä¸€å®šæ˜¯æœ‰æ•ˆçš„ï¼ˆæ¯”å¦‚åœ¨æ²¡æœ‰æ’å…¥ä»»ä½•Key-Valueå°±è¿›è¡ŒGetValueæˆ–è€…Removeï¼‰</li><li>Mergeå’ŒSplitçš„ä¸€æ ·ï¼Œä¹Ÿä¸æ˜¯ä¸€æ¬¡å°±ç»“æŸçš„ï¼Œåœ¨å®Œæˆä¸€æ¬¡Mergeä¹‹åéœ€è¦åˆ¤æ–­æ–°çš„BucketPageçš„SplitImageæ˜¯å¦ä¸ºç©ºï¼ˆæ‰‹å†Œä¸­å·²ç»ç»™äº†æç¤ºï¼‰ï¼ŒåŒæ ·éœ€è¦whileå¾ªç¯</li></ul></li></ul><h2 id="task-4---concurrency-control">Task #4 - Concurrency Control</h2><p>æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œä½¿ç”¨Task#1ä¸­çš„APIâ€”â€”FetchPageReadå’ŒFetchPageWrtieå³å¯ã€‚</p><blockquote><p>âœ‹ä¸ºä»€ä¹ˆï¼Ÿé¦–å…ˆBufferPoolManageræ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯¹äºpublicçš„ä¸‰ä¸ªAPIï¼šInsertã€Removeå’ŒGetValueï¼Œå®ƒä»¬æ‰§è¡Œçš„è¿‡ç¨‹éƒ½æ˜¯ä¾æ¬¡è·å–HeaderPageã€DirectoryPageã€BucketPageï¼Œç„¶åæ ¹æ®Pageä¸Šçš„å†…å®¹åšåç»­çš„æ“ä½œã€‚ä½¿ç”¨FetchPageReadå’ŒFetchPageWriteå°±æ˜¯å¾—çº¿ç¨‹åœ¨è·å–åˆ°å¯¹åº”çš„Pageçš„åŒæ—¶ä¹ŸæŒæœ‰Pageä¸Šçš„è¯»é”æˆ–è€…å†™é”ï¼Œèƒ½å¤Ÿåœ¨çº¿ç¨‹æŒæœ‰çš„æ—¶å€™åšåˆ°å¹¶å‘æ§åˆ¶ã€‚</p></blockquote><h2 id="debug">Debug</h2><p>æœ‰ä¸‰ä¸ªæµ‹è¯•ä¸€ç›´è¿‡ä¸å»</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/3aa3032db801492db525e473629feff1.png"alt="failed testcases" /><figcaption aria-hidden="true">failed testcases</figcaption></figure><h3 id="bug1.-inserttest3">BUG1. InsertTest3</h3><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/437c34e242b7410091495b75db09220d.png"alt="InsertTest3" /><figcaption aria-hidden="true">InsertTest3</figcaption></figure><h3 id="bug2.-recursivemergetest">BUG2. RecursiveMergeTest</h3><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/65ba806f00fd4bce80bc21fc997dec27.png"alt="RecursiveMergeTest" /><figcaption aria-hidden="true">RecursiveMergeTest</figcaption></figure><blockquote><p>ä¼°è®¡æ˜¯æ¼äº†ä¸€æ¬¡BucketMerge</p></blockquote><h3 id="bug3.-growshrinktest">BUG3. GrowShrinkTest</h3><blockquote><p>åŸå› åº”è¯¥æ˜¯åœ¨ä¸€æ¬¡SplitBucketæ—¶ï¼ŒBufferPoolManagerçš„NewPageå¤±è´¥ï¼Œè¿”å›äº†ç©ºæŒ‡é’ˆã€‚</p></blockquote><h3 id="solve1.-æ²¡æœ‰ç†è§£bucketsplitå’Œbucketmergeçš„çœŸæ­£è¿‡ç¨‹">Solve1.æ²¡æœ‰ç†è§£BucketSplitå’ŒBucketMergeçš„çœŸæ­£è¿‡ç¨‹</h3><blockquote><p>è§£å†³äº†å‰ä¸¤ä¸ªbugï¼ï¼</p></blockquote><blockquote><p>ğŸ’¬å…³äº<strong>GetSplitImageIndex</strong>å‡½æ•°ï¼Œä¹‹å‰çš„ç†è§£æœ‰è¯¯ï¼</p></blockquote><ul><li>é¦–å…ˆæ˜¯å¯¹è¿™ä¸ªå‡½æ•°çš„å«ä¹‰ç†è§£é”™è¯¯ï¼šè¿™ä¸ªå‡½æ•°è¿”å›çš„æ˜¯è¿™ä¸ªbucketåœ¨å‰é¢splitçš„æ—¶å€™åŒæ—¶äº§ç”Ÿçš„å¦ä¸€ä¸ªbucketçš„ç´¢å¼•ã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°åº”è¯¥æ˜¯ç”¨åœ¨BucketMergeä¸­çš„ã€‚<ul><li>ä¹‹å‰çš„ç†è§£æ˜¯ï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªbucketåœ¨splitåäº§ç”Ÿçš„æ–°çš„bucketçš„ç´¢å¼•ã€‚</li></ul></li><li>å¯¹bucket-splitingå’Œbucket-mergingçš„ç†è§£å‡ºç°åå·®<ul><li>å°†å®ƒä»¬ç®€å•åœ°ç†è§£æˆäº†ä¸¤ä¸ªbucket mergeæˆ–è€…ä¸€ä¸ªbucketsplitã€‚ä½†æ˜¯ä¸€ä¸ªbucketpageæ˜¯ä¼šæ¶‰åŠå¤šä¸ªbucket_idxçš„ï¼Œæ‰€ä»¥è¦å……åˆ†è€ƒè™‘æ‰€æœ‰æŒ‡å‘è¿™ä¸ªbucketpageçš„bucket_idxã€‚</li><li>æœ¬è´¨ä¸Šï¼Œsplitingå’Œmergingè¿˜æ˜¯local_depthå¯¹åº”çš„<code>lsb</code>çš„æ”¶ç¼©å’Œæ‰©å±•ï¼Œè€ƒè™‘çš„åº”è¯¥æ˜¯hashå€¼çš„æœ€ä½æœ‰æ•ˆä½ï¼Œè€Œä¸åº”è¯¥æ˜¯ç´¢å¼•ã€‚</li></ul></li></ul><h3 id="slove2.-æ²¡æœ‰æ³¨æ„bufferpoolçš„size">Slove2.æ²¡æœ‰æ³¨æ„BufferPoolçš„size</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/ceb9f678f9f84ed09e7eb7273c0359a1.png" /></p><blockquote><p>ğŸ³è€ƒè™‘ä¸€ä¸ªæƒ…å†µï¼šBufferPoolçš„å¤§å°åªæœ‰3ä¸ªPageæ—¶ï¼Œå¦‚æœåœ¨æ’å…¥æ—¶éœ€è¦åšBucketSplitï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>è¿›è€Œéœ€è¦è€ƒè™‘ï¼šBufferPoolçš„å¤§å°ä¸º2ï¼ˆPageï¼‰æ—¶åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¸º1å‘¢ï¼Ÿæœ€å°èƒ½ä¸ºå¤šå°‘å‘¢ï¼Ÿ</p></blockquote><ul><li>åˆ†æå¯¹äºæ¯ä¸ªAPIï¼Œ[å½“å‰å®ç°]ä¸€æ¬¡æœ€å¤šä¼šä½¿ç”¨åˆ°å¤šå°‘ä¸ªPageï¼Ÿ<ul><li>GetValueï¼šæœ€å¤š3ä¸ªâ€”â€”Headerã€Directoryã€Bucketå„ä¸€ä¸ªã€‚</li><li>Insertï¼šæœ€å¤š4ä¸ªâ€”â€”Headerã€Directoryã€Bucketå„ä¸€ä¸ªï¼Œå¦‚æœéœ€è¦è¿›è¡ŒBucketSplitï¼Œåœ¨whileå¾ªç¯ä¸­ä¼šå¤šä¸€ä¸ªBucketPageã€‚</li><li>Removeï¼šæœ€å¤š3ä¸ªâ€”â€”Headerã€Directoryã€Bucketå„ä¸€ä¸ªã€‚</li></ul></li><li>è¿™ä¸‰ä¸ªAPIç†è®ºä¸Šæœ€å°‘éœ€è¦å¤šå°‘ä¸ªPageåŒæ—¶åœ¨BufferPoolä¸­ï¼š<ul><li>GetValueï¼šæœ€å°‘åªéœ€è¦ä¸€ä¸ªï¼›å¯ä»¥ä¾æ¬¡å–å‡ºHeaderPageã€DirectoryPageã€BucketPageã€‚</li><li>Insertï¼šæœ€å°‘éœ€è¦ä¸‰ä¸ªï¼›HeaderPageå¯ä»¥Dropæ‰ã€‚Splitçš„æ—¶å€™éœ€è¦DirectoryPageå’ŒBucketPageï¼Œä»¥åŠä¸€ä¸ªæ–°å»ºçš„BucketPage</li><li>Removeï¼šæœ€å°‘éœ€è¦ä¸¤ä¸ªï¼›HeaderPageå¯ä»¥Dropæ‰ã€‚Mergeçš„æ—¶å€™éœ€è¦DirectoryPageå’ŒBucketPage</li></ul></li><li>æ‰€ä»¥ï¼ŒBufferPoolçš„Sizeæœ€å°‘ä¸º3(Page)æ—¶ï¼ŒExtensibleHashTableæ‰èƒ½æ­£å¸¸å·¥ä½œã€‚</li></ul><h3 id="bug4.-è¶…æ—¶">BUG4. è¶…æ—¶</h3><p>ä½†æ˜¯è¿™ä¸ªtestä»ç„¶æ— æ³•é€šè¿‡ï¼ŒåŸå› æ˜¯è¶…æ—¶ï¼ï¼</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/362bfec3df554ebea7891ffe6ab1668d.png" /></p><p>ä¼¼ä¹æ˜¯çœŸçš„å¤ªæ…¢äº†ï¼ŸçŒœæµ‹åº”è¯¥æ˜¯BucketPageé‡Œçš„Insertå’ŒRemoveå®ç°å¤ªæ…¢äº†</p><p>æ”¹è¿›äº†BucketPageå­˜å‚¨dataçš„æ–¹å¼ï¼Œæ·»åŠ ä¸€ä¸ªbitmapï¼Œbitmap[i]è¡¨ç¤ºarrayä¸­indexä¸ºiçš„é”®å€¼æ˜¯å¦ä¸ºç©ºï¼Œè¿™æ ·æœ€åæƒ…å†µä¸‹åªéœ€è¦<code>[0, max_size_]</code>çš„éå†ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/698d4605c4d44b2b9a1db8aa2409b165.png" /></p><blockquote><p>å¥½æ¶ˆæ¯ï¼šå˜å¿«äº†ï¼›åæ¶ˆæ¯ï¼šè¿˜æ˜¯è¶…æ—¶ï¼Ÿï¼</p></blockquote><hr /><blockquote><p>ğŸ™Œéœ€è¦æ˜ç¡®çš„æ˜¯ï¼šä¿®æ”¹å‡ åƒæ¬¡å°±éœ€è¦30sä»¥ä¸Šï¼Œç¡®å®æ˜¯æŸäº›åœ°æ–¹å®ç°ä¸æ°å½“ï¼Ÿ</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/1fac9ef504da409985ec6c1de3a32c76.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/477594a624af4dd2a5c769d2b7c8922c.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/b441e26013554d529327e077ba26de98.png" /></p><p>åœ¨æœ¬åœ°ç»Ÿè®¡äº†ä¸€ä¸‹æ¯insert/remove and lookup 10keysæ‰€éœ€è¦çš„æ—¶é—´ï¼Œå¯ä»¥çœ‹åˆ°æ— è®ºæ˜¯insertè¿˜æ˜¯removeï¼Œè¶Šå¾€åæ‰€éœ€è¦çš„æ—¶é—´è¶Šå¤šã€‚</p><h2 id="å®Œç»“">å®Œç»“ï¼</h2><p>ç»è¿‡æ¥è¿‘ä¸€ä¸ªæ˜ŸæœŸçš„Debugï¼Œç»ˆäºé€šè¿‡äº†ï¼ï¼</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/7af50da14006455a8ea7f53ba44eb476.png"alt="pass" /><figcaption aria-hidden="true">pass</figcaption></figure><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/9223079ff77142da960bd1b53ba8c951.png" /></p><p>åœ¨é‡æ–°å®ç°äº†P1çš„BufferPoolManagerä¹‹åï¼Œé¡ºåˆ©é€šè¿‡äº†P2ï¼Œåœ¨é‡å†™çš„æ—¶å€™ä¼˜åŒ–äº†LRUKNodeé‡Œå¯¹è®¿é—®è®°å½•çš„å­˜å‚¨ï¼š</p><ul><li>ä¹‹å‰æ˜¯ï¼šä¸€è‚¡è„‘å…¨éƒ¨å­˜è¿›<code>history_</code></li><li>ä¼˜åŒ–åï¼š<code>history_</code>ä¸­åªå­˜æ”¾æœ€è¿‘çš„åæ¡è®¿é—®è®°å½•</li></ul><p>ä¸‹é¢æ˜¯ä¼˜åŒ–å‰åï¼ŒExtensibleHashTableè¿è¡Œè¿‡ç¨‹ä¸­åœ¨LRUKNodeçš„Accessä¸­æ‰“å°å‡ºæ¥çš„æ—¥å¿—ï¼šä¼˜åŒ–å‰ï¼Œhistory_ä¸­è¦å­˜æ”¾6000å·¦å³ä¸ªè®¿é—®è®°å½•ï¼Œè€Œä¼˜åŒ–ååªéœ€è¦10ä¸ªï¼›è€Œä¸”åœ¨1500æ¬¡å·¦å³çš„Insert-and-Lookupå’ŒRemove-and-Lookupçš„æ“ä½œä¸­ï¼Œæœ‰18000æ¬¡å¯¹Nodeçš„è®¿é—®æ“ä½œã€‚</p><p>åŸå› å¯èƒ½æ˜¯ï¼š<code>history_</code>ä¸­å­˜å‚¨è¿‡å¤šçš„æ•°æ®ï¼Œå¯¼è‡´å†…å­˜é¢‘ç¹æ¢é¡µï¼Œç©ºé—´å±€éƒ¨æ€§ä¸¢å¤±ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/ff1e000ebffa40668b9d12027d2c1657.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/b6784331635644f59a0f5b40e8f5d3b9.png" /></p>]]></content>
      
      
      <categories>
          
          <category> CMU 15445 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 15445 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ECMAScript</title>
      <link href="/2024/03/05/front-end-technology/ECMAScript/"/>
      <url>/2024/03/05/front-end-technology/ECMAScript/</url>
      
        <content type="html"><![CDATA[<h1 id="ecmascript">ECMAScript</h1><h2 id="æ¦‚è¿°">1 æ¦‚è¿°</h2><p>ECMAæ˜¯ä¸€ä¸ªç»„ç»‡ï¼Œåˆ¶å®šäº†ä¸€äº›æ ‡å‡†ï¼Œç„¶åJSå»å®ç°è¿™äº›æ ‡å‡†ã€‚</p><p>ES2015å…¼å®¹æ€§ï¼šIE10+ã€Chromeã€FireFoxã€ç§»åŠ¨ç«¯ã€NodeJS</p><p>ç”±äºå…¼å®¹æ€§é—®é¢˜ï¼Œå¯¹äºä¸€äº›ç‰ˆæœ¬è¾ƒä½çš„è®¾å¤‡ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸€äº›æ–¹æ³•ä½¿å¾—ES6çš„ä»£ç å¯ä»¥è¿è¡Œèµ·æ¥</p><p>1ã€æµè§ˆå™¨æ‰“å¼€é¡µé¢æ—¶ï¼Œå¯¹ES6ä»£ç è¿›è¡Œè½¬æ¢ã€‚</p><p>2ã€å…ˆå°†ES6ä»£ç ç¼–è¯‘ä¸ºå¯ä»¥è¢«ä½ç‰ˆæœ¬è®¾å¤‡æ¥æ”¶çš„ä»£ç ï¼Œå†æ‹¿å»æ‰§è¡Œã€‚</p><h2 id="letconstå’Œå—çº§ä½œç”¨åŸŸ">2 let/constå’Œå—çº§ä½œç”¨åŸŸ</h2><p>ä¹‹å‰çš„JSä¸­åªæœ‰<code>var</code>å¯ä»¥å£°æ˜å˜é‡ï¼Œä½†æ˜¯<code>var</code>å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ol type="1"><li>å¯ä»¥é‡å¤å£°æ˜ =ã€‹æ··ä¹±</li><li>æ— æ³•é™åˆ¶ä¿®æ”¹ =ã€‹ æƒ³è¦å£°æ˜å¸¸é‡å…¨å‡­è‡ªè§‰</li><li>æ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼ˆåªæœ‰å‡½æ•°ä½œç”¨åŸŸï¼‰</li></ol><p>å¯¹äºç¬¬3ä¸ªé—®é¢˜ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­è¯´æ˜</p><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> arr = []<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++)&#123;<br>        arr.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">return</span> i*i;<br>        &#125;);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><br><span class="hljs-keyword">var</span> resluts = <span class="hljs-title function_">func</span>()<br><span class="hljs-keyword">var</span> f1 = results[<span class="hljs-number">0</span>];<br><span class="hljs-keyword">var</span> f2 = resluts[<span class="hljs-number">1</span>];<br><span class="hljs-keyword">var</span> f3 = resluts[<span class="hljs-number">2</span>];<br><br><span class="hljs-title function_">f1</span>(); <span class="hljs-comment">// 16</span><br><span class="hljs-title function_">f2</span>(); <span class="hljs-comment">// 16</span><br><span class="hljs-title function_">f3</span>(); <span class="hljs-comment">// 16</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç°è±¡å°±æ˜¯ç”±äº<code>var</code>æ²¡æœ‰å—çº§ä½œç”¨åŸŸå¼•èµ·çš„ã€‚ç”±äºå‡½æ•°å†…éƒ¨éƒ½å¼•ç”¨äº†å˜é‡<code>i</code>ï¼Œä½†æ˜¯å‡½æ•°å¹¶ä¸æ˜¯ç«‹åˆ»æ‰§è¡Œçš„ï¼Œç­‰åˆ°<code>results[0]</code>éœ€è¦è¿”å›çš„æ—¶å€™ï¼Œ<code>i</code>å·²ç»å˜æˆ3äº†ï¼Œæ‰€ä»¥éƒ½è¾“å‡ºäº†<code>9</code>ã€‚</p><p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨é—­åŒ…æ¥è§£å†³ï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°å¹¶ç«‹åˆ»æ‰§è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">var</span> arr = []<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++)&#123;<br>        arr.<span class="hljs-title function_">push</span>( <br>            (<span class="hljs-keyword">function</span>(<span class="hljs-params">n</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>                    <span class="hljs-keyword">return</span> n * n;<br>                &#125;<br>            &#125;)(i)<br>                );<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> arr;<br>&#125;<br><br><span class="hljs-keyword">var</span> resluts = <span class="hljs-title function_">func</span>()<br><span class="hljs-keyword">var</span> f1 = results[<span class="hljs-number">0</span>];<br><span class="hljs-keyword">var</span> f2 = resluts[<span class="hljs-number">1</span>];<br><span class="hljs-keyword">var</span> f3 = resluts[<span class="hljs-number">2</span>];<br><br><span class="hljs-title function_">f1</span>(); <span class="hljs-comment">// 1</span><br><span class="hljs-title function_">f2</span>(); <span class="hljs-comment">// 4</span><br><span class="hljs-title function_">f3</span>(); <span class="hljs-comment">// 9</span><br></code></pre></td></tr></table></figure></blockquote><p>ES6å¼•å…¥<code>let</code>å’Œ<code>const</code>å…³é”®å­—ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³ä¸Šé¢ä¸‰ä¸ªé—®é¢˜ã€‚</p><ol type="1"><li>ä½¿ç”¨<code>let</code>å’Œ<code>const</code>å£°æ˜å˜é‡ï¼Œä¸èƒ½é‡å¤å£°æ˜</li><li><code>const</code>å£°æ˜å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹</li><li><code>let</code>å’Œ<code>const</code>éƒ½æ˜¯å—çº§ä½œç”¨åŸŸï¼Œè¦è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œåªè¦å°†<code>for(var i...)</code>æ”¹æˆ<code>for(let i...)</code>å³å¯ã€‚</li></ol><h2 id="è§£æ„èµ‹å€¼">3 è§£æ„èµ‹å€¼</h2><p>è§£æ„èµ‹å€¼æ˜¯å¯¹èµ‹å€¼æ“ä½œç¬¦çš„æ‰©å±•ï¼Œä»å­—é¢æ„æ€ä¸Šç†è§£ï¼Œå°±æ˜¯æŠŠå¤æ‚å¯¹è±¡æ‹†åˆ†å¼€ç»™å…¶ä»–å˜é‡èµ‹å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> [a, b, c] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">// a=1, b=2, c=3</span><br><span class="hljs-keyword">let</span> [a, ...b] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">// a=1, b=[2,3]</span><br><br><span class="hljs-keyword">let</span> &#123;x, y, z&#125; = &#123;<span class="hljs-attr">x</span>:<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-attr">y</span>:<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-attr">z</span>:<span class="hljs-string">&quot;z&quot;</span>&#125;; <span class="hljs-comment">// x=&quot;x&quot;, y=&quot;y&quot;, z=&quot;z&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> front-end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ES6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab2 System Call</title>
      <link href="/2024/03/05/6.S081/6.S081-lab2-syscall/"/>
      <url>/2024/03/05/6.S081/6.S081-lab2-syscall/</url>
      
        <content type="html"><![CDATA[<h2 id="preview">1. Preview</h2><h3 id="xv6-book-chap2">1.1 xv6-book Chap2</h3><p>xv6-bookçš„ç¬¬äºŒç« å’Œlecture3çš„å†…å®¹ç±»ä¼¼ï¼Œä¸»è¦ä»‹ç»äº†æ“ä½œç³»ç»Ÿçš„ç»„ç»‡ç»“æ„ï¼Œä»ç‰©ç†èµ„æºçš„æŠ½è±¡ã€ç”¨æˆ·æ€/å†…æ ¸æ€ã€ç³»ç»Ÿè°ƒç”¨ã€å¾®å†…æ ¸/å®å†…æ ¸ä»¥åŠä»£ç å±‚é¢å±•å¼€</p><p>xv6-bookçš„4.3ã€4.4èŠ‚è®²çš„æ˜¯å¦‚ä½•è¿›è¡Œç³»ç»Ÿè°ƒç”¨</p><h3 id="code">1.2 code</h3><p>äº†è§£xv6å¯åŠ¨è¿‡ç¨‹</p><p><code>_entry.S</code>ä¸­å°†<code>stack0+4096</code>èµ‹ç»™æ ˆæŒ‡é’ˆå¯„å­˜å™¨<code>sp</code>ï¼Œä½¿å¾—å…¶æŒ‡å‘æ ˆé¡¶ï¼Œç„¶å<code>call start</code></p><p><code>start</code> =&gt; <code>main</code> =&gt;<code>userinit</code> =&gt; <code>initcode.S</code> =&gt;<code>init.c</code></p><h2 id="system-call-tracing">2 System call tracing</h2><p><code>trace</code>æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œèƒ½å¤Ÿè®°å½•æŒ‡å®šçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">trace 32 grep hello README</span><br>3: syscall read -&gt; 1023<br>3: syscall read -&gt; 966<br>3: syscall read -&gt; 70<br>3: syscall read -&gt; 0<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">å‘½ä»¤çš„æ ¼å¼</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">trace [MASK] [OPTIONS...] <span class="hljs-comment"># å…¶ä¸­[MASK]æ˜¯ä¸€ä¸ªæ•°å­—n; å¦‚æœ (n &gt;&gt; i) &amp; 1 == 1 è¡¨ç¤ºiå·ç³»ç»Ÿè°ƒç”¨éœ€è¦trace</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">è¾“å‡ºçš„å½¢å¼</span><br>[pid]: syscall &lt;name&gt; -&gt; &lt;return_value&gt;<br></code></pre></td></tr></table></figure><p>é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯<code>trace</code>ä¹Ÿæ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥å°±éœ€è¦å¤§æ¦‚æ˜ç™½ä»ç”¨æˆ·æ€è°ƒç”¨<code>trace</code>å·¥å…·åˆ°å†…æ ¸è°ƒç”¨å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹ã€‚</p><p>æ ¹æ®æ‰‹å†Œçš„æŒ‡ç¤ºå¤§æ¦‚èƒ½å¤Ÿæ¨æµ‹å‡ºæ¥</p><p>1ã€åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š<code>trace 32 grep hello README</code>åï¼Œå®é™…ä¸Šæ˜¯æ‰§è¡Œ /user/trace.c æ–‡ä»¶ã€‚è¿‡ç¨‹å°±æ˜¯ å…ˆæ‰§è¡Œ <code>trace</code>å‡½æ•°ï¼Œç„¶åå†æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚</p><p>2ã€è¿™ä¸ª trace å‡½æ•°æ˜¯éœ€è¦åœ¨ /user/user.hæ–‡ä»¶ä¸­å®šä¹‰åŸå‹çš„ï¼Œä¹‹åå¥½åƒå°±æ‰¾ä¸åˆ°å¯¹åº”çš„å®ç°äº†ã€‚å…¶å®ä¹‹åçš„å®ç°æ˜¯åœ¨å†…æ ¸æ€äº†ï¼Œéœ€è¦å…ˆé™·å…¥å†…æ ¸ï¼Œæ‰‹å†Œä¸­è¯´è¦åœ¨/user/usys.pl ä¸­å®šä¹‰ä¸€ä¸ª stub: <code>entry("trace")</code>ï¼Œè¿™ä¸ªstubä¼šåœ¨user/usys.S ç”Ÿæˆä¸€æ®µæ±‡ç¼–ä»£ç ï¼šè¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€‚</p><p>3ã€å…¶ä¸­çš„<code>ecall</code>æŒ‡ä»¤å°±ä¼šè°ƒç”¨ /kernel/syscall.c ä¸­çš„<code>syscall</code> å‡½æ•°ï¼Œæ‰§è¡Œå¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•° sys_<name></p><p>ç„¶åå°±å¯ä»¥å¼€å§‹æ ¹æ®æ‰‹å†Œçš„æç¤ºå†™ä»£ç äº†...</p><ol type="1"><li>åœ¨ kernel/sysproc.c ä¸­å¢åŠ  sys_trace() å‡½æ•°</li><li>è¦åœ¨ proc ç»“æ„ä½“ä¸­å¢åŠ ä¸€ä¸ªæ–°çš„å˜é‡å­˜å‚¨ trace çš„å‚æ•°</li><li>ä¿®æ”¹ syscall() å‡½æ•°æ¥æ‰“å° trace è¾“å‡º</li><li>ä¿®æ”¹ fork() å‡½æ•°ä½¿å¾— trace çš„å‚æ•°ä»çˆ¶è¿›ç¨‹æ‹·è´åˆ°å­è¿›ç¨‹</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// åœ¨ kernel/sysproc.c ä¸­å¢åŠ  sys_trace å‡½æ•°</span><br>uint64<br><span class="hljs-title function_">sys_trace</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  <span class="hljs-type">int</span> n;<br>  <span class="hljs-keyword">if</span>( argint(<span class="hljs-number">0</span>, &amp;n) &lt; <span class="hljs-number">0</span> )&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <span class="hljs-comment">// parse the `n` to get which sys_call need to be traced</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span>* <span class="hljs-title">p</span> =</span> myproc();<br>  p-&gt;trace_mask = n;<br>  <br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// ä¿®æ”¹ kernel/syscall.c ä¸­çš„ syscall å‡½æ•°</span><br><span class="hljs-type">void</span><br><span class="hljs-title function_">syscall</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-type">int</span> num;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span> *<span class="hljs-title">p</span> =</span> myproc();<br><br>  num = p-&gt;trapframe-&gt;a7; <span class="hljs-comment">// a7: sys_call number</span><br>  <span class="hljs-keyword">if</span>(num &gt; <span class="hljs-number">0</span> &amp;&amp; num &lt; NELEM(syscalls) &amp;&amp; syscalls[num]) &#123;<br>    p-&gt;trapframe-&gt;a0 = syscalls[num]();<br>    <span class="hljs-comment">// add the trace check</span><br>    <span class="hljs-keyword">if</span>( (( p-&gt;trace_mask &gt;&gt; num ) &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span> )&#123; <span class="hljs-comment">// need to trace</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: syscall %s -&gt; %d\n&quot;</span>, p-&gt;pid, sys_call_names[num], p-&gt;trapframe-&gt;a0);<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %s: unknown sys call %d\n&quot;</span>,<br>            p-&gt;pid, p-&gt;name, num);<br>    p-&gt;trapframe-&gt;a0 = <span class="hljs-number">-1</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœ</p><blockquote><p>æ³¨æ„ç¬¬å››ä¸ªæµ‹è¯•æœ‰å¯èƒ½ä¼šè¶…æ—¶ï¼Œéœ€è¦ä¿®æ”¹ gradelib.py æ–‡ä»¶çš„ç¬¬ 428 è¡Œæ‰©å¤§æ—¶é—´é™åˆ¶</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212319005.png" /></p><h2 id="sysinfo">3 Sysinfo</h2><p>è¿˜æ˜¯å®ç°ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨å†…æ ¸å¡«ä¸Š <code>struct sysinfo</code>çš„ä¸¤ä¸ªå­—æ®µï¼Œå¹¶æ‹·è´å›ç”¨æˆ·ç©ºé—´ï¼Œä¸»è¦è¿‡ç¨‹ï¼š</p><ol type="1"><li>åƒ<code>trace</code>é‚£æ ·ï¼Œåœ¨å¯¹åº”ä½ç½®å¢åŠ ç³»ç»Ÿè°ƒç”¨æ‰€éœ€çš„ç›¸å…³ä¿¡æ¯ã€‚</li><li>åœ¨ <code>kernel/proc.c</code> ä¸­å¢åŠ ä¸€ä¸ªç»Ÿè®¡<code>not UNUSED process</code> çš„å‡½æ•°</li><li>åœ¨ <code>kernel/kalloc.c</code> ä¸­å¢åŠ ä¸€ä¸ªç»Ÿè®¡<code>free memory</code> çš„å‡½æ•°</li><li>ç†è§£ <code>copyout</code> å‡½æ•°ï¼Œåœ¨ç³»ç»Ÿè°ƒç”¨ä¸­å°†<code>struct sysinfo</code> ä»å†…æ ¸ç©ºé—´ æ‹·è´å…¥ ç”¨æˆ·ç©ºé—´</li></ol><p>æ ¸å¿ƒä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// need to copy the sysinfo struct from kernel space to user space</span><br>uint64<br><span class="hljs-title function_">sys_sysinfo</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  uint64 addr;<br>  <span class="hljs-keyword">if</span>( argaddr(<span class="hljs-number">0</span>, &amp;addr) &lt; <span class="hljs-number">0</span> )&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sysinfo</span> <span class="hljs-title">si</span>;</span><br>  si.nproc = notunusedproc();<br>  si.freemem = freemem();<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span>* <span class="hljs-title">p</span> =</span> myproc();<br>  <span class="hljs-keyword">if</span>( copyout(p-&gt;pagetable, addr, (<span class="hljs-type">char</span> *)(&amp;(si)), <span class="hljs-keyword">sizeof</span>(si)) &lt; <span class="hljs-number">0</span> )&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡ ä¸æ˜¯ UNUSED çš„ è¿›ç¨‹æ•°é‡ï¼Œåªéœ€è¦éå† proc æ•°ç»„å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">uint64<br><span class="hljs-title function_">notunusedproc</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; NPROC; i++)&#123;<br>    <span class="hljs-keyword">if</span>(proc[i].state != UNUSED)&#123;<br>      num++;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> num;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡ free memoryï¼Œéœ€è¦è¯»ä¸€ä¸‹ <code>kalloc.c</code> çš„ä»£ç ï¼Œä¼šå‘ç° åœ¨<code>kalloc</code> å‡½æ•°ä¸­ï¼Œå¦‚æœ <code>kmem.freelist</code>ä¸ä¸ºç©ºçš„è¯å°±ä¼šåˆ†é…ä¸€ä¸ª <code>PGSIZE</code> çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥åªéœ€è¦ç»Ÿè®¡<code>kmem.freelist</code> é“¾è¡¨é•¿åº¦å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">uint64<br><span class="hljs-title function_">freemem</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">run</span>* <span class="hljs-title">r</span> =</span> kmem.freelist;<br>  <span class="hljs-type">int</span> num = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span>(r)&#123;<br>    r = r-&gt;next;<br>    num++;<br>  &#125;<br>  <span class="hljs-keyword">return</span> num * PGSIZE;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœ</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212340499.png" /></p>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab1 Utilities</title>
      <link href="/2024/03/05/6.S081/6.S081-lab1-utils/"/>
      <url>/2024/03/05/6.S081/6.S081-lab1-utils/</url>
      
        <content type="html"><![CDATA[<h3 id="æ­å»ºlabç¯å¢ƒ">1ã€æ­å»ºlabç¯å¢ƒ</h3><h4 id="å®‰è£…å·¥å…·åŒ…">1ã€å®‰è£…å·¥å…·åŒ…</h4><p>ä½¿ç”¨çš„æ˜¯ä¹‹å‰è·‘åœ¨ VirtualBox ä¸Šçš„ Ubuntu è™šæ‹Ÿæœº ç‰ˆæœ¬ 20.04.5 TLS</p><p>ç„¶åæŒ‰ç…§<ahref="https://pdos.csail.mit.edu/6.828/2021/tools.html">å®˜ç½‘</a>ä¸Šçš„æŒ‡ä»¤ä¸‹è½½å¯¹åº”çš„å·¥å…·åŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo apt-get update &amp;&amp; sudo apt-get upgrade</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu</span><br></code></pre></td></tr></table></figure><p>å®Œæˆä¹‹åå¯ä»¥æµ‹è¯•ä¸€ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212121280.png" /></p><p>ç„¶ååˆ°<ahref="https://pdos.csail.mit.edu/6.828/2021/labs/util.html">labé¡µ</a>cloneç›¸åº”çš„ä»£ç </p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212134633.png" /></p><p>æœ€åæ‰§è¡Œ <code>make qemu</code>ï¼Œå‡ºç°</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212150813.png" /></p><p>å³ä¸ºæ­å»ºæˆåŠŸ</p><h4 id="gdbè°ƒè¯•è¿‡ç¨‹">2ã€gdbè°ƒè¯•è¿‡ç¨‹</h4><p>1ã€æ‰“å¼€ä¸¤ä¸ªcmdçª—å£</p><p>2ã€å…¶ä¸­ä¸€ä¸ªè¾“å…¥ï¼šmake qemu-gdb</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212206029.png" /></p><p>3ã€å¦ä¸€ä¸ªè¾“å…¥ï¼šgdb-multiarch kernel/kernel</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212223488.png" /></p><p>4ã€å¯ä»¥ä½¿ç”¨gdbå‘½ä»¤è¿›è¡Œè°ƒè¯•äº†</p><h3 id="book-riscv-chapter-one">2ã€book-riscv Chapter One</h3><h3 id="sleepeasy">3ã€sleepï¼ˆeasyï¼‰</h3><p>è¿™ä¸ªå‡½æ•°æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ sleep</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>&#123;<br>    <span class="hljs-keyword">if</span>(argc &lt; <span class="hljs-number">2</span>)&#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;too few arguments...&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    sleep(atoi(argv[<span class="hljs-number">1</span>]));<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="pingpongeasy">3ã€pingpongï¼ˆeasyï¼‰</h3><p>è¿™ä¸ªå‡½æ•°çš„å®ç°éœ€è¦é‡ç‚¹ç†è§£<code>pipe</code>å‡½æ•°ï¼ˆxv6-bookçš„ChapterOneï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212234931.png" /></p><p>æ„Ÿæ€§çš„ç†è§£ï¼Œ<code>pipe</code>å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªç®¡é“ï¼Œä½¿å¾—ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´å¯ä»¥é€šä¿¡ï¼ˆäº’ç›¸è¯»å–åˆ°å¯¹æ–¹å†™çš„æ•°æ®ï¼‰</p><p>å®é™…ä¸Šï¼Œ<code>pipe</code>åœ¨ä¼ å…¥çš„æ•°ç»„<code>p</code>é‡Œå­˜æ”¾ä¸€ä¸ª<code>read file descriptor</code>(<code>p[0]</code>)å’Œ<code>write file descriptor</code>(<code>p[1]</code>)</p><p>å°±åƒç®¡é“çš„ä¸€å¤´ä¸€å°¾ï¼Œä»"å¤´éƒ¨"å†™å…¥æ•°æ®ï¼Œå¯ä»¥ä»"å°¾éƒ¨"è¯»å–æ•°æ®</p><p>è€Œç”±äº<code>fork</code>åˆ›å»ºçš„å­è¿›ç¨‹ä¹Ÿä¼šå¸¦ç€è¿™ä¸ªæ•°ç»„<code>p</code>ï¼Œä»è€Œå¯ä»¥å®ç°çˆ¶å­è¿›ç¨‹çš„é€šä¿¡</p><p>ï¼ˆå…·ä½“ç»†èŠ‚å‚è§<ahref="https://pdos.csail.mit.edu/6.828/2021/xv6/book-riscv-rev2.pdf">xv6-book</a>çš„ç›¸åº”éƒ¨åˆ†ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <br><span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>&#123;<br>    <span class="hljs-type">int</span> p[<span class="hljs-number">2</span>];<br><br>    <span class="hljs-type">char</span> * parent_msg = <span class="hljs-string">&quot;p&quot;</span>;<br>    <span class="hljs-type">char</span> * child_msg  = <span class="hljs-string">&quot;c&quot;</span>;<br>    <span class="hljs-type">char</span> buffer[<span class="hljs-number">2</span>];<br><br>    pipe(p);<br>    <span class="hljs-keyword">if</span>(fork() == <span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: received ping\n&quot;</span>, getpid());<br>        close(p[<span class="hljs-number">0</span>]);<br>        write(p[<span class="hljs-number">1</span>], child_msg, <span class="hljs-number">1</span>);<br>        close(p[<span class="hljs-number">1</span>]);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        write(p[<span class="hljs-number">1</span>], parent_msg, <span class="hljs-number">1</span>);<br>        close(p[<span class="hljs-number">1</span>]);<br>        wait(<span class="hljs-number">0</span>);<br>        read(p[<span class="hljs-number">0</span>], buffer, <span class="hljs-number">1</span>);<br>        close(p[<span class="hljs-number">0</span>]);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: received pong\n&quot;</span>, getpid());<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="primesmoderatehard">4ã€primesï¼ˆmoderate/hardï¼‰</h3><p><code>primes</code>å‡½æ•°æ˜¯å€ŸåŠ©<code>pipeline</code>å®ç°äº†ä¸€ä¸ªç´ æ•°ç­›ã€‚</p><p>éœ€è¦å¥½å¥½ç†è§£ä¸‹é¢<ahref="https://swtch.com/~rsc/thread/">è¿™å¹…å›¾</a>å’Œä¸Šé¢çš„<code>pipe</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029212246450.png" /></p><p>æ€æƒ³ï¼šåœ¨æ¯ä¸ªè¿›ç¨‹ä¸­ï¼Œé€‰å–ä¸€ä¸ªç´ æ•°<code>N</code>ï¼ˆå°±æ˜¯é€šè¿‡ç®¡é“è¯»åˆ°çš„ç¬¬ä¸€ä¸ªæ•°ï¼‰ï¼Œç„¶åæŠŠæ‰€æœ‰è¯»åˆ°çš„æ•°ä¸­ä¸èƒ½è¢«æ•´é™¤<code>N</code>çš„æ•°ç»§ç»­é€šè¿‡ç®¡é“å†™è¿›ä¸‹ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œè€ŒæŠŠå¯ä»¥æ•´é™¤çš„æ•°<code>drop</code>æ‰ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">func</span><span class="hljs-params">(<span class="hljs-type">int</span> * p)</span>&#123;<br>    <span class="hljs-type">int</span> p1[<span class="hljs-number">2</span>];<br>    p1[<span class="hljs-number">0</span>] = p[<span class="hljs-number">0</span>]; p1[<span class="hljs-number">1</span>] = p[<span class="hljs-number">1</span>];<br><br>    pipe(p); <span class="hljs-comment">// create the new pipeline connect the it and the it&#x27;s child</span><br><br>    <span class="hljs-type">char</span> num[<span class="hljs-number">1</span>];<br>    close(p1[<span class="hljs-number">1</span>]); <span class="hljs-comment">// close the old write</span><br>    <span class="hljs-keyword">if</span>( read(p1[<span class="hljs-number">0</span>], num, <span class="hljs-number">1</span>) == <span class="hljs-number">1</span> )&#123;<br>        <span class="hljs-type">int</span> prime = num[<span class="hljs-number">0</span>]; <span class="hljs-comment">// the first number is the prime</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;prime %d\n&quot;</span>, prime);<br><br>        <span class="hljs-keyword">if</span>(fork() == <span class="hljs-number">0</span>)&#123;<br>            func(p); <span class="hljs-comment">// recursion</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            close(p[<span class="hljs-number">0</span>]); <span class="hljs-comment">// close the read</span><br>            <span class="hljs-keyword">while</span> ( read(p1[<span class="hljs-number">0</span>], num, <span class="hljs-number">1</span>) == <span class="hljs-number">1</span> )&#123;<br>                <span class="hljs-type">int</span> n = num[<span class="hljs-number">0</span>];<br>                <span class="hljs-keyword">if</span>(n % prime != <span class="hljs-number">0</span>)&#123;<br>                    write(p[<span class="hljs-number">1</span>], num, <span class="hljs-number">1</span>);<br>                &#125;<br>            &#125;<br>            close(p1[<span class="hljs-number">0</span>]);<br>            close(p[<span class="hljs-number">1</span>]);<br>            wait(<span class="hljs-number">0</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// no data avaliable</span><br>        close(p[<span class="hljs-number">0</span>]);<br>        close(p[<span class="hljs-number">1</span>]);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <br><span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>&#123;<br><br>    <span class="hljs-type">int</span> p[<span class="hljs-number">2</span>];<br>    pipe(p);<br><br>    <span class="hljs-keyword">if</span>(fork() == <span class="hljs-number">0</span>)&#123;<br>      func(p);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        close(p[<span class="hljs-number">0</span>]);<br>        <span class="hljs-type">char</span> num[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= <span class="hljs-number">35</span>; i++)&#123;<br>            num[<span class="hljs-number">0</span>] = i;<br>            write(p[<span class="hljs-number">1</span>], num, <span class="hljs-number">1</span>);<br>        &#125;<br>        close(p[<span class="hljs-number">1</span>]);<br>        wait(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="findmoderate">5ã€findï¼ˆmoderateï¼‰</h3><p><code>find</code>å‡½æ•°çš„å®ç°éœ€è¦å…ˆå»å­¦ä¹ ä¸€ä¸‹<code>ls</code>å‡½æ•°çš„å®ç°ï¼Œä¸»è¦æ˜¯å­¦ä¹ å¦‚ä½•è¯»å–ç›®å½•çš„ï¼Œè¯»æ‡‚äº†ä¹‹åéš¾åº¦ä¸æ˜¯å¾ˆå¤§ï¼Œéœ€è¦æ³¨æ„ä¸€äº›ç»†èŠ‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs c">    <span class="hljs-comment">// Look at user/ls.c to see how to read directories.</span><br>    <span class="hljs-comment">// Use recursion to allow find to descend into sub-directories.</span><br>    <span class="hljs-comment">// Don&#x27;t recurse into &quot;.&quot; and &quot;..&quot;.</span><br>    <span class="hljs-comment">// Changes to the file system persist across runs of qemu; to get a clean file system run make clean and then make qemu.</span><br>    <span class="hljs-comment">// You&#x27;ll need to use C strings. Have a look at K&amp;R (the C book), for example Section 5.5.</span><br>    <span class="hljs-comment">// Note that == does not compare strings like in Python. Use strcmp() instead.</span><br>    <span class="hljs-comment">// Add the program to UPROGS in Makefile. </span><br><br><br><span class="hljs-type">void</span><br><span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">char</span> *dir, <span class="hljs-type">char</span> *file)</span>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">stat</span> <span class="hljs-title">st</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">dirent</span> <span class="hljs-title">de</span>;</span><br>    <span class="hljs-type">int</span> fd;<br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">512</span>], *p;<br><br>    <span class="hljs-comment">// put the dir_name into the buf</span><br>    <span class="hljs-comment">// buf : dir_name/</span><br>    <span class="hljs-built_in">strcpy</span>(buf, dir);<br>    p = buf + <span class="hljs-built_in">strlen</span>(buf);<br>    *p++ = <span class="hljs-string">&#x27;/&#x27;</span>;<br><br>    <span class="hljs-keyword">if</span>( (fd = open(dir, <span class="hljs-number">0</span>)) &lt; <span class="hljs-number">0</span> )&#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;find: cannot open %s\n&quot;</span>, dir);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>( fstat(fd, &amp;st) &lt; <span class="hljs-number">0</span> )&#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;find: cannot stat %s\n&quot;</span>, dir);<br>        close(fd);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(st.type != T_DIR)&#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;find: %s is not a dir\n&quot;</span>, dir);<br>        close(fd);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">// read the every file or dir in the `dir` sequentially</span><br>    <span class="hljs-keyword">while</span>( read(fd, &amp;de, <span class="hljs-keyword">sizeof</span>(de)) == <span class="hljs-keyword">sizeof</span>(de))&#123;<br>        <span class="hljs-keyword">if</span>(de.inum == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<br><br>        <span class="hljs-type">char</span> *name = de.name;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(name, <span class="hljs-string">&quot;.&quot;</span>) == <span class="hljs-number">0</span> || <span class="hljs-built_in">strcmp</span>(name, <span class="hljs-string">&quot;..&quot;</span>) == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// not consider the . and ..</span><br><br>        memmove(p, name, DIRSIZ);<br>        p[DIRSIZ] = <span class="hljs-number">0</span>;<br><br>        <span class="hljs-keyword">if</span>(stat(buf, &amp;st) &lt; <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;find: cannot stat %s\n&quot;</span>, name);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(st.type == T_DIR)&#123;<br>            find(buf, file);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(name, file) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, buf);<br>        &#125;<br>    &#125;<br>    close(fd);<br>&#125;<br><br><span class="hljs-comment">// find &lt;dir_name&gt; &lt;file_name&gt;</span><br><span class="hljs-comment">// find all the &lt;file_name&gt; in the &lt;dir_name&gt;</span><br><span class="hljs-type">int</span><br><span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span>&#123;<br>    <span class="hljs-keyword">if</span>(argc &lt; <span class="hljs-number">3</span>)&#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;the arguments is too few...\n&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    find(argv[<span class="hljs-number">1</span>], argv[<span class="hljs-number">2</span>]);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="xargsmoderate">6ã€xargsï¼ˆmoderateï¼‰</h3><p>é¦–å…ˆéœ€è¦çŸ¥é“è¿™ä¸ªå‘½ä»¤æ˜¯å¹²ä»€ä¹ˆçš„ã€‚</p><blockquote><p>Run COMMAND with arguments INITIAL-ARGS and more arguments read frominput.</p></blockquote><p>æ€»çš„æ¥è¯´å°±æ˜¯<strong>ç”¨æ¥è·‘å…¶ä»–å‘½ä»¤çš„ï¼Œè€Œå‚æ•°ä»è¾“å…¥ä¸­è¯»å–</strong>ã€‚</p><p>ä»å®éªŒæ‰‹å†Œä¸Šçš„è¦æ±‚å’Œä¾‹å­æ¥çœ‹ï¼Œå®ç°çš„æ˜¯ä¸€ä¸ªåªå¸¦<code>-n</code>å‚æ•°ä¸”å‚æ•°å€¼åªä¸º1çš„<code>xargs</code>å‘½ä»¤</p><p>è¿™é‡Œçš„<code>-n</code>çš„æ„æ€æ˜¯æ‰§è¡Œå‘½ä»¤æœ€å¤§èƒ½å¤Ÿä»è¾“å…¥è¯»å–çš„å‚æ•°ä¸ªæ•°ï¼Œå¦‚æœ<code>-n 1</code>å°±æ„å‘³ç€åªèƒ½ä»è¾“å…¥è¯»å–ä¸€ä¸ªå‚æ•°æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥å°±æ„å‘³ç€ä¼šæ‰§è¡Œå¤šæ¬¡å‘½ä»¤ï¼ˆéœ€è¦æŠŠè¯»å–çš„å‚æ•°ç”¨å®Œï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> hello too | xargs <span class="hljs-built_in">echo</span> <span class="hljs-built_in">bye</span></span><br>bye hello too<br><span class="hljs-meta prompt_">$</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;1\n2&quot;</span> | xargs -n 1 <span class="hljs-built_in">echo</span> line</span><br>line 1<br>line 2<br><span class="hljs-meta prompt_">$</span><br></code></pre></td></tr></table></figure><p>ç†è§£äº†<code>xargs</code>çš„ä½œç”¨å’Œå®ç°çš„ç»†èŠ‚ï¼Œå°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/types.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/stat.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;user/user.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;kernel/param.h&quot;</span></span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">author: zhhc</span><br><span class="hljs-comment">date:   2022-10-09</span><br><span class="hljs-comment">time-spent: about 3 hours</span><br><span class="hljs-comment">*/</span><br><span class="hljs-type">int</span> seq_num = MAXARG;  <span class="hljs-comment">// the max_args per cmd</span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">exec1</span><span class="hljs-params">(<span class="hljs-type">char</span> **argv)</span>&#123;<br>    <span class="hljs-keyword">if</span>(fork() == <span class="hljs-number">0</span>)&#123;<br>        exec(argv[<span class="hljs-number">0</span>], argv);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        wait(<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span> &#123;<br>    <span class="hljs-keyword">if</span> (argc &lt; <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-built_in">fprintf</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;too few arguments...&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">512</span>]; <span class="hljs-comment">// store the input from the previous cmd</span><br>    <span class="hljs-type">int</span> read_n = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> read_total = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// attention: if exits &#x27;\n&#x27;, just a read can not read all</span><br>    <span class="hljs-keyword">while</span>( (read_n = read(<span class="hljs-number">0</span>, buf + read_total, <span class="hljs-number">512</span>)) &gt; <span class="hljs-number">0</span> )&#123;<br>        read_total += read_n; <span class="hljs-comment">// stat the number of input</span><br>    &#125;<br>    <span class="hljs-type">int</span> len = read_total;<br><br>    <span class="hljs-comment">// switch all the &#x27;\n&#x27; to &#x27; &#x27;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i ++)&#123;<br>        <span class="hljs-keyword">if</span>(buf[i] == <span class="hljs-string">&#x27;\n&#x27;</span>) buf[i] = <span class="hljs-string">&#x27; &#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-type">int</span> cmd_ptr = <span class="hljs-number">1</span>; <span class="hljs-comment">// the ptr to cmd</span><br>    <span class="hljs-type">bool</span> is_set_n = <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-comment">// set the max args</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;-n&quot;</span>) == <span class="hljs-number">0</span>)&#123;<br>        is_set_n = <span class="hljs-literal">true</span>;<br>        cmd_ptr = <span class="hljs-number">3</span>;<br>    &#125;<br><br>    <span class="hljs-type">char</span>* cmd_argv[MAXARG]; <span class="hljs-comment">// the cmd argv</span><br>    <span class="hljs-comment">// put the arg into the cmd_argv</span><br>    <span class="hljs-type">int</span> idx = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = cmd_ptr; i &lt; argc; i++) &#123;<br>        <span class="hljs-type">char</span> *arg = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">strlen</span>(argv[i])+<span class="hljs-number">1</span>); <span class="hljs-comment">// attention: must use malloc, put the data in heap</span><br>        <span class="hljs-comment">// if use char arg[MAXARG] will cause the error</span><br>        <span class="hljs-built_in">strcpy</span>(arg, argv[i]);<br>        cmd_argv[idx] = arg;<br>        idx ++;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(is_set_n)&#123;<br>        <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">char</span> arg[MAXARG];<br>        <span class="hljs-built_in">memset</span>(arg, <span class="hljs-number">0</span>, MAXARG); <span class="hljs-comment">// clear the space</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>            <span class="hljs-keyword">if</span>(buf[i] == <span class="hljs-string">&#x27; &#x27;</span>) &#123; <span class="hljs-comment">// can spilt out a arg</span><br><br>                arg[index++] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>                cmd_argv[idx++] = arg;<br><br>                <span class="hljs-comment">// run</span><br>                exec1(cmd_argv);<br><br>                index = <span class="hljs-number">0</span>;<br>                <span class="hljs-built_in">memset</span>(arg, <span class="hljs-number">0</span>, MAXARG); <span class="hljs-comment">// clear the space</span><br><br>                idx --;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            arg[index ++] = buf[i];<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">int</span> prev = <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">// should spilt the args with &#x27; &#x27;</span><br>        <span class="hljs-comment">// and put them into cmd_argv sequentially</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i ++)&#123;<br>            <span class="hljs-keyword">if</span>(buf[i] == <span class="hljs-string">&#x27; &#x27;</span>)&#123;<br>                <span class="hljs-type">char</span>* add_arg = (<span class="hljs-type">char</span> *)<span class="hljs-built_in">malloc</span>(i - prev);<br>                <span class="hljs-built_in">memcpy</span>(add_arg, buf+prev, i - prev);<br>                prev = i+<span class="hljs-number">1</span>; <span class="hljs-comment">// attention</span><br>                cmd_argv[idx++] = add_arg;<br>            &#125;<br>        &#125;<br>        exec1(cmd_argv);<br>    &#125;<br><br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><blockquote><p>è®°å½•ä¸€ä¸ªå°é—®é¢˜</p><p>å‘ç”Ÿåœ¨å°†argvé‡Œçš„å‚æ•°æ‹·è´åˆ°cmd_argvçš„è¿‡ç¨‹ä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>    <span class="hljs-type">char</span> agr[<span class="hljs-number">32</span>]; <span class="hljs-comment">// æ¯æ¬¡åˆ†é…åˆ°çš„åœ°å€éƒ½æ˜¯ä¸€æ ·çš„ï¼ï¼ï¼</span><br>    cmd_argv[idx ++] = <span class="hljs-built_in">strcpy</span>(arg, argv[i]);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•°ç»„ç©ºé—´æ˜¯åˆ†é…åœ¨æ ˆä¸­çš„ï¼Œè€Œä¸”ä¸€æ¬¡è¿­ä»£ä¹‹åç©ºé—´å¤±æ•ˆï¼Œå†æ¬¡åˆ†é…æ—¶å°±ä¼šåˆ†é…ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œå¯¼è‡´cmd_argvä¸­çš„æŒ‡é’ˆå€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œç„¶åstrcpyå°±æ˜¯åœ¨ä¸æ–­åœ°æ”¹å˜é‚£å—åœ°å€ä¸­çš„å†…å®¹ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€æ¬¡é‡è£…UbuntuåŒç³»ç»Ÿ</title>
      <link href="/2023/11/01/Linux/%E9%87%8D%E8%A3%85Ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/11/01/Linux/%E9%87%8D%E8%A3%85Ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>åŸå› æ˜¯åœ¨å†™ics2023çš„pa2æ—¶ï¼Œé‡åˆ°äº†é—®é¢˜å§‹ç»ˆæ— æ³•è§£å†³ï¼Œç”±äºå½“æ—¶çš„ç³»ç»Ÿç‰ˆæœ¬æ˜¯ubuntu21.04ï¼Œè€Œæ‰‹å†Œæ˜¯ubuntu22.04ï¼Œæ‰€ä»¥è®¤ä¸ºå¯èƒ½æ˜¯ç³»ç»Ÿç‰ˆæœ¬çš„é—®é¢˜ï¼Œäºæ˜¯æƒ³è¦æ›´æ¢ç³»ç»Ÿç‰ˆæœ¬ã€‚æŒ‰ç†è¯´åªéœ€è¦å‡çº§ä¸€ä¸‹Ubuntuå³å¯ï¼Œä½†æ˜¯å°è¯•äº†è‹¥å¹²ç§æ–¹å¼éƒ½æ— æ³•æˆåŠŸå‡çº§ï¼Œäºæ˜¯åªèƒ½åˆ æ‰åŸæœ‰çš„ubuntu21.04ï¼Œè£…ä¸Šæ–°çš„ubuntu22.04.</p><h2 id="åˆ é™¤åŒç³»ç»Ÿ">åˆ é™¤åŒç³»ç»Ÿ</h2><blockquote><p><ahref="https://blog.csdn.net/yldmkx/article/details/103949640">Windowså’ŒubuntuåŒç³»ç»Ÿâ€œå½»åº•â€åˆ é™¤ubuntuç³»ç»Ÿ_ubuntuç³»ç»Ÿåˆ é™¤microsoftåŸºæœ¬æ•°æ®-CSDNåšå®¢</a></p></blockquote><h2 id="å®‰è£…åŒç³»ç»Ÿ">å®‰è£…åŒç³»ç»Ÿ</h2><p>ç»ä¸–å¥½æ–‡ï¼Œä¸¤æ¬¡å®‰è£…åŒç³»ç»Ÿéƒ½æ˜¯å‚è€ƒè¿™ç¯‡æ–‡ç« </p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/407175785">Win10 ä¸‹å®‰è£…Ubuntu21.04æ¡Œé¢ç‰ˆ åŒç³»ç»Ÿ å¹¶è®¾ç½®win10ä¸ºé»˜è®¤å¯åŠ¨ç³»ç»Ÿ è¯¦ç»†æ•™ç¨‹</a></p></blockquote><p>ä¸è¿‡åœ¨è¿›å…¥ç³»ç»Ÿå¯åŠ¨èœå•çš„æ—¶å€™ï¼ŒæŒ‰<code>F2</code>æˆ–è€…<code>F12</code>éƒ½æ²¡ç”¨ï¼Œç»“æœæ˜¯å…³æœºä¹‹åæˆ³è€³æœºå­”è¾¹ä¸Šçš„å°æ´æ‰ä¼šè¿›å…¥ç³»ç»Ÿå¯åŠ¨èœå•ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/16988307940501.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="é…ç½®æ–°ç¯å¢ƒ">é…ç½®æ–°ç¯å¢ƒ</h2><blockquote><p>é‡åˆ°äº†ä¸¤ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜</p></blockquote><h3 id="apt-get-installçš„unmet-dependencies-error">apt-getinstallçš„Unmet Dependencies Error</h3><p>åœ¨ä½¿ç”¨<code>apt-get install</code>å®‰è£…ä¾èµ–åŒ…çš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šå‡ºç°<code>unmeet dependencies</code>ã€‚å°±æ˜¯è¦å®‰è£…è¿™ä¸ªåŒ…ï¼Œè¿™ä¸ªåŒ…çš„ä¾èµ–åŒ…æ²¡æœ‰è£…ä¸Šï¼Œæ‰€ä»¥è¿™ä¸ªåŒ…è£…ä¸ä¸Šã€‚</p><blockquote><p>https://appuals.com/fix-unmet-dependencies-error-ubuntu/</p></blockquote><p>æœ€åæ˜¯ä½¿ç”¨<code>aptitude</code>è¿™ä¸ªå·¥å…·ï¼Œå®ƒä¼šé’ˆå¯¹å‡ºç°çš„ä¾èµ–é—®é¢˜ï¼Œç»™å‡ºè§£å†³æ–¹æ¡ˆï¼Œæœ€åèƒ½å¤ŸæˆåŠŸè£…ä¸Šä¾èµ–åŒ…ã€‚</p><h3 id="gitçš„opensslç¼–è¯‘">gitçš„opensslç¼–è¯‘</h3><blockquote><p>gnutls_handshake() failed: The TLS connection was non-properlyterminated</p></blockquote><p>ç»å¸¸ä¼šåœ¨è£…å®Œubuntuç³»ç»Ÿä¹‹å<code>git clone</code>å‡ºç°è¿™ç§é”™è¯¯ï¼Œæ— è®ºæ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯çœŸæœºã€‚ä¸€æŸ¥è§£å†³æ–¹æ¡ˆï¼Œå¤§éƒ½æ˜¯ä¸ç—›ä¸ç—’çš„<code>git config</code>ä¸€äº›ä¸œè¥¿ã€‚ç„¶è€ŒçœŸæ­£çš„åŸå› æ˜¯<code>gnutls</code>è¿™ä¸ªåŒ…çš„æ•ˆæœä¸å¤Ÿå¥½ï¼Œåº”è¯¥æ¢æˆ<code>openssl</code>ã€‚</p><blockquote><p><ahref="https://askubuntu.com/questions/186847/error-gnutls-handshake-failed-when-connecting-to-https-servers">"error:gnutls_handshake() failed" when connecting to https servers</a></p></blockquote><p>é‚£ä¹ˆå¦‚ä½•ç”¨opensslé‡æ–°ç¼–è¯‘gitå‘¢ï¼Ÿæœ‰å¤§ä½¬åˆ¶ä½œå¥½äº†<code>shell</code>è„šæœ¬æ”¾åœ¨äº†Githubä¸Š</p><blockquote><p>https://github.com/paul-nelson-baker/git-openssl-shellscript</p></blockquote><p>ä½†æ˜¯ï¼Œç”±äºå‰é¢<code>apt-get install</code>çš„é—®é¢˜ï¼Œéœ€è¦å¯¹è„šæœ¬è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œå³<code>apt-get</code>-&gt;<code>aptitude</code>ï¼Œå¹¶ä¸”å»æ‰åé¢<code>-y</code>ï¼Œè¿™æ ·å°±èƒ½åœ¨å®‰è£…ä¾èµ–åŒ…çš„æ—¶å€™é€‰æ‹©æƒ³è¦çš„è§£å†³æ–¹æ¡ˆï¼ˆå› ä¸º<code>aptitude</code>å¤§éƒ¨åˆ†æƒ…å†µä¸‹é»˜è®¤è§£å†³æ–¹æ¡ˆæ˜¯å•¥éƒ½ä¸å¹²ï¼‰</p><blockquote><p>æ‰€å¹¸ï¼Œå®‰è£…å®Œæ–°ç³»ç»Ÿä¹‹åï¼Œé—®é¢˜å¾—åˆ°äº†è§£å†³ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºgitæ·»åŠ ssh</title>
      <link href="/2023/03/08/others/%E5%A2%9E%E5%8A%A0ssh/"/>
      <url>/2023/03/08/others/%E5%A2%9E%E5%8A%A0ssh/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åº”é¡¹ç›®è¦æ±‚ï¼Œéœ€è¦ä¸º<code>Git</code>é…ç½®<code>SSH</code>å¯†é’¥</p></blockquote><h3 id="ç”Ÿæˆsshå¯†é’¥">ç”ŸæˆSSHå¯†é’¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh-keygen -t rsa -b 2048 -C &quot;201250150@smail.nju.edu.cn&quot;<br></code></pre></td></tr></table></figure><p>è¾“å…¥å‘½ä»¤åï¼Œä¼šåœ¨å¯¹åº”çš„<code>.ssh</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶<code>id_rsa</code>å’Œ <code>id_rsa.pub</code></p><h3 id="å°†å…¬é’¥æ‹·è´åˆ°gitlabè´¦æˆ·">å°†å…¬é’¥æ‹·è´åˆ°GitLabè´¦æˆ·</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat ~/.ssh/id_rsa.pub | clip # å°†å…¬é’¥æ‹·è´è‡³å‰ªè´´ç‰ˆ<br></code></pre></td></tr></table></figure><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230308104505040.png" /></p><h3 id="é…ç½®git">é…ç½®Git</h3><blockquote><p>æ³¨æ„å¯¹Gitç‰ˆæœ¬æœ‰è¦æ±‚ï¼š&gt;= 2.34.0</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git update-git-for-windows<br></code></pre></td></tr></table></figure></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config [--global] gpg.format ssh<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git config [--global] user.signingkey ~/.ssh/id_rsa<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨sshå¯†é’¥ç­¾ç½²æäº¤">ä½¿ç”¨sshå¯†é’¥ç­¾ç½²æäº¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git commit -S -m &quot;My commit msg&quot; # -S è¡¨ç¤ºç­¾ç½²æäº¤æ—¶ä½¿ç”¨æ ‡å¿—<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Webå‰ç«¯å¤ä¹ </title>
      <link href="/2023/02/22/nju-course-review-notes/web%E5%89%8D%E7%AB%AF/"/>
      <url>/2023/02/22/nju-course-review-notes/web%E5%89%8D%E7%AB%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯†ç åŠ å¯†">å¯†ç åŠ å¯†</h2><ul><li>å¯é€†åŠ å¯†ç®—æ³•ï¼šåŠ å¯†åå¯ä»¥è§£å¯†å¾—åˆ°å¯†ç åŸæ–‡</li><li>å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†ã€è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥<ul><li>åŠ å¯†é€Ÿåº¦å¿«ï¼›ä¸å®‰å…¨ï¼›AESï¼›DES</li></ul></li><li>éå¯¹ç§°åŠ å¯†ï¼šåŠ å¯†ä½¿ç”¨å…¬é’¥ã€è§£å¯†ä½¿ç”¨ç§é’¥<ul><li>å®‰å…¨æ€§é«˜ï¼›åŠ å¯†æ—¶é—´é•¿ï¼›RSAï¼›DSA</li></ul></li><li>ä¸å¯é€†åŠ å¯†ç®—æ³•ï¼šåŠ å¯†åä¸èƒ½åå‘è§£å¯†<ul><li>å­˜å‚¨å¯†ç ç­‰ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼›MD5ï¼›SHA</li></ul></li></ul><h2 id="å‰ç«¯é‰´æƒ">å‰ç«¯é‰´æƒ</h2><blockquote><p>è®¤è¯ã€æˆæƒã€é‰´æƒå’Œæƒé™æ§åˆ¶æ˜¯ä¸€ä¸ªå‰åä¾æ¬¡å‘ç”Ÿã€ä¸Šä¸‹æ¸¸çš„å…³ç³»</p><p>1.è®¤è¯ =ã€‹2.æˆæƒ=ã€‹3.é‰´æƒ=ã€‹4.æƒé™æ§åˆ¶</p></blockquote><ul><li>è®¤è¯ï¼šæ ¹æ®å£°æ˜è€…æ‰€ç‰¹æœ‰çš„è¯†åˆ«ä¿¡æ¯ç¡®è®¤å£°æ˜è€…çš„èº«ä»½</li><li>æˆæƒï¼šèµ„æºæ‰€æœ‰è€…èµ‹äºˆæ‰§è¡Œè€…æŒ‡å®šèŒƒå›´çš„èµ„æºæ“ä½œæƒé™ï¼Œä»¥ä¾¿å¯¹èµ„æºçš„ç›¸å…³æ“ä½œ</li><li>é‰´æƒï¼šå¯¹äºä¸€ä¸ªå£°æ˜è€…æ‰€å£°æ˜çš„èº«ä»½æƒåˆ©ï¼Œå¯¹å…¶æ‰€å£°æ˜çš„çœŸå®æ€§è¿›è¡Œé‰´åˆ«ç¡®è®¤çš„è¿‡ç¨‹</li><li>æƒé™æ§åˆ¶ï¼šå°†å¯æ‰§è¡Œçš„æ“ä½œå®šä¹‰ä¸ºæƒé™åˆ—è¡¨å¹¶åˆ¤æ–­æ“ä½œæ˜¯å¦å…è®¸/ç¦æ­¢</li></ul><h3 id="httpåŸºæœ¬é‰´æƒ">HTTPåŸºæœ¬é‰´æƒ</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219161544843.png" /></p><ul><li>ä¼˜ç‚¹ï¼šç®€å•</li><li>ç¼ºç‚¹ï¼šä¸å®‰å…¨ï¼ˆç”¨æˆ·åå¯†ç è£¸éœ²ï¼‰ï¼›æ— æ³•ä¸»åŠ¨æ’¤é”€</li><li>ä½¿ç”¨åœºæ™¯ï¼šå¯¹å®‰å…¨è¦æ±‚ä¸é«˜çš„ç½‘ç»œï¼ˆå†…éƒ¨ç½‘ç»œï¼‰</li></ul><h3 id="session-cookieé‰´æƒ">Session-Cookieé‰´æƒ</h3><blockquote><p>æœåŠ¡ç«¯çš„Sessionå’Œæµè§ˆå™¨ç«¯çš„Cookie</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219161844528.png" /></p><ul><li>ä¼˜ç‚¹ï¼šCookieç®€å•æ˜“ç”¨ï¼›Sessionç›¸è¾ƒäºJWTæ–¹ä¾¿ç®¡ç†ï¼›åç«¯æ“ä½œå³å¯</li><li>ç¼ºç‚¹ï¼šä¾èµ–Cookieï¼ˆç¦ç”¨å°±ä¼šå¤±æ•ˆï¼‰ï¼›Cookieä¸å®‰å…¨ï¼›Sessionå¢å¤§æœåŠ¡ç«¯å¼€é”€ï¼›</li><li>ä½¿ç”¨åœºæ™¯ï¼šä¸­å¤§å‹çš„ç½‘ç«™</li></ul><h3 id="token">Token</h3><blockquote><p>è®¿é—®èµ„æºæ¥å£éœ€è¦çš„èµ„æºå‡­è¯</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219162244318.png" /></p><ul><li>ä¼˜ç‚¹ï¼šæœåŠ¡ç«¯æ— çŠ¶æ€åŒ–ã€å¯æ‰©å±•æ€§å¥½ï¼›æ”¯æŒAPPç§»åŠ¨ç«¯è®¾å¤‡ï¼›ä¸éœ€è¦Cookieï¼Œå®‰å…¨æ€§å¥½ï¼Œæ”¯æŒè·¨ç¨‹åºè°ƒç”¨ï¼›</li><li>ç¼ºç‚¹ï¼šéœ€è¦å‰åç«¯é…åˆï¼›å å¸¦å®½ï¼ˆæ¯”sidæ›´å¤§ï¼‰ï¼›æœ‰æ•ˆæœŸçŸ­ï¼›æ€§èƒ½é—®é¢˜ï¼ˆéœ€è¦å¯¹tokenåŠ å¯†è§£å¯†ï¼‰</li></ul><h3 id="refresh-token">Refresh Token</h3><blockquote><p>ç”¨æ¥è·å–Access Tokenï¼Œæœ‰æ•ˆæœŸæ¯”Access Tokené•¿ä¸€äº›</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219163335945.png" /></p><h3 id="jwté‰´æƒ">JWTé‰´æƒ</h3><blockquote><p>å¯¹ç”¨æˆ·ä¿¡æ¯ç»„æˆJSONå¯¹è±¡ç„¶åè¿›è¡ŒåŠ å¯†ç­¾åå®ç°æˆæƒéªŒè¯çš„æ–¹æ¡ˆ</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219163533415.png" /></p><ul><li>ä¼˜ç‚¹ï¼šä¸éœ€è¦åœ¨æœåŠ¡ç«¯ä¿å­˜ä¼šè¯ä¿¡æ¯</li><li>ç¼ºç‚¹ï¼šåŠ å¯†é—®é¢˜ï¼›åˆ°æœŸé—®é¢˜ï¼ˆæ— æ³•åºŸæ­¢Tokenæˆ–æ›´æ”¹Tokenï¼‰</li></ul><h3 id="cookieå’Œsession">Cookieå’ŒSession</h3><ul><li>å®‰å…¨æ€§ï¼šCookieä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œå¯ä»¥è¢«éšæ„ç¯¡æ”¹</li><li>å­˜å–å€¼çš„ç±»å‹ï¼šCookieåªæ”¯æŒå­—ç¬¦ä¸²æ•°æ®ï¼›Sessionå¯ä»¥å­˜æ”¾ä»»æ„æ•°æ®</li><li>æœ‰æ•ˆæœŸä¸åŒï¼šCookieå¯ä»¥è®¾ç½®é•¿æ—¶é—´ä¿æŒï¼›Sessionä¸€èˆ¬å¤±æ•ˆæ—¶é—´çŸ­</li><li>å­˜å‚¨å¤§å°ä¸åŒï¼šCookieä¿å­˜æ•°æ®ä¸èƒ½è¶…å‡º4K</li></ul><h3 id="tokenå’Œsession">Tokenå’ŒSession</h3><ul><li>å­˜å‚¨ä½ç½®ä¸åŒï¼šTokenå­˜å‚¨åœ¨å‰ç«¯ï¼ŒSessionå­˜å‚¨åœ¨åç«¯</li><li>å®‰å…¨æ€§ï¼šTokenå®‰å…¨æ€§æ›´å¥½ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½æœ‰ç­¾å</li><li>æ”¯æŒæ€§ä¸åŒï¼šSession-Cookieè®¤è¯éœ€è¦æµè§ˆå™¨çš„Cookieæœºåˆ¶å®ç°ï¼›TokenéªŒè¯æœºåˆ¶ä¸°å¯Œäº†å®¢æˆ·ç«¯ç±»å‹</li></ul><h3 id="ç™»å½•æ–¹æ¡ˆ">ç™»å½•æ–¹æ¡ˆ</h3><ul><li>å•ç‚¹ç™»å½•ï¼ˆSSO: Single SignOnï¼‰ç™»å½•ä¸€æ¬¡å°±å¯ä»¥è®¿é—®å…¶ä»–ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿ</li><li>OAuth2.0ï¼šå…è®¸ç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®ä»–ä»¬å­˜å‚¨åœ¨å¦å¤–çš„æœåŠ¡æä¾›è€…çš„ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹ç½‘ç«™</li><li>è”åˆç™»å½•å’Œä¿¡ä»»ç™»å½•</li><li>å”¯ä¸€ç™»å½•ï¼šç¦æ­¢å¤šäººåŒæ—¶ç™»å½•ç»Ÿä¸€è´¦å·</li><li>æ‰«ç ç™»å½•</li><li>ä¸€é”®ç™»å½•ï¼šçŸ­ä¿¡éªŒè¯ç </li></ul><h2 id="å‰ç«¯æ€§èƒ½ä¼˜åŒ–">å‰ç«¯æ€§èƒ½ä¼˜åŒ–</h2><blockquote><p>è¦ç‚¹ï¼Œå¸¸ç”¨æœ¯è¯­ï¼Œæµè§ˆå™¨æ¸²æŸ“æœºåˆ¶ï¼Œæ€§èƒ½åˆ†ææ–¹æ³•ï¼Œæœ€ä½³å®è·µ</p></blockquote><blockquote><p><strong>çœ‹PPT</strong></p></blockquote><h3 id="æµè§ˆå™¨é¡µé¢æ¸²æŸ“æœºåˆ¶">æµè§ˆå™¨é¡µé¢æ¸²æŸ“æœºåˆ¶</h3><ul><li>DNSæŸ¥è¯¢ =ã€‹TCPæ¡æ‰‹ =ã€‹TLSï¼ˆTransport Layer Securityï¼‰åå•†=ã€‹TCPæ…¢å¯åŠ¨ï¼ˆ14KBè§„åˆ™ï¼‰</li><li>ç¬¬ä¸€æ­¥ï¼šå¤„ç†HTMLæ ‡è®°å¹¶æ„é€ DOMæ ‘ï¼ŒHTMLè§£ææ¶‰åŠåˆ° tokenizationå’Œæ ‘çš„æ„é€ ï¼ˆ<code>&lt;script&gt;</code>æ ‡ç­¾ä¼šé˜»å¡HTMLçš„è§£æï¼‰</li><li>ç¬¬äºŒæ­¥ï¼šå¤„ç†CSSå¹¶æ„å»ºCSSOMæ ‘ï¼Œéå†CSSä¸­æ¯ä¸ªè§„åˆ™é›†ï¼Œæ ¹æ®é€‰æ‹©å™¨åˆ›å»ºå…·æœ‰çˆ¶ã€å­å’Œå…„å¼Ÿå…³ç³»çš„èŠ‚ç‚¹æ•°</li><li>ç¬¬ä¸‰æ­¥ï¼šå°†DOMå’ŒCSSOMç»„åˆæˆä¸€ä¸ªRenderæ ‘ï¼Œè®¡ç®—æ ·å¼æ ‘æˆ–æ¸²æŸ“æ ‘ä»DOMæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹æ„å»ºï¼Œéå†æ¯ä¸ªå¯è§èŠ‚ç‚¹</li><li>ç¬¬å››æ­¥ï¼šåœ¨æ¸²æŸ“æ ‘ä¸Šè¿è¡Œå¸ƒå±€ä»¥è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä½“<ul><li>ç¬¬ä¸€æ¬¡ç¡®å®šèŠ‚ç‚¹å¤§å°å’Œä½ç½®ç§°ä¸ºå¸ƒå±€ï¼›éšåå¯¹èŠ‚ç‚¹å¤§å°å’Œä½ç½®çš„é‡æ–°è®¡ç®—ç§°ä¸ºå›æµ</li></ul></li><li>æœ€åä¸€æ­¥ï¼šå°†å„ä¸ªèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Šï¼Œå°†åœ¨å¸ƒå±€é˜¶æ®µè®¡ç®—çš„æ¯ä¸ªæ¡†è½¬æ¢ä¸ºå±å¹•ä¸Šçš„å®é™…åƒç´ </li><li>TTIï¼ˆTime To Interactiveï¼‰ç¬¬ä¸€ä¸ªè¯·æ±‚å¯¼è‡´DNSå’ŒSSL åˆ° é¡µé¢å¯äº¤äº’æ‰€ç”¨çš„æ—¶é—´</li><li>å…³é”®æ¸²æŸ“è·¯å¾„ï¼ˆCritical RenderPathï¼‰ä¼˜åŒ–ç­–ç•¥ä½¿æµè§ˆå™¨èƒ½å¤Ÿé€šè¿‡ç¡®å®šä¼˜å…ˆåŠ è½½çš„èµ„æºä»¥åŠèµ„æºåŠ è½½çš„é¡ºåºæ¥å°½å¯èƒ½å¿«åœ°åŠ è½½é¡µé¢</li></ul><h3 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</h3><ul><li>å»¶è¿Ÿä¸å¸¦å®½ï¼šä¼ æ’­/ä¼ è¾“/å¤„ç†/æ’é˜Ÿå»¶è¿Ÿ</li><li>webæ€§èƒ½è¦ç‚¹<ul><li>å»¶è¿Ÿå’Œå¸¦å®½å¯¹webæ€§èƒ½çš„å½±å“</li><li>ä¼ è¾“åè®®ï¼ˆTCPï¼‰å¯¹HTTPçš„å½±å“</li><li>HTTPåè®®è‡ªèº«çš„ç¼ºé™·</li><li>Webåº”ç”¨çš„å‘å±•è¶‹åŠ¿åŠæ€§èƒ½éœ€æ±‚</li><li>æµè§ˆå™¨å±€é™æ€§å’Œä¼˜åŒ–æ€è·¯</li></ul></li><li>æ€§èƒ½è¦ç´ ï¼šè®¡ç®—ã€æ¸²æŸ“ã€ç½‘ç»œ<ul><li>ä¸‰ä¸ªä»»åŠ¡ï¼šè·å–èµ„æºã€é¡µé¢å¸ƒå±€å’Œæ¸²æŸ“ã€jsæ‰§è¡Œ</li><li>æ›´å¤šå¸¦å®½å¹¶ä¸é‡è¦ï¼›å»¶è¿Ÿæ˜¯æ€§èƒ½ç“¶é¢ˆ</li></ul></li><li>æ€§èƒ½ç›‘æ§æŒ‡æ ‡<ul><li>é¦–å±æ—¶é—´</li><li>ç”¨æˆ·å¯äº¤äº’æ—¶é—´</li><li>æ€»ä¸‹è½½æ—¶é—´</li><li>FPï¼ˆFirst Paintï¼‰ã€FCPï¼ˆFirst Content Paintï¼‰ï¼ˆDOMå†…å®¹ï¼‰ã€FMPï¼ˆFirstMeaningful Paintï¼‰ï¼ˆå…³é”®å…ƒç´ ï¼‰</li></ul></li><li>æµè§ˆå™¨ä¼˜åŒ–<ul><li>åŸºäºæ–‡æ¡£çš„ä¼˜åŒ–ï¼šæå‰è·å–èµ„æºï¼Œæå‰è§£æ</li><li>æ¨æµ‹æ€§ä¼˜åŒ–ï¼šé¢„å…ˆè§£æDNSã€é¢„å…ˆè¿æ¥å¯èƒ½çš„ç›®æ ‡</li></ul></li><li>ï¼ˆ<strong>æœ€ä½³å®è·µ</strong>ï¼‰ä¸¤ä¸ªå‡†åˆ™<ul><li>æ¶ˆé™¤æˆ–å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œå»¶è¿Ÿ</li><li>å°†éœ€è¦ä¼ è¾“çš„æ•°æ®å‹ç¼©è‡³æœ€å°‘</li></ul></li><li>æ€§èƒ½å‡†åˆ™<ul><li>å‡å°‘DNSæŸ¥æ‰¾</li><li>é‡ç”¨TCPè¿æ¥</li><li>å‡å°‘HTTPé‡å®šå‘</li><li>ä½¿ç”¨CDNï¼ˆContent Distributed Network å†…å®¹åˆ†å‘ç½‘ç»œï¼‰</li><li>å»æ‰ä¸å¿…è¦çš„èµ„æº</li></ul></li><li>å…¶ä»–å‡†åˆ™<ul><li>åœ¨å®¢æˆ·ç«¯ç¼“å­˜èµ„æº</li><li>ä¼ è¾“å‹ç¼©è¿‡çš„å†…å®¹</li><li>æ¶ˆé™¤ä¸å¿…è¦çš„è¯·æ±‚å¼€é”€</li><li>å¹¶è¡Œå¤„ç†è¯·æ±‚å’Œå“åº”</li><li>é’ˆå¯¹åè®®ç‰ˆæœ¬é‡‡å–ä¼˜åŒ–æªæ–½<ul><li>é’ˆå¯¹HTTP1.xä¼˜åŒ–å»ºè®®<ul><li>é‡‡ç”¨HTTPç®¡é“</li><li>é‡‡ç”¨åŸŸååˆ†ç‰‡</li><li>æ‰“åŒ…èµ„æºä»¥å‡å°‘HTTPè¯·æ±‚</li><li>åµŒå…¥å°èµ„æº</li></ul></li><li>é’ˆå¯¹HTTP2çš„ä¼˜åŒ–<ul><li>å°‘å‘æ•°æ®ï¼Œå‡å°‘è¯·æ±‚ï¼Œå‡å°‘ä¼ è¾“æ•°æ®é‡å’Œä¸å¿…è¦ç½‘ç»œå»¶è¿Ÿï¼Œè°ƒæ•´èµ„æºä¾›ç»™</li><li>æ¯ä¸ªæ¥æºä¸€ä¸ªé“¾æ¥ï¼Œå»æ‰ä¸å¿…è¦èµ„æºæ‰“åŒ…ï¼Œåˆ©ç”¨æœåŠ¡å™¨æ¨é€</li></ul></li></ul></li></ul></li></ul><h2 id="http">HTTP</h2><blockquote><p>åŸºæœ¬åŸç†ã€ä¸ºä½•æ¼”è¿›ã€å¸¸è§çš„è¯·æ±‚æ–¹æ³•ã€å¤´åŸŸã€çŠ¶æ€ç </p></blockquote><h3 id="å¤´åŸŸ">å¤´åŸŸ</h3><p>ç”±ä¸»é”®/å€¼å¯¹ç»„æˆï¼Œæè¿°å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨çš„å±æ€§ã€è¢«ä¼ è¾“çš„èµ„æºä»¥åŠåº”è¯¥å®ç°çš„è¿æ¥</p><p>å››ç§ä¸åŒç±»å‹çš„å¤´æ ‡</p><ul><li>é€šç”¨å¤´æ ‡ï¼šå³å¯ç”¨äºè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥ç”¨äºå“åº”ï¼Œæ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“è€Œä¸æ˜¯ç‰¹å®šèµ„æºä¸äº‹åŠ¡ç›¸å…³è”</li><li>è¯·æ±‚å¤´æ ‡ï¼šå…è®¸å®¢æˆ·ç«¯ä¼ é€’å…³äºè‡ªèº«çš„ä¿¡æ¯å’Œå¸Œæœ›çš„å“åº”å½¢å¼</li><li>å“åº”å¤´æ ‡ï¼šæœåŠ¡å™¨ç”¨äºä¼ é€’è‡ªèº«ä¿¡æ¯çš„å“åº”</li><li>å®ä½“å¤´æ ‡ï¼šå®šä¹‰è¢«ä¼ é€èµ„æºçš„ä¿¡æ¯ï¼Œå³å¯ç”¨äºè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥ç”¨äºå“åº”</li></ul><h3 id="çŠ¶æ€ç ">çŠ¶æ€ç </h3><ul><li>1xxï¼šä¿¡æ¯å“åº”</li><li>2xxï¼šæˆåŠŸå“åº”</li><li>3xxï¼šé‡å®šå‘æ¶ˆæ¯<ul><li>301ï¼šæ°¸ä¹…é‡å®šå‘</li></ul></li><li>4xxï¼šå®¢æˆ·ç«¯é”™è¯¯å“åº”<ul><li>400ï¼šè¯·æ±‚é”™è¯¯</li><li>401ï¼šæœªè®¤è¯</li><li>403ï¼šæœªæˆæƒç¦æ­¢è®¿é—®</li><li>404ï¼šæ‰¾ä¸åˆ°</li></ul></li><li>5xxï¼šæœåŠ¡ç«¯é”™è¯¯å“åº”<ul><li>500ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯</li></ul></li></ul><h3 id="è¯·æ±‚æ–¹æ³•">è¯·æ±‚æ–¹æ³•</h3><ul><li>GETï¼šä»æœåŠ¡å™¨è·å–URLå¯¹åº”èµ„æº</li><li>POSTï¼šä¿®æ”¹URLå¯¹åº”èµ„æº</li><li>PUTï¼šä¿®æ”¹æˆ–åˆ›å»ºèµ„æº</li><li>DELETEï¼šåˆ é™¤èµ„æº</li><li>HEADï¼šè·å–å°‘é‡ä¿¡æ¯</li></ul><h3 id="httpçš„æ¼”è¿›">HTTPçš„æ¼”è¿›</h3><ul><li>HTTP/1.xï¼šæŠ¥æ–‡æœ‰ä¸€äº›æ€§èƒ½ä¸Šçš„ç¼ºç‚¹ï¼šHeaderæ— æ³•å‹ç¼©ï¼›ç›¸ä¼¼headerçš„æŠ¥æ–‡é‡å¤ä¼ è¾“ï¼›æ— æ³•å¤ç”¨</li><li>HTTP/2ï¼šé€šè¿‡å¯ç”¨å®Œæ•´çš„è¯·æ±‚å’Œå“åº”å¤šè·¯å¤ç”¨æ¥å‡å°‘å»¶è¿Ÿï¼Œé€šè¿‡æœ‰æ•ˆå‹ç¼©HTTPæ ‡å¤´å­—æ®µæ¥æœ€å°åŒ–åè®®å¼€é”€ï¼Œå¹¶å¢åŠ å¯¹è¯·æ±‚ä¼˜å…ˆçº§å’ŒæœåŠ¡å™¨æ¨é€çš„æ”¯æŒ</li><li>HTTP/3ï¼šTCPé˜Ÿå¤´é˜»å¡é—®é¢˜ã€TCPæ¡æ‰‹æ—¶é•¿é—®é¢˜ã€ç§»åŠ¨åœºæ™¯çš„ç½‘ç»œåˆ‡æ¢æˆæœ¬</li></ul><h3id="å½±å“httpå¸¸è§çš„ä¸tcpç›¸å…³çš„å»¶è¿Ÿ">å½±å“HTTPå¸¸è§çš„ä¸tcpç›¸å…³çš„å»¶è¿Ÿ</h3><ul><li>TCPè¿æ¥æ¡æ‰‹</li><li>TCPæ…¢å¯åŠ¨æ‹¥å¡æ§åˆ¶</li><li>Nagleçš„æ•°æ®èšåˆç®—æ³•</li><li>TCPç”¨äºæ‰¿è½½ç¡®è®¤çš„å»¶è¿Ÿç¡®è®¤ç®—æ³•</li><li>TIME_WAITçš„å»¶è¿Ÿå’Œç«¯å£è€—å°½</li></ul><h3 id="http1.xçš„è¿æ¥ç®¡ç†">HTTP/1.xçš„è¿æ¥ç®¡ç†</h3><ul><li>çŸ­è¿æ¥ï¼šæ¯ä¸€æ¬¡HTTPè¯·æ±‚ä¹‹å‰éƒ½ä¼šæœ‰ä¸€æ¬¡TCPæ¡æ‰‹</li><li>é•¿è¿æ¥ï¼šé•¿è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´</li><li>HTTPæµæ°´çº¿ï¼šåœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šå‘å‡ºè¿ç»­çš„è¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…åº”ç­”è¿”å›</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219174647488.png" /></p><h2 id="node.js">Node.js</h2><blockquote><p>å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç¼–ç¨‹ã€é™æ€ç½‘é¡µå’ŒåŠ¨æ€ç½‘é¡µã€Nodejsä¼˜åŠ¿/ç‰¹ç‚¹/åº”ç”¨/åŸç†ï¼Œäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼ŒåŒæ­¥IOå’Œå¼‚æ­¥IOï¼Œé˜»å¡ä¸éé˜»å¡ï¼Œæ¨¡å—ï¼ŒES6ä¸CommonJSæ¨¡å—</p></blockquote><h3 id="é™æ€ç½‘é¡µä¸åŠ¨æ€ç½‘é¡µ">é™æ€ç½‘é¡µä¸åŠ¨æ€ç½‘é¡µ</h3><ul><li>é™æ€ç½‘é¡µï¼šå†™æ­»çš„HTMLæ–‡ä»¶ï¼Œæ¯æ¬¡é€šè¿‡urlè·å–åˆ°çš„éƒ½æ˜¯ä¸€æ ·çš„é¡µé¢ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤º</li><li>åŠ¨æ€ç½‘é¡µï¼šç”±ç¨‹åº/è„šæœ¬ç”ŸæˆHTMLæ–‡ä»¶ç„¶åè¿”å›ç»™å‰ç«¯ï¼Œæ¯æ¬¡è·å–çš„éƒ½å¯èƒ½æ˜¯ä¸åŒçš„é¡µé¢ï¼Œä¸èƒ½ç›´æ¥åœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤º</li></ul><h3 id="å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç¼–ç¨‹">å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç¼–ç¨‹</h3><ul><li>å®¢æˆ·ç«¯ç¼–ç¨‹ï¼šJSç¼–ç¨‹ï¼Ÿæ‰€è§å³æ‰€å¾—ï¼Ÿï¼ˆåŠæ—¶å±•ç¤ºåé¦ˆï¼‰<ul><li>å¥½å¤„ï¼šï¼ˆä¸ç”¨å’ŒæœåŠ¡ç«¯äº¤äº’ï¼‰æ•ˆç‡é«˜ã€äº‹ä»¶é©±åŠ¨ã€å¹³å°ç‹¬ç«‹æ€§</li></ul></li><li>æœåŠ¡ç«¯ç¼–ç¨‹ï¼šä½¿ç”¨webç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ç¼–å†™çš„ç¨‹åºã€‚å®šåˆ¶ç”¨æˆ·ä½“éªŒ<ul><li>å¥½å¤„ï¼šå®‰å…¨æ€§ã€å…¼å®¹æ€§ã€åŠŸèƒ½å…¨</li></ul></li></ul><h3 id="node.jsæ¦‚è¿°">Node.jsæ¦‚è¿°</h3><ul><li>Node.jsæ˜¯ä¸€ä¸ªå¼€æºçš„ã€è·¨å¹³å°çš„è¿è¡Œæ—¶ç¯å¢ƒã€‚å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨JavaScriptåˆ›å»ºå„ç§æœåŠ¡ç«¯å·¥å…·å’Œåº”ç”¨ç¨‹åº</li><li>ç‰¹ç‚¹ï¼šäº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥IOæ¡†æ¶</li><li>åº”ç”¨ï¼šç½‘ç«™ã€å³æ—¶èŠå¤©ã€å‰ç«¯æ„å»ºå·¥å…·ã€å‘½ä»¤è¡Œå·¥å…·ã€åå‘ä»£ç†<ul><li>é€‚ç”¨äºæ•°æ®å¯†é›†å‹å®æ—¶ç¨‹åºï¼ˆDIRT data-intensivereal-timeï¼‰IOå¯†é›†å‹</li></ul></li><li>ä¼˜åŠ¿ï¼šå“è¶Šçš„æ€§èƒ½è¡¨ç°ï¼›åˆ‡æ¢æˆæœ¬ä½ï¼›å¯ç§»æ¤ï¼›æ´»è·ƒçš„ç¤¾åŒº</li></ul><h3 id="äº‹ä»¶é©±åŠ¨æ¨¡å‹">äº‹ä»¶é©±åŠ¨æ¨¡å‹</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230219182900853.png" /></p><ul><li>ç»´æŠ¤äº†ä¸€ä¸ª event queue äº‹ä»¶é˜Ÿåˆ—</li><li>æœ‰ä¸€ä¸ª event loop äº‹ä»¶å¾ªç¯ä¸æ–­è¯»å– event queue ä¸­çš„äº‹ä»¶<ul><li>å¯¹äºéé˜»å¡äº‹ä»¶ï¼Œå¤„ç†å®Œè°ƒç”¨å›è°ƒå‡½æ•°å‘ä¸Šä¸€å±‚è¿”å›ç»“æœ</li><li>å¯¹äºé˜»å¡äº‹ä»¶ï¼Œå§”æ‰˜åå°çº¿ç¨‹æ± å¤„ç†ï¼›å®Œæˆåå°†æ‰§è¡Œç»“æœä¸æä¾›çš„å›è°ƒå‡½æ•°ä¸€èµ·å†è¢«æ”¾å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼›å½“eventloop å†æ¬¡è¯»åˆ°è¿™ä¸ªäº‹ä»¶æ—¶ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œå°†ç»“æœè¿”å›ç»™ä¸Šä¸€å±‚ã€‚</li></ul></li></ul><h3 id="åŒæ­¥ioä¸å¼‚æ­¥io">åŒæ­¥IOä¸å¼‚æ­¥IO</h3><table><thead><tr class="header"><th>åŒæ­¥IOï¼ˆé˜»å¡å¼ï¼‰</th><th>å¼‚æ­¥IOï¼ˆéé˜»å¡å¼ï¼‰</th></tr></thead><tbody><tr class="odd"><td>åˆ©ç”¨å¤šçº¿ç¨‹æä¾›ååé‡</td><td>å•çº¿ç¨‹å³å¯å®ç°é«˜ååé‡</td></tr><tr class="even"><td>é€šè¿‡æ—¶é—´ç‰‡åˆ†å‰²å’Œçº¿ç¨‹è°ƒåº¦åˆ©ç”¨å¤šæ ¸CPU</td><td>é€šè¿‡åŠŸèƒ½åˆ’åˆ†åˆ©ç”¨å¤šæ ¸CPU</td></tr><tr class="odd"><td>éœ€è¦æ“ä½œç³»ç»Ÿè°ƒç”¨å¤šçº¿ç¨‹ä½¿ç”¨å¤šæ ¸CPU</td><td>å¯ä»¥å°†å•è¿›ç¨‹ç»‘å®šåˆ°å•æ ¸CPU</td></tr><tr class="even"><td>éš¾ä»¥å……åˆ†åˆ©ç”¨CPUèµ„æº</td><td>å¯ä»¥å……åˆ†åˆ©ç”¨CPUèµ„æº</td></tr><tr class="odd"><td>å†…å­˜è½¨è¿¹å¤§ï¼Œæ•°æ®å±€éƒ¨æ€§å¼±</td><td>å†…å­˜è½¨è¿¹å°ï¼Œæ•°æ®å±€éƒ¨æ€§å¼º</td></tr><tr class="even"><td>ç¬¦åˆçº¿æ€§ç¼–ç¨‹æ€ç»´</td><td>ä¸ç¬¦åˆä¼ ç»Ÿç¼–ç¨‹æ€ç»´</td></tr></tbody></table><h3 id="é˜»å¡ä¸éé˜»å¡">é˜»å¡ä¸éé˜»å¡</h3><ul><li>é˜»å¡æ˜¯æŒ‡åœ¨Node.jsç¨‹åºä¸­ï¼Œå…¶ä»–JSè¯­å¥çš„æ‰§è¡Œï¼Œå¿…é¡»ç­‰å¾…ä¸€ä¸ªéJSæ“ä½œå®Œæˆï¼Œå› ä¸ºå½“é˜»å¡å‘ç”Ÿæ—¶ï¼Œäº‹ä»¶å¾ªç¯æ— æ³•ç»§ç»­è¿è¡ŒJS</li><li>éé˜»å¡æ˜¯æŒ‡ç¨‹åºå…ˆæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰ï¼Œå½“æ“ä½œå®Œæˆåï¼Œè§¦å‘è¯¥å›è°ƒå‡½æ•°æ‰§è¡Œåç»­é€»è¾‘ï¼Œä½†æ˜¯ä¸é˜»ç¢åé¢ä»£ç çš„æ‰§è¡Œã€‚</li></ul><h3 id="es6ä¸commonjsæ¨¡å—">ES6ä¸CommonJSæ¨¡å—</h3><blockquote><p>æ¨¡å—ï¼šä¸¤ç§æ¨¡å—ï¼Œä¸å…¼å®¹ï¼›esmå’Œcjs</p></blockquote><ul><li>è¯­æ³•<ul><li>CommonJSæ¨¡å—ä½¿ç”¨<code>require()</code>åŠ è½½å’Œ<code>module.exports</code>è¾“å‡º</li><li>ES6æ¨¡å—ä½¿ç”¨<code>import</code>å’Œ<code>export</code></li></ul></li><li>CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ŒES6æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„å¼•ç”¨</li><li>CommonJSæ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£</li><li>å¾ªç¯åŠ è½½<ul><li>å¯¹äºCommonJSï¼šåŠ è½½æ—¶æ‰§è¡Œï¼Œè„šæœ¬åœ¨<code>require</code>çš„æ—¶å€™å°±ä¼šå…¨éƒ¨æ‰§è¡Œ<ul><li>requireå…¨éƒ¨æ‰§è¡Œï¼›åŠ è½½å¤šå°‘è¾“å‡ºå¤šå°‘ï¼›å¾ªç¯åŠ è½½åªè¾“å‡ºæ‰§è¡Œéƒ¨åˆ†</li></ul></li><li>å¯¹äºESMï¼š<u>é‡åˆ°æ¨¡å—åŠ è½½å‘½ä»¤åªæ˜¯ç”Ÿæˆä¸€ä¸ªå¼•ç”¨</u>ï¼Œç­‰çœŸçš„éœ€è¦å†å»æ¨¡å—é‡Œå–å€¼</li></ul></li></ul><h2 id="express">Express</h2><blockquote><p>è·¯ç”±ã€ä¸­é—´ä»¶ã€æ¨¡æ¿å¼•æ“</p></blockquote><h3 id="expressæ¦‚è¿°">expressæ¦‚è¿°</h3><ul><li>æœ€æµè¡Œçš„node webæ¡†æ¶</li><li>ç‰¹ç‚¹ï¼šç²¾ç®€ã€çµæ´»</li><li>expressä¸æ˜¯å›ºæ‰§å·±è§çš„ï¼Œæ˜¯é«˜åº¦åŒ…å®¹çš„</li></ul><h3 id="è·¯ç”±">è·¯ç”±</h3><ul><li>æŠŠéœ€è¦æ”¯æŒçš„è¯·æ±‚ï¼ˆä»¥åŠè¯·æ±‚URLä¸­åŒ…å«çš„ä»»ä½•ä¿¡æ¯ï¼‰è½¬å‘åˆ°é€‚å½“çš„æ§åˆ¶å™¨å‡½æ•°</li><li>è·¯ç”±ç”¨äºç¡®å®šåº”ç”¨ç¨‹åºå¦‚ä½•å“åº”å¯¹ç‰¹å®šç«¯ç‚¹çš„å®¢æˆ·æœºè¯·æ±‚ï¼ŒåŒ…æ‹¬ä¸€ä¸ªURIï¼ˆæˆ–è·¯å¾„ï¼‰å’Œä¸€ä¸ªç‰¹å®šçš„HTTPè¯·æ±‚æ–¹æ³•ï¼ˆGETã€POSTç­‰ï¼‰</li><li>æ¯ä¸ªè·¯ç”±å¯ä»¥å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå¤„ç†ç¨‹åºå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨è·¯ç”±åŒ¹é…æ—¶æ‰§è¡Œ</li><li>è·¯ç”±è·¯å¾„<ul><li>å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼</li><li>å¯ä»¥åŒ…å«å‚æ•°ï¼š<code>/users/:userId</code> =ã€‹å¯ä»¥åŒ¹é…<code>/users/11</code> çš„URLï¼Œå…¶ä¸­userIdä¿å­˜åœ¨req.paramså¯¹è±¡ä¸­ã€‚</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;GET it&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="ä¸­é—´ä»¶">ä¸­é—´ä»¶</h3><ul><li>ä¸­é—´ä»¶æ˜¯ä¸€ç§åŠŸèƒ½çš„å°è£…æ–¹å¼ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯å°è£…åœ¨ç¨‹åºä¸­å¤„ç†HTTPè¯·æ±‚çš„åŠŸèƒ½</li><li>ä¸­é—´ä»¶æ˜¯åœ¨ç®¡é“ä¸­æ‰§è¡Œçš„ï¼Œé€šè¿‡<code>app.use</code>å‘ç®¡é“ä¸­æ’å…¥ä¸­é—´ä»¶</li><li>ä¸­é—´ä»¶ä¸­è¦è°ƒç”¨<code>next()</code>ï¼Œå°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</li><li>ä¸­é—´ä»¶çš„è£…å…¥é¡ºåºååˆ†é‡è¦</li></ul><h3 id="æ¨¡æ¿å¼•æ“">æ¨¡æ¿å¼•æ“</h3><p>é€‰ç”¨æ¨¡æ¿å¼•æ“éœ€è¦è€ƒè™‘çš„å› ç´ </p><ul><li>è¿›å…¥ç”Ÿäº§çŠ¶æ€çš„æ—¶é—´</li><li>æµè¡Œåº¦å’Œæ´»è·ƒåº¦</li><li>é£æ ¼</li><li>æ€§èƒ½/æ¸²æŸ“æ—¶é—´</li><li>åŠŸèƒ½</li></ul><h2 id="javascript">JavaScript</h2><blockquote><p>åŸºæœ¬æ¦‚å¿µï¼ŒåŸºæœ¬è¯­æ³•ç­‰ã€DOMã€BOMã€äº‹ä»¶ã€äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ã€äº‹ä»¶å¤„ç†æ¨¡å‹ã€ä½œç”¨åŸŸã€è¯æ³•ä½œç”¨åŸŸã€ä½œç”¨åŸŸé“¾ã€é—­åŒ…ã€æå‡ã€æœ€ä½³å®è·µã€æ­£åˆ™ã€åŸå‹å¯¹è±¡ã€classã€thisã€æ¡†æ¶ä¼˜ç¼ºç‚¹</p></blockquote><h3 id="jsæ¦‚è¿°">JSæ¦‚è¿°</h3><ul><li>ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œç”±jsè§£é‡Šå™¨/å¼•æ“è®¡ç®—å’Œæ‰§è¡Œ</li><li>è§£é‡Šå‹è¯­è¨€ï¼Œæ›´åŠ å®½æ¾çš„è¯­æ³•å’Œè§„åˆ™ï¼Œå…³é”®ç±»å‹æ˜¯å‡½æ•°ï¼ŒåŒ…å«åœ¨ç½‘é¡µä¸­</li><li>åŸºæœ¬è¯­æ³•ï¼šç•¥</li></ul><h3 id="domå’Œbom">DOMå’ŒBOM</h3><ul><li>DOMï¼šæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œæ˜¯è·å–ã€æ›´æ”¹ã€æ·»åŠ æˆ–è€…åˆ é™¤HTMLå…ƒç´ çš„æ ‡å‡†ï¼›<ul><li>é€šè¿‡è¯¥æ¨¡å‹ï¼Œjså¯ä»¥è·å–åˆ›å»ºåŠ¨æ€htmlæ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½</li></ul></li><li>BOMï¼šæµè§ˆå™¨å¯¹è±¡æ¨¡å‹<ul><li>é€šè¿‡è¯¥æ¨¡å‹ï¼Œèµ‹äºˆäº†jsç¨‹åºä¸æµè§ˆå™¨äº¤äº’çš„èƒ½åŠ›</li></ul></li><li>windowå¯¹è±¡ï¼šdocumentå¯¹è±¡ã€locationå¯¹è±¡ï¼ˆå½“å‰URLä¿¡æ¯ï¼‰ã€navigatorå¯¹è±¡ï¼ˆæµè§ˆå™¨ä¿¡æ¯ï¼‰ã€screenå¯¹è±¡ã€historyå¯¹è±¡ï¼Œè¿˜å¯ä»¥é€šè¿‡window.cookieä½¿ç”¨cookie</li></ul><h3 id="äº‹ä»¶">äº‹ä»¶</h3><ul><li>ä½¿webåº”ç”¨ç¨‹åºçš„å“åº”æ€§ã€åŠ¨æ€æ€§å’Œäº¤äº’æ€§æ›´å¼ºï¼Œä¸€èˆ¬é€šè¿‡å›è°ƒå‡½æ•°å¤„ç†</li><li>å…è®¸è„šæœ¬å»å“åº”ç”¨æˆ·ä¸ç½‘é¡µä¸Šå…ƒç´ çš„äº¤äº’ï¼Œå…è®¸é€šè¿‡äº‹ä»¶è¿›è¡Œå¯¹é¡µé¢çš„ä¿®æ”¹</li></ul><h3 id="äº‹ä»¶é©±åŠ¨ç¼–ç¨‹">äº‹ä»¶é©±åŠ¨ç¼–ç¨‹</h3><ul><li>äº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå…¶ä¸­ç¨‹åºæµç”±äº‹ä»¶å†³å®šï¼Œæ‰§è¡Œç‰¹å®šçš„æ“ä½œæ¥å“åº”ç”¨æˆ·è¾“å…¥</li><li>åœ¨äº‹ä»¶é©±åŠ¨çš„åº”ç”¨ç¨‹åºä¸­ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªä¸»å¾ªç¯ç›‘å¬äº‹ä»¶ï¼Œç„¶ååœ¨æ£€æµ‹åˆ°å…¶ä¸­ä¸€ä¸ªäº‹ä»¶æ—¶è§¦å‘å›è°ƒå‡½æ•°</li><li>äº‹ä»¶å¤„ç†ç¨‹åºå¯ç”¨äºå¤„ç†å’ŒéªŒè¯ç”¨æˆ·è¾“å…¥ã€ç”¨æˆ·æ“ä½œå’Œæµè§ˆå™¨æ“ä½œ</li></ul><h3 id="äº‹ä»¶å¤„ç†æ¨¡å‹">äº‹ä»¶å¤„ç†æ¨¡å‹</h3><ul><li>DOM0ï¼šå†…è”æ¨¡å‹ï¼šäº‹ä»¶å¤„ç†ç¨‹åºä½œä¸º<u>å…ƒç´ çš„å±æ€§</u>æ·»åŠ ï¼›ä¼ ç»Ÿæ¨¡å‹ï¼šå¯ä»¥é€šè¿‡è„šæœ¬ï¼ˆjsï¼‰æ·»åŠ /åˆ é™¤äº‹ä»¶å¤„ç†ç¨‹åº</li><li>DOM2ï¼šé€šè¿‡<code>addEventListener</code>å’Œ<code>removeEventListener</code>æ¥æ·»åŠ å’Œåˆ é™¤äº‹ä»¶</li><li>DOMäº‹ä»¶æµï¼šæ•è·é˜¶æ®µ =ã€‹ç›®æ ‡é˜¶æ®µ =ã€‹å†’æ³¡é˜¶æ®µï¼ˆå¤„ç†äº‹ä»¶ï¼‰</li></ul><h3 id="ä½œç”¨åŸŸ">ä½œç”¨åŸŸ</h3><ul><li>ä½œç”¨åŸŸæ˜¯å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¯è§æˆ–è€…å¯è¢«è®¿é—®çš„å€¼å’Œè¡¨è¾¾å¼ï¼Œå³æœ‰æƒè®¿é—®çš„å˜é‡é›†åˆ<ul><li>å…¨å±€ä½œç”¨åŸŸ</li><li>æ¨¡å—ä½œç”¨åŸŸ</li><li>å‡½æ•°ä½œç”¨åŸŸ</li><li>å—çº§ä½œç”¨åŸŸï¼ˆconstå’Œletï¼‰</li></ul></li></ul><h3 id="é—­åŒ…">é—­åŒ…</h3><p>é—­åŒ…æ˜¯ä¸€ä¸ªå‡½æ•°åŠå…¶æ†ç»‘çš„å‘¨è¾¹ç¯å¢ƒçŠ¶æ€çš„å¼•ç”¨çš„ç»„åˆï¼›é—­åŒ…è®©å¼€å‘è€…å¯ä»¥ä»å†…éƒ¨å‡½æ•°è®¿é—®å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œä¼šéšç€å‡½æ•°çš„åˆ›å»ºè€Œåˆ›å»º</p><p><strong>è¯æ³•ä½œç”¨åŸŸ</strong>ï¼šï¼ˆé™æ€ä½œç”¨åŸŸï¼‰æ ¹æ®æºä»£ç ä¸­å£°æ˜å˜é‡çš„ä½ç½®æ¥ç¡®å®šè¯¥å˜é‡åœ¨ä½•å¤„å¯ç”¨</p><p>é—­åŒ…çš„åº”ç”¨åœºæ™¯ï¼š</p><ul><li>å®ç°ç§æœ‰æˆå‘˜</li><li>ä¿æŠ¤å‘½åç©ºé—´</li><li>é¿å…æ±¡æŸ“å…¨å±€å˜é‡</li><li>å˜é‡éœ€è¦é•¿ä¹…é©»ç•™åœ¨å†…å­˜</li></ul><h3 id="ä½œç”¨åŸŸé“¾">ä½œç”¨åŸŸé“¾</h3><p>ä½œç”¨åŸŸé“¾åŒ…å«äº†ä¸€ä¸ªå‡½æ•°è¢«åˆ›å»ºçš„ä½œç”¨åŸŸä¸­å¯¹è±¡çš„é›†åˆï¼Œå†³å®šäº†å“ªäº›æ•°æ®å¯ä»¥è¢«å‡½æ•°è®¿é—®ï¼Œç”¨äºåœ¨å¤„ç†æ ‡è¯†ç¬¦çš„æ—¶å€™è¿›è¡Œå˜é‡æŸ¥è¯¢</p><h3 id="æå‡">æå‡</h3><ul><li>å¯ä»¥å…ˆä½¿ç”¨å˜é‡ï¼Œå†è¿›è¡Œå£°æ˜è€Œä¸ä¼šå¼•å‘å¼‚å¸¸ï¼Œæ„Ÿè§‰åƒæ˜¯ å£°æ˜è¢«æå‡åˆ°äº†ä½¿ç”¨è¯­å¥çš„å‰é¢</li><li>åªæœ‰ä½¿ç”¨varå£°æ˜çš„å˜é‡æ‰èƒ½è¢«æå‡</li><li>ç±»å’Œå‡½æ•°è¡¨è¾¾å¼ä¸èƒ½è¢«æå‡ï¼Œå‡½æ•°å£°æ˜å¯ä»¥è¢«æå‡</li><li>letå…ˆå£°æ˜åä½¿ç”¨ä¼šå¼•èµ·æš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰</li></ul><h3 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h3><ul><li>é¿å…å…¨å±€å˜é‡ï¼Œå§‹ç»ˆå£°æ˜å±€éƒ¨å˜é‡</li><li>ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼</li><li>åœ¨é¡¶éƒ¨å£°æ˜ï¼Œå£°æ˜å˜é‡æ—¶åˆå§‹åŒ–</li><li>ä½¿ç”¨<code>===</code>æ¯”è¾ƒ</li><li>å‡å°‘å¾ªç¯æ´»åŠ¨</li></ul><blockquote><p>ä¸¥æ ¼æ¨¡å¼ï¼š<code>use strict</code></p><p>æ¶ˆé™¤jsè¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨ä¹‹å¤„ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸ºï¼›æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ï¼›æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ï¼›ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„jsåšå¥½é“ºå«</p></blockquote><h3 id="æ¡†æ¶ä¼˜ç¼ºç‚¹">æ¡†æ¶ä¼˜ç¼ºç‚¹</h3><ul><li>ä¼˜ç‚¹<ul><li>å°è£…äº†å¤æ‚å›°éš¾çš„ä»£ç </li><li>åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œæ›´å¿«å®Œæˆé¡¹ç›®</li><li>ä¸“æ³¨äºäº§å“å†…å®¹çš„ä»·å€¼ï¼Œè€Œä¸æ˜¯å®ç°è¿‡ç¨‹</li><li>è®©åˆä½œæ›´ç®€å•</li></ul></li><li>ç¼ºç‚¹<ul><li>å¦‚æœé‡åˆ°é—®é¢˜éœ€è¦é’»ç ”æ¡†æ¶</li><li>æ¡†æ¶æ›´æ–°å¿«é€Ÿï¼Œå‡çº§æ›´æ–°æ˜¯é—®é¢˜</li></ul></li></ul><h3 id="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</h3><ul><li>ä»¥<code>/</code>å¼€å§‹å’Œç»“æŸ</li><li><code>.</code>åŒ¹é…å•ä¸€å­—ç¬¦</li><li><code>i</code>ï¼šå¯¹å¤§å°å†™ä¸æ•æ„Ÿ</li><li><code>|</code>é€‰æ‹©ã€<code>()</code>å­è¡¨è¾¾å¼ã€<code>^</code>åŒ¹é…å¼€å§‹ã€<code>$</code>åŒ¹é…ç»“æŸã€<code>\</code>è½¬ä¹‰</li><li><code>*</code>ï¼š0+æ¬¡ï¼›<code>+</code>ï¼š1+æ¬¡ï¼›<code>?</code>ï¼š0/1æ¬¡</li><li><code>&#123;min,max&#125;</code>ï¼šmin-maxæ¬¡</li><li><code>[]</code>ï¼šå­—ç¬¦é›†</li></ul><h3 id="class">class</h3><blockquote><p>JSä¸­å£°æ˜ç±»çš„å…³é”®å­—</p></blockquote><h3 id="this">this</h3><ul><li>å…¨å±€ç¯å¢ƒä¸‹çš„thisï¼šä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯undefinedï¼›éä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯window</li><li>ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨ä¸­çš„thisï¼šç»‘å®šåˆ°è¯¥å¯¹è±¡ä¸Š</li><li>bindã€callã€applyæ”¹å˜thisæŒ‡å‘ï¼šæŒ‡å®šå‚æ•°ä¸Š</li><li>æ„é€ å‡½æ•°å’Œthisï¼šæ„é€ å‡½æ•°å†…çš„thisç»‘å®šåˆ°æ–°åˆ›å»ºå¯¹è±¡ä¸Š</li><li>ç®­å¤´å‡½æ•°ä¸­çš„thisï¼šç”±å¤–å±‚ä½œç”¨åŸŸæ¥å†³å®š</li></ul><h3 id="åŸå‹å¯¹è±¡">åŸå‹å¯¹è±¡</h3><ul><li>æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰å®ƒçš„åŸå‹å¯¹è±¡ï¼Œå®ƒå¯ä»¥ä½¿ç”¨è‡ªå·±åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§å’Œæ–¹æ³•</li><li>å¯ä»¥é€šè¿‡åŸå‹å¯¹è±¡æ‰©å±•å¯¹è±¡</li><li>åŸå‹é“¾ï¼šä»»ä½•å¯¹è±¡éƒ½æœ‰åŸå‹å¯¹è±¡=ã€‹å½¢æˆåŸå‹é“¾</li></ul><h2 id="css">CSS</h2><blockquote><p>åŸºæœ¬æ¦‚å¿µã€é€‰æ‹©å™¨ã€å±‚å æ’åºã€CSS3æ–°ç‰¹æ€§ã€CSSSpritesã€å¸ƒå±€ã€ç›’æ¨¡å‹ã€BFCã€å“åº”å¼webè®¾è®¡ã€ç§»åŠ¨ä¼˜å…ˆè®¾è®¡ã€æ¸è¿›æ¸å¼º</p></blockquote><h3 id="cssæ¦‚è¿°">CSSæ¦‚è¿°</h3><ul><li>Cascading Style Sheets å±‚å æ ·å¼è¡¨ï¼Œç”¨äºè®¾è®¡é£æ ¼å’Œå¸ƒå±€</li><li>CSSä¼˜åŠ¿ï¼šä¸°å¯Œçš„æ ·å¼å®šä¹‰ã€ç®€æ´ã€æ¸…æ™°ã€æ˜“äºä¿®æ”¹å’Œä½¿ç”¨</li></ul><h3 id="é€‰æ‹©å™¨">é€‰æ‹©å™¨</h3><p>è¯­æ³•ï¼š<code>selector &#123; property: value; [...] &#125;</code></p><p>ä¾‹å¦‚ï¼š<code>h1 &#123; color: blue; &#125;</code></p><ul><li>id(<code>#</code>)/class(<code>.</code>)/æ ‡ç­¾(<code>p</code>)/å±æ€§(<code>[title]</code>)/ä¼ªç±»(<code>:hover</code>)/ä¼ªå…ƒç´ (<code>:first-line</code>)/é€‰æ‹©å™¨</li><li>ç»„åˆé€‰æ‹©å™¨ï¼š<ul><li>åä»£é€‰æ‹©å™¨ï¼š<code>div p</code> ï¼ˆå¯¹divæ ‡ç­¾ä¸‹çš„æ‰€æœ‰pæ ‡ç­¾ç”Ÿæ•ˆï¼‰</li><li>å­å…ƒç´ é€‰æ‹©å™¨ï¼š<code>div&gt;p</code>ï¼ˆå¯¹divæ ‡ç­¾ä¸‹çš„<strong>å­</strong>pæ ‡ç­¾ç”Ÿæ•ˆï¼‰</li><li>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ï¼š<code>div+p</code>ï¼ˆå¯¹divæ ‡ç­¾ç›¸é‚»çš„pæ ‡ç­¾ç”Ÿæ•ˆï¼‰</li><li>æ™®é€šå…„å¼Ÿé€‰æ‹©å™¨ï¼š<code>div-p</code>ï¼ˆå¯¹divæ ‡ç­¾åŒä¸€å±‚çº§çš„pæ ‡ç­¾ç”Ÿæ•ˆï¼‰</li></ul></li></ul><h3 id="å±‚å æ’åº">å±‚å æ’åº</h3><ul><li>å†…è”æ ·å¼ &gt; åµŒå…¥æ ·å¼ï¼ˆå¤´éƒ¨styleï¼‰ &gt; å¤–éƒ¨æ ·å¼ &gt;æµè§ˆå™¨ç¼ºçœæ ·å¼</li><li>ä¼˜å…ˆçº§è®¡ç®—ï¼ša(æ˜¯å¦æ¥è‡ªstyleå±æ€§å³æ˜¯å¦æ˜¯å†…è”æ ·å¼)-b(ID)-c(å±æ€§/ä¼ªç±»)-d(å…ƒç´ /ä¼ªå…ƒç´ )</li></ul><h3 id="css3">CSS3</h3><ul><li>è¢«åˆ†æˆè‹¥å¹²ä¸ªç›¸äº’ç‹¬ç«‹çš„æ¨¡å—ï¼šæœ‰åˆ©äºè§„èŒƒåŠæ—¶æ›´æ–°å’Œå‘å¸ƒï¼ŒåŠæ—¶è°ƒæ•´æ¨¡å—çš„å†…å®¹ï¼›å‚å•†å¯ä»¥æœ‰é€‰æ‹©åœ°æ”¯æŒä¸€éƒ¨åˆ†æ¨¡å—ï¼Œæœ‰åˆ©äºCSS3æ¨å¹¿ã€‚</li><li>æ–°ç‰¹å¾ï¼šåœ†è§’æ•ˆæœã€å›¾å½¢åŒ–è¾¹ç•Œã€å—é˜´å½±ä¸æ–‡å­—é˜´å½±ã€æ¸å˜æ•ˆæœã€å®šåˆ¶å­—ä½“ï¼ˆ<spanclass="citation" data-cites="font-face">@font-face</span>ï¼‰</li><li><strong>CSS Sprites</strong>ï¼šæ˜¯å•ä¸ªå›¾åƒä¸­åŒ…å«çš„å›¾åƒé›†åˆ<ul><li>ä¼˜ç‚¹ï¼šå‡å°‘æœåŠ¡å™¨è¯·æ±‚èŠ‚çº¦å¸¦å®½ï¼›æ›´æ¢é£æ ¼æ–¹ä¾¿</li><li>ç¼ºç‚¹ï¼šç»´æŠ¤éº»çƒ¦ï¼›å›¾ç‰‡åˆæˆè´¹æ—¶è´¹åŠ›</li></ul></li></ul><h3 id="å¸ƒå±€">å¸ƒå±€</h3><p><strong>ç›’æ¨¡å‹</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230220214046314.png" /></p><p><strong>BFC</strong>ï¼šï¼ˆå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼‰æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¸ƒå±€ç¯å¢ƒï¼Œå…¶ä¸­çš„å…ƒç´ å¸ƒå±€ä¸å—å¤–ç•Œçš„å½±å“ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªBFCä¸­ï¼Œå—ç›’ä¸è¡Œç›’éƒ½ä¼šå‚ç›´åœ°æ²¿ç€å…¶çˆ¶å…ƒç´ çš„è¾¹æ¡†æ’åˆ—ï¼Œåªæœ‰Block-levelboxå‚ä¸ï¼Œè§„å®šäº†å†…éƒ¨çš„Block-levelBoxå¦‚ä½•å¸ƒå±€ï¼Œå¹¶ä¸”ä¸è¿™ä¸ªå±€åŸŸå¤–éƒ¨æ¯«ä¸ç›¸å¹²</p><h3 id="å“åº”å¼webè®¾è®¡">å“åº”å¼webè®¾è®¡</h3><p>ï¼ˆRWDï¼‰æ˜¯ä¸€ç§ç½‘é¡µè®¾è®¡æ–¹æ³•ï¼Œè¯¥è®¾è®¡å¯ä»¥ä½¿ç½‘ç«™åœ¨å¤šç§æµè§ˆè®¾å¤‡ä¸Šé˜…è¯»å’Œå¯¼èˆªï¼ŒåŒæ—¶å‡å°‘ç¼©æ”¾ã€å¹³ç§»å’Œæ»šåŠ¨</p><ul><li><p>ä¼˜ç‚¹ï¼šå¯ç”¨æ€§å¾—åˆ°æå‡ï¼›ç®€åŒ–æœåŠ¡å™¨ç«¯ï¼›æ›´æ˜“ç»´æŠ¤ï¼›æ”¯æŒæœªçŸ¥è®¾å¤‡</p></li><li><p>ç¼ºç‚¹ï¼šæ€§èƒ½è¾ƒå·®ï¼›é™åˆ¶åº”ç”¨çš„å¤æ‚æ€§ï¼›ç”¨æˆ·æ··æ·†</p></li><li><p>æµç•…æˆ–çµæ´»çš„é¡µé¢å¸ƒå±€ï¼Œæ ¹æ®æµè§ˆå™¨çª—å£å¤§å°æˆæ¯”ä¾‹ç¼©æ”¾</p></li><li><p>çµæ´»ã€æ¯”ä¾‹é€‚ä¸­çš„å›¾åƒå’Œè¯•å¬åª’ä½“</p></li><li><p>ä½¿ç”¨CSS3åª’ä½“æŸ¥è¯¢ï¼Œç¡®å®šæµè§ˆå™¨å±å¹•çš„å®½åº¦å¹¶ä½œå‡ºç›¸åº”è°ƒæ•´</p></li></ul><h3 id="ç§»åŠ¨ä¼˜å…ˆ">ç§»åŠ¨ä¼˜å…ˆ</h3><ul><li>ä¼˜å…ˆå†…å®¹å’ŒåŠŸèƒ½</li><li>å¥½å¤„ï¼šé€šç”¨è®¿é—®ï¼Œå³ä½¿æ²¡æœ‰jsä¹Ÿèƒ½çœ‹åˆ°ä¸€ä¸ªæ‹¥æœ‰åŸºæœ¬åŠŸèƒ½çš„ç½‘ç«™</li><li>ç§»åŠ¨ä¼˜å…ˆæ˜¯æ¸è¿›æ¸å¼ºç†å¿µçš„è‰¯å¥½èŒƒä¾‹ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½è®¿é—®æ ¸å¿ƒå†…å®¹å’ŒåŠŸèƒ½</li></ul><p><strong>æ¸è¿›æ¸å¼º</strong>ï¼šé¦–å…ˆåŸºäºä¸€ä¸ªå…·æœ‰å¹¿æ³›å…¼å®¹æ€§çš„æ ¸å¿ƒæ–¹æ¡ˆï¼Œåˆ›å»ºä¸€ä¸ªåŸºçº¿ç‰ˆæœ¬ï¼Œç„¶åå†æ ¹æ®å¯èƒ½ç”¨åˆ°çš„æµè§ˆå™¨ç‰¹æ€§ï¼Œæ…¢æ…¢æ·»åŠ ä¸€äº›ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</p><h2 id="html">HTML</h2><blockquote><p>åŸºæœ¬æ ‡ç­¾ã€å—å†…å…ƒç´ å’Œè¡Œå†…å…ƒç´ ã€HTML5ã€ä¼˜åŠ¿ã€åº”ç”¨ã€æ–°å…ƒç´ ã€æ–°åŠŸèƒ½ã€è¯­ä¹‰åŒ–</p></blockquote><h3 id="htmlæ¦‚è¿°">HTMLæ¦‚è¿°</h3><ul><li>HyperText Markup Languageï¼Œè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œå®šä¹‰äº†ç½‘é¡µå†…å®¹å’Œç»“æ„</li><li>å—çº§å…ƒç´ å æ®çˆ¶å…ƒç´ ï¼ˆå®¹å™¨ï¼‰çš„æ•´ä¸ªæ°´å¹³ç©ºé—´ï¼Œå‚ç›´ç©ºé—´ç­‰äºå†…åŒé«˜åº¦ï¼›è¡Œå†…å…ƒç´ åªå æ®å…ƒç´ è¾¹æ¡†æ‰€åŒ…å«çš„ç©ºé—´</li><li><code>&lt;title&gt;</code>ï¼šç”¨äºå®šä¹‰æµè§ˆå™¨å·¥å…·æ ä¸­çš„æ ‡é¢˜ï¼›æä¾›é¡µé¢è¢«æ·»åŠ åˆ°æ”¶è—å¤¹çš„æ ‡é¢˜ï¼›æ˜¾ç¤ºåœ¨æœç´¢å¼•æ“ç»“æœä¸­çš„é¡µé¢æ ‡é¢˜</li><li><code>&lt;meta&gt;</code>ï¼šç”¨äºæä¾›HTMLæ–‡æ¡£å…ƒæ•°æ®ï¼›åªå‡ºç°åœ¨headé‡Œï¼›ç”¨äºç»™å‡ºç½‘é¡µæè¿°ã€å…³é”®è¯ã€æ–‡æ¡£ä½œè€…ã€æœ€åä¿®æ”¹æ—¥æœŸç­‰ä¿¡æ¯</li><li>em vs iï¼Œstrong vs bï¼šiå’Œbéƒ½æ˜¯æ— å¼ºè°ƒæˆ–ç€é‡æ„å‘³çš„</li><li>table ä¸è¦ç”¨äºå¸ƒå±€ï¼šç»“æ„æ··ä¹±ä¸æ¸…æ™°ï¼›æœºå™¨éš¾ä»¥ç†è§£ï¼Œä¸åˆ©äºSEOï¼›</li><li>è¡¨å•ä¸­çš„éšè—å­—æ®µï¼šç›®çš„åœ¨äºæ”¶é›†æˆ–å‘é€ä¿¡æ¯ï¼Œä»¥åˆ©äºè¢«å¤„ç†è¡¨å•çš„ç¨‹åºæ‰€ä½¿ç”¨ï¼›å¸®åŠ©ç¡®è®¤ç”¨æˆ·èº«ä»½ï¼›ä¿å­˜å…¨å±€å˜é‡ï¼›</li></ul><h3 id="html5">HTML5</h3><ul><li><p>HTML5æ˜¯æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬</p></li><li><p>ä¼˜åŠ¿ï¼šè·¨æµè§ˆå™¨å…¼å®¹æ€§ã€<u>å¤§é“è‡³ç®€</u>ï¼ˆå„ç§ç®€åŒ–ï¼‰ã€è¯­ä¹‰åŒ–ã€å¯ç”¨æ€§å’Œç”¨æˆ·ä½“éªŒçš„æ”¹è¿›ã€æ— æ’ä»¶èŒƒå¼ã€å®‰å…¨ã€å¤§é‡ç”¨äºç§»åŠ¨åº”ç”¨å’Œæ¸¸æˆï¼Œå¯¹SEOå‹å¥½</p></li><li><p>åº”ç”¨ï¼šæœ¬åœ°æ•°æ®å­˜å‚¨ã€è®¿é—®æœ¬åœ°æ–‡ä»¶ã€æœ¬åœ°SQLæ•°æ®ã€ç¼“å­˜å¼•ç”¨</p></li><li><p>æ–°å…ƒç´ /æ–°åŠŸèƒ½</p><ul><li><p>æ–°å…ƒç´ ï¼šarticleã€sectionã€headerã€footerç­‰è¯­ä¹‰åŒ–æ ‡ç­¾ã€</p></li><li><p>æ›´å¤šåŸç”ŸåŠŸèƒ½ï¼ŒåŸç”Ÿæ”¯æŒéŸ³è§†é¢‘</p></li><li><p>å®Œå…¨æ”¯æŒCSS3</p></li><li><p>æä¾›åŸç”Ÿçš„ç»˜å›¾åŠŸèƒ½ï¼ˆsvgå’Œcanvaså¯¹æ¯”ï¼‰</p><table><thead><tr class="header"><th>canvas</th><th>svg</th></tr></thead><tbody><tr class="odd"><td>ä¾èµ–åˆ†è¾¨ç‡</td><td>ä¸ä¾èµ–åˆ†è¾¨ç‡</td></tr><tr class="even"><td>ä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨</td><td>æ”¯æŒäº‹ä»¶å¤„ç†å™¨</td></tr><tr class="odd"><td>å¼±æ–‡æœ¬æ¸²æŸ“èƒ½åŠ›</td><td>å¼ºæ–‡æœ¬æ¸²æŸ“èƒ½åŠ›</td></tr><tr class="even"><td>æœ€é€‚åˆå›¾åƒå¯†é›†å‹æ¸¸æˆ</td><td>ä¸é€‚åˆæ¸¸æˆ</td></tr></tbody></table></li><li><p>webå­˜å‚¨ï¼šç›¸æ¯”cookieæ›´åŠ å®‰å…¨å¿«é€Ÿï¼›localStorageï¼ˆæ•´ä¸ªç½‘ç«™æ•°æ®ï¼‰sessionStorageï¼ˆå½“å‰ä¼šè¯æ•°æ®ï¼‰</p></li><li><p>å…¶ä»–æ–°ç‰¹æ€§ï¼šç¼“å­˜ã€æ•°æ®åº“ã€web workerã€webSocket</p></li></ul></li><li><p><strong>è¯­ä¹‰åŒ–</strong>ï¼šæ ¹æ®ç»“æ„åŒ–çš„å†…å®¹é€‰æ‹©åˆé€‚çš„æ ‡ç­¾ï¼›æœ‰åˆ©äºSEOã€å¼€å‘ç»´æŠ¤ä½“éªŒå¥½ã€ç”¨æˆ·ä½“éªŒæ›´å¥½ã€æ›´å¥½çš„å¯è®¿é—®æ€§ï¼Œæ–¹ä¾¿ä»»ä½•è®¾å¤‡å¯¹ä»£ç è¿›è¡Œè§£æã€‚</p><ul><li>å¸®åŠ©å®ç°ARIAï¼ˆAccesible RIAï¼‰æ— éšœç¢å¯Œç½‘ç»œåº”ç”¨</li></ul></li><li><p>æ— æ’ä»¶èŒƒå¼ï¼šè¿‡å»å¾ˆå¤šåŠŸèƒ½åªèƒ½é€šè¿‡æ’ä»¶å®ç°ï¼Œä½†æ˜¯åœ¨HTML5ä¸­æä¾›äº†åŸç”Ÿå®ç°</p><ul><li>æ’ä»¶çš„é—®é¢˜ï¼šå®‰è£…å¯èƒ½å¤±è´¥ï¼›è¢«ç¦ç”¨æˆ–è€…å±è”½ï¼›è¢«æ”»å‡»</li></ul></li><li><p>CORSï¼šCross-Origin Resource Share è·¨åŸŸèµ„æºå…±äº« SOPï¼šSame OriginPolicy åŒæºæ”¿ç­–</p></li><li><p>RIAï¼šRich Internet Applications å¯Œç½‘ç»œåº”ç”¨</p></li></ul><h2 id="æ¦‚è¿°">æ¦‚è¿°</h2><blockquote><p>DNSã€URL/URI/URNã€webå‘å±•å†ç¨‹ã€Web3.0</p></blockquote><h3 id="webå‘å±•å†ç¨‹">webå‘å±•å†ç¨‹</h3><ul><li>web1.0 =ã€‹web2.0 =ã€‹web3.0</li><li>web2.0çš„å±€é™æ€§ï¼šç”¨æˆ·ç¼ºä¹è‡ªä¸»æƒï¼ˆæ•°å­—èº«ä»½ã€ä¸ªäººæ•°æ®ã€ç®—æ³•ï¼‰</li><li><strong>web3.0</strong>çš„ç‰¹å¾ï¼šè¯­ä¹‰åŒ–ã€3Dã€äººå·¥æ™ºèƒ½ã€å»ä¸­å¿ƒåŒ–</li></ul><h3 id="dns">DNS</h3><ul><li>Domain Name System</li><li>å…¶å‡ºç°ä¹‹å‰ä½¿ç”¨ hosts.txtä¿å­˜name-to-IPçš„æ˜ å°„å…³ç³»</li><li>åº”ç”¨ç¨‹åºï¼ˆDNSå®¢æˆ·ç«¯ï¼‰â€”â€”è§£æå™¨â€”â€”DNSæœåŠ¡å™¨</li><li>DNSåç§°æ ‘å½¢å±‚æ¬¡ç»“æ„</li><li>FQDNï¼šFully Qualified Domain Name å…¨é™å®šåŸŸå</li><li>ä¸»åç§°æœåŠ¡å™¨å’Œè¾…åç§°æœåŠ¡å™¨</li><li><strong>é€’å½’å’Œè¿­ä»£æŸ¥è¯¢</strong></li><li>DNSæœåŠ¡å™¨æœ‰ç¼“å­˜</li></ul><h3 id="uriurnurl">URI/URN/URL</h3><ul><li>RRï¼šResource Records èµ„æºè®°å½•</li><li>URIï¼šUniform Resource Identifier â½¤äºæ ‡è¯†æŸâ¼€äº’è”â½¹èµ„æºåç§°çš„å­—ç¬¦ä¸²ï¼ˆæœ€å¤§ æ˜¯åé¢ä¸¤ä¸ªè¶…é›†ï¼‰</li><li>URLï¼šUniform Resource Location å±äºURI æ ‡è¯†äº’è”ç½‘èµ„æº<ul><li>URLåè®®ï¼šhttp https file mailto</li><li>è¶…é“¾æ¥ï¼šç»å¯¹URLã€ç›¸å¯¹URLã€åŒä¸€ç½‘é¡µå†…</li><li>URLç¼–ç ï¼š<strong>åªèƒ½ä½¿ç”¨ ASCII å­—ç¬¦é›†</strong><ul><li>%20/+ =&gt; ç©ºæ ¼</li><li>%xx =&gt; ä¸­æ–‡</li></ul></li></ul></li><li>URNï¼šUniform Resource Name ä»…ç”¨äºå‘½å ä½ç½®æ— å…³ é€šè¿‡åç§°æŒ‡å®š</li></ul><h2 id="çº§webå‰ç«¯æœŸæœ«è€ƒè¯•2022">2020çº§webå‰ç«¯æœŸæœ«è€ƒè¯•ï¼ˆ2022ï¼‰</h2><h3 id="åè¯è§£é‡Š">åè¯è§£é‡Š</h3><ul><li>URN</li><li>CSSOM</li><li>SVG</li><li>CANVAS</li><li>ES6</li><li>WebAssembly</li><li>Cookie</li><li>Session</li><li>Render Tree</li><li>RWD</li></ul><h3 id="ç®€ç­”é¢˜">ç®€ç­”é¢˜</h3><ol type="1"><li>web3.0æ ¸å¿ƒæŠ€æœ¯</li><li>å¯¹é—­åŒ…çš„ç†è§£ã€ä¼˜ç¼ºç‚¹å’Œåº”ç”¨</li><li>å‰ç«¯æ™ºèƒ½åŒ–çš„ç†è§£å’Œå…¸å‹åº”ç”¨</li><li>JavaScriptçš„æ•°æ®ç±»å‹</li><li>JavaScriptçš„åŠ¨æ€å’Œå¼±ç±»å‹æ˜¯ä»€ä¹ˆæ„æ€</li><li>çŠ¶æ€ç çš„è§£é‡Šï¼š200ã€301ã€303ã€404ã€500</li><li>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«</li><li>Nodejså¦‚ä½•å®ç°é«˜å¹¶å‘</li></ol><h3 id="é—®ç­”é¢˜">é—®ç­”é¢˜</h3><ol type="1"><li>æµè¡Œçš„å‰ç«¯æ¡†æ¶ï¼ŸVanilla JavaScriptæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦æ¨å¹¿ï¼Ÿ</li><li>HTTP1.0-3.0çš„å‘å±•è¿‡ç¨‹ï¼ŸHTTP/3ç›¸æ¯”ä¹‹å‰çš„HTTPåè®®è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li><li>ç®€è¿°å››ç§å‰ç«¯é‰´æƒæ–¹æ¡ˆï¼Ÿ</li></ol>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> front-end </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab6 Multithreading</title>
      <link href="/2023/02/21/6.S081/6.S081-lab6-thread/"/>
      <url>/2023/02/21/6.S081/6.S081-lab6-thread/</url>
      
        <content type="html"><![CDATA[<h2 id="çº¿ç¨‹åˆ‡æ¢">çº¿ç¨‹åˆ‡æ¢</h2><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212104346281.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212105840373.png" /></p><h2 id="uthread-switching-between-threads">Uthread: switching betweenthreads</h2><blockquote><p>é’ˆå¯¹ç”¨æˆ·çº§çš„çº¿ç¨‹ç³»ç»Ÿè®¾è®¡å¹¶å®ç°ä¸€ä¸ªä¸Šä¸‹æ–‡åˆ‡æ¢</p></blockquote><p>ç†è§£äº†<code>lecture</code>ä¸­çš„çº¿ç¨‹åˆ‡æ¢å°±æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬ä¸Šæ¨¡ä»¿å†…æ ¸æ¨¡å¼å†™å°±è¡Œäº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">thread</span>&#123;</span><br>    <span class="hljs-type">char</span> <span class="hljs-built_in">stack</span>[STACK_SIZE];<br>    <span class="hljs-type">int</span>state;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">context</span>  <span class="hljs-title">context</span>;</span> <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡ å†…å®¹å’Œkernelä¸‹çš„contextä¸€è‡´</span><br>&#125;;<br><br><span class="hljs-type">void</span><br><span class="hljs-title function_">thread_create</span><span class="hljs-params">(<span class="hljs-type">void</span> (*func)())</span><br>&#123;<br>...<br>    <span class="hljs-comment">// è®¾ç½®è¯¥çº¿ç¨‹è¿è¡Œçš„å‡½æ•°</span><br>  t-&gt;context.ra = (uint64)func;<br>    t-&gt;context.sp = (uint64)(t-&gt;<span class="hljs-built_in">stack</span> + PGSIZE);<br>&#125;<br><br><span class="hljs-comment">// thread_schedule</span><br>thread_switch((uint64)&amp;t-&gt;context, (uint64)&amp;current_thread-&gt;context);<br><br><span class="hljs-comment">// thread_switchå†…å®¹å’Œkernelä¸‹çš„swtchä¸€è‡´</span><br></code></pre></td></tr></table></figure><blockquote><p>ç–‘éš¾ç‚¹ï¼šè®¾ç½®çº¿ç¨‹è¿è¡Œå‡½æ•°é‚£ä¸€ä¸ªåœ°æ–¹è¿˜æ˜¯éœ€è¦ç†è§£ä¸€ä¸‹ï¼ˆå½“ç„¶<code>lecture</code>ä¸­ä»¥åŠ<code>xv6</code>ä¸­ä¹Ÿæœ‰ç›¸åº”çš„éƒ¨åˆ†å¯ä»¥å‚è€ƒï¼‰ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆè®¾ç½®äº†ä¸¤ä¸ªå¯„å­˜å™¨å°±å¯ä»¥äº†ï¼Ÿ<font color='red'>å› ä¸ºæ¯æ¬¡åˆ‡æ¢ä¸Šä¸‹æ–‡ä¹‹åè¿”å›çš„éƒ½æ˜¯å½“å‰<code>ra</code>å¯„å­˜å™¨æŒ‡å‘çš„ä½ç½®ï¼Œæ‰€ä»¥æƒ³è¦ä½¿å‡½æ•°å¯ä»¥è¿è¡Œåœ¨å¯¹åº”çº¿ç¨‹ä¸Šï¼Œåªè¦è®¾ç½®è¯¥çº¿ç¨‹<code>context</code>é‡Œçš„<code>ra</code>å¯„å­˜å™¨ã€‚<code>sp</code>å¯„å­˜å™¨æ˜¯ä¸ºå‡½æ•°çš„è¿è¡Œåˆ†é…æ ˆç©ºé—´ã€‚</font></p></blockquote><h2 id="using-threads">Using threads</h2><blockquote><p>è§£å†³å¤šçº¿ç¨‹è¯»å†™å“ˆå¸Œè¡¨ï¼ˆæ•°ç»„+é“¾è¡¨ï¼‰å¼•å‘çš„<code>race-condition</code></p></blockquote><p>ç°è±¡äº§ç”Ÿçš„åŸå› ï¼šé˜…è¯»<code>ph.c</code>ä¸­ä»£ç å¯ä»¥å‘ç°ï¼Œé’ˆå¯¹ä¸€ä¸ªæ–°çš„keyï¼Œæ˜¯ä¼šæ’å…¥è¿™ä¸ªkeyå¯¹åº”æ¡¶ä¸­é“¾è¡¨çš„å¤´éƒ¨ã€‚ä½†æ˜¯ä¸€æ—¦æœ‰ä¸¤ä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼Œè€Œä¸åŠ æªæ–½ï¼Œå°±ä¼šæœ‰<code>entry</code>ä¸¢å¤±ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <br><span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> key, <span class="hljs-type">int</span> value, <span class="hljs-keyword">struct</span> entry **p, <span class="hljs-keyword">struct</span> entry *n)</span><br>&#123;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">entry</span> *<span class="hljs-title">e</span> =</span> <span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> entry));<br>  e-&gt;key = key;<br>  e-&gt;value = value;<br>  e-&gt;next = n; <span class="hljs-comment">// å¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œå®Œè¿™æ¡è¯­å¥ä¹‹åä¸­æ–­ï¼Œä¹‹åæ— è®ºå“ªä¸ªè¿›ç¨‹æ‰§è¡Œä¸‹ä¸€æ¡è¯­å¥ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªentryä¸¢å¤±ã€‚å› ä¸ºæ­¤æ—¶ä¸¤ä¸ªentryåŒæ—¶æŒ‡å‘åŸé“¾è¡¨çš„è¡¨å¤´ã€‚</span><br>  *p = e;<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼š<strong>åŠ é”</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// å…¨å±€å£°æ˜</span><br><span class="hljs-type">pthread_mutex_t</span> lock;<br><br><span class="hljs-comment">// mainå‡½æ•°é‡Œ åˆå§‹åŒ–lock</span><br>pthread_mutex_init(&amp;lock, <span class="hljs-literal">NULL</span>);<br><br><span class="hljs-comment">// åœ¨ put å‡½æ•°çš„ è°ƒç”¨insertå‡½æ•°çš„è¯­å¥å‰å åŠ é”å’Œè§£é”</span><br>pthread_mutex_lock(&amp;lock);<br>insert(...);<br>pthread_mutex_unlock(&amp;lock);<br></code></pre></td></tr></table></figure><blockquote><p>åŠ é”çš„ç²’åº¦ï¼šç»è¿‡æ€è€ƒå¯ä»¥å‘ç°ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æ˜¯ä¸éœ€è¦åŠ é”çš„ï¼ŒçœŸæ­£äº§ç”Ÿå†²çªçš„åŸå› æ˜¯insertå‡½æ•°ï¼Œæ‰€ä»¥æœ€å°çš„é”ç²’åº¦åº”è¯¥é’ˆå¯¹æ¯ä¸€æ¬¡çš„<code>insert</code>å‡½æ•°ã€‚</p></blockquote><h2 id="barrier">Barrier</h2><blockquote><p>å®ç°ä¸€ä¸ªåŒæ­¥ç‚¹ï¼šæ‰€æœ‰çš„çº¿ç¨‹è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹åˆ°è¾¾è¯¥ç‚¹</p></blockquote><blockquote><p>éœ€è¦å­¦ä¹ ä¸€ä¸‹<code>xv6</code>ä¸­çš„<code>sleep</code>å’Œ<code>wakeup</code>å‡½æ•°ï¼ˆlecture13ï¼‰</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <br><span class="hljs-title function_">barrier</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-comment">// YOUR CODE HERE</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// Block until all threads have called barrier() and</span><br>  <span class="hljs-comment">// then increment bstate.round.</span><br>  <span class="hljs-comment">//</span><br>    <br>  <span class="hljs-comment">// é¦–å…ˆéœ€è¦è·å–é”ï¼Œå› ä¸ºéœ€è¦ä¿®æ”¹bstate.nthread</span><br>  <span class="hljs-comment">// è¿™ä¸ªåœºæ™¯å’Œlectureä¸­è§£å†³lost wakeupé—®é¢˜çš„åœºæ™¯å¾ˆåƒ</span><br>  <span class="hljs-comment">// éƒ½æ˜¯åœ¨å¤–é¢è·å–é”ï¼Œåœ¨sleep(wait)é‡Œé¢é‡Šæ”¾é”ï¼Œä»è€Œé¿å…äº†ä¸€ä¸ªæ—¶é—´çª—å£ä½¿å¾—å…ˆwakeupç„¶åsleep</span><br>  pthread_mutex_lock(&amp;bstate.barrier_mutex);<br>  bstate.nthread++;<br>  <span class="hljs-keyword">if</span> (bstate.nthread != nthread) &#123;<br>    pthread_cond_wait(&amp;bstate.barrier_cond, &amp;bstate.barrier_mutex);<br>  &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// æ³¨æ„: ç”±äºæ˜¯if-elseç»“æ„ï¼Œæ‰€ä»¥åªæœ‰æœ€åä¸€ä¸ªåˆ°è¾¾barrierçš„çº¿ç¨‹æ‰ä¼šæ‰§è¡Œelseéƒ¨åˆ†</span><br>      <span class="hljs-comment">// å…¶ä»–éƒ½è¢«é˜»å¡ï¼Œå”¤é†’ä¹‹åç›´æ¥é‡Šæ”¾é”é€€å‡ºäº†</span><br>    bstate.nthread = <span class="hljs-number">0</span>;<br>    bstate.round ++;<br>    pthread_cond_broadcast(&amp;bstate.barrier_cond);<br>  &#125;<br>  pthread_mutex_unlock(&amp;bstate.barrier_mutex);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éœ€æ±‚ä¸å•†ä¸šæ¨¡å¼åˆ›æ–°</title>
      <link href="/2023/02/15/nju-course-review-notes/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/"/>
      <url>/2023/02/15/nju-course-review-notes/%E9%9C%80%E6%B1%82%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A8%A1%E5%BC%8F%E5%A4%8D%E4%B9%A0%E6%8F%90%E7%BA%B2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ–°æµªå¾®åšâ€”â€”ä¾¿åˆ©èœ‚â€”â€”è”šæ¥æ±½è½¦</p></blockquote><h2 id="ç¬¬1é¢˜å•†ä¸šæ¨¡å¼ç”»å¸ƒ">ç¬¬1é¢˜ï¼ˆå•†ä¸šæ¨¡å¼ç”»å¸ƒï¼‰</h2><p>åˆ†æå¾®åšçš„å•†ä¸šæ¨¡å¼ï¼Œå¹¶ç”»å‡ºå•†ä¸šæ¨¡å¼ç”»å¸ƒ</p><p>æ ¹æ®ææ–™ç”»å•†ä¸šæ¨¡å¼ç”»å¸ƒåŠå„éƒ¨åˆ†å…ƒç´ ã€‚å†™å‡ºä¸€ä¸ªâ€œçº¦æŸâ€éœ€æ±‚</p><p>åˆ†æè”šæ¥ç”µåŠ¨è½¦çš„å•†ä¸šæ¨¡å¼ï¼Œå¹¶ç”»å‡ºå•†ä¸šæ¨¡å¼ç”»å¸ƒï¼Œå†™å‡ºçº¦æŸä¸‰å¤§æ¥æº+æœ¬ç³»ç»Ÿçš„ä¸€æ¡çº¦æŸéœ€æ±‚</p><h2 id="ç¬¬2é¢˜å•†ä¸šæ¨¡å¼ç‰¹ç‚¹">ç¬¬2é¢˜ï¼ˆå•†ä¸šæ¨¡å¼ç‰¹ç‚¹ï¼‰</h2><p>åˆ†æå¾®åšå¦‚ä½•ä½“ç°å¤šè¾¹å¹³å°å•†ä¸šæ¨¡å¼çš„ç‰¹ç‚¹ï¼Œå¹¶æŒ‡å‡ºå¾®åšå­˜åœ¨çš„é—®é¢˜</p><p>å±äºå“ªä¸€ä¸ªå•†ä¸šæ¨¡å¼ï¼Ÿè¿™ä¸ªæ¨¡å¼æœ‰ä»€ä¹ˆè¦ç‚¹ï¼Ÿå†ç»“åˆææ–™è°ˆè°ˆ</p><p>å¯¹æ¯”ä¼ ç»Ÿè½¦å’Œç”¨æˆ·ï¼Œåˆ†æè”šæ¥ç”µåŠ¨è½¦ä½“ç°ä½•ç§å•†ä¸šæ¨¡å¼ï¼Œè¯¥å•†ä¸šæ¨¡å¼å…·æœ‰ä»€ä¹ˆç‰¹ç‚¹</p><h2 id="ç¬¬3é¢˜å®¢æˆ·æ´å¯Ÿåœºæ™¯è®²æ•…äº‹">ç¬¬3é¢˜ï¼ˆå®¢æˆ·æ´å¯Ÿã€åœºæ™¯ã€è®²æ•…äº‹ï¼‰</h2><p>å¯¹å¾®åšçš„æ™®é€šç”¨æˆ·è¿›è¡Œå®¢æˆ·æ´å¯Ÿï¼Œä¸»è¦ç‰¹ç‚¹æ˜¯æƒ³è¦è¿›è¡Œç¤¾äº¤å’Œè¿½è¸ªæ—¶äº‹çƒ­ç‚¹</p><p>ä»å…¬å¸å’Œå®¢æˆ·è§’åº¦åˆ†åˆ«è®²ä¸€ä¸ªæ•…äº‹</p><p>Appå•†åŸå†…çš„é¢˜é¢ï¼Œå¯¹å®¢æˆ·çš„è®²æ•…äº‹å’Œåœºæ™¯æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç»™å‡ºä¸€ä¸ªåœºæ™¯ï¼Œå¹¶é˜è¿°ä¸ºä»€ä¹ˆé€‚ç”¨ï¼Ÿ</p><h2 id="ç¬¬4é¢˜å•†ä¸šæ¨¡å¼åˆ†æ">ç¬¬4é¢˜ï¼ˆå•†ä¸šæ¨¡å¼åˆ†æï¼‰</h2><p><font color="red"></font></p><p>å¯¹å¾®åšçš„å•†ä¸šæ¨¡å¼è¿›è¡ŒSWOTè¯„ä¼°ï¼ˆä¸éœ€è¦æ‰“åˆ†ï¼Œæ¦‚è¦è¯„ä¼°ï¼‰</p><p>SWOTè¯„ä¼°åŒ…æ‹¬å“ªäº›è¦ç‚¹ï¼Ÿç»“åˆææ–™å’Œç”»å¸ƒé‡Œçš„æ¯ä¸ªå…ƒç´ ï¼Œç®€è¦åˆ†æï¼ˆä¸éœ€è¦æ‰“åˆ†ï¼‰</p><p>å¯¹è”šæ¥ç”µåŠ¨è½¦çš„å•†ä¸šæ¨¡å¼è¿›è¡Œç¯å¢ƒè¯„ä¼°ï¼ˆä¸éœ€è¦æ‰“åˆ†ï¼Œæ¦‚è¦è¯„ä¼°ï¼‰</p><h2 id="ç¬¬5é¢˜ç›®æ ‡æ¨¡å‹">ç¬¬5é¢˜ï¼ˆç›®æ ‡æ¨¡å‹ï¼‰</h2><p>ç»“åˆå¾®åšå­˜åœ¨çš„é—®é¢˜ï¼Œè¿›è¡Œç›®æ ‡åˆ†æï¼ˆå°½å¯èƒ½å¤šåœ°ä½¿ç”¨ç›®æ ‡åˆ†æçš„å…ƒç´ ï¼‰</p><p>æƒ³è¦åœ¨2021å¹´å¤§è§„æ¨¡æ‰©å¼ ï¼Œç”»å‡ºç›®æ ‡æ¨¡å‹</p><p>ç»“åˆè”šæ¥ç”µåŠ¨è½¦çš„è½¦å‹ç¤¾åŒºï¼Œè¿›è¡Œç›®æ ‡åˆ†æï¼ˆå°½å¯èƒ½å¤šåœ°ä½¿ç”¨ç›®æ ‡åˆ†æçš„å…ƒç´ ï¼‰</p><h2 id="ç¬¬6é¢˜æ¶‰ä¼—åˆ†æ">ç¬¬6é¢˜ï¼ˆæ¶‰ä¼—åˆ†æï¼‰</h2><p>ä½¿ç”¨power-interestå’Œpower-attributeæ¨¡å‹ï¼Œé˜è¿°å¦‚ä½•åŒ–è§£å¾®åšçš„æ¶‰ä¼—é£é™©</p><p>æœ‰åº—å‘˜å› ä¸ºæ•°å­¦ä¸å¥½è€Œç¦»èŒï¼Œè€åº—é•¿è®¤ä¸ºè®¡ç®—æœºä¸èƒ½ä»£æ›¿äººç±»å†³ç­–ï¼›é€šè¿‡å®éªŒè¯æ˜æ•°æ®æ¨¡å‹æ›´æœ‰æ•ˆï¼›è€åº—é•¿åŸ¹å…»æ–°åº—é•¿ï¼›å‡å°‘åº—å‘˜æ•°é‡ï¼Œå¢åŠ åº—å‘˜æ”¶å…¥ã€‚ç»“åˆææ–™ï¼Œç”¨stakeholder-issueæ¨¡å‹è¿›è¡Œæ¶‰ä¼—å…±èµ¢åˆ†æ</p><p>ä½¿ç”¨stakeholder/issueæ¨¡å‹è¿›è¡Œå…±èµ¢åˆ†æ</p><h2id="ç¬¬7é¢˜éœ€æ±‚è·å–ä¸‰å¤§æ‰‹æ®µé¢è°ˆåŸå‹è§‚å¯Ÿ">ç¬¬7é¢˜ï¼ˆéœ€æ±‚è·å–ä¸‰å¤§æ‰‹æ®µï¼šé¢è°ˆã€åŸå‹ã€è§‚å¯Ÿï¼‰</h2><p>å‡è®¾ä½ æƒ³è¦å¼€å‘ç›´æ’­å¸¦è´§ï¼Œç»“åˆä¸‰ç§éœ€æ±‚è·å–æ–¹æ³•ï¼Œç®€è¿°ä½ å°†å¦‚ä½•è¿›è¡Œéœ€æ±‚è·å–</p><p>æƒ³æç¤¾åŒºå›¢è´­ï¼Œæœ‰ä¸ªäººæ‡‚ï¼Œå¹¶ä¸”è¿˜ä¼šç›´æ’­å¸¦è´§ã€‚éœ€æ±‚è·å–æœ‰å“ª3ä¸ªæ–¹æ³•ï¼Ÿç»“åˆææ–™è°ˆå¦‚ä½•éœ€æ±‚è·å–</p><p>é¢è°ˆé—®é¢˜çš„ä¸¤å¤§ç±»å‹ï¼Œå’Œä¸€ä¸ªä¼ ç»Ÿç‡ƒæ²¹è½¦ç”¨æˆ·é¢è°ˆï¼Œæ¢è®¨æœåŠ¡å’Œè®©è¿™äº›å®¢æˆ·é€‰æ‹©ç”µåŠ¨è½¦ï¼Œæ„æ€ä¸€ä¸ªé—®é¢˜åˆ—è¡¨</p><h2 id="ç¬¬8é¢˜éœ€æ±‚ç®¡ç†ä¸éªŒè¯">ç¬¬8é¢˜ï¼ˆéœ€æ±‚ç®¡ç†ä¸éªŒè¯ï¼‰</h2><p>ç®€è¿°éœ€æ±‚ç®¡ç†çš„ä¸‰ç§æ–¹æ³•å’Œæµç¨‹</p><p>è®©ä½ åšå°ç¨‹åºå’ŒAppï¼Œéœ€æ±‚ç®¡ç†åŒ…æ‹¬å“ªäº›è¦ç‚¹ï¼Ÿç»“åˆç€è°ˆè°ˆ</p><p>ç®€è¿°éœ€æ±‚ç®¡ç†çš„ä¸‰ç§æ–¹æ³•å’Œç®¡ç†å˜æ›´çš„äº”å¤§åŸåˆ™</p><h2id="ç¬¬9é¢˜éœ€æ±‚åˆ†æç”»å›¾æ¦‚å¿µç±»å›¾é¡ºåºå›¾çŠ¶æ€å›¾">ç¬¬9é¢˜ï¼ˆéœ€æ±‚åˆ†æç”»å›¾ï¼šæ¦‚å¿µç±»å›¾ã€é¡ºåºå›¾ã€çŠ¶æ€å›¾ï¼‰</h2><p>å¾®åšæœ‰ä¸€ç³»åˆ—çš„å°å·è§„åˆ™ï¼Œæ ¹æ®è§„åˆ™ç”»å‡ºçŠ¶æ€å›¾</p><p>ä¹°ä¼˜æƒ åˆ¸åŒ…ã€æŸ¥çœ‹ä¼˜æƒ åˆ¸ã€ä¼˜æƒ åˆ¸åŒ…é€€æ¬¾ã€ä¼˜æƒ åˆ¸åŒ…è¿‡æœŸæ¢ç§¯åˆ†ã€‚ç”»å‡ºç”¨ä¾‹çš„ç³»ç»Ÿé¡ºåºå›¾</p><p>è”šæ¥ç”µåŠ¨è½¦æœ‰ä¸€ç³»åˆ—çš„å‡çº§ï¼ˆç±»ä¼¼ï¼‰è§„åˆ™ï¼Œæ ¹æ®è§„åˆ™ç”»å‡ºçŠ¶æ€å›¾</p><h2 id="å•†ä¸šæ¨¡å¼ç”»å¸ƒ">å•†ä¸šæ¨¡å¼ç”»å¸ƒ</h2><ul><li><strong>å®¢æˆ·ç»†åˆ†</strong><ul><li>ç›®æ ‡äººç¾¤ã€å–èˆä¸ç»†åˆ†</li><li>ç¾¤ä½“åˆ’åˆ†ï¼š<u>å¤§ä¼—å¸‚åœºã€å°ä¼—å¸‚åœºã€æ±‚åŒå­˜å¼‚çš„å®¢æˆ·ç¾¤ä½“ã€å¤šå…ƒåŒ–çš„å®¢æˆ·ç¾¤ä½“ã€å¤šå˜å¹³å°</u></li></ul></li><li><strong>ä»·å€¼ä¸»å¼ </strong><ul><li>ä¸ºæŸä¸€å®¢æˆ·ç¾¤ä½“èƒ½å¤Ÿä¸ºå…¶åˆ›é€ ä»·å€¼çš„äº§å“å’ŒæœåŠ¡</li><li>è®©äº‹æƒ…æ›´ç®€å•ï¼ˆ<u>ä¿å§†å¼æœåŠ¡</u>ã€<u>ä¾¿åˆ©æ€§</u>ã€<u>ä»·æ ¼</u>ï¼‰ã€æ›´å¤æ‚ï¼ˆ<u>å®šåˆ¶</u>ï¼‰ã€æ›´é€æ˜ï¼ˆ<u>é£æ§</u>ï¼‰ã€<u>åˆ›æ–°</u>ã€<u>æ€§èƒ½</u>ã€<u>è®¾è®¡</u>ã€<u>å“ç‰Œ/åœ°ä½</u>ã€<u>ç¼©å‡æˆæœ¬</u>ã€<u>å¯è·å¾—æ€§</u></li></ul></li><li><strong>å…³é”®ä¸šåŠ¡</strong><ul><li><u>ç”Ÿäº§ã€è§£å†³æ–¹æ¡ˆã€å¹³å°/ç½‘ç»œ</u></li></ul></li><li><strong>æ ¸å¿ƒèµ„æº</strong><ul><li>ä¿è¯å•†ä¸šæ¨¡å¼è¿è¡Œçš„æœ€é‡è¦èµ„äº§ï¼ˆå“ç‰Œä¹Ÿç®—ï¼‰</li><li><u>å®ç‰©èµ„æºã€çŸ¥è¯†å‹èµ„æºã€äººåŠ›èµ„æºã€é‡‘èèµ„æº</u></li></ul></li><li><strong>æ¸ é“é€šè·¯</strong><ul><li>å¦‚ä½•å’Œå®¢æˆ·ç¾¤ä½“è¾¾æˆæ²Ÿé€šå¹¶å»ºç«‹è”ç³»ï¼Œä»¥å‘å¯¹æ–¹ä¼ é€’è‡ªèº«çš„ä»·å€¼ä¸»å¼ </li><li><u>çŸ¥ååº¦-è¯„ä»·-è´­ä¹°-ä¼ é€’-å”®å</u></li></ul></li><li><strong>é‡è¦åˆä½œ</strong><ul><li>ä¾›åº”å•†å’Œåˆä½œä¼™ä¼´ç½‘ç»œ</li><li>éç«äº‰è€…çš„æˆ˜ç•¥åŒç›Ÿã€ç«äº‰è€…çš„æˆ˜ç•¥åŒç›Ÿï¼ˆåˆä½œï¼‰ã€ä¸ºæ–°ä¸šåŠ¡å»ºç«‹åˆèµ„å…¬å¸ã€ç¨³å®šä¾›åº”å…³ç³»çš„ä¾›åº”å•†å’Œé‡‡è´­å•†</li><li>åŠ¨æœºï¼šä¼˜åŒ–åŠè§„æ¨¡æ•ˆåº”ã€é™ä½é£é™©å’Œä¸ç¡®å®šæ€§ã€ç‰¹æ®Šèµ„æºåŠæ´»åŠ¨çš„è·å¾—</li></ul></li><li><strong>æ”¶å…¥æ¥æº</strong><ul><li>ç”¨æˆ·çœŸæ­£æ„¿æ„ä»˜è´¹çš„ç‚¹</li><li><u>èµ„äº§é”€å”®ã€ä½¿ç”¨è´¹ã€ä¼šå‘˜è´¹ã€ç§Ÿèµã€è®¸å¯ä½¿ç”¨è´¹ã€ç»çºªäººä½£é‡‘ã€å¹¿å‘Šè´¹</u></li><li>å›ºå®šä»·æ ¼ã€æµ®åŠ¨ä»·æ ¼</li></ul></li><li><strong>æˆæœ¬ç»“æ„</strong><ul><li><u>å›ºå®šæˆæœ¬ã€å¯å˜æˆæœ¬ã€è§„æ¨¡ç»æµã€èŒƒå›´ç»æµ</u></li></ul></li><li><strong>å®¢æˆ·å…³ç³»</strong><ul><li><u>ç§äººæœåŠ¡ã€ä¸“å±ç§äººæœåŠ¡ã€è‡ªåŠ©æœåŠ¡ã€è‡ªåŠ¨åŒ–æœåŠ¡ã€ç¤¾åŒºã€åä½œ/å…±åŒåˆ›é€ </u></li></ul></li></ul><h2 id="å•†ä¸šæ¨¡å¼ç±»å‹">å•†ä¸šæ¨¡å¼ç±»å‹</h2><h3 id="åˆ†æ‹†å•†ä¸šæ¨¡å¼">åˆ†æ‹†å•†ä¸šæ¨¡å¼</h3><ul><li>ä¼ä¸šä»äº‹æ´»åŠ¨çš„ä¸‰ç§ä¸åŒç±»å‹ï¼š<strong>å®¢æˆ·å…³ç³»ç®¡ç†</strong>ã€<strong>æ–°äº§å“å¼€å‘</strong>ã€<strong>åŸºç¡€è®¾æ–½ç®¡ç†</strong></li><li>å¯¹åº”ç€ä¸‰ç§ä»·å€¼ä¿¡æ¡ï¼š<strong>äº²è¿‘å®¢æˆ·</strong>ã€<strong>äº§å“é¢†å…ˆ</strong>ã€<strong>è¿è¥å“è¶Š</strong></li></ul><h3 id="å¤šè¾¹å¹³å°å•†ä¸šæ¨¡å¼">å¤šè¾¹å¹³å°å•†ä¸šæ¨¡å¼</h3><ul><li>å¹³å°å°†ä¸¤ä¸ªæˆ–æ›´å¤šç‹¬ç«‹ä½†ç›¸äº’ä¾å­˜çš„å®¢æˆ·ç¾¤ä½“è¿æ¥åœ¨ä¸€èµ·ï¼Œå¹³å°é€šè¿‡ä¿ƒè¿›ä¸åŒç¾¤ä½“ä¹‹é—´çš„äº’åŠ¨è€Œåˆ›é€ ä»·å€¼</li><li>ä»·å€¼ä¸»å¼ ï¼šå¸å¼•ç”¨æˆ·ã€ç¾¤ä½“é…å¯¹ã€åˆ©ç”¨å¹³å°äº¤æ˜“æ¸ é“é™ä½äº¤æ˜“æˆæœ¬</li><li>å®¢æˆ·ç¾¤ä½“ç›¸äº’ä¾å­˜ï¼Œæ— æ³•ç‹¬ç«‹</li><li>æ ¸å¿ƒæ˜¯è¡¥è´´æ­£ç¡®çš„å®¢æˆ·ç¾¤</li></ul><h3 id="é•¿å°¾å•†ä¸šæ¨¡å¼">é•¿å°¾å•†ä¸šæ¨¡å¼</h3><ul><li>è‡´åŠ›äºæä¾›ç›¸å½“å¤šç§ç±»çš„å°ä¼—äº§å“ï¼Œè€Œå…¶ä¸­çš„æ¯ç§å–å‡ºé‡ç›¸å¯¹å¾ˆå°‘ï¼Œä½†æ€»é”€å”®é¢å¯ä»¥ä¸ä¼ ç»Ÿæ¨¡å¼é”€å”®åª²ç¾</li><li>å›¾ä¹¦ï¼šä»¥ç•…é”€ä¹¦ä¸ºä¸­å¿ƒçš„å‡ºç‰ˆæ¨¡å¼=ã€‹ä¸ºä»»ä½•éœ€è¦çš„äººå‡ºç‰ˆ</li><li>ä¹é«˜ï¼šä¼ ç»Ÿçš„ç§¯æœ¨åˆ¶ä½œ=ã€‹ç”¨æˆ·å®šåˆ¶+åœ¨çº¿å”®å–</li><li>å‡ºç°çš„åŸå› ï¼š<ul><li>ç”Ÿäº§å·¥å…·çš„æ™®åŠ</li><li>é”€å”®æ¸ é“çš„æ™®åŠ</li><li>è¿æ¥ä¾›éœ€åŒæ–¹æœå¯»æˆæœ¬çš„é™ä½</li></ul></li></ul><h3 id="å…è´¹å•†ä¸šæ¨¡å¼">å…è´¹å•†ä¸šæ¨¡å¼</h3><ul><li>è‡³å°‘æœ‰ä¸€ä¸ªå…³é”®çš„å®¢æˆ·ç¾¤ä½“æ˜¯å¯ä»¥æŒç»­å…è´¹åœ°äº«å—æœåŠ¡ï¼Œä¸ä»˜è´¹å®¢æˆ·æ‰€å¾—åˆ°åœ°è´¢åŠ¡æ”¯æŒæ¥è‡ªäºå¦ä¸€ä¸ªå®¢æˆ·ç¾¤ä½“</li><li>å¹¿å‘Šæ¨¡å¼<ul><li>å…è´¹çš„å½¢å¼ï¼šåŸºäºå¤šè¾¹å¹³å°çš„å…è´¹å•†å“</li></ul></li><li>å…è´¹å¢å€¼<ul><li>å…è´¹çš„å½¢å¼ï¼šå…è´¹çš„åŸºæœ¬æœåŠ¡ï¼Œå¯é€‰çš„å¢å€¼æœåŠ¡</li></ul></li><li>è¯±é¥µ&amp;é™·é˜±<ul><li>ä»¥ä¸€ä¸ªå…è´¹æˆ–è€…å¾ˆä¾¿å®œçš„åˆå§‹ä»·æ ¼å¸å¼•å®¢æˆ·ï¼Œå¼•è¯±å®¢æˆ·è¿›å…¥é‡å¤è´­ä¹°çŠ¶æ€</li></ul></li></ul><h3 id="å¼€æ”¾å•†ä¸šæ¨¡å¼">å¼€æ”¾å•†ä¸šæ¨¡å¼</h3><ul><li>ç³»ç»Ÿæ€§ä¸å¤–éƒ¨ä¼™ä¼´åˆä½œ</li><li>ç”±å†…åˆ°å¤–ï¼šå°†å¤–éƒ¨çš„ç†è®ºã€æŠ€æœ¯æˆ–çŸ¥è¯†äº§æƒå¼•å…¥å†…éƒ¨</li><li>ç”±å¤–åˆ°å†…ï¼šå°†å†…éƒ¨çš„çŸ¥è¯†äº§æƒæˆ–æŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯é—²ç½®èµ„äº§å‘å¤–å‡ºå”®</li></ul><h2 id="å•†ä¸šæ¨¡å¼è®¾è®¡">å•†ä¸šæ¨¡å¼è®¾è®¡</h2><h3 id="å®¢æˆ·æ´å¯Ÿ">å®¢æˆ·æ´å¯Ÿ</h3><ul><li><strong>çœ‹åˆ°ä»€ä¹ˆ</strong>ï¼šæè¿°è¿™ä¸ªå®¢æˆ·åœ¨å¥¹æ‰€åœ¨çš„ç¯å¢ƒä¸­<strong>æ‰€çœ‹åˆ°çš„ä¸œè¥¿</strong>ï¼ŒåŒç±»äº§å“ã€æœ‹å‹ã€çœ‹æˆ‘ä»¬çš„äº§å“</li><li><strong>å¬åˆ°ä»€ä¹ˆ</strong>ï¼šæè¿°ç¯å¢ƒå¦‚ä½•å½±å“åˆ°è¿™ä¸ªå®¢æˆ·</li><li><strong>æƒ³&amp;æ„Ÿå—</strong>ï¼šå°è¯•å‹¾å‹’ä½ çš„<strong>å®¢æˆ·æ€ç»´</strong>çš„è¿‡ç¨‹ï¼Œé‡è¦ã€æ‰“åŠ¨</li><li><strong>è¯´&amp;åš</strong>ï¼šæƒ³è±¡å®¢æˆ·å¯èƒ½å‡ºç°çš„<strong>è¨€è¾</strong>ï¼Œæˆ–å…¬å…±åœºåˆçš„<strong>è¡Œä¸º</strong></li><li><strong>ç—›ç‚¹</strong>ï¼šå·²é­å—çš„æŒ«æŠ˜ã€æ­£é‡åˆ°çš„é˜»ç¢ã€æ€•æ‰¿æ‹…çš„é£é™©</li><li><strong>æ”¶ç›Š</strong>ï¼šé¢„æœŸæˆå°±ã€æˆåŠŸè¡¡é‡æ ‡å‡†ã€å®ç°ç›®æ ‡æ‰€é‡‡ç”¨çš„ç­–ç•¥</li></ul><h3 id="æ„æ€">æ„æ€</h3><ul><li>çµæ„Ÿã€æ„æ€ã€å®æ–½</li><li>ç”Ÿæˆå¤§é‡åˆ›æ„=ã€‹å¯¹åˆ›æ„è¿›è¡Œæ•´åˆç­›é€‰</li><li>å¤´è„‘é£æš´</li><li>èµ„æºé©±åŠ¨ã€ä¾›ç»™é©±åŠ¨ã€å®¢æˆ·é©±åŠ¨ã€è´¢åŠ¡é©±åŠ¨ã€å¤šç‚¹é©±åŠ¨</li><li>ä»ç”»å¸ƒå¯»æ‰¾åˆ›æ–°ç‚¹ã€å¦‚æœ...ä¼šæ€æ ·</li></ul><h3 id="è§†è§‰åŒ–æ€è€ƒ">è§†è§‰åŒ–æ€è€ƒ</h3><ul><li>æŠ½è±¡=ã€‹å…·ä½“</li><li>ä¸¤é¡¹æŠ€æœ¯ï¼šå¦‚ä½•ä½¿ç”¨ä¾¿åˆ©è´´+å¦‚ä½•å°†è‰å›¾ä¸å•†ä¸šæ¨¡å¼ç”»å¸ƒç»“åˆ</li><li>å››ä¸ªæµç¨‹ï¼šç†è§£ã€å¯¹è¯ã€æ¢ç´¢ã€æ²Ÿé€š</li><li>ä½œç”¨ï¼šåŠ æ·±ç†è§£ã€æé«˜å¯¹è¯æ•ˆç‡ã€æ¢ç´¢åˆ›æ„ã€æå‡æ²Ÿé€š</li></ul><h3 id="æ¨¡å‹æ„å»º">æ¨¡å‹æ„å»º</h3><ul><li>æŠ½è±¡æ¦‚å¿µå…·ä½“åŒ–ï¼Œå¸®åŠ©æ¢ç´¢æ–°çš„åˆ›æ„ï¼Œæœ‰åŠ©äºå®é™…å•†ä¸šæ¨¡å¼çš„æ¢ç´¢</li><li>è®¾è®¡æ€åº¦ï¼šä¸“æ³¨æ¢ç´¢ã€å…¨é¢è€ƒè™‘ã€å¿«é€Ÿæ”¾å¼ƒã€é€‰å‡ºå€¼å¾—ä¼˜åŒ–çš„æƒ³æ³•ã€æ¥æ”¶ä¸ç¡®å®šæ€§</li><li>æ§åˆ¶è§„æ¨¡<ul><li>éšæ‰‹ç´ æ</li><li>ç²¾å¿ƒæç»˜çš„ç”»å¸ƒ</li><li>å•†ä¸šæ¡ˆä¾‹</li><li>å®åœ°éªŒè¯</li></ul></li></ul><h3 id="è®²æ•…äº‹">è®²æ•…äº‹</h3><ul><li>ç†æƒ³çš„çƒ­èº«å·¥å…·ï¼Œä¸ºæ·±åº¦è®¨è®ºå•†ä¸šæ¨¡å¼ä¸å…¶å†…åœ¨é€»è¾‘åšå¥½å‡†å¤‡</li><li>ä¸ºä»€ä¹ˆè¦è®²æ•…äº‹<ul><li>ä»‹ç»æ–°æƒ³æ³•</li><li>å‘æŠ•èµ„äººæ¨è</li><li>å¸å¼•å‘˜å·¥</li><li>è®©æœªæ¥è§¦æ‰‹å¯åŠ</li></ul></li><li>æ•…äº‹çš„ä¸åŒè§†è§’ï¼šå®¢æˆ·ã€å…¬å¸ã€æœªæ¥</li></ul><h3 id="åœºæ™¯">åœºæ™¯</h3><ul><li>å°†æ¨¡å‹æ„å»ºä¸­æ˜ç¡®çš„æ–¹å‘å…·ä½“åŒ–ï¼Œä»è€Œç»™å‡ºæœ‰è§åœ°çš„è®¾è®¡</li><li>ä¸¤ç§åœºæ™¯<ul><li>ä¸åŒçš„å®¢æˆ·ç»“æ„ï¼šç»“åˆå®¢æˆ·æ´å¯Ÿæç»˜å¤„ç‹¬ç‰¹ã€å…·ä½“çš„å›¾æ™¯</li><li>æœªæ¥å¯èƒ½çš„ç«äº‰ç¯å¢ƒï¼šæƒ³è±¡æœªæ¥å¯èƒ½çš„å…·ä½“ç»†èŠ‚ï¼Œå“å‘³ç‰¹å®šæ¡ä»¶ä¸‹å•†ä¸šæ¨¡å¼å¦‚ä½•æ¼”è¿›</li></ul></li><li>ä¸ºä¸€ä¸ªæ•…äº‹è®¾è®¡å¹¶è¡¥å……ä¸€ä¸ªåœºæ™¯</li><li>äº†è§£è¯„ä¼°=ã€‹è´­ä¹°ä¸ä¼ é€’=ã€‹äº¤äº’=ã€‹å”®å=ã€‹è¯„ä»·ä¸å¤è´­</li></ul><h2 id="å•†ä¸šæ¨¡å¼æˆ˜ç•¥">å•†ä¸šæ¨¡å¼æˆ˜ç•¥</h2><h3 id="å•†ä¸šæ¨¡å¼ç¯å¢ƒ">å•†ä¸šæ¨¡å¼ç¯å¢ƒ</h3><ul><li><strong>å¸‚åœºå½±å“åŠ›</strong>ï¼š<ul><li>å¸‚åœºé—®é¢˜ï¼š</li><li>å¸‚åœºåˆ†ç±»ï¼šè¯†åˆ«å®¢æˆ·ç¾¤ä½“</li><li>éœ€æ±‚å’Œè¯‰æ±‚ï¼š</li><li>åˆ‡æ¢æˆæœ¬ï¼š</li><li>æ”¶å…¥å¸å¼•åŠ›ï¼š</li></ul></li><li><strong>è¡Œä¸šå½±å“åŠ›</strong><ul><li>ç«äº‰å¯¹æ‰‹</li><li>æ–°è¿›å…¥è€…ï¼ˆæŒ‘æˆ˜è€…ï¼‰</li><li>æ›¿ä»£äº§å“å’ŒæœåŠ¡ï¼šæ½œåœ¨æ›¿ä»£å“</li><li>ä¾›åº”å•†å’Œä»·å€¼é‡é“¾ä¸Šçš„å…¶ä»–å‚å•†ï¼šå¸‚åœºä»·å€¼é“¾ä¸­çš„å…³é”®ç©å®¶</li><li>åˆ©ç›Šç›¸å…³è€…ï¼šå½±å“ç»„ç»‡å’Œå•†ä¸šæ¨¡å¼çš„äºº</li></ul></li><li><strong>å…³é”®è¶‹åŠ¿</strong>ï¼š<ul><li>æŠ€æœ¯è¶‹åŠ¿ï¼šå¨èƒ/æ¨åŠ¨å•†ä¸šæ¨¡å¼çš„æŠ€æœ¯</li><li>è¡Œä¸šç®¡ç†è¶‹åŠ¿ï¼š</li><li>ç¤¾ä¼šå’Œæ–‡åŒ–è¶‹åŠ¿ï¼šä»·å€¼è§‚ï¼Ÿ</li><li>ç¤¾ä¼šç»æµè¶‹åŠ¿ï¼š</li></ul></li><li><strong>å®è§‚ç»æµå½±å“</strong>ï¼š<ul><li>å…¨çƒå¸‚åœºæƒ…å†µ</li><li>èµ„æœ¬å¸‚åœº</li><li>å¤§å®—å•†å“å’Œå…¶ä»–èµ„æºï¼šå•†ä¸šæ¨¡å¼æ‰€éœ€èµ„æºçš„ä»·æ ¼å’Œä»·æ ¼è¶‹åŠ¿ï¼ˆäººæ‰ã€åŸæ–™ï¼‰</li><li>ç»æµåŸºç¡€è®¾æ–½</li></ul></li></ul><h3 id="swotåˆ†æ">SWOTåˆ†æ</h3><ul><li><strong>SW</strong><ul><li>ä»·å€¼ä¸»å¼ <ul><li>ç”¨æˆ·éœ€æ±‚ã€ç½‘ç»œæ•ˆåº”ã€äº§å“æœåŠ¡å¼ºè€¦åˆã€ç”¨æˆ·æ»¡æ„</li></ul></li><li>æˆæœ¬/æ”¶å…¥<ul><li>åˆ©æ¶¦é«˜ã€æ”¶å…¥å¯é¢„æœŸã€æ”¶å…¥å¯æŒç»­ã€æ”¶å…¥å¤šæ ·åŒ–ã€æ”¯å‡ºå‰æœ‰è¿›è´¦ã€æŠ“ä½å®¢æˆ·çš„æ„æ„¿ã€å®¢æˆ·æƒ³è¦çš„å’Œæä¾›çš„ä¸€è‡´</li><li>æˆæœ¬å¯é¢„æµ‹ã€æˆæœ¬åŒ¹é…å•†ä¸šæ¨¡å¼ã€è¿è¥æˆæœ¬æ•ˆç‡é«˜ã€è§„æ¨¡ç»æµä¸­è·ç›Š</li></ul></li><li>åŸºç¡€è®¾æ–½ï¼ˆæ ¸å¿ƒèµ„æºã€å…³é”®ä¸šåŠ¡ã€é‡è¦åˆä½œï¼‰<ul><li>å¯¹æ‰‹éš¾å¤åˆ¶ã€èµ„æºéœ€æ±‚å¯é¢„æµ‹ã€åˆé€‚æ—¶é—´éƒ¨ç½²åˆé€‚èµ„æº</li><li>æœ‰æ•ˆæ‰§è¡Œå…³é”®ä¸šåŠ¡ã€éš¾ä»¥å¤åˆ¶ã€æ‰§è¡Œè´¨é‡é«˜ã€è‡ªæœ‰æ´»åŠ¨å’Œå¤–åŒ…æ´»åŠ¨å¹³è¡¡</li><li>å¿…è¦åˆä½œã€å…³ç³»èæ´½</li></ul></li><li>å®¢æˆ·ç•Œé¢ï¼ˆå®¢æˆ·ç»†åˆ†ã€æ¸ é“é€šè·¯ã€å®¢æˆ·å…³ç³»ï¼‰<ul><li>å®¢æˆ·æµå¤±ç‡ä½ã€å¾ˆå¥½åœ°åˆ†ç±»ç”¨æˆ·ã€ä¸æ–­è·å¾—ç”¨æˆ·</li><li>æ¸ é“æœ‰æ•ˆç‡ã€æ¸ é“æœ‰æ•ˆæœã€è¿æ¥å®¢æˆ·æ•ˆæœå¥½ã€å®¢æˆ·è½»æ˜“æ¥è§¦æ¸ é“ã€é«˜åº¦æ•´åˆã€è§„æ¨¡ç»æµã€åŒ¹é…å®¢æˆ·ç¾¤ä½“</li><li>å®¢æˆ·å…³ç³»å¼ºã€åŒ¹é…å®¢æˆ·ç¾¤ä½“ã€åˆ‡æ¢æˆæœ¬é«˜ç»‘å®šå…³ç³»ã€å“ç‰Œå¾ˆå¼º</li></ul></li></ul></li><li><strong>O</strong><ul><li>ä»·å€¼ä¸»å¼ ï¼šäº§å“æœåŠ¡åŒ–ï¼Ÿæ•´åˆäº§å“æœåŠ¡ï¼Ÿé¢å¤–éœ€æ±‚ï¼Ÿä»·å€¼ä¸»å¼ å¤–å»¶ï¼Ÿé¢å¤–å·¥ä½œï¼Ÿ</li><li>æˆæœ¬/æ”¶å…¥ï¼š<ul><li>é‡å¤æ”¶å…¥ï¼Ÿå†…éƒ¨æˆ–åˆä½œä¼™ä¼´äº¤å‰é”€å”®ï¼Ÿå¢åŠ åˆ›é€ æ”¶å…¥æ¥æºï¼Ÿæä»·ï¼Ÿ</li><li>å‰Šå‡æˆæœ¬ï¼Ÿ</li></ul></li><li>åŸºç¡€è®¾æ–½ï¼š<ul><li>èµ„æºæˆæœ¬æ›´ä½ï¼Ÿè½¬ç§»ç»™åˆä½œä¼™ä¼´ï¼Ÿå¼€å‘ä¸è¶³ï¼Ÿå¯¹ä»–äººæœ‰ç”¨çš„çŸ¥è¯†èµ„äº§</li><li>å…³é”®ä¸šåŠ¡æ ‡å‡†åŒ–ï¼Ÿæé«˜æ•ˆç‡ï¼ŸITå¸®åŠ©ï¼Ÿ</li><li>å¤–åŒ…ï¼Ÿæ‰©å¤§åˆä½œï¼Ÿäº¤å‰é”€å”®ï¼Ÿå¸®åŠ©è¿æ¥å®¢æˆ·ï¼Ÿè¡¥å……ä»·å€¼ä¸»å¼ ï¼Ÿ</li></ul></li><li>å®¢æˆ·ç•Œé¢ï¼š<ul><li>å¢é•¿çš„å¸‚åœºï¼Ÿæ–°å®¢æˆ·ï¼Ÿæ›´ç»†è‡´çš„åˆ†ç±»ï¼Ÿ</li><li>æå‡æ•ˆç‡æ•ˆç›Šï¼Ÿæ•´åˆæ¸ é“ï¼Ÿè¡¥å……æ€§æ¸ é“ä¼™ä¼´ï¼Ÿå»ä¸­é—´å•†ï¼ŸåŒ¹é…æ¸ é“å®¢æˆ·ï¼Ÿ</li><li>æå‡å®¢æˆ·è·Ÿè¿›æ•ˆæœï¼Ÿç´§å¯†å®¢æˆ·å…³ç³»ï¼Ÿæ”¹è¿›å®šåˆ¶åŒ–ï¼Ÿæå‡åˆ‡æ¢æˆæœ¬ï¼Ÿèˆå¼ƒæ— åˆ©æ¶¦å®¢æˆ·ï¼Ÿå®¢æˆ·å…³ç³»è‡ªåŠ¨ç»´æŠ¤ï¼Ÿ</li></ul></li></ul></li><li><strong>T</strong><ul><li>ä»·å€¼ä¸»å¼ ï¼šå­˜åœ¨å¯æ›¿ä»£å“ï¼Ÿ</li><li>æˆæœ¬/æ”¶å…¥ï¼š<ul><li>åˆ©æ¶¦çš„å¨èƒï¼Ÿæ”¶ç›Šæ¥æºå•ä¸€ï¼Ÿæ”¶ç›Šæ¥æºæ¶ˆå¤±ï¼Ÿ</li><li>æˆæœ¬æ— æ³•é¢„æµ‹ï¼Ÿæˆæœ¬è¶…è¿‡æ”¶å…¥ï¼Ÿ</li></ul></li><li>åŸºç¡€è®¾æ–½<ul><li>èµ„æºä¾›åº”ä¸è¶³ã€èµ„æºè´¨é‡ä¿è¯ï¼Ÿ</li><li>å…³é”®ä¸šåŠ¡å¹²æ‰°ï¼Ÿä¸šåŠ¡è´¨é‡è¢«å¨èƒï¼Ÿ</li><li>å¤±å»åˆä½œä¼™ä¼´ï¼Ÿå’Œå¯¹æ‰‹åˆä½œï¼Ÿè¿‡åˆ†ä¾èµ–ä¼™ä¼´ï¼Ÿ</li></ul></li><li>å®¢æˆ·ç•Œé¢<ul><li>å¸‚åœºé¥±å’Œï¼Ÿå¨èƒå¸‚åœºä»½é¢ï¼Ÿè½¬æŠ•ç«äº‰å¯¹æ‰‹ï¼Ÿç«äº‰ç™½çƒ­åŒ–ï¼Ÿ</li><li>å¨èƒæ¸ é“ï¼Ÿæ¸ é“ç”¨æˆ·ä¸ç›¸å…³ï¼Ÿ</li><li>å®¢æˆ·å…³ç³»æ¶åŒ–ï¼Ÿ</li></ul></li></ul></li></ul><h3 id="è“æµ·æˆ˜ç•¥">è“æµ·æˆ˜ç•¥</h3><ul><li>å¢åŠ ä»·å€¼+å‡å°‘æˆæœ¬</li><li>ä¸‰ä¸ªè§†è§’ï¼šå®¢æˆ·ç¾¤ä½“è§†è§’ã€ä»·å€¼ä¸»å¼ è§†è§’ã€æˆæœ¬çš„è§†è§’</li><li>å››é¡¹è¡ŒåŠ¨ï¼šåˆ é™¤ã€å‰Šå‡ã€æå‡ã€åˆ›é€ </li><li>å¤ªé˜³é©¬æˆå›¢ï¼šä»·å€¼ä¸»å¼ ï¼šå¢åŠ è‰ºæœ¯å…ƒç´ ï¼Œæ”¾å¼ƒåŠ¨ç‰©è¡¨æ¼”</li><li>ä»»å¤©å ‚çš„wiiï¼šå®¢æˆ·ç¾¤ä½“ï¼šé“æ†ç©å®¶=ã€‹ä¼‘é—²ç©å®¶</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230205120635021.png" /></p><h2 id="éœ€æ±‚åŸºç¡€">éœ€æ±‚åŸºç¡€</h2><blockquote><p>ç¬¬ä¸€é¢˜å¯èƒ½ä¼šæ¶‰åŠä¸€äº›éœ€æ±‚åŸºç¡€</p></blockquote><ul><li>éœ€æ±‚çš„å±‚æ¬¡æ€§ï¼š<ul><li>ä¸šåŠ¡éœ€æ±‚ï¼šè§£å†³æ–¹æ¡ˆä¸ç³»ç»Ÿç‰¹æ€§</li><li>ç”¨æˆ·éœ€æ±‚ï¼šç”¨æˆ·å¯ä»¥ä½¿ç”¨ç³»ç»Ÿå®Œæˆxxä»»åŠ¡</li><li>ç³»ç»Ÿçº§éœ€æ±‚ï¼šç”¨æˆ·å¯¹ç³»ç»Ÿè¡Œä¸ºçš„æœŸæœ›ï¼Œå…·ä½“çš„</li></ul></li><li>éœ€æ±‚åˆ†ç±»<ul><li>è½¯ä»¶éœ€æ±‚</li><li>ç¡¬ä»¶éœ€æ±‚</li><li>å…¶ä»–éœ€æ±‚</li></ul></li><li>è½¯ä»¶éœ€æ±‚<ul><li>åŠŸèƒ½éœ€æ±‚</li><li>æ€§èƒ½éœ€æ±‚</li><li>è´¨é‡éœ€æ±‚</li><li>å¯¹å¤–æ¥å£</li><li><strong>çº¦æŸ</strong>ï¼šé™åˆ¶å¼€å‘äººå‘˜è®¾è®¡å’Œæ„å»ºç³»ç»Ÿæ—¶çš„é€‰æ‹©èŒƒå›´<ul><li>ç³»ç»Ÿå¼€å‘åŠè¿è¡Œçš„ç¯å¢ƒ</li><li>é—®é¢˜åŸŸæ ‡å‡†ï¼šæ³•å¾‹æ³•è§„</li><li>å•†ä¸šè§„åˆ™</li><li>ç¤¾ä¼šæ€§å› ç´ </li></ul></li><li>å…¶ä»–éœ€æ±‚</li></ul></li></ul><h2 id="ç›®æ ‡æ¨¡å‹">ç›®æ ‡æ¨¡å‹</h2><h3 id="ç›®æ ‡è§„æ ¼çš„åŸºæœ¬æ¨¡å¼">ç›®æ ‡è§„æ ¼çš„åŸºæœ¬æ¨¡å¼</h3><blockquote><p>ï¼ˆéœ€è¦è®°ä½è¿™äº›åè¯åœ¨ç”»å›¾çš„æ—¶å€™ä¼šç”¨åˆ°ï¼‰</p></blockquote><table><thead><tr class="header"><th>æ¨¡å¼</th><th>ç¬¦å·æè¿°</th><th>å«ä¹‰</th></tr></thead><tbody><tr class="odd"><td>å®ç°(Achieve)</td><td><span class="math inline">\(P \Rightarrow \Diamond Q\)</span></td><td>å¦‚æœå°†æ¥æŸä¸€æ—¶åˆ»Qä¸ºçœŸ(è¢«æ»¡è¶³)ï¼Œåˆ™ç›®æ ‡å®ç°</td></tr><tr class="even"><td>ç»ˆæ­¢(Cease)</td><td><span class="math inline">\(P \Rightarrow \Diamond \negQ\)</span></td><td>å¦‚æœå°†æ¥æŸä¸€æ—¶åˆ»Qä¸ºå‡(è¢«ç»ˆæ­¢)ï¼Œåˆ™ç›®æ ‡å®ç°</td></tr><tr class="odd"><td>ä¿æŒ(Maintain)</td><td><span class="math inline">\(P \Rightarrow \Box Q\)</span></td><td>å°†æ¥ä»»ä¸€æ—¶åˆ»Qéƒ½ä¸ºçœŸï¼Œåˆ™ç›®æ ‡å®ç°</td></tr><tr class="even"><td>é¿å…(Avoid)</td><td><span class="math inline">\(P \Rightarrow \Box \neg Q\)</span></td><td>å°†æ¥ä»»ä¸€æ—¶åˆ»Qéƒ½ä¸ºå‡ï¼Œåˆ™ç›®æ ‡å®ç°</td></tr><tr class="odd"><td>ä¼˜åŒ–(Optimize)</td><td>-</td><td>æœ€å¤§åŒ–Maximize(ç›®æ ‡åŠŸèƒ½) æˆ– æœ€å°åŒ–Minimize (ç›®æ ‡åŠŸèƒ½)</td></tr></tbody></table><h3 id="ç›®æ ‡æ¨¡å‹çš„å…³ç³»">ç›®æ ‡æ¨¡å‹çš„å…³ç³»</h3><ul><li><strong>ç²¾åŒ–</strong><ul><li><u>ANDç²¾åŒ–</u>ï¼šä»»ä¸€å­ç›®æ ‡çš„å®Œæˆéƒ½æœ‰åŠ©äºçˆ¶ç›®æ ‡çš„å®Œæˆ<ul><li>å®Œå¤‡ANDç²¾åŒ–ï¼šå­ç›®æ ‡çš„å®Œæˆå¯ä»¥ç›´æ¥ä¿è¯çˆ¶ç›®æ ‡çš„å®Œæˆ</li></ul></li><li><u>ORç²¾åŒ–</u>ï¼šä»»ä¸€å­ç›®æ ‡éƒ½æ˜¯çˆ¶ç›®æ ‡çš„æ›¿ä»£æ–¹æ¡ˆ</li></ul></li><li><strong>é˜»ç¢</strong>ï¼šå­ç›®æ ‡è¾¾æˆä¼šä½¿å¾—çˆ¶ç›®æ ‡å¤±è´¥ï¼›å¯ä»¥å¯¹é˜»ç¢ç›®æ ‡ç»§ç»­ç²¾åŒ–</li><li><strong>æ”¯æŒä¸å†²çª</strong><ul><li>supportï¼šä¸€ä¸ªç›®æ ‡å¯¹å…¶ä»–ç›®æ ‡çš„æ”¯æŒä¿ƒè¿›ä½œç”¨ï¼Œå¯ä»¥è¢«å¤„ç†ä¸º<strong>ORç²¾åŒ–å…³ç³»</strong></li><li>conflictï¼šä¸€ä¸ªç›®æ ‡å¯¹å…¶ä»–ç›®æ ‡çš„å®ç°æœ‰é˜»ç¢ä½œç”¨</li></ul></li></ul><h3 id="ç›®æ ‡åˆ†æè¿‡ç¨‹">ç›®æ ‡åˆ†æè¿‡ç¨‹</h3><ul><li><strong>ä»é«˜å±‚ç›®æ ‡æè¿°ä¸­å‘ç°å…³ç³»</strong><ul><li>ANDç²¾åŒ–å…³ç³»<ul><li>åŒä¸€ä¸ªç›®æ ‡æœ‰ä¸åŒåœºæ™¯</li><li>å®Œæˆç›®æ ‡æœ‰è¿ç»­è¿‡ç¨‹</li><li>å®Œæˆç›®æ ‡éœ€è¦å¤šä¸ªæ–¹é¢ç²¾å¯†é…åˆ</li><li>ç›®æ ‡æœ‰ä¸åŒè´¨é‡ç¯å¢ƒåŠè¡¨ç°</li></ul></li><li>ORç²¾åŒ–å…³ç³»ï¼šå¤šç§å¯ä»¥ç›¸äº’æ›¿ä»£çš„â€œå€™é€‰æ–¹æ³•â€</li></ul></li><li><strong>è€ƒè™‘é˜»ç¢ç›®æ ‡å®ç°çš„æƒ…å†µ</strong><ul><li>è€ƒè™‘ä½¿å¾—å­ç›®æ ‡å¤±è´¥çš„é˜»ç¢</li><li>è€ƒè™‘ä¸»ä½“è¡Œä¸ºå¯¼è‡´ç›®æ ‡å¤±è´¥çš„é˜»ç¢</li><li>è€ƒè™‘é¢„é˜²å¤±è´¥çš„æƒ…å†µ</li><li>é‡æ–°å¤„ç†å¤ªç†æƒ³åŒ–çš„ç›®æ ‡</li></ul></li><li><strong>è€ƒè™‘å·²æœ‰ç›®æ ‡ä¹‹é—´çš„æ”¯æŒä¸å†²çªå…³ç³»</strong></li><li><strong>å¯¹é«˜å±‚ç›®æ ‡é—®howï¼Œå¯¹ä½å±‚ç›®æ ‡é—®why</strong></li><li><strong>ç›®æ ‡çš„å®ç°</strong><ul><li>1ã€å°†æœ€åº•å±‚ç›®æ ‡åˆ†é…ç»™ä¸»ä½“</li><li>2ã€è®¾è®¡å®ç°æœ€åº•å±‚ç›®æ ‡çš„æ“ä½œ</li><li>ç›®æ ‡ä¸ä¸»ä½“çš„å…³ç³»ï¼šORå’ŒAND</li><li>ç›®æ ‡ä¸æ“ä½œçš„å…³ç³»ï¼šORå’ŒANDï¼ˆæ²¡æœ‰ç®­å¤´ ç›®æ ‡é—´å…³ç³»æœ‰ç®­å¤´ï¼‰</li></ul></li></ul><h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book5/37.png" /></p><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book5/38.png" /></p><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book5/69.png" /></p><h2 id="æ¶‰ä¼—åˆ†æ">æ¶‰ä¼—åˆ†æ</h2><h3 id="æ¶‰ä¼—è¯†åˆ«ä¹‹admæ¨¡å‹">æ¶‰ä¼—è¯†åˆ«ä¹‹ADMæ¨¡å‹</h3><blockquote><p>ä¸»ä½“ä¾èµ–æ¨¡å‹</p></blockquote><ul><li><font color='red'><strong>ç›®æ ‡ä¾èµ–</strong></font>ï¼šä¾èµ–è€…å¸Œæœ›è¢«ä¾èµ–è€…æ»¡è¶³ä¸€ä¸ªæ¡ä»¶ï¼Œä½†æ˜¯ä¸è§„å®šæ€æ ·æ»¡è¶³è¯¥æ¡ä»¶</li><li><font color='#f4df15'><strong>è½¯ç›®æ ‡ä¾èµ–</strong></font>ï¼šä¸€ç§ç‰¹æ®Šç±»å‹çš„ç›®æ ‡ä¾èµ–ï¼Œæ— æ³•é‡åŒ–æè¿°</li><li><font color='green'><strong>ä»»åŠ¡ä¾èµ–</strong></font>ï¼šä¾èµ–è€…å¸Œæœ›è¢«ä¾èµ–è€…æ‰§è¡Œç‰¹å®šä»»åŠ¡ï¼Œæ¯”ç›®æ ‡ä¾èµ–æ›´åŠ å…·ä½“</li><li><font color='blue'><strong>èµ„æºä¾èµ–</strong></font>ï¼šä¾èµ–è€…å¸Œæœ›è¢«ä¾èµ–è€…æä¾›èµ„æºå®ä½“ï¼ˆæŠ½è±¡ä¿¡æ¯æˆ–è€…å®ç‰©ææ–™ï¼‰ä¸ºè‡ªå·±æ‰€ç”¨</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210154032835.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210155251866.png" /></p><h3 id="æ¶‰ä¼—åˆ†æpower-interestæ¨¡å‹">æ¶‰ä¼—åˆ†æâ€”Power-Interestæ¨¡å‹</h3><p><strong>ä¼˜å…ˆçº§è¯„ä¼°</strong>ï¼šæœ‰äº›æ¶‰ä¼—å°±æ˜¯ä¼šæ›´åŠ é‡è¦ä¸€ç‚¹ï¼Œå…·æœ‰æ›´é«˜ä¼˜å…ˆçº§ï¼Œä½“ç°åœ¨å’Œç³»ç»Ÿçš„è”ç³»ä¸Š</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/11.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/12.png" /></p><p><strong>åŒ–è§£æ¶‰ä¼—é£é™©çš„ç­–ç•¥</strong></p><ul><li>æé«˜ç¯å¢ƒè®¾å®šè€…å¯¹ç³»ç»Ÿçš„å…³æ³¨ï¼Œè½¬å˜ä¸ºå‚ä¸è€…</li><li>æ¶ˆé™¤å¼ºåå¯¹è€…çš„åå¯¹åŸå› ï¼Œå˜ä¸ºå¼ºæ”¯æŒè€…</li><li>ç»™äºˆè¢«å½±å“è€…å‘è¡¨å®ç°è‡ªèº«æ„æ„¿çš„æƒåˆ©ï¼ŒåŒ–è§£å¼±åå¯¹è€…å¿§è™‘</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/13.png" /></p><h3id="å…±èµ¢åˆ†æstakeholder-issueæ¨¡å‹">å…±èµ¢åˆ†æâ€”Stakeholder-Issueæ¨¡å‹</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/15.png" /></p><ol type="1"><li>åˆ—å‡ºæ‰€æœ‰æ¶‰ä¼—ç±»åˆ«</li><li>å‘ç°æ¶‰ä¼—ä»¬èƒŒåæ¶‰åŠçš„å…±åŒé—®é¢˜ï¼ˆissueï¼‰</li><li>å»ºç«‹æ¶‰ä¼—ç±»åˆ«å’Œé—®é¢˜çš„å…³è”</li><li>è¡¨æ˜stakeholder-issueå…³ç³»æ‰€å¯„äºˆçš„æœŸæœ›</li></ol><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210171728451.png" /></p><h2 id="éœ€æ±‚è·å–æ‰‹æ®µ">éœ€æ±‚è·å–æ‰‹æ®µ</h2><h3 id="é¢è°ˆ">é¢è°ˆ</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211102941016.png" /></p><h4 id="é—®é¢˜ç±»å‹">é—®é¢˜ç±»å‹</h4><ul><li>å¼€æ”¾å¼é—®é¢˜<ul><li>â€œè¯·è§£é‡Šä½ æ˜¯å¦‚ä½•åšè¿›åº¦å†³ç­–çš„â€</li><li>ä¼˜ç‚¹ï¼šç»†èŠ‚ä¸°å¯Œï¼›è¢«ä¼šè§è€…è‡ªåœ¨</li><li>ç¼ºç‚¹ï¼šä¿¡æ¯ç‡ä½ï¼›</li><li>éœ€æ±‚è·å–çš„åˆæœŸï¼ŒæŒæ¡çš„ä¿¡æ¯ä¼˜å…ˆï¼Œå¸Œæœ›æä¾›ä¸°å¯Œçš„ä¿¡æ¯</li></ul></li><li>å°é—­å¼é—®é¢˜<ul><li>å›ç­”çš„å½¢å¼å—é™åˆ¶</li><li>ä¼˜ç‚¹ï¼šèŠ‚çœæ—¶é—´ï¼›åˆ‡ä¸­è¦ç‚¹</li><li>ç¼ºç‚¹ï¼šç»†èŠ‚ä¸å¤Ÿï¼›è¢«åŒçƒ¦</li><li>éœ€æ±‚è·å–çš„åæœŸï¼Œå·²ç»å¯¹äº‹å®å’Œé—®é¢˜çš„èŒƒå›´æ¯”è¾ƒæ˜ç¡®</li></ul></li><li>è¯±å¯¼æ€§é—®é¢˜</li><li>æ¢ç©¶å¼é—®é¢˜</li><li>åŒç­’å¼é—®é¢˜</li><li>å…ƒé—®é¢˜</li></ul><h4 id="é¢è°ˆçš„é—®é¢˜å‡†å¤‡ç¤ºä¾‹">é¢è°ˆçš„é—®é¢˜å‡†å¤‡ç¤ºä¾‹</h4><ul><li>å‰æœŸ</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211103950830.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211104035259.png" /></p><ul><li>åæœŸ</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211104114828.png" /></p><h3 id="åŸå‹">åŸå‹</h3><blockquote><p>è·å–ä¸ç¡®å®šéœ€æ±‚ï¼šå¯èƒ½æ³•åƒ§çš„éœ€æ±‚å˜æ›´ï¼›å­˜åœ¨å†²çªçš„åœ°æ–¹ï¼›ä¿¡æ¯ä¸å……åˆ†...</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211110400104.png" /></p><ul><li>ç¡®å®šåŸå‹éœ€æ±‚ï¼šä¸ºä»€ä¹ˆè¦å¼€å‘åŸå‹ï¼Œæ‹¥æœ‰çš„èµ·å§‹ç‚¹æ˜¯ä»€ä¹ˆï¼ŒæœŸæœ›çš„ç»“æŸæ ‡å‡†æ˜¯ä»€ä¹ˆ</li><li>åŸå‹å¼€å‘ï¼šä¾æ®åŸå‹çš„éœ€æ±‚ç‰¹ç‚¹å’Œå¼€å‘ç›®çš„ï¼Œä»¥æœ€ä½çš„æˆæœ¬å»ºç«‹åˆå§‹åŸå‹</li><li>åŸå‹è¯„ä¼°ï¼šå¯¹ä¸Šä¸€é˜¶æ®µäº§ç”Ÿçš„åŸå‹è¿›è¡Œè¯„ä¼°ï¼Œæ ¹æ®è¯„ä¼°è€…ï¼ˆç”¨æˆ·å’Œå¼€å‘è€…ï¼‰çš„åé¦ˆåˆ¤æ–­åŸå‹æ˜¯å¦æ»¡è¶³ç»“æŸæ ‡å‡†</li><li>åŸå‹ä¿®æ­£ï¼šå¦‚æœå·²ç»è¾¾åˆ°äº†ç›®çš„å°±ç»“æŸï¼›å¦åˆ™æ ¹æ®è¯„ä¼°è€…åé¦ˆè¿›è¡ŒåŸå‹è°ƒæ•´</li></ul><h3 id="è§‚å¯Ÿ">è§‚å¯Ÿ</h3><blockquote><p>äº‹ä»¶çš„æƒ…å¢ƒæ€§ï¼šæŸäº›äº‹ä»¶åªæœ‰å’Œå…·ä½“çš„æƒ…å¢ƒè”ç³»èµ·æ¥æ‰èƒ½å¾—åˆ°å¾ˆå¥½çš„ç†è§£</p></blockquote><h4 id="é‡‡æ ·è§‚å¯Ÿ">é‡‡æ ·è§‚å¯Ÿ</h4><ul><li>æ—¶é—´é‡‡æ ·ï¼šæŒ‡å®šæ—¶é—´é—´éš”æ¥è§‚å¯Ÿç”¨æˆ·çš„æ´»åŠ¨æƒ…å†µ<ul><li>åœ¨7ä¸ª8å°æ—¶å·¥ä½œæ—¥å†…éšæœºæŒ‡å®š5ä¸ª10åˆ†é’Ÿé—´éš”æ¥è§‚å¯Ÿç”¨æˆ·</li><li>ä¼˜ç‚¹ï¼šå‡å°‘å¶ç„¶åå·®ï¼›èŠ‚çœæ—¶é—´æˆæœ¬</li><li>ç¼ºç‚¹ï¼šä¸èƒ½æä¾›å…¨é¢çš„ä¿¡æ¯ï¼›å¿½è§†é‡è¦ä½†æ˜¯é¢‘ç‡ä½çš„äº‹åŠ¡</li></ul></li><li>äº‹ä»¶é‡‡æ ·ï¼šæœ‰ç›®çš„åœ°é€‰å–æ•´ä¸ªäº‹ä»¶è¿›è¡Œè§‚å¯Ÿ<ul><li>ä¸ä¼šé—æ¼é‡è¦äº‹ä»¶</li><li>äº‹ä»¶æˆæœ¬é«˜ï¼›æ¼æ‰é¢‘å‘å‘ç”Ÿäº‹ä»¶çš„ä»£è¡¨æ€§æ ·æœ¬</li></ul></li></ul><h4 id="æ°‘æ—å¿—">æ°‘æ—å¿—</h4><blockquote><p>æ°‘æ—å¿—å¯ä»¥å¾ˆå¥½åœ°å¤„ç†å¤æ‚çš„ååŒå·¥ä½œï¼Œä¾‹å¦‚èˆªç©ºè°ƒåº¦ã€è¯åˆ¸äº¤æ˜“ç­‰</p></blockquote><p>ä¼˜ç‚¹ï¼šèƒ½å¤Ÿæ·±åº¦ç†è§£ä¿¡æ¯ï¼›è®©çœŸå®äº‹ä»¶çš„ç¤¾ä¼šæ€§å› ç´ å¯è§åŒ–</p><p>ç¼ºç‚¹ï¼šæ—¶é—´æˆæœ¬é«˜ï¼›äº§ç”Ÿçš„æ•°æ®è¿‡äºå¹¿æ³›ï¼Œæ•°æ®æŠ½å–å­˜åœ¨ä¸€å®šéš¾åº¦</p><p>å®æ–½ï¼š</p><ul><li>é’ˆå¯¹å¤æ‚ååŒé—®é¢˜çš„æ°‘æ—å¿—ï¼ˆå…³æ³¨ä»¥ä¸‹3æ–¹é¢ï¼‰<ul><li>åˆ†å¸ƒå¼ååŒï¼šç”¨æˆ·çš„æ´»åŠ¨æ˜¯ä¸€ä¸ªæœ‰ç»„ç»‡çš„æ•´ä½“æ´»åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å•çº¯çš„ä¸ªä½“æ´»åŠ¨</li><li>è®¡åˆ’å’Œç¨‹åºï¼šäº§ç”Ÿçš„èµ„æ–™ã€è®°å½•ä»»åŠ¡å®Œæˆå¾—ç»†èŠ‚æ­¥éª¤å’Œè¿‡ç¨‹</li><li>å·¥ä½œçš„æ„è¯†ï¼šæ´»åŠ¨å¯¹ååŒä¸­çš„å…¶ä»–äººå¯è§æˆ–è€…å¯ç†è§£</li></ul></li><li>æ™®é€šæ°‘æ—å¿—çš„è§„åˆ™<ul><li>å®šæœŸè®°å½•å‘ç°</li><li>å°½å¿«è®°å½•å¯èƒ½å‘ç”Ÿçš„é¢è°ˆ</li><li>å®šæœŸå¤æŸ¥å’Œæ›´æ–°è‡ªå·±çš„æƒ³æ³•</li><li>åŠæ—¶å¯¹ä¿¡æ¯è¿›è¡Œæ€»ç»“ç´¢å¼•åˆ†ç±»</li></ul></li></ul><h2 id="éœ€æ±‚åˆ†æ">éœ€æ±‚åˆ†æ</h2><p><strong>éœ€æ±‚åˆ†æçš„æ ¹æœ¬ä»»åŠ¡</strong>ï¼š</p><ul><li>å»ºç«‹åˆ†ææ¨¡å‹ï¼Œè¾¾æˆå¼€å‘è€…å’Œç”¨æˆ·å¯¹éœ€æ±‚ä¿¡æ¯çš„å…±åŒç†è§£<ul><li>æ¨¡å‹æ˜¯å¯¹äº‹åŠ¡çš„æŠ½è±¡ï¼šæŠ½è±¡ã€åˆ†è§£ã€æŠ•å½±</li><li>ä¸¤ç§ä¸–ç•Œä¸ä¸‰ç§æ¨¡å‹<ul><li>è®¡ç®—ä¸–ç•Œä¸è®¡ç®—æ¨¡å‹</li><li>é—®é¢˜ä¸–ç•Œä¸ä¸šåŠ¡æ¨¡å‹</li><li>è½¯ä»¶åˆ†ææ¨¡å‹ï¼ˆåˆ†æè§†å›¾ï¼‰</li><li>ä¸šåŠ¡æ¨¡å‹=ã€‹è½¯ä»¶åˆ†ææ¨¡å‹=ã€‹è®¡ç®—æ¨¡å‹</li></ul></li></ul></li><li>ä¾æ®å…±åŒçš„ç†è§£ï¼Œå‘æŒ¥åˆ›é€ æ€§ï¼Œåˆ›å»ºè½¯ä»¶ç³»ç»Ÿè§£å†³æ–¹æ¡ˆ</li></ul><h3 id="å¯¹è±¡æ¨¡å‹">å¯¹è±¡æ¨¡å‹</h3><h4 id="å¯¹è±¡">å¯¹è±¡</h4><ul><li><strong>ç‹¬ç«‹å¯ç¡®è®¤</strong>ï¼š<u>ç›¸å¯¹äºé—®é¢˜åŸŸ</u>æ˜¯å¯ç•Œå®šçš„ï¼Œå…·æœ‰==æ ‡è¯†ç¬¦==æ¥å”¯ä¸€åœ°æ ‡è¯†è‡ªå·±</li><li><strong>æœ‰æ˜ç¡®çš„è§’è‰²</strong>ï¼šè¦æ±‚å¯¹è±¡å…·æœ‰ä¸€å®š<u>çŠ¶æ€å’Œè¡Œä¸º</u><ul><li>==çŠ¶æ€==ï¼šå¯¹è±¡çš„ç‰¹å¾æè¿°</li><li>==è¡Œä¸º==ï¼šå¯¹è±¡åœ¨å…¶çŠ¶æ€å‘ç”Ÿæ”¹å˜æˆ–è€…æ¥æ”¶åˆ°å¤–ç•Œæ¶ˆæ¯æ—¶æ‰€é‡‡å–çš„è¡ŒåŠ¨</li></ul></li><li>å¯¹è±¡é—´çš„å…³ç³»ï¼šå¯¹è±¡é—´äº’ç›¸åä½œçš„å…³ç³»ç§°ä¸º<u>é“¾æ¥</u>ï¼Œå»ºç«‹aæŒ‡å‘bçš„é“¾æ¥çš„é€”å¾„æœ‰ï¼š<ul><li>bæ˜¯å…¨å±€å¯¹è±¡</li><li>bæ˜¯açš„ä¸€éƒ¨åˆ†</li><li>bæ˜¯è¢«aåˆ›å»ºçš„</li><li>bçš„å¼•ç”¨è¢«ä½œä¸ºæ¶ˆæ¯çš„ä¸€éƒ¨åˆ†ä¼ é€’ç»™äº†a</li></ul></li></ul><h4 id="ç±»">ç±»</h4><ul><li><p>ç±»çš„æ¦‚å¿µï¼šå…±äº«ç›¸åŒå±æ€§å’Œè¡Œä¸ºçš„å¯¹è±¡çš„é›†åˆ</p></li><li><p>ç±»çš„äº§ç”Ÿâ€”â€”åˆ†ç±»ï¼š</p><ul><li>æ•°æ®é©±åŠ¨ï¼šä»¥å¯¹è±¡çš„å±æ€§ä¸ºæ ‡å‡†</li><li>èŒè´£é©±åŠ¨ï¼šç»“åˆå¯¹è±¡çš„çŠ¶æ€å’Œè¡Œä¸º è€ƒè™‘æ¦‚å¿µä¹‹é—´çš„ç›¸ä¼¼æ€§</li></ul></li><li><p>ç±»çš„äº§ç”Ÿâ€”â€”æŠ½è±¡ï¼š</p><ul><li>æ°´å¹³å±‚æ¬¡å¿½ç•¥ï¼šå¿½ç•¥ä¸é‡è¦çš„å±æ€§</li><li>å‚ç›´å±‚æ¬¡å¿½ç•¥ï¼šå°†å€¼å¿½ç•¥ï¼ŒæŠ½è±¡ä¸ºå±æ€§</li></ul></li><li><p>ç±»çš„å°è£…ï¼š</p><ul><li>ä¿¡æ¯éšè—</li><li>åªå…¬å¼€å¯¹è±¡ä¸ºå±¥è¡ŒèŒè´£æ‰€å¿…éœ€çš„åè®®</li></ul></li><li><p><strong>ç±»ä¹‹é—´çš„å…³ç³»</strong></p><ul><li><p><strong>å…³è”</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212140305004.png" /></p></li><li><p><strong>èšåˆå’Œç»„åˆ</strong></p><ul><li>èšåˆï¼šè¡¨ç¤ºæ•´ä½“ä¸éƒ¨åˆ†ä¹‹é—´çš„å…³ç³»</li><li>ç»„åˆï¼šé™¤äº†åŒ…å«å…³ç³»ï¼Œè¿˜å¯¹éƒ¨åˆ†æœ‰å®Œå…¨çš„ç®¡ç†èŒè´£ï¼ˆä¸€æ—¦éƒ¨åˆ†å±äºæŸä¸ªæ•´ä½“ï¼Œæ”¹éƒ¨åˆ†ä¸èƒ½å±äºå…¶ä»–æ•´ä½“ï¼Œä¹Ÿä¸èƒ½å•ç‹¬å­˜åœ¨ï¼‰</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212140340175.png" /></p></li><li><p><strong>ç»§æ‰¿</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212140447249.png" /></p></li><li><p>å¤šæ€</p></li></ul></li></ul><h4 id="é¢†åŸŸæ¨¡å‹">é¢†åŸŸæ¨¡å‹</h4><p>é¢†åŸŸæ¨¡å‹ä¸­çš„ç±»å¤§å¤šæ˜¯<strong>æ¦‚å¿µç±»</strong>ï¼š</p><ul><li>æ¦‚å¿µç±»é—´å­˜åœ¨æŒ‡æ˜è¯­ä¹‰è”ç³»çš„å…³è”ï¼Œè¿™äº›å…³è”é€šå¸¸ä¸æ ‡è®°æ–¹å‘ï¼Œä¹Ÿä¸æ¯”è¾ƒå…³è”ç«¯çš„å¯è§æ€§</li><li>æ¦‚å¿µç±»ä¼šæ˜¾å¼æè¿°è‡ªå·±çš„ä¸€äº›é‡è¦å±æ€§ï¼Œä½†æ˜¯ä¸æ˜¯å…¨éƒ¨çš„è¯¦ç»†å±æ€§ï¼Œå±æ€§æ²¡æœ‰ç±»å‹çš„çº¦æŸ</li><li>æ¦‚å¿µç±»ä¸æ˜¾ç¤ºåœ°æ ‡è®°ç±»çš„è¡Œä¸ºï¼Œå³ä¸åŒ…å«æ˜ç¡®çš„æ–¹æ³•</li></ul><h4 id="å»ºç«‹é¢†åŸŸæ¨¡å‹æ¦‚å¿µç±»å›¾">å»ºç«‹é¢†åŸŸæ¨¡å‹ï¼ˆæ¦‚å¿µç±»å›¾ï¼‰</h4><blockquote><p>å­¦ä¹ æ•™æä¸­çš„å‡ ä¸ªä¾‹å­ï¼ˆP349ï¼‰</p></blockquote><ol type="1"><li><strong>è¯†åˆ«å€™é€‰å¯¹è±¡ä¸ç±»</strong><ul><li>æ¦‚å¿µç±»åˆ†ç±»åˆ—è¡¨</li><li>åè¯åˆ†æ</li><li>è¡Œä¸ºåˆ†æï¼šè¯†åˆ«ç³»ç»Ÿè¡Œä¸ºä¸­çš„è¢«åŠ¨å¯¹è±¡å’Œä¸»åŠ¨å¯¹è±¡</li></ul></li><li><strong>ç¡®å®šæ¦‚å¿µç±»</strong><ul><li>ç¡®å®šä¸ºæ¦‚å¿µç±»çš„å¯¹è±¡éœ€è¦æ—¢ç»´æŒä¸€å®šçš„çŠ¶æ€ã€åˆä¾æ®çŠ¶æ€è¡¨ç°ä¸€å®šçš„è¡Œä¸º</li><li>å±æ€§çš„å¤æ‚åº¦ï¼Œä¾‹å¦‚â€œå›¾ä¹¦â€å’Œâ€œä½œè€…â€</li><li>æ­¦æ–­åœ°å°†å•å€¼çŠ¶æ€ç±»æŠ½è±¡ä¸ºå…¶ä»–ç±»çš„å±æ€§ï¼Œä¾‹å¦‚â€œå•†å“â€å’Œâ€œä»·æ ¼â€</li></ul></li><li><strong>å»ºç«‹ç±»ä¹‹é—´çš„å…³ç³»</strong></li><li><strong>æ·»åŠ ç±»çš„é‡è¦å±æ€§</strong></li></ol><h3 id="è¡Œä¸ºæ¨¡å‹">è¡Œä¸ºæ¨¡å‹</h3><h4 id="é¡ºåºå›¾">é¡ºåºå›¾</h4><ul><li>é¡ºåºå›¾ç¤ºä¾‹</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212154449638.png" /></p><ul><li><p>ç³»ç»Ÿé¡ºåºå›¾ï¼šå°†æ•´ä¸ªç³»ç»Ÿçœ‹ä½œä¸€ä¸ªé»‘ç®±çš„å¯¹è±¡ï¼Œå¼ºè°ƒå¤–éƒ¨å‚ä¸è€…å’Œç³»ç»Ÿçš„äº¤äº’è¡Œä¸ºï¼Œé‡ç‚¹å±•ç¤ºç³»ç»Ÿçº§äº‹ä»¶ï¼ˆ<u>å’Œè®¾è®¡çš„åŒºåˆ«ï¼šè®¾è®¡ä¼šå°†ç³»ç»Ÿæ‹†æˆä¸€ä¸ªä¸ªæ¨¡å—</u>ï¼‰</p></li><li><p>é¡ºåºå›¾çš„ç»„åˆç‰‡æ®µ</p><ul><li><code>seq</code>ï¼šåŒä¸€æ ¹ç”Ÿå‘½çº¿ä¸Šçš„æ“ä½œéœ€è¦æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¸åŒç”Ÿå‘½çº¿çš„æ“ä½œæ˜¯å¹¶å‘çš„</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212155122180.png" /></p></li><li><p>ç³»ç»Ÿé¡ºåºå›¾ç¤ºä¾‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230212155445497.png" /></p></li></ul><h4 id="çŠ¶æ€å›¾">çŠ¶æ€å›¾</h4><p><strong>å»ºç«‹çŠ¶æ€å›¾</strong></p><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book14/59.png" /><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book14/60.png" />UMLçŠ¶æ€å›¾ç¤ºä¾‹ <imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book14/61.png" /></p><ul><li>ç¡®å®šä¸Šä¸‹æ–‡ç¯å¢ƒ</li><li>è¯†åˆ«çŠ¶æ€</li><li>å»ºç«‹çŠ¶æ€è½¬æ¢</li><li>è¡¥å……è¯¦ç»†ä¿¡æ¯</li></ul><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book14/35.png" /></p><h2 id="éœ€æ±‚ç®¡ç†ä¸éªŒè¯">éœ€æ±‚ç®¡ç†ä¸éªŒè¯</h2><h3 id="éœ€æ±‚ç®¡ç†çš„ä¸‰ä¸ªæ´»åŠ¨">éœ€æ±‚ç®¡ç†çš„ä¸‰ä¸ªæ´»åŠ¨</h3><ol type="1"><li><p><strong>ç»´æŠ¤éœ€æ±‚åŸºçº¿</strong></p><ul><li>éœ€æ±‚åŸºçº¿ï¼šå·²ç»é€šè¿‡æ­£å¼è¯„å®¡å’Œæ‰¹å‡†çš„è§„æ ¼è¯´æ˜æˆ–äº§å“ï¼Œå¯ä»¥ä½œä¸ºè¿›ä¸€æ­¥å¼€å‘çš„åŸºç¡€ï¼Œå¹¶ä¸”åªæœ‰é€šè¿‡æ­£å¼çš„å˜æ›´æ§åˆ¶è¿‡ç¨‹æ‰èƒ½ä¿®æ”¹å®ƒ</li><li>éœ€æ±‚åŸºçº¿çš„ç»´æŠ¤ï¼š<ul><li>é…ç½®ç®¡ç†ï¼š1ã€æ ‡è¯†é…ç½®é¡¹ï¼›2ã€ç‰ˆæœ¬æ§åˆ¶ï¼›3ã€å˜æ›´æ§åˆ¶ï¼›4ã€è®¿é—®å®¡è®¡ï¼›5ã€çŠ¶æ€æŠ¥å‘Š</li><li>çŠ¶æ€ç»´æŠ¤ï¼šåæ˜ é¡¹ç›®çš„å®é™…è¿›å±•çŠ¶å†µ<ul><li>å·²æè®®ï¼›å·²æ‰¹å‡†ï¼›å·²å®ç°ï¼›å·²éªŒè¯ï¼›å·²åˆ é™¤ï¼›å·²å¦å†³</li></ul></li></ul></li></ul></li><li><p><strong>å®ç°éœ€æ±‚è·Ÿè¸ª</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230213093320780.png" /></p><ul><li>åœ¨æ¶‰ä¼—éœ€æ±‚å˜åŒ–ä¸­åè°ƒç³»ç»Ÿçš„æ¼”åŒ–ï¼Œä¿æŒå„é¡¹å¼€å‘å·¥ä½œå¯¹éœ€æ±‚çš„ä¸€è‡´æ€§</li><li>å‰å‘è·Ÿè¸ªï¼šæ¶‰ä¼—éœ€è¦=ã€‹è½¯ä»¶éœ€æ±‚ï¼›è½¯ä»¶éœ€æ±‚=ã€‹æ¶‰ä¼—éœ€è¦</li><li>åå‘è·Ÿè¸ªï¼šè½¯ä»¶éœ€æ±‚=ã€‹åç»­å¼€å‘ç‰©ä»¶ï¼›åç»­å¼€å‘ç‰©ä»¶=ã€‹è½¯ä»¶éœ€æ±‚</li><li>éœ€æ±‚è·Ÿè¸ªçš„å®ç°æ–¹æ³•ï¼šçŸ©é˜µã€å®ä½“å…³ç³»æ¨¡å‹å’Œäº¤å‰å¼•ç”¨3ç§</li></ul></li><li><p><strong>å˜æ›´æ§åˆ¶</strong></p><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book17/8.png" /></p><ul><li>éœ€æ±‚çš„å˜åŒ–æ˜¯æ­£å½“çš„å’Œä¸å¯é¿å…çš„</li><li>ä»¥å¯æ§ã€ä¸€è‡´çš„æ–¹å¼è¿›è¡Œéœ€æ±‚åŸºçº¿ä¸­éœ€æ±‚å˜æ›´å¤„ç†ï¼ŒåŒ…æ‹¬å¯¹å˜åŒ–çš„è¯„ä¼°ã€åè°ƒã€æ‰¹å‡†æˆ–æ‹’ç»ã€å®ç°å’ŒéªŒè¯</li><li>5ä¸ªæ³¨æ„äº‹é¡¹ï¼ˆ5å¤§åŸåˆ™ï¼Ÿï¼‰<ul><li>è®¤è¯†åˆ°å˜æ›´çš„å¿…è¦æ€§ï¼Œå¹¶ä¸ºä¹‹åˆ¶å®šè®¡åˆ’</li><li>ç»´æŠ¤éœ€æ±‚åŸºçº¿ï¼Œå®¡è®¡å˜æ›´è®°å½•</li><li>ç®¡ç†èŒƒå›´è”“å»¶</li><li>çµæ´»åº”å¯¹å˜è¯·æ±‚</li><li>ä½¿ç”¨è¾…åŠ©å·¥å…·</li></ul></li></ul></li></ol><h3 id="éœ€æ±‚éªŒè¯">éœ€æ±‚éªŒè¯</h3><p><imgsrc="https://spricoder.oss-cn-shanghai.aliyuncs.com/2020-Demand-and-business-model-innovation/éœ€æ±‚/img/book16/1.png" /></p><ul><li>éœ€æ±‚çš„éªŒè¯ï¼šä»¥æ­£ç¡®çš„æ–¹å¼å»ºç«‹éœ€æ±‚</li><li>éœ€æ±‚çš„ç¡®è®¤ï¼šå»ºç«‹çš„éœ€æ±‚æ˜¯æ­£ç¡®çš„</li><li>éªŒè¯æ–¹æ³•ï¼šè¯„å®¡ã€åŸå‹ä¸æ¨¡æ‹Ÿã€æµ‹è¯•ç”¨ä¾‹å¼€å‘ã€ç”¨æˆ·æ‰‹å†Œç¼–åˆ¶ã€åˆ©ç”¨è·Ÿè¸ªå…³ç³»å’Œè‡ªåŠ¨åŒ–åˆ†æ</li><li><strong>è¯„å®¡</strong>ï¼šé™æ€åˆ†æï¼›ä½œè€…ä¹‹å¤–çš„äºº</li><li><strong>åŸå‹</strong>ï¼šæ¶‰åŠå¤æ‚çš„åŠ¨æ€åŠ¨ä½œï¼Œæˆæœ¬è¾ƒé«˜</li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> demand and business model innovation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤„ç†å™¨ç®¡ç†</title>
      <link href="/2023/02/15/nju-course-review-notes/os/processor-management/"/>
      <url>/2023/02/15/nju-course-review-notes/os/processor-management/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤„ç†å™¨">2.1 å¤„ç†å™¨</h2><h3 id="å¤„ç†å™¨ä¸å¯„å­˜å™¨">2.1.1 å¤„ç†å™¨ä¸å¯„å­˜å™¨</h3><ul><li><strong>ç”¨æˆ·ç¨‹åºå¯è§å¯„å­˜å™¨</strong>ï¼šå‡å°‘è®¿é—®ä¸»å­˜å‚¨å™¨</li><li><strong>æ§åˆ¶ä¸çŠ¶æ€å¯„å­˜å™¨</strong></li><li><strong>ç¨‹åºçŠ¶æ€å­—</strong></li></ul><h3 id="æŒ‡ä»¤ä¸å¤„ç†å™¨æ¨¡å¼">2.1.2 æŒ‡ä»¤ä¸å¤„ç†å™¨æ¨¡å¼</h3><ul><li><strong>æœºå™¨æŒ‡ä»¤</strong>ï¼šè®¡ç®—æœºç³»ç»Ÿæ‰§è¡Œçš„åŸºæœ¬å‘½ä»¤ï¼Œä¸­å¤®å¤„ç†å™¨æ‰§è¡Œçš„åŸºæœ¬å•ä½</li><li>æŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼šå–æŒ‡â€”â€”è§£ç â€”â€”æ‰§è¡Œ</li><li>ç‰¹æƒæŒ‡ä»¤å’Œéç‰¹æƒæŒ‡ä»¤</li><li>æ¨¡å¼åˆ‡æ¢</li></ul><h2 id="ä¸­æ–­ç®¡ç†">2.2 ä¸­æ–­ç®¡ç†</h2><h3 id="ä¸­æ–­ä¸ä¸­æ–­æº">2.2.1 ä¸­æ–­ä¸ä¸­æ–­æº</h3><ul><li><strong>==ä¸­æ–­==</strong>ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°æ€¥éœ€å¤„ç†çš„äº‹ä»¶æ—¶ï¼Œæš‚æ—¶ä¸­æ­¢CPUä¸Šç°è¡Œçš„ç¨‹åºï¼Œè½¬å»æ‰§è¡Œç›¸åº”çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¾…å¤„ç†å®Œæˆåå†è¿”å›åŸç¨‹åºè¢«ä¸­æ–­å¤„æˆ–è€…è°ƒåº¦å…¶ä»–ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹</li><li>æ“ä½œç³»ç»Ÿæ˜¯ä¸­æ–­é©±åŠ¨çš„ï¼Œä¸­æ–­æ˜¯æ¿€æ´»æ“ä½œç³»ç»Ÿçš„å”¯ä¸€æ–¹å¼</li><li>ç‹­ä¹‰çš„ä¸­æ–­ï¼šæ¥æºäºå¤„ç†å™¨ä¹‹å¤–çš„ä¸­æ–­äº‹ä»¶ï¼Œä¸å½“å‰æ‰§è¡ŒæŒ‡ä»¤æ— å…³çš„ä¸­æ–­äº‹ä»¶</li><li>å¼‚å¸¸ï¼š<u>å½“å‰è¿è¡ŒæŒ‡ä»¤</u>å¼•èµ·çš„ä¸­æ–­äº‹ä»¶=ã€‹éæ­£å¸¸</li><li>ç³»ç»Ÿå¼‚å¸¸ï¼šæ‰§è¡Œé™·å…¥æŒ‡ä»¤å‡ºå‘ç³»ç»Ÿè°ƒç”¨ï¼šè¯·æ±‚è®¾å¤‡ã€è¯·æ±‚I/Oã€åˆ›å»ºè¿›ç¨‹ç­‰</li><li><strong>ä¸­æ–­æº</strong>ï¼š<ul><li>ç¡¬ä»¶æ•…éšœ</li><li>ç¨‹åºæ€§ä¸­æ–­â€”â€”å¼‚å¸¸</li><li>è‡ªæ„¿æ€§ä¸­æ–­â€”â€”ç³»ç»Ÿè°ƒç”¨ã€é™·å…¥æŒ‡ä»¤</li><li>I/Oä¸­æ–­äº‹ä»¶â€”â€”IOå¤„ç†</li><li>å¤–éƒ¨ä¸­æ–­äº‹ä»¶â€”â€”è®¾å¤‡å¼•èµ·çš„ä¸­æ–­ï¼ˆæ—¶é’Ÿã€é”®ç›˜ï¼‰</li></ul></li></ul><h3 id="ä¸­æ–­ç³»ç»Ÿ">2.2.2 ä¸­æ–­ç³»ç»Ÿ</h3><ul><li><p><strong>ä¸­æ–­ç³»ç»Ÿ</strong>æ˜¯è®¡ç®—æœºç³»ç»Ÿå“åº”å¹¶å¤„ç†ä¸­æ–­çš„ç³»ç»Ÿ</p><ul><li>ç¡¬ä»¶å­ç³»ç»Ÿ=ã€‹ä¸­æ–­å“åº”</li><li>è½¯ä»¶å­ç³»ç»Ÿ=ã€‹ä¸­æ–­å¤„ç†</li></ul></li><li><p>ä¸­æ–­å“åº”å¤„ç† =ã€‹åœ¨æ¯ä¸ªæŒ‡ä»¤å‘¨æœŸçš„æœ€åè¿›è¡Œ</p></li><li><p>ä¸­æ–­è£…ç½®ï¼šè®¡ç®—æœºç³»ç»Ÿå‘ç°å¹¶ç›¸åº”ä¸­æ–­çš„ç¡¬ä»¶è£…ç½®</p><ul><li>å¤„ç†å™¨ä»¥å¤–çš„ä¸­æ–­ï¼šä¸­æ–­æ§åˆ¶å™¨å‘ç°å¹¶å“åº”</li><li>å¤„ç†å™¨ä»¥å†…çš„å¼‚å¸¸ï¼šæŒ‡ä»¤çš„æ§åˆ¶é€»è¾‘å’Œå®ç°çº¿è·¯å‘ç°å¹¶å“åº”</li><li>è¯·æ±‚OSæœåŠ¡çš„<u>ç³»ç»Ÿå¼‚å¸¸</u></li></ul></li><li><p>ä¸­æ–­æ§åˆ¶å™¨ï¼šæ§åˆ¶éƒ¨ä»¶ï¼Œä¸­æ–­æ§åˆ¶é€»è¾‘çº¿è·¯+ä¸­æ–­å¯„å­˜å™¨</p><ul><li>å¤–éƒ¨è®¾å¤‡å‘å‡ºIRQ=ã€‹åœ¨ä¸­æ–­å¯„å­˜å™¨ä¸­è®¾ç½®å·²å‘ç”Ÿçš„ä¸­æ–­</li><li>åœ¨æŒ‡ä»¤å¤„ç†ç»“æŸå‰ï¼Œæ£€æŸ¥ä¸­æ–­çš„äº§ç”Ÿ</li></ul></li><li><p>ä¸­æ–­å“åº”è¿‡ç¨‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215113158382.png" /></p></li></ul><h3 id="å¤šä¸­æ–­çš„å“åº”ä¸å¤„ç†">2.2.3 å¤šä¸­æ–­çš„å“åº”ä¸å¤„ç†</h3><ul><li>ä¸­æ–­å±è”½å¯ä»¥ä½¿ä¸­æ–­è£…ç½®ä¸å“åº”æŸäº›ä¸­æ–­</li><li>ä¸­æ–­ä¼˜å…ˆçº§å†³å®šäº†ä¸­æ–­è£…ç½®å“åº”ä¸­æ–­çš„æ¬¡åº</li><li>ä¸­æ–­åµŒå¥—æœ‰å±‚æ•°é™åˆ¶</li><li>ä¸­æ–­çš„åµŒå¥—å¤„ç†æ”¹å˜äº†ä¸­æ–­å¤„ç†çš„æ¬¡åºï¼ˆå…ˆå“åº”åå¤„ç†ï¼‰</li></ul><h2 id="è¿›ç¨‹ç®¡ç†">2.3 è¿›ç¨‹ç®¡ç†</h2><h3 id="è¿›ç¨‹åŠå…¶çŠ¶æ€">2.3.1 è¿›ç¨‹åŠå…¶çŠ¶æ€</h3><ul><li><p><strong>è¿›ç¨‹</strong>ï¼šä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºå…³äºæŸä¸ªæ•°æ®é›†åˆçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨</p></li><li><p>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„ä¸€ä¸ªç‹¬ç«‹å•ä½</p></li><li><p>ä¸€ä¸ªè¿›ç¨‹åŒ…æ‹¬äº”ä¸ªå®ä½“éƒ¨åˆ†ï¼šPï¼ˆç®¡ç†è¿è¡Œç¨‹åºçš„æ•°æ®ç»“æ„ï¼‰ã€Cï¼ˆå†…å­˜ä»£ç ï¼‰ã€Dï¼ˆå†…å­˜æ•°æ®ï¼‰ã€Rï¼ˆé€šç”¨å¯„å­˜å™¨ä¿¡æ¯ï¼‰ã€PSWï¼ˆç¨‹åºçŠ¶æ€å­—ä¿¡æ¯ï¼‰</p></li><li><p>ä»£ç ã€æ•°æ®ã€è¿è¡Œæ—¶é—´çš„ä¸åŒéƒ½æ„å‘³ç€ä¸åŒçš„è¿›ç¨‹</p></li><li><p><strong>çŠ¶æ€</strong></p><ul><li><strong>è¿è¡Œæ€</strong>ï¼šè¿›ç¨‹å æœ‰å¤„ç†å™¨</li><li><strong>å°±ç»ªæ€</strong>ï¼šè¿›ç¨‹å…·å¤‡è¿è¡Œæ¡ä»¶ç­‰å¾…è¢«å¤„ç†å™¨é€‰ä¸­è¿è¡Œ</li><li><strong>ç­‰å¾…æ€</strong>ï¼šç­‰å¾…èµ„æºã€è¾“å…¥è¾“å‡ºã€ä¿¡å·ç­‰è€Œä¸å…·å¤‡è¿è¡Œæ¡ä»¶</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215090607700.png" /></p></li><li><p><strong>æŒ‚èµ·æ€</strong>ï¼šæŸäº›è¿›ç¨‹è¢«å‰¥å¤ºäº†å†…å­˜åŠå…¶ä»–èµ„æºï¼Œè°ƒå…¥OSç®¡ç†çš„å¯¹æ¢åŒºï¼Œä¸å‚åŠ è¿›ç¨‹è°ƒåº¦ï¼Œç­‰å¾…é€‚å½“æ—¶å€™å†è°ƒå…¥å†…å­˜ã€æ¢å¤èµ„æºã€å‚ä¸è¿è¡Œ=ã€‹ è¿›ç¨‹æŒ‚èµ·ï¼ˆä¸å æ®ä»»ä½•èµ„æºï¼‰</p></li></ul><h3 id="è¿›ç¨‹çš„æ•°æ®æè¿°">2.3.2 è¿›ç¨‹çš„æ•°æ®æè¿°</h3><ul><li><strong>è¿›ç¨‹æ§åˆ¶å—</strong>ï¼š<code>PCB</code>ï¼ŒOSç”¨äºè®°å½•å’Œåˆ»ç”»è¿›ç¨‹çŠ¶æ€åŠç¯å¢ƒä¿¡æ¯çš„æ•°æ®ç»“æ„ï¼Œå€Ÿä»¥å…¨é¢ç®¡ç†è¿›ç¨‹çš„ç‰©ç†å®ä½“ï¼Œåˆ»ç”»è¿›ç¨‹çš„æ‰§è¡Œç°çŠ¶ï¼Œæ§åˆ¶è¿›ç¨‹çš„æ‰§è¡Œ<ul><li>æ ‡è¯†ä¿¡æ¯ï¼šå”¯ä¸€æ ‡è¯†è¿›ç¨‹</li><li>ç°åœºä¿¡æ¯ï¼šç”¨æˆ·å¯è§å¯„å­˜å™¨ã€æ§åˆ¶ä¸çŠ¶æ€å¯„å­˜å™¨ã€æ ˆæŒ‡é’ˆå†…å®¹</li><li>æ§åˆ¶ä¿¡æ¯</li></ul></li><li><strong>è¿›ç¨‹æ˜ åƒ</strong>ï¼šæŸä¸€æ—¶åˆ»è¿›ç¨‹çš„å†…å®¹åŠå…¶æ‰§è¡ŒçŠ¶æ€é›†åˆã€‚è¿›ç¨‹æ˜ åƒæ˜¯å†…å­˜çº§çš„ç‰©ç†å®ä½“ï¼Œåˆç§°ä¸ºè¿›ç¨‹çš„å†…å­˜æ˜ åƒ<ul><li>è¿›ç¨‹æ§åˆ¶å—</li><li>è¿›ç¨‹ç¨‹åºå—</li><li>è¿›ç¨‹æ•°æ®å—</li><li>æ ¸å¿ƒæ ˆï¼ˆå†…æ ¸æ¨¡å¼ï¼‰</li></ul></li><li><strong>è¿›ç¨‹ä¸Šä¸‹æ–‡</strong>ï¼šè¿›ç¨‹ç‰©ç†å®ä½“+æ”¯æŒè¿›ç¨‹è¿è¡Œçš„ç¯å¢ƒ=ã€‹è¿›ç¨‹ä¸Šä¸‹æ–‡<ul><li>ç”¨æˆ·çº§ä¸Šä¸‹æ–‡</li><li>å¯„å­˜å™¨ä¸Šä¸‹æ–‡</li><li>ç³»ç»Ÿçº§ä¸Šä¸‹æ–‡</li></ul></li></ul><h3 id="è¿›ç¨‹ç®¡ç†çš„å®ç°">2.3.3 è¿›ç¨‹ç®¡ç†çš„å®ç°</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215105222086.png" /></p><ul><li><p>å»ºç«‹å¤šä¸ªè¿›ç¨‹é˜Ÿåˆ—=ã€‹å°±ç»ªé˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—=ã€‹å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—å’Œä¼˜å…ˆé˜Ÿåˆ—</p></li><li><p>è¿›ç¨‹çš„æ§åˆ¶å’Œç®¡ç†</p></li><li><p>è¿›ç¨‹æ§åˆ¶è¿‡ç¨‹ä¸­æ¶‰åŠå¯¹OSæ ¸å¿ƒæ•°æ®ç»“æ„çš„ä¿®æ”¹éœ€è¦ä½¿ç”¨åŸè¯­</p></li><li><p>è¿›ç¨‹åˆ‡æ¢</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215111124677.png" /></p></li><li></li></ul><h3 id="å¤šçº¿ç¨‹æŠ€æœ¯">2.4 å¤šçº¿ç¨‹æŠ€æœ¯</h3><h3 id="å¤šçº¿ç¨‹ç¯å¢ƒæ¦‚è¿°">2.4.1 å¤šçº¿ç¨‹ç¯å¢ƒæ¦‚è¿°</h3><ul><li>å•çº¿ç¨‹ç»“æ„è¿›ç¨‹çš„é—®é¢˜ï¼š<ul><li>è¿›ç¨‹åˆ‡æ¢å¼€é”€å¤§</li><li>è¿›ç¨‹é€šä¿¡å¼€é”€å¤§</li><li>é™åˆ¶äº†å¹¶å‘è¿›ç¨‹çš„ç²’åº¦</li><li>é™ä½äº†å¹¶è¡Œè®¡ç®—çš„æ•ˆç‡</li></ul></li><li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œ<u>è¿›ç¨‹æ˜¯OSè¿›è¡Œä¿æŠ¤å’Œèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½</u>ï¼›<u>çº¿ç¨‹æ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½</u>ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹å…±äº«è¿›ç¨‹è·å¾—çš„ä¸»å­˜ç©ºé—´å’Œèµ„æºã€‚</li><li>å¤šçº¿ç¨‹ä¼˜ç‚¹ï¼šçº¿ç¨‹åˆ‡æ¢å¿«é€Ÿï¼›å‡å°‘ç®¡ç†å¼€é”€ï¼›é€šä¿¡æ˜“äºå®ç°ï¼›å¹¶è¡Œç¨‹åº¦æé«˜ï¼›èŠ‚çœå†…å­˜ç©ºé—´</li><li>å¤šçº¿ç¨‹åº”ç”¨ï¼šå‰åå°å·¥ä½œã€C/Såº”ç”¨æ¨¡å¼ã€åŠ å¿«æ‰§è¡Œé€Ÿåº¦ã€è®¾è®¡ç”¨æˆ·æ¥å£</li></ul><h3 id="å¤šçº¿ç¨‹çš„å®ç°æŠ€æœ¯">2.4.2 å¤šçº¿ç¨‹çš„å®ç°æŠ€æœ¯</h3><ul><li><p><strong>å†…æ ¸çº§å¤šçº¿ç¨‹ï¼ˆKLTï¼‰</strong>ï¼šçº¿ç¨‹ç®¡ç†çš„æ‰€æœ‰å·¥ä½œç”±OSå†…æ ¸æ¥åš</p><ul><li>çº¿ç¨‹åˆ‡æ¢éœ€è¦å†…æ ¸å‚ä¸=ã€‹æ¨¡å¼åˆ‡æ¢=ã€‹ç³»ç»Ÿå¼€é”€å¤§</li><li>ç‰©ç†å¹¶è¡Œæ€§é—®é¢˜</li></ul></li><li><p><strong>ç”¨æˆ·çº§å¤šçº¿ç¨‹ï¼ˆULTï¼‰</strong>ï¼šçº¿ç¨‹ç®¡ç†çš„æ‰€æœ‰å·¥ä½œéƒ½ç”±åº”ç”¨ç¨‹åºå®Œæˆï¼Œå†…æ ¸æ²¡æœ‰æ„è¯†åˆ°çº¿ç¨‹çš„å­˜åœ¨</p><ul><li>çº¿ç¨‹åˆ‡æ¢ä¸éœ€è¦å†…æ ¸å‚ä¸ï¼›ä½†æ˜¯ä¸èƒ½åˆ©ç”¨å¤šå¤„ç†å™¨çš„ä¼˜ç‚¹ï¼Œçº¿ç¨‹çš„é˜»å¡ä¼šå¼•èµ·æ•´ä¸ªè¿›ç¨‹çš„é˜»å¡</li><li>é€»è¾‘å¹¶è¡Œæ€§é—®é¢˜</li></ul></li><li><p><strong>JacketingæŠ€æœ¯</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215101225878.png" /></p><ul><li>è§£å†³ULTä¸­ä¸€ä¸ªçº¿ç¨‹çš„é˜»å¡å¼•èµ·æ•´ä¸ªè¿›ç¨‹é˜»å¡çš„é—®é¢˜</li><li>çº¿ç¨‹ä¸æ˜¯ç›´æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè€Œæ˜¯è°ƒç”¨jacketingç¨‹åºï¼Œç”±jacketingç¨‹åºæ¥æ£€æŸ¥çº¿ç¨‹æ‰€éœ€èµ„æºæ˜¯å¦ç©ºé—²ï¼Œå¦‚æœä¸ç©ºé—²çš„è¯å°±è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼ˆå¦‚æœä¸ä½¿ç”¨jacketingæŠ€æœ¯ï¼Œè¯¥çº¿ç¨‹å°±ä¼šé™·å…¥ç³»ç»Ÿè°ƒç”¨ç„¶åè¢«é˜»å¡ï¼‰ï¼Œå½“è¯¥çº¿ç¨‹å†æ¬¡è¢«èµ‹äºˆæ—¶é—´ç‰‡çš„æ—¶å€™ï¼Œjacketç¨‹åºä¼šå†æ¬¡æ£€æŸ¥èµ„æºæ˜¯å¦ç©ºé—²<ul><li>é˜»å¡å¼ç³»ç»Ÿè°ƒç”¨=ã€‹éé˜»å¡å¼</li></ul></li></ul></li><li><p><strong>æ··åˆå¼ç­–ç•¥</strong>ï¼šç»„åˆç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹</p><ul><li><p>ä¸€ä¸ªåº”ç”¨ä¸­çš„ULTä¼šè¢«æ˜ å°„åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªKLTä¸Š</p></li><li><p>çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’ŒåŒæ­¥å®Œå…¨æ˜¯åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆçš„</p></li><li><p>è°ƒåº¦å›¾</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215101829462.png" /></p></li></ul></li></ul><table><thead><tr class="header"><th>å†…æ ¸çº§çº¿ç¨‹</th><th>ç”¨æˆ·çº§çº¿ç¨‹</th><th>æ··åˆå¼çº¿ç¨‹</th></tr></thead><tbody><tr class="odd"><td><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215100240015.png" /></td><td><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215100254822.png" /></td><td><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215100312478.png" /></td></tr></tbody></table><h2 id="å¤„ç†å™¨è°ƒåº¦">2.5 å¤„ç†å™¨è°ƒåº¦</h2><h3 id="å¤„ç†å™¨è°ƒåº¦å±‚æ¬¡">2.5.1 å¤„ç†å™¨è°ƒåº¦å±‚æ¬¡</h3><ul><li><strong>é«˜çº§è°ƒåº¦ï¼ˆé•¿ç¨‹/ä½œä¸šè°ƒåº¦ï¼‰</strong>ï¼šå†³å®šèƒ½å¦åŠ å…¥åˆ°æ‰§è¡Œçš„è¿›ç¨‹æ± ä¸­<ul><li>æ–°å»ºæ€=ã€‹å°±ç»ªæ€/å°±ç»ªæŒ‚èµ·æ€</li><li>æ˜¯å¦æ–°å»ºï¼Ÿæ˜¯å¦åŠ å…¥è¿›ç¨‹æ± ä¸­ï¼Ÿè¿è¡Œå‰çš„å‡†å¤‡</li></ul></li><li><strong>ä¸­çº§è°ƒåº¦ï¼ˆå¹³è¡¡è´Ÿè½½è°ƒåº¦ï¼‰</strong>ï¼šå†³å®šä¸»å­˜ä¸­å¯ç”¨çš„è¿›ç¨‹é›†åˆï¼ˆæŒ‚èµ·ç›¸å…³ï¼‰<ul><li>ä¸ºäº†æé«˜å†…å­˜åˆ©ç”¨ç‡å’Œä½œä¸šååé‡</li><li>å†³å®šå“ªäº›è¿›ç¨‹ç•™åœ¨ä¸»å­˜ä¸­å‚ä¸å¤„ç†å™¨ç«äº‰ï¼Œå“ªäº›è¿›ç¨‹æ¢å‡ºä¸»å­˜</li></ul></li><li><strong>ä½çº§è°ƒåº¦ï¼ˆçŸ­ç¨‹/è¿›ç¨‹è°ƒåº¦ï¼‰</strong>ï¼šå†³å®šå“ªä¸ªå¯ç”¨è¿›ç¨‹å¯ä»¥å ç”¨å¤„ç†å™¨æ‰§è¡Œï¼ˆæ ¸å¿ƒä¸‰æ€æ¨¡å‹ä¹‹é—´çš„è°ƒåº¦ï¼‰</li></ul><h3 id="å¤„ç†å™¨è°ƒåº¦ç®—æ³•">2.5.2 å¤„ç†å™¨è°ƒåº¦ç®—æ³•</h3><ul><li><strong>ä¼˜å…ˆæ•°è°ƒåº¦ç®—æ³•</strong>ï¼šæ ¹æ®åˆ†é…ç»™è¿›ç¨‹çš„ä¼˜å…ˆæ•°<ul><li>æŠ¢å å¼/éæŠ¢å å¼</li><li>ä¼˜å…ˆæ•°ç¡®å®šå‡†åˆ™ï¼šä»»åŠ¡ç´§è¿«ç¨‹åº¦ã€äº¤äº’æ€§ã€ä½¿ç”¨å¤–è®¾é¢‘ç‡ã€è¿›å…¥ç³»ç»Ÿæ—¶é—´é•¿çŸ­</li><li>è®¡ç®—æ—¶é—´çŸ­ã€å‰©ä½™è®¡ç®—æ—¶é—´çŸ­ã€å“åº”æ¯”ï¼ˆç­‰å¾…æ—¶é—´/è¿›å…¥æ—¶é—´ï¼‰é«˜ä¼˜å…ˆã€å…ˆæ¥å…ˆæœåŠ¡</li></ul></li><li><strong>æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•</strong>ï¼šæ ¹æ®è¿›å…¥å°±ç»ªé˜Ÿåˆ—çš„æ—¶é—´å…ˆåè½®æµå æœ‰CPUä¸€ä¸ªæ—¶é—´ç‰‡</li><li><strong>åˆ†çº§è°ƒåº¦ç®—æ³•</strong>ï¼šå¤šçº§é˜Ÿåˆ—ç­–ç•¥<ul><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230215103848868.png" /></li></ul></li><li><strong>å½©ç¥¨è°ƒåº¦ç®—æ³•</strong>ï¼šéšæœºï¼Ÿæ ¹æ®ä¼˜å…ˆçº§å‘æ”¾å½©ç¥¨æ•°é‡ï¼ˆä¼˜å…ˆçº§é«˜å½©ç¥¨æ•°é‡å¤šï¼‰è°ƒåº¦=ã€‹éšæœºæŠ½å½©ç¥¨</li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ç®¡ç†</title>
      <link href="/2023/02/13/nju-course-review-notes/os/file-management/"/>
      <url>/2023/02/13/nju-course-review-notes/os/file-management/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°">5.1 æ–‡ä»¶ç³»ç»Ÿæ¦‚è¿°</h2><h3 id="æ–‡ä»¶çš„æ¦‚å¿µ">5.1.1 æ–‡ä»¶çš„æ¦‚å¿µ</h3><h4 id="æ–‡ä»¶æ¦‚å¿µ">æ–‡ä»¶æ¦‚å¿µ</h4><p><strong>æ–‡ä»¶æ˜¯å…·æœ‰ç¬¦å·åçš„ï¼Œåœ¨é€»è¾‘ä¸Šå…·æœ‰å®Œæ•´æ„ä¹‰çš„ä¸€ç»„ç›¸å…³ä¿¡æ¯é¡¹çš„åºåˆ—</strong></p><blockquote><p>æ–‡ä»¶çš„å‘½åï¼š<æ–‡ä»¶å><code>.</code><æ‰©å±•å></p><p>æ–‡ä»¶åç”¨äºè®¾åˆ«æ–‡ä»¶ï¼Œæ‰©å±•åç”¨äºè¯†åˆ«æ–‡ä»¶ç‰¹æ€§</p></blockquote><h4 id="å¼•å…¥æ–‡ä»¶çš„ä¼˜ç‚¹">å¼•å…¥æ–‡ä»¶çš„ä¼˜ç‚¹</h4><ol type="1"><li>ç”¨æˆ·ä½¿ç”¨æ–¹ä¾¿ï¼šå®ç°äº†==æŒ‰åå­˜å–==ï¼ŒçŸ¥é“æ–‡ä»¶åå°±å¯å­˜å–ä¿¡æ¯ã€‚</li><li>æ–‡ä»¶å®‰å…¨å¯é ï¼šé€šè¿‡æ–‡ä»¶ç³»ç»Ÿå®ç°å¯¹æ–‡ä»¶çš„è®¿é—®</li><li>æ–‡ä»¶å¯å¤‡ä»½ï¼šæ–‡ä»¶å¯ä»¥ç»„ç»‡è½¬å‚¨æˆ–å¤‡ä»½</li><li>æ–‡ä»¶å¯å…±äº«ï¼šæ–‡ä»¶å¯å…±äº«ï¼Œæé«˜åˆ©ç”¨ç‡</li></ol><h3 id="æ–‡ä»¶ç³»ç»ŸåŠå…¶åŠŸèƒ½">5.1.2 æ–‡ä»¶ç³»ç»ŸåŠå…¶åŠŸèƒ½</h3><h4 id="æ–‡ä»¶ç³»ç»Ÿ">æ–‡ä»¶ç³»ç»Ÿ</h4><p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­è´Ÿè´£å­˜å–å’Œç®¡ç†ä¿¡æ¯çš„æ¨¡å—ï¼Œå®ƒç”¨ç»Ÿä¸€çš„æ–¹å¼ç®¡ç†ç”¨æˆ·å’Œç³»ç»Ÿä¿¡æ¯çš„å­˜å‚¨ã€æ£€ç´¢ã€æ›´æ–°ã€å…±äº«å’Œä¿æŠ¤ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›ä¸€æ•´å¥—æ–¹ä¾¿æœ‰æ•ˆçš„æ–‡ä»¶ä½¿ç”¨å’Œæ“ä½œæ–¹æ³•</p><p>åŠŸèƒ½ï¼š</p><ul><li>æ–‡ä»¶çš„æŒ‰åå­˜å–</li><li>æ–‡ä»¶çš„å…±äº«å’Œä¿æŠ¤</li><li>æ–‡ä»¶çš„æ“ä½œå’Œä½¿ç”¨</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221124234708050.png" /></p><h2 id="æ–‡ä»¶çš„ç»„ç»‡">5.2 æ–‡ä»¶çš„ç»„ç»‡</h2><h3 id="æ–‡ä»¶çš„å­˜å‚¨">5.2.1 æ–‡ä»¶çš„å­˜å‚¨</h3><h4 id="å·å’Œå—">å·å’Œå—</h4><ul><li>æ–‡ä»¶å­˜å‚¨ä»‹è´¨ï¼šç£å¸¦ã€å…‰ç›˜å’Œç£ç›˜</li><li>==å·==ï¼šå­˜å‚¨ä»‹è´¨çš„ç‰©ç†å•ä½ï¼Œå¯¹åº”äºä¸€ç›˜ç£ç›˜ã€ä¸€å—è½¯ç›˜ã€ä¸€ä¸ªå…‰ç›˜ç‰‡ã€ä¸€ä¸ªç¡¬ç›˜åˆ†åŒº</li><li>==å—==ï¼šå­˜å‚¨ä»‹è´¨ä¸Šè¿ç»­ä¿¡æ¯æ‰€ç»„æˆçš„ä¸€ä¸ªåŒºåŸŸï¼Œä¹Ÿå«ç‰©ç†è®°å½•<ul><li><strong>æ˜¯ä¸»å­˜å‚¨å™¨å’Œè¾…åŠ©å­˜å‚¨å™¨è¿›è¡Œæ•°æ®äº¤æ¢çš„<u>ç‰©ç†å•ä½</u>ï¼Œæ¯æ¬¡äº¤æ¢ä¸€å—æˆ–æ•´æ•°å—ä¿¡æ¯</strong></li><li>å­˜å‚¨æ–‡ä»¶çš„è®¾å¤‡ä¸€èˆ¬éƒ½æ˜¯å—è®¾å¤‡</li></ul></li><li>å—çš„å¤§å°å’Œ<u>ç”¨æˆ·ä½¿ç”¨æ–¹å¼</u>ã€<u>æ•°æ®ä¼ è¾“æ•ˆç‡</u>å’Œ<u>å­˜å‚¨è®¾å¤‡ç±»å‹</u>ç›¸å…³<ul><li>å¤–å›´è®¾å¤‡ä¸­ç›¸é‚»å—ä¹‹é—´å¿…é¡»ç•™æœ‰é—´éš™ï¼š<u>å¯åœæœºæ¢°åŠ¨ä½œ</u>å’Œ<u>è¯†åˆ«ä¸åŒå—</u>çš„è¦æ±‚=ã€‹éœ€è¦æ—¶é—´<ul><li>ç£ç›˜</li></ul></li></ul></li></ul><h4 id="å­˜å–å­˜å‚¨æ–¹å¼">å­˜å–å­˜å‚¨æ–¹å¼</h4><h5 id="é¡ºåºå­˜å–å­˜å‚¨è®¾å¤‡">é¡ºåºå­˜å–å­˜å‚¨è®¾å¤‡</h5><ul><li>ç£å¸¦æœºï¼ˆåŒå¿ƒåœ†ï¼‰ã€å…‰ç›˜ï¼ˆèºæ—‹çº¿ï¼‰éƒ½æ˜¯ä¸€ç§é¡ºåºå­˜å–å­˜å‚¨è®¾å¤‡</li><li><u>ä¸¥æ ¼ä¾èµ–ä¿¡æ¯çš„ç‰©ç†ä½ç½®æ¬¡åºè¿›è¡Œå®šä½å’Œè¯»å†™</u>çš„å­˜å‚¨è®¾å¤‡</li><li>ç£å¸¦æœº<ul><li>å­˜å‚¨å®¹é‡å¤§ã€ç¨³å®šå¯é ã€å·å¯è£…å¸å’Œä¾¿äºä¿å­˜ï¼Œå¹¿æ³›ç”¨ä½œå­˜æ¡£</li><li>ç£å¸¦çš„å—é•¿çš„å˜åŒ–èŒƒå›´å¯ä»¥è¾ƒå¤§ï¼Œæ²¡æœ‰é™åˆ¶</li></ul></li></ul><h5 id="ç›´æ¥å­˜å–å­˜å‚¨è®¾å¤‡">ç›´æ¥å­˜å–å­˜å‚¨è®¾å¤‡</h5><ul><li>==ç£ç›˜==æ˜¯ä¸€ç§ç›´æ¥ï¼ˆéšæœºï¼‰å­˜å–å­˜å‚¨è®¾å¤‡</li><li><u>ç§»è‡‚+æ—‹è½¬</u>æ¥å®šä½ï¼Œå­˜å‚¨é€Ÿåº¦é«˜ï¼Œå­˜å–ä»»æ„ä¸€ä¸ªç‰©ç†å—æ‰€éœ€æ—¶é—´å‡ ä¹ä¸ä¾èµ–äºä¿¡æ¯çš„ä½ç½®</li></ul><h3 id="æ–‡ä»¶çš„é€»è¾‘ç»“æ„">5.2.2 æ–‡ä»¶çš„é€»è¾‘ç»“æ„</h3><h4 id="é€»è¾‘æ–‡ä»¶">é€»è¾‘æ–‡ä»¶</h4><p>==é€»è¾‘æ–‡ä»¶==ï¼šåˆç§°æ–‡ä»¶çš„é€»è¾‘ç»“æ„</p><ul><li>ç‹¬ç«‹äºç‰©ç†ç¯å¢ƒçš„ï¼Œç”¨æˆ·æ¦‚å¿µä¸­çš„æŠ½è±¡ä¿¡æ¯ç»„ç»‡æ–¹å¼</li><li>ç”¨æˆ·èƒ½è§‚å¯Ÿåˆ°çš„ï¼Œå¹¶åŠ ä»¥å¤„ç†çš„æ•°æ®é›†åˆ</li></ul><p>åˆ†ä¸ºä¸¤ç§å½¢å¼ï¼š1ã€æµå¼æ–‡ä»¶ï¼›2ã€è®°å½•å¼æ–‡ä»¶</p><h4 id="æµå¼æ–‡ä»¶">æµå¼æ–‡ä»¶</h4><p>æ–‡ä»¶å†…çš„æ•°æ®ä¸å†ç»„æˆè®°å½•ï¼Œåªæ˜¯ç”±ä¸€ä¸²ä¾æ¬¡çš„å­—èŠ‚ç»„æˆçš„ä¿¡æ¯æµåºåˆ—ï¼Œå¸¸å¸¸æŒ‰é•¿åº¦æ¥è¯»å–æ‰€éœ€ä¿¡æ¯ã€‚</p><h4 id="è®°å½•å¼æ–‡ä»¶">è®°å½•å¼æ–‡ä»¶</h4><ul><li>è®°å½•å¼æ–‡ä»¶ï¼šæœ‰ç»“æ„çš„æ–‡ä»¶ï¼Œè‹¥å¹²é€»è¾‘è®°å½•ä¿¡æ¯æ‰€ç»„æˆçš„è®°å½•æµæ–‡ä»¶</li><li>é€»è¾‘è®°å½•æ˜¯æ–‡ä»¶ä¸­æŒ‰ä¿¡æ¯åœ¨é€»è¾‘ä¸Šçš„ç‹¬ç«‹å«ä¹‰æ‰€åˆ’åˆ†çš„ä¿¡æ¯å•ä½</li><li>ä¾‹å¦‚ï¼šæ¯ä¸ªèŒå·¥çš„å·¥èµ„ä¿¡æ¯æ„æˆä¸€ä¸ªé€»è¾‘ä¿¡æ¯ï¼Œæ‰€æœ‰èŒå·¥çš„å·¥èµ„ä¿¡æ¯ä¾¿ç»„æˆäº†è®°å½•å¼æ–‡ä»¶ã€‚</li></ul><blockquote><p>å’Œæ•°æ®åº“ä¹‹é—´çš„åŒºåˆ«ï¼š</p><ol type="1"><li>æ•°æ®åº“ä¸­çš„è®°å½•ä¹‹é—´å¯ä»¥é€šè¿‡æ•°æ®å†—ä½™<strong>æ„æˆæŸç§è”ç³»</strong></li><li>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ”¯æŒåŸºäºè”ç³»çš„<strong>æ•°æ®æŸ¥è¯¢</strong></li><li>æ•°æ®åº“æ”¯æŒ<strong>äº‹åŠ¡ç®¡ç†</strong></li></ol></blockquote><h3 id="è®°å½•ç»„æˆä¸åˆ†è§£">5.2.3 è®°å½•ç»„æˆä¸åˆ†è§£</h3><blockquote><p>ä¸Šè¯¾æ²¡è®²</p></blockquote><h3 id="æ–‡ä»¶çš„ç‰©ç†ç»“æ„">5.2.4 æ–‡ä»¶çš„ç‰©ç†ç»“æ„</h3><ul><li>æ–‡ä»¶çš„ç‰©ç†ç»“æ„å’Œç»„ç»‡æ˜¯æŒ‡æ–‡ä»¶åœ¨ç‰©ç†å­˜å‚¨ç©ºé—´ä¸­çš„å­˜æ”¾æ–¹æ³•å’Œç»„ç»‡å…³ç³»</li><li>æ–‡ä»¶çš„å­˜å‚¨ç»“æ„æ¶‰åŠå—çš„åˆ’åˆ†ã€è®°å½•çš„æ’åˆ—ã€ç´¢å¼•çš„ç»„ç»‡ã€ä¿¡æ¯çš„æœç´¢ç­‰è®¸å¤šé—®é¢˜ï¼Œå…¶ä¼˜åŠ£ç›´æ¥å½±å“æ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½</li></ul><h4 id="é¡ºåºæ–‡ä»¶">é¡ºåºæ–‡ä»¶</h4><p>é¡ºåºï¼ˆè¿ç»­ï¼‰æ–‡ä»¶ï¼šå°†ä¸€ä¸ªæ–‡ä»¶ä¸­é€»è¾‘ä¸Šè¿ç»­çš„ä¿¡æ¯å­˜æ”¾åˆ°å­˜å‚¨ä»‹è´¨çš„ä¾æ¬¡ç›¸é‚»çš„å—ä¸­çš„æ–‡ä»¶</p><p>ä¾‹å¦‚ï¼šç£å¸¦æ–‡ä»¶ã€å…‰ç›˜æ–‡ä»¶</p><ul><li>ä¼˜ç‚¹ï¼šé¡ºåºå­˜å–è®°å½•æ—¶é€Ÿåº¦è¾ƒå¿«</li><li>ç¼ºç‚¹ï¼š<ul><li>å»ºç«‹æ–‡ä»¶å‰éœ€è¦é¢„å…ˆç¡®å®šæ–‡ä»¶é•¿åº¦ä»¥åˆ†é…å­˜å‚¨ç©ºé—´</li><li>ä¿®æ”¹ã€æ’å…¥å¢åŠ æ–‡ä»¶è®°å½•æœ‰å›°éš¾</li></ul></li></ul><h4 id="è¿æ¥æ–‡ä»¶">è¿æ¥æ–‡ä»¶</h4><ul><li>è¿æ¥ï¼ˆä¸²è”ï¼‰æ–‡ä»¶ï¼šä½¿ç”¨è¿æ¥å­—æ¥è¡¨ç¤ºæ–‡ä»¶ä¸­å„ä¸ªç‰©ç†å—ä¹‹é—´çš„å…ˆåæ¬¡åº</li><li>è¾“å…¥äº•å’Œè¾“å‡ºäº•éƒ½ä½¿ç”¨æ­¤ç±»æ–‡ä»¶</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125003450926.png"alt="è¿æ¥æ–‡ä»¶" /><figcaption aria-hidden="true">è¿æ¥æ–‡ä»¶</figcaption></figure><p>ä¼˜ç‚¹ï¼šæ˜“äºå¯¹æ–‡ä»¶è®°å½•åšå¢ã€åˆ ã€æ”¹ï¼Œæ˜“äºåŠ¨æ€å¢é•¿è®°å½•ï¼›ä¸å¿…é¢„å…ˆç¡®çŸ¥æ–‡ä»¶é•¿åº¦ï¼›å­˜å‚¨ç©ºé—´åˆ©ç”¨ç‡é«˜ã€‚</p><p>ç¼ºç‚¹ï¼šå­˜æ”¾æŒ‡é’ˆéœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼›éœ€è¦é€šè¿‡ç¼“å†²åŒºè·å¾—è¿æ¥å­—åæ‰èƒ½æ‰¾åˆ°ä¸‹ä¸€ç‰©ç†å—åœ°å€ï¼Œä»…é€‚ç”¨äºé¡ºåºå­˜å–ã€‚</p><h4 id="ç›´æ¥æ–‡ä»¶">ç›´æ¥æ–‡ä»¶</h4><p>åˆç§°æ•£åˆ—æ–‡ä»¶ï¼Œé€šè¿‡è®¡ç®—è®°å½•çš„å…³é”®å­—å»ºç«‹ä¸ç‰©ç†å­˜å‚¨åœ°å€ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼ˆæ•£åˆ—è¡¨ï¼Œå¯èƒ½å‡ºç°å†²çªï¼‰</p><h4 id="ç´¢å¼•æ–‡ä»¶">ç´¢å¼•æ–‡ä»¶</h4><p>ç´¢å¼•æ–‡ä»¶ä¸ºæ¯ä¸ªæ–‡ä»¶éƒ½å»ºç«‹äº†ä¸€å¼ ç´¢å¼•è¡¨ï¼Œå…¶ä¸­ï¼Œæ¯ä¸ªè¡¨ç›®åŒ…å«ä¸€ä¸ªè®°å½•çš„é”®ï¼ˆæˆ–é€»è¾‘è®°å½•å·ï¼‰åŠå…¶å­˜å‚¨åœ°å€ã€‚ç´¢å¼•è¡¨çš„åœ°å€å¯ç”±æ–‡ä»¶ç›®å½•æŒ‡å‡ºï¼ŒæŸ¥é˜…ç´¢å¼•è¡¨å…ˆæ‰¾åˆ°ç›¸åº”è®°å½•é”®ï¼ˆæˆ–é€»è¾‘è®°å½•å·ï¼‰ï¼Œç„¶åè·å¾—æ•°æ®å­˜å‚¨åœ°å€ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125161841819.png"alt="ç´¢å¼•æ–‡ä»¶" /><figcaption aria-hidden="true">ç´¢å¼•æ–‡ä»¶</figcaption></figure><p>è®¿é—®æ–¹å¼ï¼š1ã€æŸ¥æ‰¾ç´¢å¼•è¡¨ï¼›2ã€è·å¾—è®°å½•çš„ç‰©ç†åœ°å€</p><p>ä¼˜ç‚¹ï¼šå…‹æœäº†è¿æ¥æ–‡ä»¶åªèƒ½é¡ºåºå­˜å–çš„ç¼ºç‚¹ï¼Œå…·æœ‰ç›´æ¥è¯»å†™ä»»æ„ä¸€ä¸ªè®°å½•çš„èƒ½åŠ›ï¼Œä¾¿äºæ–‡ä»¶çš„å¢ã€åˆ ã€æ”¹ã€‚</p><p>ç¼ºç‚¹ï¼šå¢åŠ äº†ç´¢å¼•è¡¨çš„ç©ºé—´å¼€é”€å’ŒæŸ¥æ‰¾æ—¶é—´ã€‚</p><p>==å¤šçº§ç´¢å¼•==</p><p>ä¼˜ç‚¹ï¼šèŠ‚çœinodeçš„å­˜å‚¨ç©ºé—´ï¼ˆä½¿å¾—inodeå·å®¹é‡å°½å¯èƒ½å¤§ï¼‰ï¼›å¯¹å°æ–‡ä»¶æœ‰è¾ƒé«˜çš„æ€§èƒ½</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125162119490.png"alt="å¤šçº§ç´¢å¼•" /><figcaption aria-hidden="true">å¤šçº§ç´¢å¼•</figcaption></figure><blockquote><p>ç¬¬ä¸€åˆ—çš„13ä¸ªåœ°å€ä¸ºï¼š10ä¸ªç›´æ¥åœ°å€çš„ç´¢å¼•+1ä¸ªä¸€çº§é—´æ¥ç´¢å¼•+1ä¸ªäºŒçº§é—´æ¥ç´¢å¼•+1ä¸ªä¸‰çº§é—´æ¥ç´¢å¼•</p></blockquote><h2 id="æ–‡ä»¶ç›®å½•">5.3 æ–‡ä»¶ç›®å½•</h2><h3 id="æ–‡ä»¶ç›®å½•ç»“æ„">5.3.1 æ–‡ä»¶ç›®å½•ç»“æ„</h3><h4 id="æ–‡ä»¶ç›®å½•-1">æ–‡ä»¶ç›®å½•</h4><ul><li>æ–‡ä»¶ç›®å½•æ˜¯å®ç°æ–‡ä»¶æŒ‰åå­˜å–çš„å…³é”®æ•°æ®ç»“æ„</li><li>æ–‡ä»¶ç›®å½•çš„å»ºç«‹ç»´æŠ¤å’Œæ£€ç´¢æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½ä¹‹ä¸€</li><li>æ–‡ä»¶ç›®å½•éœ€è¦æ°¸ä¹…ä¿å­˜ï¼Œç»„ç»‡æˆæ–‡ä»¶æ”¾åœ¨ç£ç›˜ä¸­ï¼Œç§°ä¸ºç›®å½•æ–‡ä»¶</li></ul><h4 id="ä¸€çº§ç›®å½•ç»“æ„">ä¸€çº§ç›®å½•ç»“æ„</h4><p><u>æ„é€ ä¸€å¼ çº¿æ€§è¡¨</u>ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ç›¸å…³å±æ€§å ç”¨ä¸€ä¸ªç›®å½•é¡¹ï¼Œæ„æˆä¸€çº§ç›®å½•ç»“æ„</p><p>å®¹æ˜“é‡åï¼Œä¸åˆ©äºè®°å¿†</p><h4 id="äºŒçº§ç›®å½•ç»“æ„">äºŒçº§ç›®å½•ç»“æ„</h4><p>ç¬¬ä¸€çº§ä¸ºä¸»æ–‡ä»¶ç›®å½•ï¼Œç®¡ç†æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶ç›®å½•ï¼Œç›®å½•é¡¹ç™»è®°äº†ç³»ç»Ÿæ¥å—çš„<u>ç”¨æˆ·çš„åå­—</u>åŠ<u>è¯¥ç”¨æˆ·æ–‡ä»¶ç›®å½•çš„åœ°å€</u>ã€‚</p><p>ç¬¬äºŒçº§ä¸ºç”¨æˆ·çš„æ–‡ä»¶ç›®å½•ï¼Œç›®å½•é¡¹ç™»è®°ä¸€ä¸ªæ–‡ä»¶çš„ç›¸å…³å±æ€§ï¼Œæ¯ä¸ªç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ–‡ä»¶ç›®å½•ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221124154232094.png"alt="äºŒçº§ç›®å½•ç»“æ„" /><figcaption aria-hidden="true">äºŒçº§ç›®å½•ç»“æ„</figcaption></figure><p>ä¼˜ç‚¹ï¼šé€šè¿‡ä¸»æ–‡ä»¶ç›®å½•ä½¿å¾—ç”¨æˆ·æ–‡ä»¶ç§å¯†æ€§å¾—åˆ°ä¿è¯ï¼Œå®ç°äº†å¯¹æ–‡ä»¶çš„ä¿å¯†å’Œä¿æŠ¤ï¼›ä¸åŒç”¨æˆ·å¯ä»¥å…·æœ‰åŒåæ–‡ä»¶ï¼Œä¸ä¼šæ··ä¹±ã€‚</p><p>ç¼ºç‚¹ï¼šåŒä¸€ä¸ªç”¨æˆ·è¿˜æ˜¯å­˜åœ¨æ–‡ä»¶å¤šã€æ˜“é‡åé—®é¢˜ã€‚</p><h4 id="æ ‘å½¢ç›®å½•ç»“æ„">æ ‘å½¢ç›®å½•ç»“æ„</h4><ul><li>å±‚æ¬¡æ–‡ä»¶ç›®å½•ç»“æ„é€šå¸¸ä½¿ç”¨ æ ‘å½¢ç›®å½•ç»“æ„</li><li>å¯ä»¥è¾ƒå¥½åœ°åæ˜ ç°å®ä¸–ç•Œä¸­å…·æœ‰<u>å±‚æ¬¡å…³ç³»çš„æ•°æ®é›†åˆ</u>å’Œ<u>è¾ƒç¡®åˆ‡åœ°åæ˜ ç³»ç»Ÿå†…éƒ¨æ–‡ä»¶çš„ç»„ç»‡ç»“æ„</u></li><li>æ˜“äºè§„å®šä¸åŒå±‚æ¬¡æˆ–å­æ ‘ä¸­æ–‡ä»¶çš„ä¸åŒå­˜å–è§„æ ¼ï¼Œä¾¿äºæ–‡ä»¶çš„ä¿æŠ¤ã€ä¿å¯†å’Œå…±äº«ã€‚</li><li>åªè¦ä¸ä½äºåŒä¸€æœ«ç«¯çš„å­ç›®å½•ä¸­ï¼Œä¸åŒæ–‡ä»¶å¯ä»¥é‡å</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125163457307.png"alt="æ ‘å½¢ç›®å½•ç»“æ„" /><figcaption aria-hidden="true">æ ‘å½¢ç›®å½•ç»“æ„</figcaption></figure><h2 id="æ–‡ä»¶çš„å…±äº«ä¿æŠ¤ä¸ä¿å¯†">5.4 æ–‡ä»¶çš„å…±äº«ã€ä¿æŠ¤ä¸ä¿å¯†</h2><h3 id="æ–‡ä»¶çš„å®‰å…¨ä¸ä¿æŠ¤">5.4.1 æ–‡ä»¶çš„å®‰å…¨ä¸ä¿æŠ¤</h3><ul><li>æ–‡ä»¶å…±äº«ï¼šä¸åŒç”¨æˆ·å…±åŒä½¿ç”¨æŸäº›æ–‡ä»¶</li><li>æ–‡ä»¶ä¿æŠ¤ï¼šé˜²æ­¢æ–‡ä»¶è¢«ç ´å</li><li>æ–‡ä»¶ä¿å¯†ï¼šé˜²æ­¢æ–‡ä»¶åŠå…¶å†…å®¹è¢«å…¶ä»–ç”¨æˆ·çªƒå–<ul><li>éšè”½æ–‡ä»¶ç›®å½•</li><li>è®¾ç½®å£ä»¤</li><li>ä½¿ç”¨å¯†ç </li></ul></li></ul><h3 id="æ–‡ä»¶çš„ä¿æŠ¤">5.4.2 æ–‡ä»¶çš„ä¿æŠ¤</h3><ul><li>æ–‡ä»¶å‰¯æœ¬ï¼šé˜²æ­¢è½¯ç¡¬ä»¶æ•…éšœã€ä¿å­˜ä¿¡æ¯å®Œæ•´æ€§çš„èƒ½åŠ›<ul><li>åŠ¨æ€å¤šå‰¯æœ¬æŠ€æœ¯ï¼šåœ¨å¤šä¸ªä»‹è´¨ä¸Šç»´æŠ¤åŒä¸€å†…å®¹çš„æ–‡ä»¶ï¼Œå¹¶ä¿æŒåŒæ­¥æ›´æ–°</li><li>è½¬å‚¨ã€å¤‡ä»½ä¸æ¢å¤ï¼šå®šæ—¶æŠŠæ–‡ä»¶å¤åˆ¶è½¬å‚¨åˆ°å…¶ä»–ä»‹è´¨ä¸Šï¼Œå½“æŸä»‹è´¨å‡ºç°æ•…éšœæ—¶ï¼Œå¤åŸè½¬å‚¨æ–‡ä»¶<ul><li>ä¸€å®šæ—¶é—´é—´éš”æˆ–ä¸€ä¸ªå•ä½å¤„ç†ç»“æŸåï¼Œç³»ç»Ÿè‡ªåŠ¨å¤å†™æ›´æ–°è¿‡çš„æ–‡ä»¶å’Œæ•°æ®</li><li>äºŒæ˜¯æ¯å¤©æˆ–æ¯å‘¨æŠŠæ–‡ä»¶ä¿¡æ¯å…¨éƒ¨å¤å†™ä¸€é</li></ul></li></ul></li><li>æ–‡ä»¶å­˜å–çŸ©é˜µä¸æ–‡ä»¶å­˜å–è¡¨ï¼šç³»ç»Ÿä¸ºæ¯ä¸ªç”¨æˆ·è®¾ç½®è®¿é—®æ¯ä¸ªæ–‡ä»¶å¯¹è±¡çš„å­˜å–å±æ€§ç»„æˆçš„äºŒç»´çŸ©é˜µ<ul><li>æ–‡ä»¶å­˜å–çŸ©é˜µæ˜¯ç¨€ç–çŸ©é˜µ =ã€‹å­˜å–æ§åˆ¶è¡¨</li><li>ç”¨æˆ·ã€æ–‡ä»¶ã€å­˜å–å±æ€§</li><li>å­˜å–æ§åˆ¶è¡¨ä»…ç™»è®°å¯¹æ–‡ä»¶æ‹¥æœ‰å­˜å–å±æ€§çš„éƒ¨åˆ†</li><li>å­˜å–å±æ€§ï¼šè®¿é—®ã€è¯»ã€å†™ã€æ‰§è¡Œã€åˆ›å»ºã€åˆ é™¤ã€æˆæƒç­‰</li></ul></li><li>æ–‡ä»¶å±æ€§<ul><li>ç”¨æˆ·åˆ†ç±»ï¼šå±ä¸»ã€åˆä½œè€…ã€å…¶ä»–</li><li>æ–‡ä»¶å±æ€§ï¼šè¯»ã€å†™ã€æ‰§è¡Œï¼›æ”¾åœ¨æ–‡ä»¶ç›®å½•é¡¹ä¸­</li><li>ç”¨æˆ·ä½¿ç”¨æ–‡ä»¶æ—¶ï¼Œé€šè¿‡æ ¸å¯¹æ–‡ä»¶å±æ€§ï¼Œå®ç°ä¿æŠ¤</li></ul></li></ul><h2 id="è¡¥å……å†…å®¹">5.5 è¡¥å……å†…å®¹</h2><p>å¦‚ä½•åœ¨çº¿æ€§åœ°å€ç©ºé—´å®ç°éçº¿æ€§å±‚æ¬¡ç›®å½•ç»“æ„â€”â€”æŒ‰åå­˜å–</p><p>æŒ‰åå­˜å–â€”â€”æŒ‰å·å­˜å–ï¼ˆå­˜åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ä¿å­˜ï¼šåå’Œå·çš„æ˜ å°„å…³ç³»ï¼‰</p><p>ï¼ˆå«è·¯å¾„çš„æ–‡ä»¶åï¼‰åâ€”â€”ç›®å½•é¡¹ã€å | indoeå·ã€‘â€”â€”inodeå·</p><p>æ–‡ä»¶çš„å­˜å–æ–¹æ³•</p><ul><li>é¡ºåºå­˜å–</li><li>ç›´æ¥å­˜å–</li><li>ç´¢å¼•å­˜å–ï¼šç´¢å¼•æ–‡ä»¶</li></ul><p>æ–‡ä»¶ç³»ç»Ÿçš„å®ç°å±‚æ¬¡</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230225112534129.png" /></p><h3 id="inode">Inode</h3><p>Linuxç³»ç»Ÿçš„FCBä¸­çš„æ–‡ä»¶åå’Œå…¶ä»–ç®¡ç†ä¿¡æ¯åˆ†å¼€ï¼Œå…¶ä»–ä¿¡æ¯å•ç‹¬ç»„æˆä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹<code>inode</code>ï¼Œç”±<code>inodeå·</code>æ ‡è¯†ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230225100907302.png"alt="FCBç»“æ„" /><figcaption aria-hidden="true">FCBç»“æ„</figcaption></figure><p>æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªç£ç›˜<code>inode</code>ä¸ä¹‹å¯¹åº”ï¼Œè¿™äº›<code>inode</code>è¢«é›†ä¸­å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„<code>inodeåŒº</code>ã€‚</p><p>ä¸ºäº†é¿å…ä¸æ–­æ¥å›äºå†…å¤–å­˜å¼•ç”¨ç£ç›˜inodeè¡¨ï¼Œåœ¨å†…å­˜åŒºå¼€è¾Ÿä¸€å¼ æ´»åŠ¨inodeè¡¨ï¼Œç£ç›˜inodeåæ˜ æ–‡ä»¶é™æ€ç‰¹æ€§ï¼Œæ´»åŠ¨inodeè¡¨åæ˜ æ–‡ä»¶åŠ¨æ€ç‰¹æ€§</p><h3 id="å±‚æ¬¡ç›®å½•ç»“æ„">å±‚æ¬¡ç›®å½•ç»“æ„</h3><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230225101609127.png"alt="Linuxå’ŒWindowså±‚æ¬¡ç›®å½•ç»“æ„" /><figcaption aria-hidden="true">Linuxå’ŒWindowså±‚æ¬¡ç›®å½•ç»“æ„</figcaption></figure><ul><li>çº¯æ ‘å‹ç›®å½•ç»“æ„ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½åªæœ‰ä¸€ä¸ªçˆ¶ç›®å½•</li><li>æœ‰å‘æ— ç¯å›¾ç›®å½•ï¼šå…è®¸æ–‡ä»¶æœ‰å¤šä¸ªçˆ¶ç›®å½•è€Œç ´åæ ‘çš„ç‰¹æ€§</li></ul><p><strong>Linuxæ”¯æŒå¤šçˆ¶ç›®å½•ï¼Œä½†å…¶ä¸­ä¸€ä¸ªæ˜¯ä¸»çˆ¶ç›®å½•ï¼Œå®ƒæ˜¯æ–‡ä»¶æ‹¥æœ‰è€…</strong>ï¼Œæ–‡ä»¶è¢«ç‰©ç†å­˜æ”¾åœ¨è¯¥ç›®å½•ä¸‹ï¼Œå…¶ä»–çˆ¶ç›®å½•é€šè¿‡linkçš„æ–¹å¼æ¥è¿ç»“å’Œå¼•ç”¨æ–‡ä»¶ï¼Œå…è®¸ä»»ä¸€çˆ¶ç›®å½•åˆ é™¤å…±äº«æ–‡ä»¶ã€‚ï¼ˆWindowsä¸­çš„å¿«æ·æ–¹å¼ï¼‰</p><h3 id="æ–‡ä»¶ç³»ç»Ÿçš„å®ç°">æ–‡ä»¶ç³»ç»Ÿçš„å®ç°</h3><p>æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç»“æ„</p><ul><li>è¶…çº§å—ï¼šå ç”¨1#å·å—ï¼›å­˜æ”¾æ–‡ä»¶ç³»ç»Ÿç»“æ„å’Œç®¡ç†ä¿¡æ¯ï¼Œæ—¢æœ‰ç›˜ä½ç¤ºå›¾çš„åŠŸèƒ½ï¼Œåˆè®°å½•æ•´ä¸ªæ–‡ä»¶å·çš„æ§åˆ¶æ•°æ®</li><li>ç´¢å¼•èŠ‚ç‚¹åŒºï¼š2#â€”k+1#å—ï¼›å­˜æ”¾åœ¨inodeè¡¨</li><li>æ•°æ®åŒºï¼šk+2#â€”n#å—ï¼šæ–‡ä»¶å†…å®¹ä¿å­˜åœ¨è¿™ä¸ªåŒºåŸŸä¸­</li></ul><p>é‡è¦æ•°æ®ç»“æ„</p><ul><li>ç”¨æˆ·æ‰“å¼€æ–‡ä»¶è¡¨</li><li>ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶è¡¨ï¼šä¸ºäº†è§£å†³å¤šç”¨æˆ·è¿›ç¨‹å…±äº«æ–‡ä»¶ã€çˆ¶å­è¿›ç¨‹å…±äº«æ–‡ä»¶è€Œè®¾ç½®çš„ï¼Œé€šè¿‡æ­¤è¡¨é¡¹å°†<u>ç”¨æˆ·æ‰“å¼€æ–‡ä»¶è¡¨çš„è¡¨é¡¹</u> å’Œ <u>æ–‡ä»¶æ´»åŠ¨inodeè¡¨çš„è¡¨é¡¹</u>è”æ¥èµ·æ¥ï¼Œä»¥å®ç°æ•°æ®çš„è®¿é—®å’Œä¿¡æ¯çš„å…±äº«ã€‚</li><li>ä¸»å­˜æ´»åŠ¨<code>inodeè¡¨</code></li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/82705ca69201a804478a2a214a987d67.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/543d71fd2007f6df381df780b979bac0.png" /></p><h3 id="æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨">æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">fd = create(file_name_p, mode);<br>unlink(file_name_p);<br>fd = open(file_name_p, mode);<br>close(fd);<br></code></pre></td></tr></table></figure><ul><li><code>f_count</code>ï¼šåæ˜ ä¸åŒè¿›ç¨‹é€šè¿‡<strong>åŒä¸€ä¸ªç³»ç»Ÿæ‰“å¼€æ–‡ä»¶è¡¨é¡¹</strong>å…±äº«ä¸€ä¸ªæ–‡ä»¶çš„æƒ…å†µ</li><li><code>i_count</code>ï¼šåæ˜ ä¸åŒè¿›ç¨‹é€šè¿‡<strong>ä¸åŒç³»ç»Ÿæ‰“å¼€æ–‡ä»¶è¡¨é¡¹</strong>å…±äº«åŒä¸€ä¸ªæ–‡ä»¶çš„æƒ…å†µ</li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-built_in">read</span>(fd, buf, <span class="hljs-built_in">count</span>);<br><span class="hljs-built_in">write</span>(fd, buf, <span class="hljs-built_in">count</span>);<br></code></pre></td></tr></table></figure><h3 id="æ–‡ä»¶å…±äº«">æ–‡ä»¶å…±äº«</h3><ul><li><p>é™æ€å…±äº«</p><ul><li><code>linke(old_name_p, new_name_p)</code></li><li>æ‰¾åˆ°<code>old_name_p</code>æ‰€æŒ‡å‘çš„æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹inodeç¼–å·ï¼Œæ£€ç´¢åˆ°<code>new_name_p</code>æ‰€æŒ‡æ–‡ä»¶çš„çˆ¶ç›®å½•æ–‡ä»¶ï¼ŒæŠŠä»¥å­˜åœ¨æ–‡ä»¶çš„ç´¢å¼•èŠ‚ç‚¹<code>inode</code>ç¼–å·å’Œåˆ«åæ„æˆä¸€ä¸ªæ–°çš„ç›®å½•é¡¹ï¼Œæ”¾åœ¨è¯¥ç›®å½•æ–‡ä»¶ä¸­å»ï¼Œä»¥å­˜åœ¨æ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹<code>inode</code>çš„è¿æ¥è®¡æ•°<code>i_link</code>åŠ <code>1</code>ã€‚</li></ul></li><li><p>åŠ¨æ€å…±äº«</p><ul><li><p>ä½¿ç”¨åŒä¸€ä½ç§»æŒ‡é’ˆçš„æ–‡ä»¶å…±äº«ï¼šå…ˆæ‰“å¼€æ–‡ä»¶ï¼Œå†<code>fork</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/a9e4a3c7e96f8cf5e91b8dedbaede05a.png" /></p></li><li><p>ä½¿ç”¨ä¸åŒä½ç§»æŒ‡é’ˆçš„æ–‡ä»¶å…±äº«ï¼šå…ˆ<code>fork</code>ï¼Œå†æ‰“å¼€æ–‡ä»¶</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/e34f5e74a7701f774f2c11aebd51d06e.png" /></p></li></ul></li><li><p>ç¬¦å·é“¾æ¥å…±äº«ï¼šç¬¦å·é“¾æ¥åˆç§°è½¯é“¾æ¥ï¼Œæ˜¯ä¸€ç§åªæœ‰æ–‡ä»¶åï¼Œä¸æŒ‡å‘inodeçš„æ–‡ä»¶ï¼Œé€šè¿‡åç§°å¼•ç”¨æ–‡ä»¶ã€‚é€šè¿‡åç§°æŸ¥æ‰¾å¯ä»¥å®ç°é“¾æ¥è®¡ç®—æœºç³»ç»Ÿä¸­ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ã€‚</p></li></ul><h3 id="ç£ç›˜ç©ºé—²ç©ºé—´ç®¡ç†">ç£ç›˜ç©ºé—²ç©ºé—´ç®¡ç†</h3><ul><li>ä½ç¤ºå›¾ï¼š1è¡¨ç¤ºå—å·²å ç”¨ï¼Œ0è¡¨ç¤ºå—ç©ºé—²</li><li>ç©ºé—²åŒºè¡¨ï¼šï¼ˆç±»ä¼¼äºå­˜å‚¨ç®¡ç†ä¸­çš„å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†ï¼‰</li><li>ç©ºé—²é“¾è¡¨ï¼šå°†æ‰€æœ‰ç©ºé—²å—é“¾æ¥åœ¨ä¸€èµ·</li></ul><h3 id="ä¸»å­˜æ˜ å°„æ–‡ä»¶">ä¸»å­˜æ˜ å°„æ–‡ä»¶</h3><blockquote><p>å°†æ–‡ä»¶æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œä½¿å¾—è¿›ç¨‹å¯ä»¥é€šè¿‡è¯»å†™è™šå­˜å†…å®¹æ¥å®ç°æ–‡ä»¶è¯»å†™æ“ä½œ</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230225112807801.png" /></p><h2 id="ç›¸å…³ä¹ é¢˜">ç›¸å…³ä¹ é¢˜</h2><ul><li>æ–‡ä»¶ç›®å½•çš„ä¸»è¦ä½œç”¨æ˜¯ <strong>æŒ‰åå­˜å–</strong></li><li>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶çš„ä¸åŒç‰©ç†ç»“æ„æœ‰ä¸åŒçš„ä¼˜ç¼ºç‚¹ã€‚åœ¨ä¸‹åˆ—æ–‡ä»¶çš„ç‰©ç†ç»“æ„ä¸­ï¼Œ<strong>ç´¢å¼•ç»“æ„</strong>å…·æœ‰ç›´æ¥è¯»å†™æ–‡ä»¶ä»»æ„ä¸€ä¸ªè®°å½•çš„èƒ½åŠ›ï¼Œåˆæé«˜äº†æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„åˆ©ç”¨ç‡</li><li>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä½ç¤ºå›¾å¯ç”¨äº <strong>ç£ç›˜ç©ºé—´çš„ç®¡ç†</strong></li><li>Unixç³»ç»Ÿä¸­ï¼Œé€šè¿‡ <strong>ç›®å½•é¡¹</strong>å®ç°æ–‡ä»¶ç³»ç»Ÿçš„æŒ‰åå­˜å–åŠŸèƒ½</li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­˜å‚¨ç®¡ç†</title>
      <link href="/2023/02/13/nju-course-review-notes/os/memory-management/"/>
      <url>/2023/02/13/nju-course-review-notes/os/memory-management/</url>
      
        <content type="html"><![CDATA[<h2 id="å­˜å‚¨ç®¡ç†åŸºç¡€">3.1 å­˜å‚¨ç®¡ç†åŸºç¡€</h2><h3 id="å­˜å‚¨ç®¡ç†ä¸»è¦æ¨¡å¼">3.1.1 å­˜å‚¨ç®¡ç†ä¸»è¦æ¨¡å¼</h3><p>==é€»è¾‘åœ°å€==ï¼šç›¸å¯¹åœ°å€ï¼Œå³ç”¨æˆ·ç¨‹åºæ‰€ä½¿ç”¨çš„åœ°å€ç©ºé—´ã€‚ä»0å¼€å§‹ç¼–å·ï¼Œæœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç»´é€»è¾‘åœ°å€ï¼ˆåœ°å€ï¼‰ï¼›äºŒç»´é€»è¾‘åœ°å€ï¼ˆæ®µå·ï¼šæ®µå†…åœ°å€ï¼‰</p><blockquote><p>æ®µå¼ç¨‹åºè®¾è®¡ï¼šæŠŠä¸€ä¸ªç¨‹åºè®¾è®¡æˆå¤šä¸ªæ®µï¼šä»£ç æ®µã€æ•°æ®ç«¯ã€å †æ ˆæ®µç­‰</p><p>ç”¨æˆ·å¯ä»¥è‡ªå·±åº”ç”¨ <strong>æ®µè¦†ç›–æŠ€æœ¯</strong> æ‰©å……å†…å­˜ç©ºé—´ä½¿ç”¨é‡</p></blockquote><p>==ç‰©ç†åœ°å€==ï¼šç»å¯¹åœ°å€ï¼Œå³ç¨‹åºæ‰§è¡Œæ‰€ä½¿ç”¨çš„åœ°å€ç©ºé—´ï¼Œå¤„ç†å™¨æ‰§è¡ŒæŒ‡ä»¤æ—¶æŒ‰ç…§ç‰©ç†åœ°å€è¿›è¡Œã€‚</p><h4 id="ä¸»å­˜å‚¨å™¨">ä¸»å­˜å‚¨å™¨</h4><p>å¤šé“ç¨‹åºè®¾è®¡éœ€è¦å¤ç”¨ä¸»å­˜</p><ul><li>æŒ‰ç…§åˆ†åŒºå¤ç”¨ï¼šä¸€ä¸ªç¨‹åº/ç¨‹åºæ®µå ç”¨ä¸€ä¸ªåˆ†åŒº</li><li>æŒ‰ç…§é¡µæ¶å¤ç”¨ï¼šä¸€ä¸ªç¨‹åº/ç¨‹åºæ®µå ç”¨å¤šä¸ªé¡µæ¶</li></ul><p>å­˜å‚¨å™¨ç®¡ç†çš„åŸºæœ¬æ¨¡å¼</p><ol type="1"><li>å•è¿ç»­å­˜å‚¨ç®¡ç†ï¼š<u>ä¸€ç»´é€»è¾‘åœ°å€ç©ºé—´</u>çš„ç¨‹åºå ç”¨<u>ä¸€ä¸ªä¸»å­˜å›ºå®šåˆ†åŒºæˆ–å¯å˜åˆ†åŒº</u></li><li>æ®µå¼å­˜å‚¨ç®¡ç†ï¼š<u>æ®µå¼äºŒç»´é€»è¾‘åœ°å€ç©ºé—´</u>çš„ç¨‹åºå ç”¨<u>å¤šä¸ªä¸»å­˜å¯å˜åˆ†åŒº</u></li><li>é¡µå¼å­˜å‚¨ç®¡ç†ï¼š<u>ä¸€ç»´é€»è¾‘åœ°å€ç©ºé—´</u>çš„ç¨‹åºå ç”¨<u>å¤šä¸ªä¸»å­˜é¡µæ¶åŒº</u></li><li>æ®µé¡µå¼å­˜å‚¨ç®¡ç†ï¼š<u>æ®µå¼äºŒç»´é€»è¾‘åœ°å€ç©ºé—´</u>çš„ç¨‹åºå ç”¨<u>å¤šä¸ªä¸»å­˜é¡µæ¶åŒº</u></li></ol><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221123201329326.png"alt="å­˜å‚¨ç®¡ç†æ¨¡å¼ç¤ºæ„å›¾" /><figcaption aria-hidden="true">å­˜å‚¨ç®¡ç†æ¨¡å¼ç¤ºæ„å›¾</figcaption></figure><h3 id="å­˜å‚¨ç®¡ç†çš„åŠŸèƒ½">3.1.2 å­˜å‚¨ç®¡ç†çš„åŠŸèƒ½</h3><h4 id="åœ°å€è½¬æ¢">åœ°å€è½¬æ¢</h4><ul><li>åœ°å€è½¬æ¢ï¼šåˆç§°é‡å®šä½ï¼Œå³æŠŠé€»è¾‘åœ°å€è½¬æ¢ä¸ºç»å¯¹åœ°å€</li><li>é™æ€é‡å®šä½ï¼š==ç¨‹åºè£…å…¥å†…å­˜æ—¶==è¿›è¡Œåœ°å€è½¬æ¢</li><li>åŠ¨æ€é‡å®šä½ï¼š==åœ¨CPUæ‰§è¡Œç¨‹åºæ—¶==è¿›è¡Œåœ°å€è½¬æ¢</li></ul><h4 id="åˆ†é…ä¸å»é…">åˆ†é…ä¸å»é…</h4><ul><li>åˆ†é…ï¼šè¿›ç¨‹è£…å…¥ä¸»å­˜æ—¶ï¼Œå­˜å‚¨ç®¡ç†è½¯ä»¶è¿›è¡Œå…·ä½“çš„ä¸»å­˜åˆ†é…æ“ä½œï¼Œå¹¶è®¾ç½®ä¸€ä¸ªè¡¨æ ¼è®°å½•ä¸»å­˜ç©ºé—´çš„åˆ†é…æƒ…å†µ</li><li>å»é…ï¼šå½“æŸä¸ªè¿›ç¨‹æ’¤ç¦»æˆ–è€…ä¸»åŠ¨å½’è¿˜ä¸»å­˜èµ„æºæ—¶ï¼Œå­˜å‚¨ç®¡ç†è½¯ä»¶è¦æ”¶å›å®ƒæ‰€å ç”¨çš„å…¨éƒ¨æˆ–è€…éƒ¨åˆ†å­˜å‚¨ç©ºé—´ï¼Œè°ƒæ•´ä¸»å­˜åˆ†é…è¡¨ä¿¡æ¯</li></ul><h4 id="ä¸»å­˜å‚¨å™¨ç©ºé—´çš„å…±äº«">ä¸»å­˜å‚¨å™¨ç©ºé—´çš„å…±äº«</h4><p><u>å¤šé“ç¨‹åºè®¾è®¡æŠ€æœ¯</u>ä½¿è‹¥å¹²ä¸ªç¨‹åºåŒæ—¶è¿›å…¥ä¸»å­˜å‚¨å™¨ï¼Œå„è‡ªå ç”¨ä¸€å®šæ•°é‡çš„å­˜å‚¨ç©ºé—´ï¼Œ<u>å…±åŒä½¿ç”¨ä¸€ä¸ªä¸»å­˜å‚¨å™¨</u>ï¼Œè‹¥å¹²ä¸ªåä½œè¿›ç¨‹æœ‰å…±åŒçš„ä¸»å­˜ç¨‹åºå—æˆ–è€…ä¸»å­˜æ•°æ®å—</p><blockquote><p>å­˜å‚¨ä¿æŠ¤é—®é¢˜ï¼Œè½¯ç¡¬ä»¶ååŒå®Œæˆ</p><ul><li>ç§æœ‰ä¸»å­˜åŒºä¸­çš„ä¿¡æ¯ï¼šå¯è¯»å¯å†™</li><li>å…¬å…±åŒºä¸­çš„å…±äº«ä¿¡æ¯ï¼šçœ‹æˆæƒ</li><li>éæœ¬è¿›ç¨‹ä¿¡æ¯ï¼šä¸å¯è¯»å†™</li></ul></blockquote><h4 id="ä¸»å­˜å‚¨å™¨ç©ºé—´çš„æ‰©å……">ä¸»å­˜å‚¨å™¨ç©ºé—´çš„æ‰©å……</h4><ul><li>å­˜å‚¨æ‰©å……ï¼šç£ç›˜ä½œä¸ºä¸»å­˜æ‰©å……ï¼ŒåªæŠŠéƒ¨åˆ†è¿›ç¨‹æˆ–è€…è¿›ç¨‹çš„éƒ¨åˆ†å†…å®¹è£…å…¥å†…å­˜ã€‚<ul><li>å¯¹æ¢æŠ€æœ¯ï¼šæŠŠéƒ¨åˆ†ä¸è¿è¡Œçš„è¿›ç¨‹è°ƒå‡º</li><li>è™šæ‹ŸæŠ€æœ¯ï¼šåªè°ƒå…¥è¿›ç¨‹çš„éƒ¨åˆ†å†…å®¹</li></ul></li></ul><h3 id="è™šæ‹Ÿå­˜å‚¨å™¨çš„æ¦‚å¿µ">3.1.3 è™šæ‹Ÿå­˜å‚¨å™¨çš„æ¦‚å¿µ</h3><h4 id="è™šæ‹Ÿå­˜å‚¨å™¨">è™šæ‹Ÿå­˜å‚¨å™¨</h4><blockquote><p>ç¨‹åºå±€éƒ¨æ€§åŸç†ï¼šæŒ‡ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªè¾ƒçŸ­æ—¶é—´å†…ï¼Œ<u>æ‰€æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€</u><u>æˆ–æ“ä½œæ•°åœ°å€åˆ†åˆ«å±€é™äºä¸€å®šçš„å­˜å‚¨åŒºåŸŸä¸­</u></p></blockquote><p>1ã€åŸå› ï¼š</p><ul><li>ä¸»å­˜å®¹é‡å­˜åœ¨é™åˆ¶ï¼Œä½¿å¾—ç”¨æˆ·ç¼–å†™ç¨‹åºå—é™ï¼Œå¤šé“ç¨‹åºè®¾è®¡é“æ•°å—é™</li><li>å­˜åœ¨ç©ºé—´å±€éƒ¨æ€§å’Œæ—¶é—´å±€éƒ¨æ€§ï¼Œä½¿å¾—æŸä¸€é˜¶æ®µåªéœ€è¦éƒ¨åˆ†è¿›ç¨‹å†…å®¹</li></ul><p>2ã€åŸºæœ¬æ€æƒ³ï¼š</p><ul><li>è¿›ç¨‹ä¿¡æ¯å…¨éƒ¨æ”¾åœ¨è¾…å­˜ï¼Œæ‰§è¡Œæ—¶==éšç”¨éšè°ƒå…¥==</li><li>æŠŠä¸»å­˜ä¸­æš‚æ—¶ä¸ç”¨çš„ä¿¡æ¯è°ƒåˆ°è¾…å­˜ä¸Šå»</li></ul><p>3ã€å®ç°æ€è·¯ï¼š</p><ul><li>å»ºç«‹ä¸¤ä¸ªåœ°å€ç©ºé—´<ul><li>ï¼ˆè¾…å­˜ï¼‰è™šæ‹Ÿåœ°å€ç©ºé—´ï¼šå®¹çº³è¿›ç¨‹è£…å…¥</li><li>ï¼ˆä¸»å­˜ï¼‰å®é™…åœ°å€ç©ºé—´ï¼šæ‰¿è½½è¿›ç¨‹æ‰§è¡Œ</li></ul></li><li>è™šæ‹Ÿå­˜å‚¨å™¨æ˜¯ä¸€ç§åœ°å€ç©ºé—´æ‰©å±•æŠ€æœ¯ï¼Œå¯¹ç”¨æˆ·é€æ˜ï¼Œç”¨æˆ·ç¼–ç¨‹æ—¶ä»¥ä¸ºå¯ä»¥æ“çºµæ•´ä¸ªå†…å­˜</li></ul><p>4ã€è¦†ç›–ä¸äº¤æ¢</p><ul><li>è¦†ç›–ï¼šæŒ‰ç…§ç¨‹åºé€»è¾‘ç»“æ„è®©é‚£äº›ä¸éœ€è¦åŒæ—¶æ‰§è¡Œçš„ç¨‹åºæ®µå…±äº«åŒä¸€å—å†…å­˜åŒºï¼Œä½¿å¾—åé¢çš„ç¨‹åºæ®µå¯ä»¥è°ƒå…¥å†…å­˜è¦†ç›–å‰é¢çš„ç¨‹åºæ®µã€‚</li><li>äº¤æ¢ï¼šæŠŠå¤„äºç­‰å¾…çŠ¶æ€çš„è¿›ç¨‹æ¢å‡ºå†…å­˜ã€‚</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221123204556880.png"alt="è™šæ‹Ÿå­˜å‚¨å™¨" /><figcaption aria-hidden="true">è™šæ‹Ÿå­˜å‚¨å™¨</figcaption></figure><h3 id="å­˜å‚¨ç®¡ç†çš„ç¡¬ä»¶æ”¯æ’‘">3.1.4 å­˜å‚¨ç®¡ç†çš„ç¡¬ä»¶æ”¯æ’‘</h3><h4 id="å­˜å‚¨å™¨çš„ç»„ç»‡å±‚æ¬¡">å­˜å‚¨å™¨çš„ç»„ç»‡å±‚æ¬¡</h4><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221123204656005.png"alt="å­˜å‚¨å™¨é‡‘å­—å¡”å±‚æ¬¡" /><figcaption aria-hidden="true">å­˜å‚¨å™¨é‡‘å­—å¡”å±‚æ¬¡</figcaption></figure><p>å­˜å‚¨ç®¡ç†æ¶‰åŠçš„å­˜å‚¨å¯¹è±¡ï¼š</p><ol type="1"><li>ä¸»å­˜å‚¨å™¨</li><li>Cache</li><li>ä¸ºäº†è·å¾—æ›´å¤§çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå­˜å‚¨ç®¡ç†éœ€è¦å¯¹å­˜æ”¾åœ¨ç¡¬ç›˜ã€å›ºæ€ç¡¬ç›˜ã€ç”šè‡³ç½‘ç»œç¡¬ç›˜ä¸Šçš„è™šæ‹Ÿå­˜å‚¨å™¨æ–‡ä»¶è¿›è¡Œç®¡ç†</li></ol><h4 id="cache">Cache</h4><p>1ã€ä»‹äºCPUå’Œä¸»å­˜ä¹‹é—´çš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ï¼ŒSRAMç»„æˆï¼Œæ¥è¿‘CPUé€Ÿåº¦ã€‚ï¼ˆä¸»å­˜DRAMï¼‰</p><p>2ã€CPUå¾€å¾€éœ€è¦é‡å¤è¯»å–åŒæ ·çš„æ•°æ®å—ï¼Œæ—¶é—´å±€éƒ¨æ€§å’Œç©ºé—´å±€éƒ¨æ€§</p><p>3ã€ç»„æˆï¼šé«˜é€Ÿå­˜å‚¨å™¨ã€è”æƒ³å­˜å‚¨å™¨ã€åœ°å€è½¬æ¢éƒ¨ä»¶ã€æ›¿æ¢é€»è¾‘</p><ul><li>è”æƒ³å­˜å‚¨å™¨ï¼šæ ¹æ®å†…å®¹è¿›è¡Œå¯»å€çš„å­˜å‚¨å™¨ã€‚</li><li>åœ°å€è½¬æ¢éƒ¨ä»¶ï¼šé€šè¿‡è”æƒ³å­˜å‚¨å™¨å»ºç«‹ç›®å½•è¡¨ä»¥å®ç°å¿«é€Ÿåœ°å€è½¬æ¢ã€‚å‘½ä¸­æ—¶ç›´æ¥è®¿é—®Cacheï¼Œæœªå‘½ä¸­æ—¶ä»å†…å­˜è¯»å–æ”¾å…¥Cacheã€‚</li><li>æ›¿æ¢éƒ¨ä»¶ï¼šåœ¨Cacheå·²æ»¡æ—¶æŒ‰ä¸€å®šç­–ç•¥è¿›è¡Œæ•°æ®å—æ›¿æ¢ï¼Œå¹¶ä¿®æ”¹åœ°å€è½¬æ¢éƒ¨ä»¶ã€‚</li></ul><p>4ã€ç»„ç»‡ï¼šL1ã€L2ã€L3ä¸‰çº§</p><ul><li>L1 Cacheï¼šæ•°æ®ç¼“å­˜å’ŒæŒ‡ä»¤ç¼“å­˜ï¼›å†…ç½®ï¼›32KB-256KB</li><li>L2 Cacheï¼šå†…ç½®å’Œå¤–ç½®ï¼›512KBâ€”8MB</li><li>L3 Cacheï¼šå¤šä¸ºå¤–ç½®</li></ul><h3 id="ä¼™ä¼´ç³»ç»Ÿ">ä¼™ä¼´ç³»ç»Ÿ</h3><ul><li>ä¼™ä¼´ç³»ç»Ÿï¼Œåˆç§°buddyç®—æ³•ï¼Œæ˜¯ä¸€ç§å›ºå®šåˆ†åŒºå’Œå¯å˜åˆ†åŒºæŠ˜ä¸­çš„ä¸»å­˜ç®¡ç†ç®—æ³•</li><li>ä»»ä½•å°ºå¯¸ä¸º2<sup>i</sup>çš„ç©ºé—²å—éƒ½å¯ä»¥è¢«åˆ†ä¸ºä¸¤ä¸ªå°ºå¯¸ä¸º2<sup>i-1</sup>çš„ç©ºé—²å—ï¼Œè¿™ä¸¤ä¸ªç©ºé—²å—ç§°ä½œä¼™ä¼´</li><li>SunOSæ“ä½œç³»ç»Ÿä¸­é¦–åˆ›çš„åŸºäºä¼™ä¼´ç³»ç»Ÿçš„<code>slab</code>åˆ†é…å™¨</li><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127151706379.png" /></li><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127151731055.png" /></li></ul><h3 id="åˆ†æ®µå’Œåˆ†é¡µ">åˆ†æ®µå’Œåˆ†é¡µ</h3><h4 id="åˆ†æ®µ">åˆ†æ®µ</h4><ul><li>åˆ†æ®µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œç”±æºç¨‹åºçš„é€»è¾‘ç»“æ„æ‰€å†³å®šï¼Œç”¨æˆ·å¯è§</li><li>æ®µé•¿å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦æ¥è§„å®šï¼Œæ®µèµ·å§‹åœ°å€å¯ä»¥ä»ä»»ä½•ä¸»å­˜åœ°å€å¼€å§‹</li><li>åˆ†æ®µæ–¹å¼ä¸‹ï¼Œæºç¨‹åºï¼ˆæ®µå·ï¼Œæ®µå†…åœ°å€ï¼‰ç»è¿ç»“è£…é…ååœ°å€ä»ä¿æŒäºŒç»´ç»“æ„</li><li><strong>æ®µæ˜¯ä¸å®šé•¿è¿ç»­çš„</strong></li></ul><h4 id="åˆ†é¡µ">åˆ†é¡µ</h4><ul><li>åˆ†é¡µæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼Œä¸æºç¨‹åºçš„é€»è¾‘ç»“æ„æ— å…³ï¼Œç”¨æˆ·ä¸å¯è§</li><li>é¡µé•¿ç”±ç³»ç»Ÿå†³å®šï¼Œé¡µé¢åªèƒ½ä»¥é¡µå¤§å°çš„æ•´æ•°å€åœ°å€å¼€å§‹</li><li>åˆ†é¡µæ–¹å¼ä¸­ï¼Œæºç¨‹åºï¼ˆé¡µå·ï¼Œé¡µå†…åœ°å€ï¼‰ç»è¿ç»“è£…é…ååœ°å€å˜æˆäº†ä¸€ç»´ç»“æ„</li></ul><h2 id="å•è¿ç»­åˆ†åŒºå­˜å‚¨ç®¡ç†">3.2 å•è¿ç»­åˆ†åŒºå­˜å‚¨ç®¡ç†</h2><h3 id="å•è¿ç»­åˆ†åŒºå­˜å‚¨ç®¡ç†-1">3.2.1 å•è¿ç»­åˆ†åŒºå­˜å‚¨ç®¡ç†</h3><p>æ¯ä¸ªè¿›ç¨‹å ç”¨ä¸€ä¸ªç‰©ç†ä¸Šå®Œå…¨è¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼ˆåŒºåŸŸï¼‰</p><h4 id="å•ç”¨æˆ·è¿ç»­åˆ†åŒºç®¡ç†å­˜å‚¨">å•ç”¨æˆ·è¿ç»­åˆ†åŒºç®¡ç†å­˜å‚¨</h4><ul><li>ä¸»å­˜åŒºåŸŸåˆ’åˆ†ä¸ºç³»ç»ŸåŒºå’Œç”¨æˆ·åŒº</li><li>è®¾ç½®ä¸€ä¸ªæ …æ å¯„å­˜å™¨ç•Œåˆ†ä¸¤ä¸ªåŒºåŸŸï¼Œç¡¬ä»¶ç”¨å®ƒåœ¨æ‰§è¡Œæ—¶è¿›è¡Œåœ°å€è½¬æ¢</li><li>ä¸€èˆ¬é‡‡ç”¨é™æ€é‡å®šä½è¿›è¡Œåœ°å€è½¬æ¢</li><li>ç¡¬ä»¶å®ç°ä»£ä»·ä½</li><li>é€‚ç”¨äºå•ç”¨æˆ·å•ä»»åŠ¡æ“ä½œç³»ç»Ÿï¼ˆDOSï¼‰</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126232350828.png" /></p><h4 id="å›ºå®šåˆ†åŒºå­˜å‚¨ç®¡ç†">å›ºå®šåˆ†åŒºå­˜å‚¨ç®¡ç†</h4><ul><li>æ”¯æŒå¤šä¸ªåˆ†åŒº</li><li>åˆ†åŒºæ•°é‡å›ºå®šã€å¤§å°å›ºå®š</li><li>å¯ç”¨é™æ€é‡å®šä½</li><li>ç¡¬ä»¶å®ç°ä»£ä»·ä½</li><li>æ—©æœŸOSé‡‡ç”¨</li></ul><p>ä¸»å­˜åˆ†é…ï¼šé‡‡ç”¨ä¸»å­˜åˆ†é…è¡¨è®°å½•ä¸»å­˜çš„åˆ†é…ä¿¡æ¯</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126232531636.png" /></p><p>åœ°å€è½¬æ¢</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126232815963.png" /></p><h4 id="å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†">å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†</h4><ul><li>å›ºå®šåˆ†åŒºå­˜å‚¨ç®¡ç†ä¸å¤Ÿçµæ´»ï¼Œæ—¢ä¸é€‚åº”å¤§å°ºå¯¸ç¨‹åºï¼Œåˆå­˜åœ¨å†…å­˜é›¶å¤´ï¼Œæœ‰æµªè´¹</li><li>å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†ï¼šå…è®¸æŒ‰ç…§è¿›ç¨‹å®é™…å†…å­˜éœ€æ±‚åŠ¨æ€åˆ’åˆ†åˆ†åŒºï¼Œå¹¶å…è®¸åˆ†åŒºä¸ªæ•°å¯å˜</li></ul><h3 id="å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†-1">3.2.2 å¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126234630035.png" /></p><p>ä¸»å­˜åˆ†é…è¡¨ï¼šå·²åˆ†é…åŒºè¡¨å’Œæœªåˆ†é…åŒºè¡¨ï¼Œé‡‡ç”¨é“¾è¡¨ç»“æ„</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126234732011.png" /></p><p>åˆ†é…ç®—æ³•ï¼š</p><ul><li>æœ€å…ˆé€‚é…åˆ†é…ç®—æ³•ï¼šç©ºé—²åˆ†åŒºä»¥<strong>åœ°å€é€’å¢</strong>çš„æ¬¡åºè¿æ¥ï¼Œåˆ†é…å†…å­˜æ—¶<strong>é¡ºåºæŸ¥æ‰¾</strong>ï¼Œæ‰¾åˆ°å¤§å°èƒ½æ»¡è¶³è¦æ±‚çš„ç¬¬ä¸€ä¸ªç©ºé—²åˆ†åŒº</li><li>é‚»è¿‘é€‚é…åˆ†é…ç®—æ³•ï¼šå¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•ï¼Œç”±é¦–æ¬¡é€‚åº”ç®—æ³•æ¼”å˜è€Œæˆï¼Œä¸åŒçš„æ˜¯ï¼Œåˆ†é…å†…å­˜æ—¶<strong>ä»ä¸Šæ¬¡æŸ¥æ‰¾ç»“æŸçš„ä½ç½®</strong>å¼€å§‹ç»§ç»­æŸ¥æ‰¾</li><li>æœ€ä¼˜é€‚é…åˆ†é…ç®—æ³•ï¼šç©ºé—²åˆ†åŒºæŒ‰<strong>å®¹é‡é€’å¢çš„æ–¹å¼</strong>å½¢æˆåˆ†åŒºé“¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ç©ºé—²åˆ†åŒº</li><li>æœ€åé€‚é…åˆ†é…ç®—æ³•ï¼šç©ºé—²åˆ†åŒºä»¥<strong>å®¹é‡é€’å‡çš„æ¬¡åº</strong>è¿æ¥ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªèƒ½æ»¡è¶³è¦æ±‚çš„ç©ºé—²åˆ†åŒº</li></ul><p>åœ°å€è½¬æ¢</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126234915421.png" /></p><p><strong>å†…å­˜é›¶å¤´</strong></p><ul><li>å›ºå®šåˆ†åŒºæ–¹å¼ä¼šäº§ç”Ÿ<u>å†…å­˜å†…é›¶å¤´</u></li><li>å¯å˜åˆ†åŒºæ–¹å¼ä¼šäº§ç”Ÿ<u>å†…å­˜å¤–é›¶å¤´</u></li><li>åˆ†æ®µæ–¹å¼ä¼šäº§ç”Ÿå†…å­˜å¤–é›¶å¤´</li><li>åˆ†é¡µæ–¹å¼ä¼šäº§ç”Ÿå†…å­˜å†…é›¶å¤´</li><li>æœ€ä¼˜é€‚é…ç®—æ³•æœ€å®¹æ˜“äº§ç”Ÿå¤–é›¶å¤´ï¼Œ<u>å¤–é›¶å¤´æ˜¯ä¸å¯é¿å…çš„</u></li></ul><p><strong>ç§»åŠ¨æŠ€æœ¯ï¼ˆç¨‹åºæµ®åŠ¨æŠ€æœ¯ï¼‰</strong></p><ul><li>ç§»åŠ¨åˆ†åŒºä»¥è§£å†³å†…å­˜å¤–é›¶å¤´</li><li>éœ€è¦åŠ¨æ€é‡å®šä½çš„æ”¯æ’‘</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126235242772.png" /></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126235315170.png"alt="å·¥ä½œæµç¨‹" /><figcaption aria-hidden="true">å·¥ä½œæµç¨‹</figcaption></figure><h2 id="é¡µå¼å­˜å‚¨ç®¡ç†">3.3 é¡µå¼å­˜å‚¨ç®¡ç†</h2><h3 id="é¡µå¼å­˜å‚¨ç®¡ç†çš„åŸºæœ¬åŸç†">3.3.1 é¡µå¼å­˜å‚¨ç®¡ç†çš„åŸºæœ¬åŸç†</h3><ul><li>åˆ†é¡µå­˜å‚¨å™¨å°†ä¸»å­˜åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„==é¡µæ¶==</li><li>å—é¡µæ¶å°ºå¯¸é™åˆ¶ï¼Œç¨‹åºçš„é€»è¾‘åœ°å€ä¹Ÿè‡ªç„¶åˆ†æˆ==é¡µ==</li><li>ä¸åŒçš„é¡µå¯ä»¥æ”¾åœ¨ä¸åŒçš„é¡µæ¶ä¸­ï¼Œä¸éœ€è¦è¿ç»­</li><li>é¡µè¡¨ç”¨äºç»´ç³»è¿›ç¨‹çš„ä¸»å­˜å®Œæ•´æ€§</li><li>å¯ç”¨ä¸€å¼ ä½ç¤ºå›¾æ¥è®°å½•ä¸»å­˜åˆ†é…æƒ…å†µ</li></ul><p>åœ°å€è½¬æ¢</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127000913182.png" /></p><p>é¡µçš„å…±äº«</p><ul><li>é¡µå¼å­˜å‚¨ç®¡ç†èƒ½å¤Ÿå®ç°å¤šä¸ªè¿›ç¨‹å…±äº«ç¨‹åºå’Œæ•°æ®</li><li>æ•°æ®å…±äº«ï¼šä¸åŒè¿›ç¨‹å¯ä»¥ä½¿ç”¨ä¸åŒé¡µå·å…±äº«æ•°æ®é¡µ</li><li>ä»£ç å…±äº«ï¼šä¸åŒè¿›ç¨‹å¿…é¡»ä½¿ç”¨ç›¸åŒé¡µå·å…±äº«ä»£ç é¡µï¼ˆJMPæŒ‡ä»¤åœ¨ä¸åŒé¡µå·æ˜¯åšä¸åˆ°çš„ï¼‰</li></ul><h3 id="é¡µå¼å­˜å‚¨ç®¡ç†çš„åœ°å€è½¬æ¢">3.3.2 é¡µå¼å­˜å‚¨ç®¡ç†çš„åœ°å€è½¬æ¢</h3><h4 id="è½¬æ¢ä»£ä»·">è½¬æ¢ä»£ä»·</h4><ul><li>æ¯æ¬¡åœ°å€è½¬æ¢éœ€è¦è®¿é—®ä¸¤æ¬¡ä¸»å­˜<ul><li>è¯»å–é¡µè¡¨</li><li>è¯»å†™æ•°æ®</li></ul></li><li>é™ä½å­˜å–é€Ÿåº¦</li><li>åˆ©ç”¨Cacheå­˜æ”¾éƒ¨åˆ†é¡µè¡¨</li></ul><h4 id="å¿«è¡¨">å¿«è¡¨</h4><ul><li>è¿™ç§é«˜é€Ÿå­˜å‚¨å™¨æ˜¯è”æƒ³å­˜å‚¨å™¨ï¼Œå³æŒ‰å†…å®¹å¯»å€ï¼Œè€ŒéæŒ‰ç…§åœ°å€å¯»å€</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127002107339.png"alt="åœ°å€è½¬æ¢" /><figcaption aria-hidden="true">åœ°å€è½¬æ¢</figcaption></figure><h3 id="é¡µå¼è™šæ‹Ÿå­˜å‚¨ç®¡ç†">3.3.3 é¡µå¼è™šæ‹Ÿå­˜å‚¨ç®¡ç†</h3><p>æŠŠè¿›ç¨‹å…¨éƒ¨é¡µé¢è£…å…¥è™šæ‹Ÿå­˜å‚¨å™¨ï¼Œæ‰§è¡Œæ—¶å…ˆæŠŠéƒ¨åˆ†é¡µé¢è£…å…¥å®é™…å†…å­˜ï¼Œç„¶åï¼Œæ ¹æ®æ‰§è¡Œè¡Œä¸ºï¼ŒåŠ¨æ€è°ƒå…¥ä¸åœ¨ä¸»å­˜ä¸­çš„é¡µï¼ŒåŒæ—¶è¿›è¡Œå¿…è¦çš„é¡µé¢è°ƒå‡ºã€‚</p><p><strong>ç°ä»£OSçš„ä¸»æµå­˜å‚¨ç®¡ç†æŠ€æœ¯</strong></p><p>é¦–æ¬¡åªæŠŠè¿›ç¨‹çš„ç¬¬ä¸€é¡µä¿¡æ¯è£…å…¥ä¸»å­˜ï¼Œç§°ä¸º==è¯·æ±‚é¡µå¼å­˜å‚¨ç®¡ç†==</p><p>éœ€è¦æ‰©å……é¡µè¡¨</p><ul><li><p>åŸæœ¬æ˜¯ï¼šåªå­˜æ”¾ä¸»å­˜å—å·</p></li><li><p>ç°åœ¨éœ€è¦ï¼š<u>æ ‡å¿—ä½</u>ï¼ˆä¸»å­˜é©»ç•™æ ‡å¿—ï¼Œå†™å›æ ‡å¿—ï¼Œä¿æŠ¤æ ‡å¿—ã€å¼•ç”¨æ ‡å¿—ã€å¯ç§»åŠ¨æ ‡å¿—ï¼‰+<u>ä¸»å­˜å—å·</u>+<u>è¾…åŠ©å­˜å‚¨å™¨åœ°å€</u></p></li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127132726430.png"alt="åœ°å€è½¬æ¢" /><figcaption aria-hidden="true">åœ°å€è½¬æ¢</figcaption></figure><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127132805046.png"alt="ç¼ºé¡µä¸­æ–­" /><figcaption aria-hidden="true">ç¼ºé¡µä¸­æ–­</figcaption></figure><h3 id="é¡µé¢è°ƒåº¦">3.3.4 é¡µé¢è°ƒåº¦</h3><p>å½“ä¸»å­˜ç©ºé—´å·²æ»¡ä½†æ˜¯æœ‰éœ€è¦è£…å…¥æ–°é¡µæ—¶ï¼Œé¡µå¼è™šæ‹Ÿå­˜å‚¨ç®¡ç†å¿…é¡»æŒ‰ç…§ä¸€å®šçš„ç®—æ³•æŠŠå·²åœ¨ä¸»å­˜çš„ä¸€äº›é¡µè°ƒå‡ºå»</p><ul><li>é¡µé¢è°ƒåº¦ï¼šé€‰æ‹©æ·˜æ±°é¡µçš„å·¥ä½œ</li><li>é¡µé¢è°ƒåº¦ç®—æ³•ï¼šé€‰æ‹©æ·˜æ±°é¡µçš„ç®—æ³•</li><li>å¦‚æœé¡µé¢è°ƒåº¦ç®—æ³•è®¾è®¡ä¸å½“ï¼Œä¼šå‡ºç°==æŠ–åŠ¨/é¢ ç°¸==ç°è±¡ï¼Œå³åˆšè¢«æ·˜æ±°çš„é¡µé¢ç«‹å³åˆè¦è°ƒå…¥ï¼Œå¦‚æ­¤åå¤</li></ul><h4 id="ç¼ºé¡µä¸­æ–­ç‡">ç¼ºé¡µä¸­æ–­ç‡</h4><ul><li><p>å®šä¹‰ï¼šä¸æˆåŠŸè®¿é—®çš„æ¬¡æ•° / è®¿é—®çš„æ€»æ¬¡æ•°</p></li><li><p>å½±å“ç¼ºé¡µä¸­æ–­ç‡çš„å› ç´ </p><ul><li><u>åˆ†é…ç»™è¿›ç¨‹çš„é¡µæ¶æ•°</u>ï¼šå¯ç”¨é¡µæ¶æ•°è¶Šå¤šï¼Œç¼ºé¡µä¸­æ–­ç‡å°±è¶Šä½</li><li><u>é¡µé¢çš„å¤§å°</u>ï¼šå°ºå¯¸è¶Šå¤§ï¼Œç¼ºé¡µä¸­æ–­ç‡å°±è¶Šä½</li><li><u>ç”¨æˆ·çš„ç¨‹åºç¼–åˆ¶æ–¹æ³•</u></li></ul></li><li><p>ç»å…¸ä¾‹å­</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127133944658.png" /></p></li></ul><h4 id="è°ƒåº¦ç®—æ³•">è°ƒåº¦ç®—æ³•</h4><ul><li>OPTé¡µé¢è°ƒåº¦ç®—æ³•ï¼š<u>ç†æƒ³çš„è°ƒåº¦ç®—æ³•</u>ï¼Œå½“è¦è°ƒå…¥æ–°é¡µé¢æ—¶ï¼Œ<u>é¦–å…ˆæ·˜æ±°ä»¥åä¸å†è®¿é—®çš„é¡µï¼Œç„¶åé€‰æ‹©è·ç¦»ç°åœ¨æœ€é•¿æ—¶é—´åå†è®¿é—®çš„é¡µ</u><ul><li>Beladyç®—æ³•ï¼Œåˆç§°æœ€ä½³ç®—æ³•</li><li>OPTåªå¯æ¨¡æ‹Ÿï¼Œä¸å¯å®ç°</li></ul></li><li>å…ˆè¿›å…ˆå‡ºFIFOé¡µé¢è°ƒåº¦ç®—æ³•<ul><li>æ€»æ˜¯æ·˜æ±°<u>æœ€å…ˆè°ƒå…¥ä¸»å­˜çš„é‚£ä¸€é¡µ</u>ï¼ˆä¸»å­˜é©»ç•™æ—¶é—´æœ€é•¿çš„é‚£ä¸€é¡µï¼‰</li><li>æ€æƒ³ï¼šæ¨¡æ‹Ÿçš„æ˜¯ç¨‹åºæ‰§è¡Œçš„é¡ºåºæ€§</li><li><strong>Beladyå¼‚å¸¸</strong>ï¼šå¢åŠ å¯ç”¨ç‰©ç†é¡µæ¡†çš„æ•°é‡ä¼šå¯¼è‡´æ›´å¤šçš„ç¼ºé¡µå¼‚å¸¸ã€‚</li></ul></li><li>æœ€è¿‘æœ€å°‘ä½¿ç”¨LRUé¡µé¢è°ƒåº¦ç®—æ³•<ul><li>æ·˜æ±°<u>æœ€è¿‘ä¸€æ®µæ—¶é—´è¾ƒä¹…æœªè¢«è®¿é—®çš„é‚£ä¸€é¡µ</u></li><li>æ€æƒ³ï¼šé‚£äº›åˆšåˆšè¢«ä½¿ç”¨è¿‡çš„é¡µé¢ï¼Œå¯èƒ½é©¬ä¸Šè¿˜è¦è¢«ç”¨åˆ°</li><li>éœ€è¦ç»´æŠ¤ç‰¹æ®Šé˜Ÿåˆ—</li><li><strong>æ—¶é—´é—´éš”ä¸­æ–­ï¼Œä¸­æ–­æ—¶é¡µå¼•ç”¨æ ‡å¿—ä½ç½®0</strong></li><li>åœ°å€è½¬æ¢æ—¶ï¼Œé¡µå¼•ç”¨æ ‡å¿—ä½ç½®1</li><li>æ·˜æ±°é¡µé¢æ—¶ï¼Œä»é¡µå¼•ç”¨æ ‡å¿—ä½ä¸º0çš„é¡µä¸­éšæœºæ·˜æ±°</li></ul></li><li>æœ€ä¸å¸¸ç”¨LFUé¡µé¢è°ƒåº¦ç®—æ³•<ul><li>æ·˜æ±°<u>æœ€è¿‘ä¸€æ®µæ—¶é—´å†…è®¿é—®æ¬¡æ•°æœ€å°‘çš„é¡µé¢</u></li><li><strong>åŸºäºæ—¶é—´é—´éš”ä¸­æ–­</strong>ï¼Œç»™æ¯ä¸€é¡µè®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨</li><li><strong>æ—¶é—´é—´éš”ä¸­æ–­å‘ç”Ÿåï¼Œæ‰€æœ‰è®¡æ•°å™¨æ¸…0</strong></li><li>æ¯è®¿é—®é¡µ1æ¬¡å°±ç»™è®¡æ•°å™¨åŠ 1</li><li>é€‰æ‹©è®¡æ•°å€¼æœ€å°çš„é¡µé¢æ·˜æ±°</li></ul></li><li>æ—¶é’ŸCLOCKé¡µé¢è°ƒåº¦ç®—æ³•<ul><li>é‡‡ç”¨å¾ªç¯é˜Ÿåˆ—æœºåˆ¶æ„é€ é¡µé¢é˜Ÿåˆ—</li><li>å·¥ä½œæµç¨‹<ul><li>é¡µé¢è°ƒå…¥ä¸»å­˜å’Œè®¿é—®ä¸»å­˜é¡µé¢æ—¶ï¼Œå¼•ç”¨æ ‡å¿—ä½ç½®1</li><li>æ·˜æ±°é¡µé¢æ—¶ï¼Œä»æŒ‡é’ˆå½“å‰æŒ‡å‘çš„é¡µé¢å¼€å§‹æ‰«æå¾ªç¯é˜Ÿåˆ—<ul><li>é‡åˆ°å¼•ç”¨æ ‡å¿—ä½æ˜¯1çš„é¡µé¢å°†å¼•ç”¨æ ‡å¿—ä½æ¸…0</li><li>é‡åˆ°å¼•ç”¨æ ‡å¿—ä½æ˜¯0çš„é¡µé¢æ·˜æ±°ï¼ŒæŒ‡é’ˆæ¨è¿›ä¸€æ­¥ï¼Œç®—æ³•åœæ­¢</li><li><strong>å¦‚æœå¼•ç”¨æ ‡å¿—ä½å…¨éƒ¨æ˜¯1</strong>ï¼ŒæŒ‡é’ˆä¼šç¯ç»•æ•´ä¸ªå¾ªç¯é˜Ÿåˆ—ä¸€åœˆï¼ŒæŠŠç¢°åˆ°çš„å¼•ç”¨æ ‡å¿—ä½æ¸…0ï¼ŒæŒ‡é’ˆåœåœ¨èµ·å§‹ä½ç½®ï¼ˆå¼€å§‹éå†çš„ä½ç½®ï¼‰ï¼Œå¹¶æ·˜æ±°è¯¥é¡µï¼Œç„¶åæŒ‡é’ˆå‘å‰æ¨è¿›ä¸€æ­¥</li></ul></li></ul></li></ul></li><li>å±€éƒ¨æœ€ä½³é¡µé¢æ›¿æ¢ç®—æ³•ï¼ˆMINï¼‰<ul><li>å¦‚æœè¯¥é¡µé¢åœ¨æ—¶é—´é—´éš”<span class="math inline">\((t,t+\tau)\)</span>å†…æœªè¢«å¼•ç”¨ï¼Œé‚£ä¹ˆå°±ç§»é™¤ï¼›å¦åˆ™è¯¥é¡µè¢«ä¿ç•™åœ¨è¿›ç¨‹é©»ç•™é›†ä¸­</li></ul></li><li>å·¥ä½œé›†ç½®æ¢ç®—æ³•ï¼ˆWSï¼‰<ul><li>==è¿›ç¨‹å·¥ä½œé›†==ï¼šåœ¨æŸä¸€æ®µæ—¶é—´é—´éš”å†…è¿›ç¨‹è¿è¡Œæ‰€éœ€è®¿é—®çš„é¡µé¢é›†åˆ<ul><li><span class="math inline">\(W(t, \Delta)\)</span>è¡¨ç¤ºåœ¨æ—¶åˆ»<spanclass="math inline">\(t-\Delta\)</span>åˆ°æ—¶åˆ»<spanclass="math inline">\(t\)</span>ä¹‹é—´æ‰€è®¿é—®çš„é¡µé¢é›†åˆï¼Œè¿›ç¨‹åœ¨æ—¶åˆ»<spanclass="math inline">\(t\)</span>çš„å·¥ä½œé›†</li></ul></li><li>å®ç°æ€æƒ³ï¼šä¸å‘å‰æŸ¥çœ‹é¡µé¢å¼•ç”¨ä¸²ï¼Œè€Œæ˜¯åŸºäºç¨‹åºå±€éƒ¨æ€§åŸç†å‘åçœ‹</li><li>å®šæœŸåœ°ä»è¿›ç¨‹é©»ç•™é›†ä¸­åˆ å»é‚£äº›ä¸åœ¨å·¥ä½œé›†ä¸­çš„é¡µé¢ã€‚å¦‚æœé¡µé¢åœ¨æ—¶é—´é—´éš”<spanclass="math inline">\((t-\Delta, t)\)</span>å†…æœªè¢«å¼•ç”¨ï¼Œå°±è¦ç§»é™¤ã€‚</li></ul></li></ul><h3 id="åç½®é¡µè¡¨">3.3.5 åç½®é¡µè¡¨</h3><p><strong>é’ˆå¯¹å†…å­˜ä¸­çš„æ¯ä¸ªé¡µæ¶å»ºç«‹ä¸€ä¸ªé¡µè¡¨ï¼ŒæŒ‰ç…§å—å·æ’åº</strong></p><p>åç½®é¡µè¡¨é¡¹</p><ul><li>é¡µå·ï¼šè™šæ‹Ÿåœ°å€é¡µå·éƒ¨åˆ†</li><li>è¿›ç¨‹æ ‡å¿—ç¬¦ï¼šä½¿ç”¨è¯¥é¡µçš„è¿›ç¨‹</li><li>æ§åˆ¶ä½</li><li>é“¾æŒ‡é’ˆ</li></ul><p>åœ°å€è½¬æ¢è¿‡ç¨‹</p><ul><li>MMUé€šè¿‡å“ˆå¸Œè¡¨æŠŠ<u>è¿›ç¨‹æ ‡è¯†</u>å’Œ<u>è™šæ‹Ÿé¡µå·</u>è½¬æ¢æˆä¸€ä¸ªå“ˆå¸Œå€¼ï¼ŒæŒ‡å‘IPTçš„ä¸€ä¸ªè¡¨ç›®</li><li>MMU<u>éå†å“ˆå¸Œé“¾</u>æ‰¾åˆ°æ‰€éœ€è¿›ç¨‹çš„è™šé¡µå·ï¼Œ<u>è¯¥é¡¹çš„ç´¢å¼•å°±æ˜¯é¡µæ¶å·</u>ï¼Œé€šè¿‡æ‹¼æ¥ä½ç§»ä¾¿å¯ç”Ÿæˆç‰©ç†åœ°å€</li><li>è‹¥éå†æ•´ä¸ªåç½®é¡µè¡¨ä¸­æœªèƒ½æ‰¾åˆ°åŒ¹é…é¡µè¡¨é¡¹ï¼Œè¯´æ˜è¯¥é¡µä¸åœ¨å†…å­˜ï¼Œäº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿè°ƒå…¥</li></ul><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127190347147.png"alt="åœ°å€è½¬æ¢" /><figcaption aria-hidden="true">åœ°å€è½¬æ¢</figcaption></figure><h3 id="å¤šçº§é¡µè¡¨">3.3.6 å¤šçº§é¡µè¡¨</h3><ul><li>ç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹å»ºä¸€å¼ é¡µç›®å½•è¡¨ï¼Œå®ƒçš„æ¯ä¸ªè¡¨é¡¹å¯¹åº”ä¸€ä¸ªé¡µè¡¨é¡µï¼Œè€Œé¡µè¡¨é¡µçš„æ¯ä¸ªè¡¨é¡¹ç»™å‡ºäº†é¡µé¢å’Œé¡µæ¡†çš„å¯¹åº”å…³ç³»ï¼Œé¡µç›®å½•è¡¨æ˜¯ä¸€çº§é¡µè¡¨ï¼Œé¡µè¡¨é¡µæ˜¯äºŒçº§é¡µè¡¨</li><li>é€»è¾‘åœ°å€ç»“æ„ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šé¡µç›®å½•ã€é¡µè¡¨é¡µå’Œä½ç§»</li><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127185029725.png" /></li></ul><h3 id="é¡µçš„å¤§å°">é¡µçš„å¤§å°</h3><blockquote><p>é¡µçš„å¤§å°ä¼šå½±å“å¾ˆå¤šå› ç´ </p></blockquote><h3 id="tlbå¿«è¡¨">TLBå¿«è¡¨</h3><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127212343408.png"alt="å¿«è¡¨" /><figcaption aria-hidden="true">å¿«è¡¨</figcaption></figure><h2 id="æ®µå¼å­˜å‚¨ç®¡ç†">3.4 æ®µå¼å­˜å‚¨ç®¡ç†</h2><h3 id="æ®µå¼å­˜å‚¨ç®¡ç†-1">3.4.1 æ®µå¼å­˜å‚¨ç®¡ç†</h3><h4 id="æ®µå¼ç¨‹åºè®¾è®¡">æ®µå¼ç¨‹åºè®¾è®¡</h4><ul><li>æ¯ä¸ªç¨‹åºå¯æœ‰è‹¥å¹²æ®µç»„æˆï¼Œæ¯ä¸€æ®µéƒ½å¯ä»¥ä»â€œ0â€å¼€å§‹ç¼–å€ï¼Œæ®µå†…åœ°å€æ˜¯è¿ç»­çš„</li><li>åˆ†æ®µå­˜å‚¨å™¨çš„é€»è¾‘åœ°å€ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<u>æ®µå·+å•å…ƒå·</u></li></ul><h4 id="åŸºæœ¬æ€æƒ³">åŸºæœ¬æ€æƒ³</h4><ul><li><p>æ®µå¼å­˜å‚¨ç®¡ç†åŸºäºå¯å˜åˆ†åŒºå­˜å‚¨ç®¡ç†å®ç°ï¼Œä¸€ä¸ªè¿›ç¨‹è¦å ç”¨å¤šä¸ªåˆ†åŒº</p></li><li><p>å­˜å‚¨ç®¡ç†éœ€è¦å¢åŠ è®¾ç½®ä¸€ä¸ªæ®µè¡¨ï¼Œæ¯ä¸ªæ®µç«™å ç”¨ä¸€ä¸ªæ®µè¡¨é¡¹ï¼šæ®µèµ·å€+æ®µé™é•¿+æ ‡å¿—ä½</p></li><li><p>è½¬æ¢æµç¨‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127145627167.png" /></p></li><li><p>æ®µçš„å…±äº«ï¼šé€šè¿‡ä¸åŒè¿›ç¨‹æ®µè¡¨ä¸­çš„é¡¹æŒ‡å‘åŒä¸€ä¸ªæ®µåŸºå€æ¥å®ç°ï¼Œå¯¹å…±äº«æ®µçš„ä¿¡æ¯å¿…é¡»è¿›è¡Œä¿æŠ¤ã€‚</p></li></ul><h3 id="æ®µå¼è™šæ‹Ÿå­˜å‚¨ç®¡ç†">3.4.2 æ®µå¼è™šæ‹Ÿå­˜å‚¨ç®¡ç†</h3><ul><li>è¿›ç¨‹çš„æ‰€æœ‰åˆ†æ®µéƒ½å­˜æ”¾åœ¨è¾…å­˜ä¸­ï¼Œè¿›ç¨‹è¿è¡Œæ—¶å…ˆæŠŠéœ€è¦çš„æ®µè£…å…¥å†…å­˜ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­å†åŠ¨æ€è£…å…¥</li><li><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127150229497.png"alt="åœ°å€è½¬æ¢" /><figcaption aria-hidden="true">åœ°å€è½¬æ¢</figcaption></figure></li></ul><h3 id="æ®µé¡µå¼å­˜å‚¨ç®¡ç†">3.4.3 æ®µé¡µå¼å­˜å‚¨ç®¡ç†</h3><ul><li>æ®µå¼å­˜å‚¨ç®¡ç†å¯ä»¥åŸºäºé¡µå¼å­˜å‚¨ç®¡ç†å®ç°ï¼Œæ¯ä¸€æ®µä¸å¿…å æ®è¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥å­˜æ”¾åœ¨ä¸è¿ç»­çš„ä¸»å­˜é¡µæ¶ä¸­=&gt; æ®µé¡µå¼å­˜å‚¨ç®¡ç†ï¼Œè£…å…¥éƒ¨åˆ†æ®µæˆ–è€…è£…å…¥æ®µä¸­çš„éƒ¨åˆ†é¡µé¢</li><li><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127150559962.png"alt="æ®µè¡¨å’Œé¡µè¡¨" /><figcaption aria-hidden="true">æ®µè¡¨å’Œé¡µè¡¨</figcaption></figure></li><li><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127150539225.png"alt="åœ°å€è½¬æ¢" /><figcaption aria-hidden="true">åœ°å€è½¬æ¢</figcaption></figure></li><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127150648346.png" /></li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾å¤‡ç®¡ç†</title>
      <link href="/2023/02/12/nju-course-review-notes/os/device-management/"/>
      <url>/2023/02/12/nju-course-review-notes/os/device-management/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¾å¤‡ç®¡ç†åŸºç¡€">4.1 è®¾å¤‡ç®¡ç†åŸºç¡€</h2><h3 id="è®¾å¤‡ç®¡ç†æ¦‚è¿°">4.1.1 è®¾å¤‡ç®¡ç†æ¦‚è¿°</h3><ul><li><p><strong>I/Oè®¾å¤‡</strong>ï¼šè¾“å…¥è¾“å‡ºè®¾å¤‡ã€å¤–å›´è®¾å¤‡ã€å¤–éƒ¨è®¾å¤‡ã€å¤–è®¾ã€‚ç”¨äºè®¡ç®—æœºç³»ç»Ÿä¸å¤–éƒ¨ä¸–ç•Œçš„ä¿¡æ¯äº¤æ¢æˆ–å­˜å‚¨ã€‚</p></li><li><p><strong>I/Oç³»ç»Ÿ</strong>ï¼šI/Oè®¾å¤‡åŠå…¶æ¥å£çº¿è·¯ã€æ§åˆ¶éƒ¨ä»¶ã€é€šé“å’Œç®¡ç†è½¯ä»¶</p></li><li><p><strong>I/Oæ“ä½œ</strong>ï¼šå†…å­˜å’Œå¤–è®¾é—´çš„ä¿¡æ¯ä¼ é€æ“ä½œã€‚</p><ul><li>å½±å“è®¡ç®—æœºç³»ç»Ÿçš„<u>é€šç”¨æ€§</u>å’Œ<u>å¯æ‰©å……æ€§</u></li><li>å½±å“è®¡ç®—æœºç³»ç»Ÿçš„<u>ç»¼åˆå¤„ç†èƒ½åŠ›åŠæ€§ä»·æ¯”</u></li></ul></li></ul><h4 id="ioè®¾å¤‡åˆ†ç±»">I/Oè®¾å¤‡åˆ†ç±»</h4><h5 id="ä¿¡æ¯ä¼ è¾“è§†è§’">ä¿¡æ¯ä¼ è¾“è§†è§’</h5><ul><li>è¾“å…¥è®¾å¤‡ï¼šé”®ç›˜ã€é¼ æ ‡ã€æ‰«æä»ª</li><li>è¾“å‡ºè®¾å¤‡ï¼šæ˜¾ç¤ºå™¨ã€æ‰“å°æœº</li><li>è¾“å…¥è¾“å‡ºè®¾å¤‡ï¼šç£ç›˜é©±åŠ¨å™¨ã€ç½‘å¡</li></ul><h5 id="äº¤äº’åŠŸèƒ½è§†è§’">äº¤äº’åŠŸèƒ½è§†è§’</h5><ul><li>äººæœºäº¤äº’è®¾å¤‡ï¼šé¼ æ ‡ã€é”®ç›˜ã€æ˜¾ç¤ºå™¨</li><li>å­˜å‚¨è®¾å¤‡ï¼ˆ==å­˜å‚¨å¤§é‡ä¿¡æ¯å¹¶å¿«é€Ÿæ£€ç´¢==ï¼‰ï¼šç£ç›˜é©±åŠ¨å™¨ã€å…‰ç›˜é©±åŠ¨å™¨</li><li>æœºæœºé€šä¿¡è®¾å¤‡ï¼šç½‘å¡ã€è°ƒåˆ¶è§£è°ƒå™¨</li></ul><h5 id="è®¾å¤‡ç®¡ç†è§†è§’">è®¾å¤‡ç®¡ç†è§†è§’</h5><ul><li>å­—ç¬¦è®¾å¤‡ï¼šé¼ æ ‡ã€æ˜¾ç¤ºå™¨ï¼Œä»¥==å­—ç¬¦ä¸ºå•ä½==è¿›è¡Œä¿¡æ¯äº¤æ¢</li><li>å—è®¾å¤‡ï¼šç£ç›˜ï¼Œä»¥å›ºå®šå¤§å°çš„==æ•°æ®å—ä¸ºå•ä½==è¿›è¡Œä¿¡æ¯äº¤æ¢</li><li>ç½‘ç»œè®¾å¤‡ï¼šæœºæœºé€šä¿¡è®¾å¤‡ï¼ˆç½‘å¡ï¼‰ï¼Œå³å¯æŠ½è±¡ä¸º å­—ç¬¦è®¾å¤‡ ä¹Ÿå¯æŠ½è±¡ä¸ºå—è®¾å¤‡</li></ul><h4 id="è®¾å¤‡ç®¡ç†çš„ç›®æ ‡">è®¾å¤‡ç®¡ç†çš„ç›®æ ‡</h4><ol type="1"><li><strong>è§£å†³è®¾å¤‡ä¸CPUé€Ÿåº¦çš„ä¸åŒ¹é…ï¼Œä½¿ä¸»æœºå’Œè®¾å¤‡å……åˆ†å¹¶è¡Œå·¥ä½œï¼Œæé«˜è®¾å¤‡ä½¿ç”¨æ•ˆç‡</strong></li><li>æ“ä½œç³»ç»Ÿå°†æ‰€æœ‰è®¾å¤‡éƒ½å®šä¹‰ä¸ºæ–‡ä»¶ï¼Œç»Ÿä¸€åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸‹</li><li>å±è”½è®¾å¤‡çš„ç‰©ç†ç»†èŠ‚å’Œæ“ä½œè¿‡ç¨‹ï¼Œé…ç½®é©±åŠ¨ç¨‹åºï¼Œæä¾›ç»Ÿä¸€ç•Œé¢<ol type="1"><li>æŠ½è±¡ä¸ºè£¸è®¾å¤‡</li><li>æŠ½è±¡ä¸ºè®¾å¤‡æ–‡ä»¶</li></ol></li></ol><h4 id="è®¾å¤‡ç®¡ç†çš„åŠŸèƒ½">è®¾å¤‡ç®¡ç†çš„åŠŸèƒ½</h4><ol type="1"><li>è®¾å¤‡ä¸­æ–­å¤„ç†</li><li>ç¼“å†²åŒºç®¡ç†</li><li>è®¾å¤‡çš„åˆ†é…å’Œå»é…</li><li>è®¾å¤‡é©±åŠ¨è°ƒåº¦</li><li>è™šæ‹Ÿè®¾å¤‡çš„å®ç°</li></ol><h4 id="è®¾å¤‡ç®¡ç†çš„å®ç°å±‚æ¬¡">è®¾å¤‡ç®¡ç†çš„å®ç°å±‚æ¬¡</h4><ul><li>I/Oç¡¬ä»¶<ul><li>I/Oè®¾å¤‡åŠå…¶æ¥å£è·¯çº¿</li><li>æ§åˆ¶éƒ¨ä»¶</li><li>é€šé“</li></ul></li><li>I/Oè½¯ä»¶<ul><li>ç³»ç»ŸI/Oè½¯ä»¶</li><li>ç”¨æˆ·ç©ºé—´I/Oè½¯ä»¶</li></ul></li></ul><h3 id="ioæ§åˆ¶æ–¹å¼">4.1.2 I/Oæ§åˆ¶æ–¹å¼</h3><h4 id="è®¾å¤‡æ§åˆ¶å™¨">è®¾å¤‡æ§åˆ¶å™¨</h4><p>ä¼˜åŠ¿ï¼šå¼•å…¥æ§åˆ¶å™¨åï¼Œé€šè¿‡ä¼ é€’ç®€å•å‚æ•°å°±å¯è¿›è¡ŒI/Oæ“ä½œï¼Œå¤§å¤§ç®€åŒ–ç³»ç»Ÿçš„è®¾è®¡ï¼Œæœ‰åˆ©äºè®¡ç®—æœºç³»ç»Ÿå¯¹å„ç±»æ§åˆ¶å™¨å’Œè®¾å¤‡çš„å…¼å®¹æ€§</p><p>æ¨¡å—åŒ–å’Œé€šç”¨æ€§çš„è®¾è®¡ç›®æ ‡ =ã€‹æœºæ¢°éƒ¨ä»¶ + ==ç”µå­éƒ¨ä»¶==</p><p><strong>ç”µå­éƒ¨ä»¶</strong>ï¼š==è®¾å¤‡æ§åˆ¶å™¨==ï¼›<u>ç³»ç»Ÿä¸è®¾å¤‡æ§åˆ¶å™¨äº¤äº’</u>ï¼›è®¾å¤‡æ§åˆ¶å™¨å…·ä½“æ§åˆ¶è®¾å¤‡è¿›è¡ŒI/Oã€‚</p><p>è®¾å¤‡æ§åˆ¶å™¨æ˜¯ CPU å’Œ è®¾å¤‡ä¹‹é—´çš„æ¥å£ï¼Œå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ol type="1"><li>æ¥æ”¶å’Œè¯†åˆ« CPUæˆ–é€šé“ å‘æ¥çš„å‘½ä»¤ =ã€‹æ§åˆ¶å¯„å­˜å™¨</li><li>å®ç°æ•°æ®äº¤æ¢ =ã€‹ æ•°æ®å¯„å­˜å™¨</li><li>å‘ç°å’Œè®°å½•è®¾å¤‡åŠè‡ªèº«çš„çŠ¶æ€ä¿¡æ¯ï¼Œä¾›CPUå¤„ç†æ—¶ä½¿ç”¨ =ã€‹çŠ¶æ€å¯„å­˜å™¨</li><li>å½“è¿æ¥å¤šå°è®¾å¤‡æ—¶ï¼Œè¯†åˆ«è®¾å¤‡åœ°å€ =ã€‹å¯¹å¯„å­˜å™¨å¯»å€</li></ol><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E5%99%A8%E7%BB%84%E6%88%90.png"alt="è®¾å¤‡æ§åˆ¶å™¨çš„ç»„æˆ" /><figcaption aria-hidden="true">è®¾å¤‡æ§åˆ¶å™¨çš„ç»„æˆ</figcaption></figure><blockquote><p>æ³¨æ„ï¼šä¸€ä¸ªI/Oæ§åˆ¶å™¨å¯èƒ½å¯¹åº”å¤šä¸ªè®¾å¤‡ï¼›æ•°æ®å¯„å­˜å™¨ã€çŠ¶æ€å¯„å­˜å™¨å’Œæ§åˆ¶å¯„å­˜å™¨ä¹Ÿå¯èƒ½æœ‰å¤šä¸ªã€‚</p></blockquote><h4 id="ioæ§åˆ¶æ–¹å¼-1">I/Oæ§åˆ¶æ–¹å¼</h4><h5 id="è½®è¯¢æ–¹å¼">è½®è¯¢æ–¹å¼</h5><p>==CPUå’ŒI/Oè®¾å¤‡ä¸²è¡Œæ“ä½œ==</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222163641779.png"alt="è½®è¯¢æ–¹å¼" /><figcaption aria-hidden="true">è½®è¯¢æ–¹å¼</figcaption></figure><blockquote><p>è¯»å†™æ•°æ®ï¼š1ã€ä»I/Oæ¨¡å—ä¸­è¯»å–å­— 2ã€å¾€å­˜å‚¨å™¨ä¸­å†™å…¥å­—</p></blockquote><h5 id="ä¸­æ–­æ–¹å¼">ä¸­æ–­æ–¹å¼</h5><p>==CPUä¸I/Oè®¾å¤‡å¹¶è¡Œå·¥ä½œ==</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222163707920.png"alt="ä¸­æ–­æ–¹å¼" /><figcaption aria-hidden="true">ä¸­æ–­æ–¹å¼</figcaption></figure><p>å¤„ç†å™¨å‘é€æŒ‡ä»¤ç»™æ§åˆ¶å™¨ï¼Œç„¶åç»§ç»­æ‰§è¡ŒæŒ‡ä»¤=ã€‹I/Oæ“ä½œå®Œæˆåï¼Œæ§åˆ¶å™¨å‘èµ·ä¸­æ–­è¯·æ±‚ =ã€‹...</p><blockquote><p>ä¸€æ—¦æ¶‰åŠå¤§é‡æ•°æ®ä¼ è¾“ï¼Œå°±ä¼šéœ€è¦é¢‘ç¹çš„ä¸­æ–­å¤„ç†ï¼Œæ¶ˆè€—è¾ƒå¤šCPUçš„æ—¶é—´</p></blockquote><h5 id="dmaæ–¹å¼">DMAæ–¹å¼</h5><blockquote><p>DMAï¼šDirect Memory Access ç›´æ¥å­˜å‚¨å™¨å­˜å–</p></blockquote><p>å†…å­˜å’Œè®¾å¤‡ä¹‹é—´æœ‰ä¸€æ¡æ•°æ®é€šè·¯==æˆå—==åœ°ä¼ é€æ•°æ®ï¼Œæ— é¡»CPUå¹²é¢„ï¼Œå®é™…æ•°æ®ä¼ è¾“æ“ä½œç”±DMAç›´æ¥å®Œæˆã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165648687.png"alt="DMAæ–¹å¼" /><figcaption aria-hidden="true">DMAæ–¹å¼</figcaption></figure><p>å¤„ç†å™¨å‘DMAå‘å‡ºI/Oå‘½ä»¤ï¼Œç»§ç»­è‡ªå·±çš„å·¥ä½œ =ã€‹DMAå®Œæˆæ•°æ®ä¼ è¾“åï¼Œä¸­æ–­å¤„ç†å™¨</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165629970.png"alt="DMAæ§åˆ¶å™¨" /><figcaption aria-hidden="true">DMAæ§åˆ¶å™¨</figcaption></figure><blockquote><p>æ³¨æ„ï¼šDMAæ§åˆ¶å™¨å¹¶ä¸æ˜¯æ¯æ¬¡ç›´æ¥è¯»å…¥ä¸€æ•´å—çš„æ•°æ®ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„ä¼ è¾“ï¼Œä»I/Oè®¾å¤‡ =ã€‹DR =ã€‹å†…å­˜</p><p>ä¸€æ¬¡è¯»å†™ä¸€ä¸ªæˆ–å¤šä¸ªå—ï¼ˆ<strong>å¤šä¸ªå—å¿…é¡»æ˜¯è¿ç»­çš„</strong>ï¼‰</p></blockquote><p>==å‘¨æœŸçªƒå–==ï¼šåŒæ—¶é€šè¿‡æ€»çº¿è®¿é—®ä¸»å­˜æ—¶ï¼ŒCPUè®©å‡ºæ€»çº¿å æœ‰æƒç»™DMA</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125185725792.png" /></p><p><strong>DMAçš„æ€»çº¿ç±»å‹</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125185818229.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125185834509.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125185901377.png" /></p><h5 id="ioé€šé“">I/Oé€šé“</h5><p>==é€šé“æ§åˆ¶å™¨==ï¼Œç”¨äºå®Œæˆé€»è¾‘ä¸Šç‹¬ç«‹çš„I/Oä»»åŠ¡ã€‚</p><p>ä¸»æœºã€é€šé“ã€æ§åˆ¶å™¨å’Œè®¾å¤‡ä¹‹é—´é‡‡ç”¨å››çº§è¿æ¥ï¼Œå®æ–½ä¸‰çº§æ§åˆ¶ï¼Œä¸€ä¸ªCPUè¿æ¥è‹¥å¹²ä¸ªé€šé“ï¼Œä¸€ä¸ªé€šé“è¿æ¥è‹¥å¹²ä¸ªæ§åˆ¶å™¨ï¼Œä¸€ä¸ªæ§åˆ¶å™¨è¿æ¥è‹¥å¹²ä¸ªè®¾å¤‡ã€‚</p><p><strong>å¤„ç†å™¨ä¸å†æ‰§è¡ŒI/OæŒ‡ä»¤ï¼Œè€Œæ˜¯åœ¨ä¸»å­˜ä¸­ç»„ç»‡é€šé“ç¨‹åºï¼Œç”±I/Oé€šé“æ‰§è¡Œï¼ŒCPUä¸é€šé“é«˜åº¦å¹¶è¡Œå·¥ä½œ</strong></p><p>CPUå¯åŠ¨æŒ‡å®šé€šé“ä¸Šçš„è®¾å¤‡ï¼Œé€šé“æ§åˆ¶è®¾å¤‡è¿›è¡Œæ“ä½œï¼ŒCPUæ‰§è¡Œå…¶ä»–ä»»åŠ¡ =ã€‹I/Oæ“ä½œå®Œæˆï¼Œä¸­æ–­å¤„ç†å™¨å¤„ç†I/Oæ“ä½œç»“æŸäº‹ä»¶ã€‚</p><table><thead><tr class="header"><th>CPUä½œç”¨</th><th>ç­‰å¾…è®¾å¤‡</th><th>å†…å­˜æ•°æ®äº¤æ¢</th></tr></thead><tbody><tr class="odd"><td>è½®è¯¢æ–¹å¼</td><td>éœ€è¦</td><td>éœ€è¦</td></tr><tr class="even"><td>ä¸­æ–­æ–¹å¼</td><td>ä¸éœ€è¦</td><td>éœ€è¦</td></tr><tr class="odd"><td>DMAæ–¹å¼</td><td>ä¸éœ€è¦</td><td>ä¸éœ€è¦</td></tr><tr class="even"><td>I/Oé€šé“</td><td>ä¸éœ€è¦</td><td>ä¸éœ€è¦</td></tr></tbody></table><h4 id="ioåŠŸèƒ½çš„æ¼”åŒ–">I/OåŠŸèƒ½çš„æ¼”åŒ–</h4><ol type="1"><li><p>å¤„ç†å™¨ç›´æ¥æ§åˆ¶å¤–å›´è®¾å¤‡</p></li><li><p>å¢åŠ äº†æ§åˆ¶å™¨æˆ–I/Oæ¨¡å—ï¼š<u>ç¨‹åºæ§åˆ¶</u></p><blockquote><p>å¤„ç†å™¨å¼€å§‹ä»å¤–å›´è®¾å¤‡æ¥å£çš„å…·ä½“ç»†èŠ‚ä¸­åˆ†ç¦»å‡ºæ¥</p></blockquote></li><li><p>é‡‡ç”¨<u>ä¸­æ–­æ–¹å¼</u>çš„æ§åˆ¶å™¨æˆ–I/Oæ¨¡å—</p></li><li><p>I/Oæ¨¡å—é€šè¿‡<u>DMA</u>ç›´æ¥æ§åˆ¶å­˜å‚¨å™¨</p></li><li><p>I/Oæ¨¡å—è¢«å¢å¼ºä¸ºå•ç‹¬çš„å¤„ç†å™¨ï¼Œæœ‰ä¸“é—¨ä¸ºI/Oè®¾è®¡çš„æŒ‡ä»¤é›†</p></li><li><p>I/Oæ¨¡å—æœ‰è‡ªå·±çš„å±€éƒ¨å­˜å‚¨å™¨ï¼Œæœ¬èº«å°±æ˜¯ä¸€å°è®¡ç®—æœº</p></li></ol><h3 id="æ€»çº¿ä¸io">4.1.3 æ€»çº¿ä¸I/O</h3><h4 id="å•æ€»çº¿ç»“æ„">å•æ€»çº¿ç»“æ„</h4><p>å°†CPUã€ä¸»å­˜å’ŒI/Oæ¨¡å—è¿æ¥åˆ°åŒä¸€æ€»çº¿</p><p>ä¼˜ç‚¹ï¼šç»“æ„ç®€å•ï¼Œæ˜“äºæ‰©å……</p><p>ç¼ºç‚¹ï¼šå…±ç”¨æ€»çº¿ï¼Œè®¾å¤‡å¤šæ—¶æ€»çº¿å‹åŠ›å¤§ï¼Œä¼ è¾“æ—¶å»¶é•¿ï¼Œä¸”æ…¢é€Ÿå¤–è®¾å ç”¨å¸¦å®½å¤š</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165730821.png"alt="å•æ€»çº¿ç»“æ„" /><figcaption aria-hidden="true">å•æ€»çº¿ç»“æ„</figcaption></figure><blockquote><p>å¾…è¡¥å……</p></blockquote><h2 id="è®¾å¤‡ç®¡ç†è½¯ä»¶">4.2 è®¾å¤‡ç®¡ç†è½¯ä»¶</h2><h3 id="ioè½¯ä»¶çš„å®ç°å±‚æ¬¡">4.2.1 I/Oè½¯ä»¶çš„å®ç°å±‚æ¬¡</h3><h4 id="ioè½¯ä»¶çš„è®¾è®¡ç›®æ ‡">I/Oè½¯ä»¶çš„è®¾è®¡ç›®æ ‡</h4><ul><li>è®¾è®¡ç›®æ ‡<ul><li>é«˜æ•ˆæ€§ï¼šæœ€å…³æ³¨ç£ç›˜I/Oçš„æ•ˆç‡</li><li>é€šç”¨æ€§ï¼šç”¨ç»Ÿä¸€æ ‡å‡†çš„æ–¹æ³•æ¥ç®¡ç†æ‰€æœ‰è®¾å¤‡</li></ul></li><li>è®¾è®¡æ€è·¯ï¼šå±‚æ¬¡ç»“æ„ï¼Œä½å±‚è½¯ä»¶å±è”½ç¡¬ä»¶ç»†èŠ‚ï¼Œé«˜å±‚è½¯ä»¶ä¸ç”¨æˆ·å‹å¥½äº¤äº’</li><li>ä¸»è¦é—®é¢˜<ul><li>è®¾å¤‡æ— å…³æ€§<ul><li>è®¿é—®è®¾å¤‡çš„ç¨‹åºä¸å…·ä½“ç‰©ç†è®¾å¤‡æ— å…³</li></ul></li><li>å‡ºé”™å¤„ç†<ul><li>æ•°æ®ä¼ è¾“ä¸­çš„é”™è¯¯åº”è¯¥å°½å¯èƒ½åœ¨é è¿‘ç¡¬ä»¶çš„åœ°æ–¹å¤„ç†ï¼Œå°½é‡åœ¨ä½å±‚æ¬¡å¤„ç†</li></ul></li><li>åŒæ­¥ï¼ˆé˜»å¡ï¼‰â€”â€”å¼‚æ­¥ï¼ˆä¸­æ–­é©±åŠ¨ï¼‰ä¼ è¾“<ul><li>å¼‚æ­¥ä¼ è¾“ï¼šCPUå¯åŠ¨I/Oåå¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–å·¥ä½œï¼Œç›´åˆ°ä¸­æ–­åˆ°è¾¾</li><li>åŒæ­¥ä¼ è¾“ï¼šé˜»å¡æ–¹å¼ï¼Œè®©å¯åŠ¨I/Oçš„è¿›ç¨‹é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ•°æ®ä¼ è¾“å®Œæˆ</li></ul></li><li>ç‹¬å å‹å¤–å›´è®¾å¤‡å’Œå…±äº«å‹å¤–å›´è®¾å¤‡<ul><li>å»ºç«‹æ•°æ®ç¼“å†²åŒºï¼Œè®©æ•°æ®åˆ°è¾¾ä¸ç¦»å»ç‡ç›¸åŒ¹é…ï¼Œæé«˜ç³»ç»Ÿååç‡</li></ul></li></ul></li></ul><h4 id="ioè½¯ä»¶çš„å±‚æ¬¡ç»“æ„">I/Oè½¯ä»¶çš„å±‚æ¬¡ç»“æ„</h4><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126103415450.png"alt="I/Oè®¾å¤‡å±‚æ¬¡ç»“æ„" /><figcaption aria-hidden="true">I/Oè®¾å¤‡å±‚æ¬¡ç»“æ„</figcaption></figure><h3 id="ioè½¯ä»¶çš„å®ç°">4.2.2 I/Oè½¯ä»¶çš„å®ç°</h3><h4 id="ioä¸­æ–­é©±åŠ¨ç¨‹åº">I/Oä¸­æ–­é©±åŠ¨ç¨‹åº</h4><ul><li>ä½äºæ“ä½œç³»ç»Ÿåº•å±‚ï¼Œä¸ç¡¬ä»¶å¯†åˆ‡ç›¸å…³</li><li>è®¾å¤‡å‘CPUæå‡ºä¸­æ–­è¯·æ±‚æ—¶ï¼ŒCPUå“åº”å¹¶è½¬å…¥ä¸­æ–­å¤„ç†ç¨‹åºæ‰§è¡Œï¼Œé€šå¸¸åšçš„å·¥ä½œ<ul><li>æ£€æŸ¥è®¾å¤‡çŠ¶æ€å¯„å­˜å™¨ï¼Œåˆ¤æ–­ä¸­æ–­åŸå› </li><li><u>è‹¥ä¼ è¾“æœ‰é”™</u>ï¼šå‘ä¸Šå±‚è½¯ä»¶æŠ¥å‘Šè®¾å¤‡çš„å‡ºé”™ä¿¡æ¯ï¼Œå®æ–½é‡æ–°æ‰§è¡Œ</li><li><u>è‹¥æ­£å¸¸ç»“æŸ</u>ï¼šå”¤é†’ç­‰å¾…ä¼ è¾“çš„è¿›ç¨‹ï¼Œä½¿å…¶è½¬æ¢ä¸ºå°±ç»ªæ€</li><li><u>è‹¥æœ‰ç­‰å¾…ä¼ è¾“çš„I/Oå‘½ä»¤</u>ï¼šé€šçŸ¥ç›¸å…³è½¯ä»¶å¯åŠ¨ä¸‹ä¸€ä¸ªI/Oè¯·æ±‚</li></ul></li></ul><h4 id="è®¾å¤‡é©±åŠ¨ç¨‹åº">è®¾å¤‡é©±åŠ¨ç¨‹åº</h4><ul><li>åŒ…æ‹¬ä¸è®¾å¤‡å¯†åˆ‡ç›¸å…³çš„æ‰€æœ‰ä»£ç </li><li><strong>æŠŠç”¨æˆ·æäº¤çš„é€»è¾‘I/Oè¯·æ±‚è½¬åŒ–ä¸ºç‰©ç†I/Oæ“ä½œçš„å¯åŠ¨å’Œæ‰§è¡Œ</strong>ï¼Œå¦‚è®¾å¤‡å=ã€‹ç«¯å£åœ°å€ï¼Œé€»è¾‘è®°å½•=ã€‹ç‰©ç†è®°å½•ï¼Œé€»è¾‘æ“ä½œ=ã€‹ç‰©ç†æ“ä½œ</li></ul><h4 id="ç‹¬ç«‹äºè®¾å¤‡çš„ioè½¯ä»¶">ç‹¬ç«‹äºè®¾å¤‡çš„I/Oè½¯ä»¶</h4><ul><li>å¯¹è®¾å¤‡é©±åŠ¨ç¨‹åºçš„ç»Ÿä¸€æ¥å£</li><li><strong>è®¾å¤‡å‘½å</strong><ul><li><u>è®¾å¤‡éƒ½è¢«çœ‹ä½œæ–‡ä»¶</u>ï¼Œé€šè¿‡è·¯å¾„åè¿›è¡Œå¯»å€</li><li>è®¾å¤‡ä¸ä»…å…·æœ‰æ–‡ä»¶åï¼Œ<u>ä¸”æ”¯æŒä¸æ–‡ä»¶ç›¸å…³çš„æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨</u>ï¼Œopenã€closeã€readç­‰</li><li>è®¾å¤‡æ–‡ä»¶ä¾èµ–äºinodeæ¥å®ç°ï¼Œæ–‡ä»¶ç›®å½•å¹¶ä¸èƒ½åŒºåˆ†æ–‡ä»¶åæ˜¯ä»£è¡¨ä¸€ä¸ªç£ç›˜æ–‡ä»¶æˆ–è®¾å¤‡æ–‡ä»¶ã€‚ä½†æ˜¯inodeä¸­çš„å†…å®¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œç£ç›˜æ–‡ä»¶çš„inodeåŒ…å«æŒ‡å‘æ•°æ®å—çš„æŒ‡é’ˆï¼Œè€Œè®¾å¤‡æ–‡ä»¶çš„inodeåˆ™åŒ…å«æŒ‡å‘å†…æ ¸è®¾å¤‡é©±åŠ¨ç¨‹åºçš„æŒ‡é’ˆï¼Œç”¨æ¥æ§åˆ¶è®¾å¤‡çš„I/O</li></ul></li><li><strong>è®¾å¤‡ä¿æŠ¤</strong><ul><li>è®¾å¤‡ä¿æŠ¤éœ€è¦æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒè®¿é—®æ‰€ç”³è¯·çš„è®¾å¤‡ï¼ˆI/OæŒ‡ä»¤æ˜¯ç‰¹æƒæŒ‡ä»¤ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨é—´æ¥ä¾›ç”¨æˆ·ä½¿ç”¨ï¼‰</li><li>Unix/Linuxä¸­å¯¹I/Oè®¾å¤‡çš„ç‰¹åˆ«æ–‡ä»¶é‡‡ç”¨rwxä¿æŠ¤æœºåˆ¶ï¼Œå¯¹æ–‡ä»¶çš„ä¿æŠ¤è§„åˆ™ä¹Ÿé€‚ç”¨äºI/Oè®¾å¤‡</li></ul></li><li>æä¾›ä¸è®¾å¤‡æ— å…³çš„å—å°ºå¯¸<ul><li>å±è”½ä¸åŒç£ç›˜æ‰‡åŒºå¤§å°å¹¶å‘é«˜å±‚è½¯ä»¶æä¾›ç»Ÿä¸€å¤§å°çš„é€»è¾‘å—</li></ul></li><li>ç¼“å†²åŒºç®¡ç†<ul><li>é€šè¿‡ç¼“å†²åŒºæ¥æ¶ˆé™¤å¡«æ»¡é€Ÿç‡å’Œæ¸…ç©ºé€Ÿç‡ä¹‹é—´çš„å½±å“ï¼Œå—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡éƒ½éœ€è¦ç¼“å†²æŠ€æœ¯ï¼Œå¯åœ¨ä¸»å­˜å»ºç«‹ç¼“å†²åŒºçš„æ–¹å¼è§£å†³</li></ul></li><li>åˆ†é…ä¸çŠ¶æ€è·Ÿè¸ª<ul><li>é™æ€ã€åŠ¨æ€ã€è™šæ‹Ÿåˆ†é…</li></ul></li><li>å‡ºé”™å¤„ç†å’ŒæŠ¥å‘Š<ul><li>é”™è¯¯å¤„ç†å¤šæ•°ç”±é©±åŠ¨ç¨‹åºå®Œæˆï¼Œä½å±‚è½¯ä»¶å®Œæˆä¸äº†çš„æƒ…å†µï¼Œäº¤ç»™é«˜å±‚è½¯ä»¶å¤„ç†</li></ul></li></ul><h4 id="ç”¨æˆ·ç©ºé—´çš„ioè½¯ä»¶">ç”¨æˆ·ç©ºé—´çš„I/Oè½¯ä»¶</h4><ul><li>åº“å‡½æ•°å®ç°çš„I/Oç³»ç»Ÿè°ƒç”¨</li><li>åº“å‡½æ•°å°†ä¸åº”ç”¨ç¨‹åºé“¾æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆå¯æ‰§è¡Œä»£ç è£…å…¥ä¸»å­˜ï¼Œåº“å‡½æ•°ä¹Ÿæ˜¯I/Oç³»ç»Ÿçš„ä¸€éƒ¨åˆ†</li><li><strong>åº“å‡½æ•°æ‰€åšçš„å·¥ä½œåªæ˜¯å°†ç³»ç»Ÿè°ƒç”¨æ‰€éœ€è¦çš„å‚æ•°æ”¾åœ¨åˆé€‚çš„ä½ç½®ï¼Œç„¶åé™·å…¥å†…æ ¸ï¼Œç”±å†…æ ¸å‡½æ•°å®ç°çœŸæ­£çš„I/Oæ“ä½œ</strong></li></ul><h3 id="ioç¼“å†²">I/Oç¼“å†²</h3><h4 id="ç›®çš„">ç›®çš„</h4><ol type="1"><li>è§£å†³CPUä¸è®¾å¤‡ä¹‹é—´é€Ÿåº¦ä¸åŒ¹é…çš„çŸ›ç›¾</li><li>åè°ƒé€»è¾‘è®°å½•å¤§å°ä¸ç‰©ç†è®°å½•å¤§å°ä¸ä¸€è‡´çš„é—®é¢˜</li><li>æé«˜CPUå’Œè®¾å¤‡çš„å¹¶è¡Œæ€§</li><li>å‡å°‘I/Oæ“ä½œå¯¹CPUçš„ä¸­æ–­æ¬¡æ•°</li><li>æ”¾å®½å¯¹CPUä¸­æ–­å“åº”æ—¶é—´çš„è¦æ±‚</li></ol><blockquote><p>é¢å‘å—ï¼šæ•°æ®å­˜å‚¨å’Œä¼ é€ä»¥å—ä¸ºå•ä½ï¼Œå—çš„å¤§å°é€šå¸¸å›ºå®šï¼Œå¯ä»¥é€šè¿‡å—å·è®¿é—®æ•°æ®ï¼ˆç£ç›˜å’Œç£å¸¦ï¼‰</p><p>é¢å‘æµï¼šè®¾å¤‡ä»¥å­—èŠ‚æµçš„æ–¹å¼ä¼ è¾“æ•°æ®ï¼ˆç»ˆç«¯ã€æ‰“å°æœºã€é€šä¿¡ç«¯å£ã€é¼ æ ‡å’Œ<u>å…¶ä»–æŒ‡ç¤ºè®¾å¤‡</u>ä»¥åŠå¤§å¤šæ•°<u>éè¾…å­˜çš„å…¶ä»–è®¾å¤‡</u>ï¼‰</p></blockquote><h4 id="ioç¼“å†²åŒº">I/Oç¼“å†²åŒº</h4><p>åœ¨å†…å­˜ä¸­å¼€è¾Ÿçš„å­˜å‚¨åŒºï¼Œä¸“é—¨ç”¨äºä¸´æ—¶å­˜æ”¾I/Oæ“ä½œçš„æ•°æ®</p><h4 id="å•ç¼“å†²æŠ€æœ¯">å•ç¼“å†²æŠ€æœ¯</h4><p>è¾“å…¥ä¼ é€çš„æ•°æ®æ”¾åˆ°ç¼“å†²åŒºä¸­ï¼Œä¼ é€å®Œæˆæ—¶ï¼Œè¿›ç¨‹å°†è¯¥å—ç§»åŠ¨åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå¹¶ç«‹å³è¯·æ±‚å¦ä¸€å—ï¼Œç§°ä¸ºè¶…å‰ï¼ˆé¢„å…ˆè¾“å…¥ï¼‰</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165818611.png"alt="å•ç¼“å†²æŠ€æœ¯" /><figcaption aria-hidden="true">å•ç¼“å†²æŠ€æœ¯</figcaption></figure><h4 id="åŒç¼“å†²æŠ€æœ¯">åŒç¼“å†²æŠ€æœ¯</h4><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165839461.png"alt="åŒç¼“å†²æŠ€æœ¯" /><figcaption aria-hidden="true">åŒç¼“å†²æŠ€æœ¯</figcaption></figure><h4 id="å¾ªç¯ç¼“å†²æŠ€æœ¯">å¾ªç¯ç¼“å†²æŠ€æœ¯</h4><p>ä½¿å¾—I/Oæ“ä½œèƒ½å¤Ÿè·Ÿå¾—ä¸Šè¿›ç¨‹çš„æ‰§è¡Œ</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230222165856069.png"alt="å¾ªç¯ç¼“å†²æŠ€æœ¯" /><figcaption aria-hidden="true">å¾ªç¯ç¼“å†²æŠ€æœ¯</figcaption></figure><h2 id="ç‹¬å å‹å¤–å›´è®¾å¤‡çš„åˆ†é…">4.3 ç‹¬å å‹å¤–å›´è®¾å¤‡çš„åˆ†é…</h2><blockquote><p>è®¾å¤‡åˆ†é…</p><ul><li>è®¾å¤‡ç‰¹æ€§ï¼šç‹¬å è®¾å¤‡ã€å…±äº«è®¾å¤‡å’Œè™šæ‹Ÿè®¾å¤‡ä¸‰ç±»</li><li>ç®¡ç†å’Œåˆ†é…å¤–å›´è®¾å¤‡çš„æŠ€æœ¯ï¼šç‹¬å æ–¹å¼ã€å…±äº«æ–¹å¼å’Œè™šæ‹Ÿæ–¹å¼</li></ul></blockquote><h3 id="è®¾å¤‡ç‹¬ç«‹æ€§">4.3.1 è®¾å¤‡ç‹¬ç«‹æ€§</h3><p>ç”¨æˆ·é€šå¸¸ä¸æŒ‡å®šç‰©ç†è®¾å¤‡ï¼Œè€Œæ˜¯<u>æŒ‡å®šé€»è¾‘è®¾å¤‡</u>ï¼Œä½¿å¾—ç”¨æˆ·è¿›ç¨‹å’Œç‰©ç†è®¾å¤‡åˆ†ç¦»å¼€æ¥ï¼Œå†é€šè¿‡å…¶ä»–é€”å¾„å»ºç«‹é€»è¾‘è®¾å¤‡å’Œç‰©ç†è®¾å¤‡ä¹‹é—´çš„æ˜ å°„ï¼ˆç³»ç»Ÿéœ€è¦æä¾›é€»è¾‘è®¾å¤‡åå’Œç‰©ç†è®¾å¤‡åçš„å¯¹åº”è¡¨ï¼‰</p><p>åŸå› ï¼šå¦‚æœç›´æ¥æŒ‡å®šæŸä¸ªç‰©ç†è®¾å¤‡çš„è¯ï¼Œè™½ç„¶ä¼šè®©è®¾å¤‡åˆ†é…å˜å¾—ç®€å•ï¼Œä½†æ˜¯ä¸€æ—¦è¯¥ç‰©ç†è®¾å¤‡å‡ºç°æ•…éšœï¼Œå³ä½¿ç³»ç»Ÿä¸­å­˜åœ¨åŒç±»è®¾å¤‡ä¹Ÿä¸èƒ½è¿è¡Œ</p><p>ä¼˜ç‚¹ï¼š1ã€<strong>åº”ç”¨ç¨‹åºå’Œå…·ä½“ç‰©ç†è®¾å¤‡æ— å…³</strong>ï¼Œå˜æ›´è®¾å¤‡æ—¶ä¸éœ€è¦ä¿®æ”¹æºç ã€‚2ã€<strong>æ˜“äºåº”å¯¹å„ç§I/Oè®¾å¤‡æ•…éšœ</strong>ï¼Œæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€‚3ã€<strong>å¢åŠ è®¾å¤‡åˆ†é…çš„çµæ´»æ€§</strong>ï¼Œæœ‰åˆ©äºæ›´åŠ æœ‰æ•ˆåœ°åˆ©ç”¨è®¾å¤‡èµ„æºï¼Œå®ç°å¤šé“ç¨‹åºè®¾è®¡ã€‚</p><h3 id="ç‹¬å å‹å¤–å›´è®¾å¤‡çš„åˆ†é…-1">4.3.2 ç‹¬å å‹å¤–å›´è®¾å¤‡çš„åˆ†é…</h3><p>ç‹¬å å‹å¤–å›´è®¾å¤‡ï¼šä¸€æ¬¡åªèƒ½ç”±ä¸€ä¸ªè¿›ç¨‹ç‹¬å ä½¿ç”¨</p><p>åˆ†é…æ–¹å¼ï¼š1ã€é™æ€åˆ†é…ï¼Œè¿è¡Œå‰ç”³è¯·ï¼Œå®ç°ç®€å•ï¼Œé˜²æ­¢æ­»é”ï¼Œä½†æ˜¯é™ä½è®¾å¤‡åˆ©ç”¨ç‡</p><p>â€‹ 2ã€åŠ¨æ€åˆ†é…ï¼Œéšç”¨éšåˆ†é…ï¼Œæé«˜è®¾å¤‡åˆ©ç”¨ç‡</p><p>è®¾å¤‡åˆ†é…çš„æ•°æ®ç»“æ„ï¼šè®¾å¤‡ç±»è¡¨ï¼ˆè®°å½•å„ç±»è®¾å¤‡çš„ä¿¡æ¯ï¼‰è®¾å¤‡è¡¨ï¼ˆè®°å½•æŸä¸€ç±»è®¾å¤‡çš„ä¿¡æ¯ï¼‰</p><p><strong>è®¾å¤‡åˆ†é…ç®—æ³•</strong>ï¼ˆä¸çŸ¥é“é‡ä¸é‡è¦ï¼‰</p><ol type="1"><li>æ ¹æ®è®¾å¤‡ç±»æŸ¥æ‰¾è®¾å¤‡ç±»è¡¨</li><li>è‹¥æ— ç©ºé—²è®¾å¤‡åˆ™ç­‰å¾…è®¾å¤‡</li><li>å–å¾—è®¾å¤‡è¡¨é¦–åœ°å€</li><li>æŸ¥è®¾å¤‡è¡¨å‘ç°ç©ºé—²è®¾å¤‡æ </li><li>è‹¥æœªå‘ç°ç©ºé—²è®¾å¤‡æ åˆ™ç­‰å¾…è®¾å¤‡</li><li>å¡«å ç”¨è¿›ç¨‹å·ï¼Œé€»è¾‘è®¾å¤‡åï¼Œåˆ†é…è®¾å¤‡</li></ol><h2 id="å…±äº«å‹å¤–å›´è®¾å¤‡çš„é©±åŠ¨">4.4 å…±äº«å‹å¤–å›´è®¾å¤‡çš„é©±åŠ¨</h2><h3 id="ç£ç›˜çš„ç‰©ç†ç»“æ„">4.4.1 ç£ç›˜çš„ç‰©ç†ç»“æ„</h3><h4 id="ç£ç›˜ç»“æ„">ç£ç›˜ç»“æ„</h4><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125165707732.png"alt="ç£ç›˜" /><figcaption aria-hidden="true">ç£ç›˜</figcaption></figure><ul><li>ç£ç›˜ç”±å¤šä¸ªç›˜ç‰‡ç»„æˆ</li><li>æ¯ä¸ªç›˜ç‰‡ä¸€èˆ¬æœ‰ä¸¤ä¸ªç›˜é¢ï¼ˆä¸Šä¸‹ä¸¤ä¸ªï¼‰</li><li>ç›˜é¢åŒ…æ‹¬å¤šä¸ªåŒå¿ƒåœ†ç»“æ„çš„ç£é“</li><li>ä¸åŒç›˜é¢ä¸Šä½äºç›¸åŒä½ç½®çš„ç£é“æ„æˆæŸ±é¢</li><li>æ¯ä¸ªç£é“åˆ†ä¸ºå›ºå®šå¤šä¸ªæ‰‡åŒºï¼Œç›¸é‚»æ‰‡åŒºç»„åˆæˆç°‡</li><li>ç‰©ç†å—åœ°å€ï¼šæŸ±é¢å·ï¼Œç£å¤´å·ï¼ˆç›˜é¢å·ï¼‰ï¼Œæ‰‡åŒºå·</li></ul><h4 id="ç£ç›˜è¯»å†™æ•°æ®çš„æ–¹å¼">ç£ç›˜è¯»å†™æ•°æ®çš„æ–¹å¼</h4><ol type="1"><li>å¯»é“ï¼šæ§åˆ¶ç§»åŠ¨è‡‚åˆ°è¾¾æŒ‡å®šæŸ±é¢</li><li>æ—‹è½¬ï¼šç­‰å¾…è¦è¯»å†™çš„æ‰‡åŒºæ—‹è½¬åˆ°ç£å¤´ä¸‹</li><li>é€‰æ‹©ç£å¤´å·ï¼Œè¿›è¡Œæ•°æ®è¯»å†™</li></ol><h4 id="ç£ç›˜å­˜å–æ—¶é—´">ç£ç›˜å­˜å–æ—¶é—´</h4><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221125170404914.png"alt="ç£ç›˜å­˜å–æ—¶é—´" /><figcaption aria-hidden="true">ç£ç›˜å­˜å–æ—¶é—´</figcaption></figure><h3 id="ç£ç›˜çš„é©±åŠ¨è°ƒåº¦">4.4.2 ç£ç›˜çš„é©±åŠ¨è°ƒåº¦</h3><p>ç£ç›˜å¯èƒ½åŒæ—¶æ¥æ”¶åˆ°è‹¥å¹²I/Oè¯·æ±‚ï¼ŒOSè¿›è¡Œç£ç›˜çš„é©±åŠ¨è°ƒåº¦ç­–ç•¥ï¼š1ã€ç§»è‡‚è°ƒåº¦ï¼›2ã€æ—‹è½¬è°ƒåº¦</p><h4 id="ç§»è‡‚è°ƒåº¦">ç§»è‡‚è°ƒåº¦</h4><p>ç›®çš„ï¼šä½¿ç§»åŠ¨è‡‚çš„ç§»åŠ¨æ—¶é—´æœ€çŸ­ï¼Œä»è€Œå‡å°‘å¯»é“æ€»æ—¶é—´</p><ul><li>å…ˆæ¥å…ˆæœåŠ¡ï¼ˆ==FIFO/FCFS==ï¼‰ï¼šç§»è‡‚è·ç¦»å¤§ï¼Œæ€§èƒ½ä¸å¥½</li><li>ä¼˜å…ˆçº§ï¼ˆ==Priority==ï¼‰<ul><li><u>æ¯”è¾ƒçŸ­çš„æ‰¹ä½œä¸šå’Œäº¤äº’ä½œä¸šçš„ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œè€Œè¾ƒé•¿è®¡ç®—æ—¶é—´çš„é•¿ä½œä¸šä¼˜å…ˆçº§è¾ƒä½</u></li><li>é•¿ä½œä¸šç­‰å¾…æ—¶é—´è¾ƒé•¿</li></ul></li><li>åè¿›å…ˆå‡ºï¼ˆ==LIFO==ï¼‰<ul><li>æŠŠè®¾å¤‡èµ„æºä¼˜å…ˆæä¾›ç»™æœ€ååˆ°æ¥çš„ç”¨æˆ·</li><li>å±€éƒ¨æ€§å¥½ï¼Œæé«˜ååç‡ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜</li><li>å¯èƒ½å‡ºç°â€œé¥¿æ­»â€</li></ul></li><li>æœ€çŸ­æœåŠ¡æ—¶é—´ä¼˜å…ˆï¼ˆ==SSTF==ï¼‰ï¼šä¼˜å…ˆå¤„ç†æœåŠ¡æ—¶é—´æ›´çŸ­çš„è¯·æ±‚ï¼ˆé€‰æ‹©ä½¿ç£å¤´ä»å½“å‰ä½ç½®å¼€å§‹ç§»åŠ¨çš„æœ€å°‘çš„è¯·æ±‚ï¼‰ï¼Œå­˜åœ¨é¥¥é¥¿ç°è±¡</li><li>æ‰«æç®—æ³•<ul><li>å•å‘æ‰«æï¼šç§»åŠ¨è‡‚å‘ä¸€ä¸ªæ–¹å‘æ‰«æï¼Œå½’é€”ä¸æä¾›æœåŠ¡</li><li>åŒå‘æ‰«æï¼ˆ==SCAN==ï¼‰ï¼šç§»åŠ¨è‡‚æ¯æ¬¡å‘ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œé‡åˆ°æœ€è¿‘çš„I/Oè¯·æ±‚ä¾¿è¿›è¡Œå¤„ç†ï¼Œ<strong>åˆ°è¾¾æœ€åä¸€ä¸ªæŸ±é¢å</strong>å†å‘åæ–¹å‘ç§»åŠ¨<font color='red'>ï¼ˆ<strong>åŒå‘åˆ°åº•</strong>ï¼‰</font></li><li>ç”µæ¢¯è°ƒåº¦ï¼ˆ==LOOK==ï¼‰ï¼šåŒå‘æ‰«æçš„æ”¹è¿›ï¼Œ<strong>å½“å‰ç§»åŠ¨æ–¹å‘æ²¡æœ‰è®¿é—®è¯·æ±‚æ—¶</strong>ï¼Œå°±æ”¹å˜ç§»åŠ¨æ–¹å‘<font color='red'>ï¼ˆ<strong>åŒå‘ä¸åˆ°åº•</strong>ï¼‰</font></li><li>å¾ªç¯æ‰«æï¼ˆ==C-SCAN==ï¼‰ï¼šæŠŠæ‰«æé™å®šåœ¨ä¸€ä¸ªæ–¹å‘ï¼Œå½“è®¿é—®åˆ°æ²¿æŸä¸ªæ–¹å‘çš„æœ€åä¸€ä¸ªç£é“æ—¶ï¼Œç£å¤´è‡‚è¿”å›åˆ°ç£ç›˜ç›¸åæ–¹å‘ç£é“çš„æœ«ç«¯ï¼ˆ<strong>å½’é€”ä¸æä¾›æœåŠ¡</strong>ï¼‰ï¼Œå†æ¬¡å¼€å§‹æ‰«æ<font color='red'>ï¼ˆ<strong>å•å‘åˆ°åº•</strong>ï¼‰</font></li><li>==C-LOOK==ï¼šå¾ªç¯ç”µæ¢¯ï¼Ÿå¾ªç¯æ‰«æçš„æ”¹è¿›ï¼Œå½“ç§»åŠ¨æ–¹å‘æ²¡æœ‰è®¿é—®è¯·æ±‚çš„æ—¶å€™ï¼Œæ”¹å˜ç§»åŠ¨æ–¹å‘ï¼ˆ<strong>å½’é€”ä¸æä¾›æœåŠ¡</strong>ï¼‰<font color='red'>ï¼ˆ<strong>å•å‘ä¸åˆ°åº•</strong>ï¼‰</font></li><li>==N-step-SCAN==<ul><li>è¿›ç¨‹å¦‚æœé‡å¤è¯·æ±‚åŒä¸€ä¸ªç£é“å°±ä¼šå„æ–­æ•´ä¸ªè®¾å¤‡ï¼Œæ•…é‡‡ç”¨åˆ†å¸ƒæ‰«æé¿å…æ­¤ç±»é—®é¢˜</li><li><strong>æŠŠç£ç›˜è¯·æ±‚é˜Ÿåˆ—åˆ†æˆé•¿åº¦ä¸ºNçš„å­é˜Ÿåˆ—ï¼Œæ¯ä¸€æ¬¡ç”¨SCANå¤„ç†ä¸€ä¸ªå­é˜Ÿåˆ—</strong>ï¼Œå¤„ç†ä¸€ä¸ªé˜Ÿåˆ—æ—¶ï¼Œæ–°è¯·æ±‚å¿…é¡»æ·»åŠ åˆ°å…¶ä»–æŸä¸ªé˜Ÿåˆ—ä¸­ã€‚</li></ul></li><li>==FSCAN==<ul><li>ä½¿ç”¨ä¸¤ä¸ªå­é˜Ÿåˆ—</li><li>å¼€å§‹æ‰«ææ—¶ï¼Œæ‰€æœ‰è¯·æ±‚å¤„äºä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¦ä¸€ä¸ªé˜Ÿåˆ—ä¸ºç©ºï¼›æ‰«æè¿‡ç¨‹ä¸­ï¼Œæ–°åˆ°çš„è¯·æ±‚æ”¾å…¥å¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­</li></ul></li></ul></li></ul><h4 id="æ—‹è½¬è°ƒåº¦">æ—‹è½¬è°ƒåº¦</h4><p>ç›®çš„ï¼šä½¿å¾—æ—‹è½¬å»¶è¿Ÿçš„æ€»æ—¶é—´æœ€å°‘</p><ul><li>å¾ªç¯æ’åºï¼šåœ¨æœ€å°‘æ—‹è½¬åœˆæ•°å†…å®Œæˆä½äºåŒä¸€æŸ±é¢çš„è®¿é—®è¯·æ±‚<ul><li>æ—‹è½¬ä½ç½®æµ‹å®šç¡¬ä»¶ å’Œ å¤šç£å¤´åŒæ—¶è¯»å†™æŠ€æœ¯ æœ‰åˆ©äºæé«˜æ—‹è½¬è°ƒåº¦çš„æ•ˆç‡</li></ul></li><li>ä¼˜åŒ–åˆ†å¸ƒï¼šé€šè¿‡ä¿¡æ¯åœ¨å­˜å‚¨ç©ºé—´çš„æ’åˆ—æ–¹å¼æ¥å‡å°‘æ—‹è½¬å»¶è¿Ÿ<ul><li>äº¤æ›¿æ’åºï¼šç”±äºç£ç›˜åŒ€é€Ÿè¿è½¬ï¼Œå¯èƒ½å¤„ç†å½“å‰æ‰‡åŒºæ•°æ®æ—¶ï¼Œä¸‹ä¸ªæ‰‡åŒºå·²ç»è·³è¿‡äº†ã€‚æ‰€ä»¥ï¼Œå¯¹æ‰‡åŒºé—´éš”ç¼–å·ï¼Œå¦‚äº¤å‰å› å­<code>n:1</code>è¡¨ç¤ºç›¸é‚»ç¼–å·é—´ä¼šé—´éš”<code>n-1</code>ä¸ªæ‰‡åŒºï¼Œè¿™æ ·å½“å¤„ç†å®Œæ‰‡åŒºæ•°æ®ä¹‹åå¯èƒ½æ­£å¥½è¾¾åˆ°ä¸‹ä¸€ä¸ªç¼–å·çš„æ‰‡åŒºã€‚</li></ul></li></ul><h3 id="raid">RAID</h3><ul><li><p>RAID0</p><p><u>å¹¶è¡Œäº¤å‰å­˜å–ï¼Œé€‚ç”¨äºå¤§æ•°æ®é‡çš„I/Oè¯·æ±‚ï¼Œæ— å†—ä½™æ ¡éªŒ</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000256864.png"alt="RAID0" /><figcaption aria-hidden="true">RAID0</figcaption></figure></li><li><p>RAID1</p><p><u>å®¹é‡ä¸‹é™ä¸€åŠï¼Œæˆæœ¬å¾ˆé«˜</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000339022.png"alt="RAID1" /><figcaption aria-hidden="true">RAID1</figcaption></figure></li><li><p>RAID2</p><p><u>å¹¶è¡Œå­˜å–ï¼Œæµ·æ˜æ ¡éªŒç ï¼Œæˆæœ¬è¾ƒé«˜</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000536145.png"alt="RAID2" /><figcaption aria-hidden="true">RAID2</figcaption></figure></li><li><p>RAID3</p><p><u>åªç”¨ä¸€ä¸ªå†—ä½™ç›˜ï¼Œé‡‡ç”¨å¥‡å¶æ ¡éªŒæŠ€æœ¯</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000626692.png"alt="RAID3" /><figcaption aria-hidden="true">RAID3</figcaption></figure></li><li><p>RAID4</p><p><u>ç‹¬ç«‹å­˜å–ç£ç›˜é˜µåˆ—ï¼Œæ•°æ®æ¡å¸¦äº¤å‰å­˜æ”¾</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000656448.png"alt="RAID4" /><figcaption aria-hidden="true">RAID4</figcaption></figure></li><li><p>RAID5</p><p><u>å¥‡å¶æ ¡éªŒç å¾ªç¯åˆ†å¸ƒåœ¨æ¯ä¸ªç›˜ä¸Šä½¿å®¹é”™æ€§æ›´å¥½</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000713694.png"alt="RAID5" /><figcaption aria-hidden="true">RAID5</figcaption></figure></li><li><p>RAID6</p><p><u>åŒé‡å†—ä½™æŠ€æœ¯ï¼Œä¸”é‡‡ç”¨ä¸¤ç§ä¸åŒçš„æ•°æ®æ ¡éªŒç®—æ³•</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126000736328.png"alt="RAID6" /><figcaption aria-hidden="true">RAID6</figcaption></figure></li></ul><h3 id="ç£ç›˜cache">ç£ç›˜Cache</h3><blockquote><p>ä¸»å­˜ä¸­ä¸ºç£ç›˜æ‰‡åŒºè®¾ç½®çš„ä¸€ä¸ªç¼“å†²åŒºï¼Œåˆ©ç”¨å±€éƒ¨æ€§åŸç†ï¼Œå‡å°‘å­˜å‚¨å™¨å­˜å–æ—¶é—´</p></blockquote><ul><li>LRUï¼šæ›¿æ¢Cacheä¸­æœªè¢«è®¿é—®çš„æ—¶é—´æœ€é•¿çš„å—</li><li>LFUï¼šæ›¿æ¢Cacheä¸­è®¿é—®æ¬¡æ•°æœ€å°‘çš„å—</li></ul><h2 id="è™šæ‹Ÿè®¾å¤‡">4.5 è™šæ‹Ÿè®¾å¤‡</h2><h3 id="spooling-ç³»ç»Ÿ">4.5.1 SPOOLing ç³»ç»Ÿ</h3><h4 id="è™šæ‹Ÿè®¾å¤‡æŠ€æœ¯">è™šæ‹Ÿè®¾å¤‡æŠ€æœ¯</h4><p>ä½¿ç”¨ä¸€ç±»ç‰©ç†è®¾å¤‡æ¨¡æ‹Ÿå¦ä¸€ç±»ç‰©ç†è®¾å¤‡çš„æŠ€æœ¯ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨å…±äº«å‹å¤–å›´è®¾å¤‡æ¨¡æ‹Ÿç‹¬å å‹å¤–å›´è®¾å¤‡ã€‚</p><ul><li>å†…å­˜å¡æ¨¡æ‹Ÿç£ç›˜</li><li>å—è®¾å¤‡æ¨¡æ‹Ÿå­—ç¬¦è®¾å¤‡</li><li>è¾“å…¥è¾“å‡ºé‡å®šå‘</li></ul><h4 id="spoolingè®¾å¤‡">SPOOLingè®¾å¤‡</h4><blockquote><p>å¤–éƒ¨è®¾å¤‡è”æœºå¹¶è¡Œæ“ä½œï¼ˆSimultaneous Peripheral OperationsOn-Lineï¼‰</p><p>å…³äºæ…¢é€Ÿå­—ç¬¦è®¾å¤‡å¦‚ä½•ä¸è®¡ç®—æœºä¸»æœºäº¤æ¢ä¿¡æ¯çš„ä¸€ç§æŠ€æœ¯ï¼Œé€šå¸¸ç§°ä¸ºâ€œå‡è„±æœºæŠ€æœ¯â€</p></blockquote><p>ä¸€ä¸ªç»å…¸çš„SPOOLingç³»ç»Ÿï¼š<strong>ç”¨é«˜é€Ÿçš„ç£ç›˜è®¾å¤‡æ¥æ¨¡æ‹Ÿæ…¢é€Ÿçš„å­—ç¬¦è®¾å¤‡ï¼Œç¼©çŸ­è¿›ç¨‹åœ¨å†…å­˜ä¸­çš„é©»ç•™æ—¶é—´</strong></p><ul><li>â€œäº•â€æ˜¯ç”¨ä½œç¼“å†²çš„å­˜å‚¨åŒºåŸŸï¼Œé‡‡ç”¨äº•çš„æŠ€æœ¯èƒ½è°ƒèŠ‚ä¾›æ±‚ä¹‹é—´çš„çŸ›ç›¾ï¼Œæ¶ˆé™¤äººå·¥å¹²é¢„å¸¦æ¥çš„æŸå¤±ã€‚</li><li>â€œé¢„è¾“å…¥ç¨‹åºâ€ï¼šé¢„å…ˆæŠŠæ•°æ®ä»è¾“å…¥è®¾å¤‡ä¼ é€åˆ°ç£ç›˜è¾“å…¥äº•</li><li>â€ç¼“è¾“å‡ºç¨‹åºâ€œï¼šæŠŠæ•°æ®ä»ç£ç›˜è¾“å‡ºäº•ä¼ é€åˆ°è¾“å‡ºè®¾å¤‡</li><li>â€œäº•ç®¡ç†ç¨‹åºâ€ï¼šæ§åˆ¶è¿›ç¨‹ä¸äº•ä¹‹é—´çš„æ•°æ®äº¤æ¢ï¼ˆI/Oé‡å®šå‘ï¼‰</li></ul><p><u>å…¨éƒ¨çš„I/Oéƒ½åŸºäºç£ç›˜ï¼ŒåŠ å¿«è¿›ç¨‹å‘¨è½¬æ—¶é—´ï¼Œæé«˜ç³»ç»Ÿååé‡</u></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126101616883.png"alt="SPOOLingç³»ç»Ÿ" /><figcaption aria-hidden="true">SPOOLingç³»ç»Ÿ</figcaption></figure><p>æ‰“å°SPOOLingç³»ç»Ÿ</p><ul><li>å®ˆæŠ¤è¿›ç¨‹æ˜¯å”¯ä¸€æœ‰ç‰¹æƒä½¿ç”¨æ‰“å°æœºè®¾å¤‡çš„è¿›ç¨‹</li><li>æ‰“å°æ–‡ä»¶å‰ï¼Œç”¨æˆ·è¿›ç¨‹å…ˆäº§ç”Ÿå®Œæ•´çš„å¾…è¾“å‡ºæ–‡ä»¶ï¼Œå¹¶å­˜æ”¾åœ¨æ‰“å°ç›®å½•ä¸‹</li><li>æ‰“å°æœºç©ºé—²æ—¶ï¼Œå¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ï¼Œæ‰“å°å¾…è¾“å‡ºæ–‡ä»¶</li></ul><h3 id="æ‰¹å¤„ç†ç³»ç»Ÿçš„ä½œä¸šç®¡ç†">4.5.2 æ‰¹å¤„ç†ç³»ç»Ÿçš„ä½œä¸šç®¡ç†</h3><p>ä½œä¸šè°ƒåº¦å’Œè¿›ç¨‹è°ƒåº¦çš„å…³ç³»</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221126102228704.png"alt="ä½œä¸šè°ƒåº¦å’Œè¿›ç¨‹è°ƒåº¦çš„å…³ç³»" /><figcaption aria-hidden="true">ä½œä¸šè°ƒåº¦å’Œè¿›ç¨‹è°ƒåº¦çš„å…³ç³»</figcaption></figure><h2 id="ç›¸å…³ä¹ é¢˜">4.6 ç›¸å…³ä¹ é¢˜</h2><ul><li>CPUè¾“å‡ºæ•°æ®çš„é€Ÿåº¦è¿œè¿œé«˜äºæ‰“å°æœºçš„æ‰“å°é€Ÿåº¦ï¼Œä¸ºäº†è§£å†³è¿™ä¸€çŸ›ç›¾ï¼Œå¯é‡‡ç”¨<strong>ç¼“å†²æŠ€æœ¯</strong></li><li>ä¸ºäº†ä½¿å¤šä¸ªè¿›ç¨‹èƒ½æœ‰æ•ˆåœ°åŒæ—¶å¤„ç†è¾“å…¥å’Œè¾“å‡ºï¼Œæœ€å¥½ä½¿ç”¨<strong>ç¼“å†²æ± </strong> ç»“æ„çš„ç¼“å†²æŠ€æœ¯</li><li>åœ¨é‡‡ç”¨SPOOLingæŠ€æœ¯çš„ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çš„æ‰“å°ç»“æœé¦–å…ˆè¢«é€åˆ°<strong>ç£ç›˜å›ºå®šåŒºåŸŸ</strong></li><li>é‡‡ç”¨å‡è„±æœºæŠ€æœ¯ï¼Œå°†ç£ç›˜çš„ä¸€éƒ¨åˆ†ä½œä¸ºå…¬å…±ç¼“å†²åŒºä»¥ä»£æ›¿æ‰“å°æœºï¼Œç”¨æˆ·å¯¹æ‰“å°æœºçš„æ“ä½œå®é™…ä¸Šæ˜¯å¯¹ç£ç›˜çš„å­˜å‚¨æ“ä½œï¼Œç”¨ä»¥ä»£æ›¿æ‰“å°æœºçš„éƒ¨åˆ†æ˜¯<strong>è™šæ‹Ÿè®¾å¤‡</strong></li><li>å°†ç³»ç»Ÿä¸­çš„æ¯ä¸€å°è®¾å¤‡æŒ‰æŸç§åŸåˆ™è¿›è¡Œç»Ÿä¸€çš„ç¼–å·ï¼Œè¿™äº›ç¼–å·ä½œä¸ºåŒºåˆ†ç¡¬ä»¶å’Œè¯†åˆ«è®¾å¤‡çš„ä»£å·ï¼Œè¯¥ç¼–å·ç§°ä¸ºè®¾å¤‡çš„<strong>ç»å¯¹å·</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaé›†åˆç±»</title>
      <link href="/2023/02/10/Java/java-collection/"/>
      <url>/2023/02/10/Java/java-collection/</url>
      
        <content type="html"><![CDATA[<h2 id="é›†åˆä¸­çš„fail-fast">é›†åˆä¸­çš„fail-fast</h2><blockquote><p><code>fail-fast</code>å…¶å®æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œå³åœ¨ç¨‹åºå‡ºç°é”™è¯¯æ—¶ä¸å†ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè€Œæ˜¯æŠ›å‡ºå¼‚å¸¸é€€å‡ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (String name : names) &#123;<br>    <span class="hljs-keyword">if</span> (...) &#123;<br>        names.remove(name);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç å°±ä¼šè§¦å‘<code>fail-fast</code>é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸<code>ConcurrentModificationException</code>ã€‚</p><p><strong>äº§ç”Ÿçš„åŸå› </strong>ï¼šå¢å¼ºçš„forå¾ªç¯æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡è¿­ä»£å™¨å®ç°ã€‚</p><p>é€šè¿‡æŸ¥çœ‹æŠ¥é”™ä½ç½®å¯ä»¥å‘ç°ï¼ŒæŠ›å‡ºå¼‚å¸¸çš„åŸå› æ˜¯<code>modCount</code>å’Œ<code>expectedModCount</code>ä¸¤ä¸ªå˜é‡ä¸ç›¸åŒã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210202342425.png" /></p><ul><li><code>modCount</code>ï¼šæˆå‘˜å˜é‡ï¼Œè®°å½•é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°</li><li><code>expectedModCount</code>ï¼šå†…éƒ¨ç±»<code>Itr</code>çš„æˆå‘˜å˜é‡ï¼Œè¡¨ç¤ºè¿™ä¸ªè¿­ä»£å™¨é¢„æœŸè¯¥é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œåœ¨<code>Itr</code>è¢«åˆ›å»ºæ—¶è¢«åˆå§‹åŒ–ä¸ºå½“å‰<code>modCount</code>å€¼ï¼Œåªæœ‰é€šè¿‡è¿­ä»£å™¨ä¿®æ”¹é›†åˆæ‰ä¼šæ›´æ–°è¯¥å€¼</li></ul><p>è€Œä¸Šé¢çš„<code>remove</code>ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†<code>fastRemove</code>æ›´æ–°äº†<code>modCount</code>ï¼Œä½†æ˜¯ç”±äºå¢å¼ºforå¾ªç¯åˆ›å»ºäº†<code>Itr</code>ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨è¿­ä»£å™¨å»åˆ é™¤å…ƒç´ ï¼Œå°±å¯¼è‡´äº†<code>modCount</code>å’Œ<code>expectedModCount</code>ä¸ä¸€è‡´ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210202944702.png" /></p><p><strong>è§£å†³æ–¹æ³•</strong>ï¼šä½¿ç”¨æ™®é€šforå¾ªç¯...</p><h2 id="arraylist">ArrayList</h2><h3 id="æ¦‚è¿°">æ¦‚è¿°</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211154139737.png" /></p><ul><li><code>RandomAccess</code>ï¼šæ ‡è¯†ç±»ï¼Œå¹¶æ— å®ç°ï¼Œæ ‡è¯†è¯¥ç±»æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®</li><li><code>Cloneable</code>ï¼šå¯ä»¥è°ƒç”¨<code>clone()</code>æ–¹æ³•å…‹éš†å¯¹è±¡</li><li><code>java.io.Serializable</code>ï¼šå¯åºåˆ—åŒ–</li></ul><h3 id="å’Œ-linkedlist-çš„æ¯”è¾ƒ">å’Œ LinkedList çš„æ¯”è¾ƒ</h3><ul><li>æ˜¯å¦çº¿ç¨‹å®‰å…¨</li><li>åº•å±‚æ•°æ®ç»“æ„</li><li>å¢åˆ æŸ¥çš„å¤æ‚åº¦</li><li>å†…å­˜ç©ºé—´å ç”¨</li></ul><h3 id="arraylistæ‰©å®¹æœºåˆ¶">ArrayListæ‰©å®¹æœºåˆ¶</h3><p>1ã€ArrayListæä¾›äº†ä¸‰ä¸ªæ„é€ å‡½æ•°</p><blockquote><p>è¦æ³¨æ„çš„æ˜¯å¦‚æœä½¿ç”¨æ— å‚æ„é€ ï¼Œåº•å±‚çš„æ•°ç»„æ˜¯<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ï¼Œç»“åˆåé¢çš„æ‰©å®¹æœºåˆ¶å¯ä»¥å‘ç°å½“<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ç¬¬ä¸€æ¬¡addå…ƒç´ æ—¶å°±ä¼šå°†æ‰©å®¹è‡³<code>DEFAULT_CAPACITY</code>(10)ã€‚</p><p>è€Œ<code>EMPTY_ELEMENTDATA</code>æ˜¯çœŸå®ç©ºçš„æ•°ç»„ï¼ˆå› ä¸ºåªæœ‰ä¼ è¿›æ¥çš„å®¹é‡ä¸º0çš„æ—¶å€™æ‰ä¼šèµ‹è¯¥å€¼ï¼‰</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity)</span> &#123;<br>    <span class="hljs-keyword">if</span> (initialCapacity &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">this</span>.elementData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[initialCapacity];<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (initialCapacity == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">this</span>.elementData = EMPTY_ELEMENTDATA;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Illegal Capacity: &quot;</span>+<br>                                           initialCapacity);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">(Collection&lt;? extends E&gt; c)</span> &#123;<br>    Object[] a = c.toArray();<br>    <span class="hljs-keyword">if</span> ((size = a.length) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (c.getClass() == ArrayList.class) &#123;<br>            elementData = a;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            elementData = Arrays.copyOf(a, size, Object[].class);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// replace with empty array.</span><br>        elementData = EMPTY_ELEMENTDATA;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ¯æ¬¡è°ƒç”¨<code>add</code>å‡½æ•°éƒ½ä¼šç»å†ä¸€æ¬¡"æ‰©å®¹"ï¼ˆå¯èƒ½æ²¡æœ‰çœŸå®å‘ç”Ÿï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span> &#123;<br>    ensureCapacityInternal(size + <span class="hljs-number">1</span>);  <span class="hljs-comment">// Increments modCount!!</span><br>    elementData[size++] = e;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>minCapacity</code>ï¼šå®Œæˆaddæ“ä½œçš„æœ€å°æ‰©å®¹é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ensureCapacityInternal</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculateCapacity</span><span class="hljs-params">(Object[] elementData, <span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    <span class="hljs-comment">// DEFAULTCAPACITY_EMPTY_ELEMENTDATA æ‰©å®¹</span><br>    <span class="hljs-keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;<br>        <span class="hljs-keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity); <span class="hljs-comment">// max(10, minCapacity);</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> minCapacity;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ensureExplicitCapacity</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    modCount++;<br><br>    <span class="hljs-comment">// overflow-conscious code</span><br>    <span class="hljs-keyword">if</span> (minCapacity - elementData.length &gt; <span class="hljs-number">0</span>)<br>        grow(minCapacity);<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…è¿›è¡Œæ‰©å®¹çš„å‡½æ•°æ˜¯<code>grow(int)</code>ï¼Œç»è¿‡ä¸€ç³»åˆ—çš„åˆ¤æ–­åé€šè¿‡<code>Arrays.copyOf()</code>è¿›è¡Œæ‰©å®¹ã€‚</p><p><code>newCapacity</code>ï¼šæ‰©å®¹æœºåˆ¶æŒ‡å®šçš„æ‰©å®¹é‡ï¼ˆåŸå®¹é‡1.5å€ï¼‰</p><p><code>MAX_ARRAY_SIZE</code>ï¼šæœ€å¤§æ‰©å®¹é‡ï¼ˆ<code>Integer.MAX_VALUE-8</code>ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">grow</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    <span class="hljs-comment">// overflow-conscious code</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">oldCapacity</span> <span class="hljs-operator">=</span> elementData.length;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">newCapacity</span> <span class="hljs-operator">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class="hljs-number">1</span>); <span class="hljs-comment">// æ–°å®¹é‡ä¸ºåŸå®¹é‡çš„1.5å€</span><br>    <span class="hljs-keyword">if</span> (newCapacity - minCapacity &lt; <span class="hljs-number">0</span>)<br>        newCapacity = minCapacity;<br>    <span class="hljs-keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="hljs-number">0</span>)<br>        newCapacity = hugeCapacity(minCapacity);<br>    <span class="hljs-comment">// minCapacity is usually close to size, so this is a win:</span><br>    elementData = Arrays.copyOf(elementData, newCapacity);<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hugeCapacity</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    <span class="hljs-keyword">if</span> (minCapacity &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OutOfMemoryError</span>();<br>    <span class="hljs-keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?<br>        Integer.MAX_VALUE :<br>        MAX_ARRAY_SIZE;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ€»çš„æ¥è¯´æ‰©å®¹æœºåˆ¶æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯å­˜åœ¨å¤šä¸ª<code>capacity</code>éœ€è¦æ¯”è¾ƒï¼Œéœ€è¦å¼„æ¸…è¿™äº›<code>capacity</code>æ‰€ä»£è¡¨çš„å«ä¹‰ã€‚</p></blockquote><h3 id="å‡ ä¸ªé‡è¦çš„å‡½æ•°æºç ">å‡ ä¸ªé‡è¦çš„å‡½æ•°æºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span> &#123;<br>    rangeCheckForAdd(index);<br><br>    ensureCapacityInternal(size + <span class="hljs-number">1</span>);  <span class="hljs-comment">// Increments modCount!!</span><br>    <span class="hljs-comment">// ä½¿ç”¨äº†System.arraycopyæ¥å®ç°å…ƒç´ çš„åç§»</span><br>    System.arraycopy(elementData, index, elementData, index + <span class="hljs-number">1</span>,<br>                     size - index);<br>    elementData[index] = element;<br>    size++;<br>&#125;<br></code></pre></td></tr></table></figure><p>æä¾›ç»™å¤–éƒ¨çš„æ˜¾ç¤ºæ‰©å®¹å‡½æ•°<code>ensureCapacity</code></p><blockquote><p>æ³¨æ„æ‰€æœ‰çš„æ‰©å®¹éƒ½å‡ºç°äº†<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ï¼ˆç¬¬ä¸€æ¬¡æ‰©å®¹çš„ç‰¹æ®Šæ€§ï¼‰</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ensureCapacity</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">minExpand</span> <span class="hljs-operator">=</span> (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)<br>        <span class="hljs-comment">// any size if not default element table</span><br>        ? <span class="hljs-number">0</span><br>        <span class="hljs-comment">// larger than default for default empty table. It&#x27;s already</span><br>        <span class="hljs-comment">// supposed to be at default size.</span><br>        : DEFAULT_CAPACITY;<br><br>    <span class="hljs-keyword">if</span> (minCapacity &gt; minExpand) &#123;<br>        ensureExplicitCapacity(minCapacity);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹¶å‘ç¨‹åºè®¾è®¡</title>
      <link href="/2023/02/10/nju-course-review-notes/os/concurrent-programming/"/>
      <url>/2023/02/10/nju-course-review-notes/os/concurrent-programming/</url>
      
        <content type="html"><![CDATA[<h2 id="å¹¶å‘è¿›ç¨‹">6.1 å¹¶å‘è¿›ç¨‹</h2><h3 id="å¹¶å‘ç¨‹åºè®¾è®¡çš„æ¦‚å¿µ">6.1.1 å¹¶å‘ç¨‹åºè®¾è®¡çš„æ¦‚å¿µ</h3><h4 id="é¡ºåºç¨‹åºè®¾è®¡">é¡ºåºç¨‹åºè®¾è®¡</h4><ul><li>ç¨‹åºæ‰§è¡Œçš„å†…éƒ¨é¡ºåºæ€§ï¼šç¨‹åºåœ¨å¤„ç†å™¨ä¸Šçš„æ‰§è¡Œæ˜¯ä¸¥æ ¼æœ‰åºçš„</li><li>ç¨‹åºæ‰§è¡Œçš„å¤–éƒ¨é¡ºåºæ€§ï¼šå°†å…·ä½“é—®é¢˜çš„æ±‚è§£è¿‡ç¨‹è®¾è®¡ä¸ºä¸€ä¸ªç¨‹åºæˆ–è€…ä¸¥æ ¼é¡ºåºæ‰§è¡Œçš„ç¨‹åºåºåˆ—</li></ul><h4 id="é¡ºåºç¨‹åºè®¾è®¡ç‰¹æ€§">é¡ºåºç¨‹åºè®¾è®¡ç‰¹æ€§</h4><ol type="1"><li>ç¨‹åºæ‰§è¡Œçš„é¡ºåºæ€§</li><li>è®¡ç®—ç¯å¢ƒçš„å°é—­æ€§ï¼šç‹¬å èµ„æº</li><li>è®¡ç®—ç»“æœçš„ç¡®å®šæ€§</li><li>è®¡ç®—è¿‡ç¨‹çš„å¯å†è§æ€§</li></ol><h4 id="è¿›ç¨‹çš„å¹¶å‘æ‰§è¡Œ">è¿›ç¨‹çš„å¹¶å‘æ‰§è¡Œ</h4><ul><li>å¤šé“ç¨‹åºè®¾è®¡å…è®¸å¤šä¸ªç¨‹åºåŒæ—¶è¿›å…¥å†…å­˜ç«äº‰å¤„ç†å™¨</li><li>OSå…è®¸å¤šä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œ</li><li>OSä¿è¯<u>æŒ‰ç…§â€œé¡ºåºç¨‹åºè®¾è®¡â€æ€æƒ³ç¼–åˆ¶çš„ç¨‹åº</u>åœ¨å¹¶å‘æ‰§è¡Œæ—¶ä¸å—å½±å“ï¼Œå¦‚åŒç‹¬å è®¡ç®—æœº</li><li><u>æŒ‰ç…§â€œé¡ºåºç¨‹åºè®¾è®¡â€æ€æƒ³ç¼–åˆ¶çš„è¿›ç¨‹</u>åœ¨OSä¸­å¹¶å‘æ‰§è¡Œå±äºæ— å…³çš„å¹¶å‘è¿›ç¨‹</li></ul><h4 id="å¹¶å‘ç¨‹åºè®¾è®¡">å¹¶å‘ç¨‹åºè®¾è®¡</h4><p>æŠŠä¸€ä¸ªå…·ä½“é—®é¢˜æ±‚è§£è®¾è®¡æˆ<strong>è‹¥å¹²ä¸ªå¯åŒæ—¶æ‰§è¡Œçš„ç¨‹åºæ¨¡å—</strong>çš„æ–¹æ³•</p><h4 id="å¹¶å‘ç¨‹åºè®¾è®¡çš„ç‰¹æ€§">å¹¶å‘ç¨‹åºè®¾è®¡çš„ç‰¹æ€§</h4><ul><li>å¹¶å‘æ€§</li><li>å…±äº«æ€§ï¼šå…±äº«è½¯ä»¶èµ„æº</li><li>äº¤å¾€æ€§ï¼šå¹¶å‘æ‰§è¡Œæ—¶å­˜åœ¨åˆ¶çº¦</li></ul><h3 id="å¹¶å‘è¿›ç¨‹çš„åˆ¶çº¦å…³ç³»">6.1.2 å¹¶å‘è¿›ç¨‹çš„åˆ¶çº¦å…³ç³»</h3><p>1ã€æ— å…³ä¸äº¤å¾€çš„å¹¶å‘è¿›ç¨‹</p><ul><li><p>æ— å…³ï¼šåˆ†åˆ«åœ¨ä¸åŒçš„å˜é‡é›†åˆä¸Šè¿è¡Œï¼Œæ»¡è¶³<code>Bernstein</code>æ¡ä»¶</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211185046857.png" /></p></li><li><p>äº¤å¾€ï¼šå…±äº«æŸäº›å˜é‡</p></li></ul><p>2ã€ä¸æ—¶é—´æœ‰å…³çš„é”™è¯¯</p><p>äº¤å¾€çš„å¹¶å‘è¿›ç¨‹å¯èƒ½ä¼šç”±äºè®¾è®¡ä¸å½“å‡ºç°ï¼ˆ1ï¼‰ç»“æœé”™è¯¯ï¼ˆ2ï¼‰æ°¸è¿œç­‰å¾…</p><p>3ã€è¿›ç¨‹äº’æ–¥ä¸è¿›ç¨‹åŒæ­¥ï¼ˆç«äº‰ä¸åä½œï¼‰</p><blockquote><p>è¿›ç¨‹äº’æ–¥å…³ç³»æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹åŒæ­¥å…³ç³»ï¼Œå³é€æ¬¡ä½¿ç”¨äº’æ–¥å…±äº«èµ„æºï¼Œæ˜¯å¯¹è¿›ç¨‹ä½¿ç”¨èµ„æºæ¬¡åºä¸Šçš„ä¸€ç§åè°ƒ</p></blockquote><ul><li>==è¿›ç¨‹äº’æ–¥==ï¼šå¹¶å‘è¿›ç¨‹ä¹‹é—´å› ç›¸äº’<strong>äº‰å¤ºç‹¬å å‹èµ„æº</strong>è€Œäº§ç”Ÿçš„ç«äº‰åˆ¶çº¦å…³ç³»ï¼Œå¼•å‘æ­»é”ã€é¥¥é¥¿é—®é¢˜</li><li>==è¿›ç¨‹åŒæ­¥==ï¼šä¸ºå®Œæˆå…±åŒä»»åŠ¡<strong>åŸºäºæŸä¸ªæ¡ä»¶</strong>æ¥åè°ƒæ‰§è¡Œå…ˆåå…³ç³»è€Œäº§ç”Ÿçš„åä½œåˆ¶çº¦å…³ç³»</li></ul><h2 id="ä¸´ç•ŒåŒºç®¡ç†">6.2 ä¸´ç•ŒåŒºç®¡ç†</h2><h3 id="ä¸´ç•ŒåŒº">6.2.1 ä¸´ç•ŒåŒº</h3><ul><li>ä¸´ç•Œèµ„æºï¼šäº’æ–¥å…±äº«å˜é‡æ‰€ä»£è¡¨çš„èµ„æºï¼ˆä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹æ‰€ä½¿ç”¨ï¼‰</li><li>ä¸´ç•ŒåŒºï¼ˆcriticalsectionï¼‰ï¼š<u>å¹¶å‘è¿›ç¨‹ä¸­ä¸äº’æ–¥å…±äº«å˜é‡ç›¸å…³çš„<strong>ç¨‹åºæ®µ</strong></u></li><li>ä¸´ç•ŒåŒºç®¡ç†çš„ä¸‰ä¸ªè¦æ±‚<ul><li>ä¸€æ¬¡è‡³å¤šå…è®¸ä¸€ä¸ªè¿›ç¨‹åœç•™åœ¨ä¸´ç•ŒåŒº</li><li>ä¸èƒ½æ— é™åœç•™åœ¨ä¸´ç•ŒåŒº</li><li>ä¸èƒ½æ— é™ç­‰å¾…è¿›å…¥ä¸´ç•ŒåŒº</li></ul></li></ul><h3 id="ä¸´ç•ŒåŒºç®¡ç†è½¯ä»¶æ–¹æ³•">6.2.2 ä¸´ç•ŒåŒºç®¡ç†â€”â€”è½¯ä»¶æ–¹æ³•</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">P1:<br><span class="hljs-keyword">while</span> flag2 &#123;&#125; <span class="hljs-comment">// è¯­å¥1</span><br>flag1 = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¯­å¥2</span><br><span class="hljs-comment">// ä¸´ç•ŒåŒº</span><br>flag1 = <span class="hljs-literal">false</span>;<br><br>P2:<br><span class="hljs-keyword">while</span> flag1 &#123;&#125;<br>flag2 = <span class="hljs-literal">true</span>;<br><span class="hljs-comment">// ä¸´ç•ŒåŒº</span><br>flag2 = <span class="hljs-literal">false</span>;<br></code></pre></td></tr></table></figure><p>è¯­å¥1å’Œè¯­å¥2å¯ä»¥äº¤æ¢é¡ºåºï¼Œä½†æ˜¯éƒ½æ˜¯ä¸å¯è¡Œçš„ï¼Œæœ¬è´¨æ˜¯å› ä¸ºè¯­å¥1å’Œè¯­å¥2æ˜¯å¯ä»¥è¢«ä¸­æ–­çš„ï¼Œå°±ä¼šå¯¼è‡´åŒæ—¶è¿›å…¥æˆ–è€…åŒæ—¶ç­‰å¾…</p><h4 id="dekkerç®—æ³•">Dekkerç®—æ³•</h4><blockquote><p><ahref="https://blog.csdn.net/Wang_Dou_Dou_/article/details/120467157">è¿›ç¨‹è”ç³»ä¸ä¸´ç•ŒåŒºç®¡ç†</a></p></blockquote><h4 id="petersonç®—æ³•">Petersonç®—æ³•</h4><blockquote><p>P0å’ŒP1ä½¿ç”¨ä¸´ç•ŒåŒºçš„æ¬¡åºå˜æˆäº†å®Œå…¨1:1çš„äº¤æ›¿æ–¹å¼ï¼Œå¹¶ä¸ç¬¦åˆä¸´ç•ŒåŒºäº’æ–¥ä½¿ç”¨çš„å®Œå…¨éšæœºæ€§</p></blockquote><h3 id="ä¸´ç•ŒåŒºç®¡ç†ç¡¬ä»¶æ–¹æ³•">6.2.3 ä¸´ç•ŒåŒºç®¡ç†â€”â€”ç¡¬ä»¶æ–¹æ³•</h3><h4 id="tsæŒ‡ä»¤">TSæŒ‡ä»¤</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230203114203042.png" /></p><h4 id="swapæŒ‡ä»¤">SWAPæŒ‡ä»¤</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230203114232770.png" /></p><h4 id="å¼€å…³ä¸­æ–­">å¼€å…³ä¸­æ–­</h4><ul><li>TSå’ŒSWAPæŒ‡ä»¤å‡ä¸ºå¿™ç­‰å¼ï¼Œæ•ˆç‡ä½</li><li>ã€å…³ä¸­æ–­ã€‘ï¼›ã€ä¸´ç•ŒåŒºã€‘ï¼›ã€å¼€ä¸­æ–­ã€‘</li><li>ä¸ä¾¿äº¤ç»™ç”¨æˆ·è¿›ç¨‹ä½¿ç”¨ï¼ˆé˜²æ­¢æ»¥ç”¨ï¼‰</li></ul><h2 id="pvæ“ä½œ">6.3 PVæ“ä½œ</h2><h3 id="pvæ“ä½œä¸è¿›ç¨‹äº’æ–¥">6.3.1 PVæ“ä½œä¸è¿›ç¨‹äº’æ–¥</h3><p>==ä¿¡å·é‡==</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">semaphore</span> &#123;</span><br>    <span class="hljs-type">int</span> value; <span class="hljs-comment">// ä¿¡å·é‡å€¼</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pcb</span>* <span class="hljs-title">list</span>;</span> <span class="hljs-comment">// ç­‰å¾…ä¿¡å·é‡çš„è¿›ç¨‹é˜Ÿåˆ—</span><br>&#125;<br></code></pre></td></tr></table></figure><p>==PVæ“ä½œ==</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">P(semaphore s)&#123;<br>    s -= <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (s &lt; <span class="hljs-number">0</span>) W(s); <span class="hljs-comment">// å°†è¿›ç¨‹åŠ å…¥ç­‰å¾…é˜Ÿåˆ—</span><br>&#125;<br><br>V(semaphore s)&#123;<br>    s += <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (s &lt;= <span class="hljs-number">0</span>) R(s); <span class="hljs-comment">// ä»ç­‰å¾…é˜Ÿåˆ—ä¸­é‡Šæ”¾ä¸€ä¸ªè¿›ç¨‹</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="pvæ“ä½œä¸è¿›ç¨‹åŒæ­¥ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜">6.3.2PVæ“ä½œä¸è¿›ç¨‹åŒæ­¥ï¼ˆç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ï¼‰</h3><h4 id="æ¶ˆè´¹è€…1ç”Ÿäº§è€…1ç¼“å†²åŒº">1æ¶ˆè´¹è€…1ç”Ÿäº§è€…1ç¼“å†²åŒº</h4><p>éœ€è¦ä¸¤ä¸ªä¿¡å·é‡ï¼š1ã€ç”Ÿäº§è€…çš„ç©ºä½ï¼›2ã€æ¶ˆè´¹è€…çš„äº§å“</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230203141237328.png" /></p><h4 id="æ¶ˆè´¹è€…1ç”Ÿäº§è€…nç¼“å†²åŒº">1æ¶ˆè´¹è€…1ç”Ÿäº§è€…Nç¼“å†²åŒº</h4><p>éœ€è¦ä¸ºæ¶ˆè´¹è€…å’Œç”Ÿäº§è€…å¢åŠ ä¸¤ä¸ªæŒ‡é’ˆ</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230203141604601.png" /></p><h4 id="næ¶ˆè´¹è€…nç”Ÿäº§è€…nç¼“å†²åŒº">Næ¶ˆè´¹è€…Nç”Ÿäº§è€…Nç¼“å†²åŒº</h4><p>éœ€è¦å¢åŠ ä¸¤ä¸ªä¿¡å·é‡ï¼šNä¸ªæ¶ˆè´¹è€…äº’æ–¥ä½¿ç”¨getptrï¼›Nä¸ªç”Ÿäº§è€…äº’æ–¥ä½¿ç”¨putptrï¼›</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230203141653802.png" /></p><h2 id="ç®¡ç¨‹">6.4 ç®¡ç¨‹</h2><h3 id="ä¸ºä»€ä¹ˆè¦å¼•å…¥ç®¡ç¨‹">ä¸ºä»€ä¹ˆè¦å¼•å…¥ç®¡ç¨‹?</h3><ul><li>æŠŠåˆ†æ•£åœ¨å„è¿›ç¨‹ä¸­çš„ä¸´ç•ŒåŒºé›†ä¸­èµ·æ¥è¿›è¡Œç®¡ç†</li><li>é˜²æ­¢è¿›ç¨‹æœ‰æ„æˆ–æ— æ„çš„è¿æ³•åŒæ­¥æ“ä½œ</li><li>ä¾¿äºç”¨é«˜çº§è¯­è¨€æ¥ä¹¦å†™ç¨‹åº</li></ul><h3 id="ç®¡ç¨‹-1">ç®¡ç¨‹</h3><p>ç®¡ç¨‹æ˜¯ç”±<u>å±€éƒ¨äºè‡ªå·±çš„è‹¥å¹²å…¬å…±å˜é‡åŠå…¶è¯´æ˜</u>å’Œ<u>æ‰€æœ‰è®¿é—®è¿™äº›å…¬å…±å˜é‡çš„è¿‡ç¨‹</u>æ‰€ç»„æˆçš„è½¯ä»¶æ¨¡å—ã€‚</p><ul><li>æ¡ä»¶å˜é‡ï¼šç”¨äºé˜»å¡è¿›ç¨‹çš„ä¿¡å·é‡</li><li>åŒæ­¥åŸè¯­waitï¼šé˜»å¡è¿›ç¨‹</li><li>åŒæ­¥åŸè¯­signalï¼šé‡Šæ”¾è¿›ç¨‹</li></ul><blockquote><p>signalæ“ä½œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š<strong>ä¼šå¯¼è‡´é‡Šæ”¾è¿›ç¨‹å’Œè¢«é‡Šæ”¾è¿›ç¨‹åŒæ—¶å­˜åœ¨äºç®¡ç¨‹ä¸­</strong></p><p>éœå°”ç®¡ç¨‹ï¼š<strong>æ‰§è¡Œsignalè¿›ç¨‹ç­‰å¾…ï¼Œç›´åˆ°è¢«é‡Šæ”¾è¿›ç¨‹é€€å‡ºç®¡ç¨‹æˆ–ç­‰å¾…å¦ä¸€ä¸ªæ¡ä»¶</strong></p></blockquote><h3 id="éœå°”ç®¡ç¨‹">éœå°”ç®¡ç¨‹</h3><blockquote><p>éœå°”ç®¡ç¨‹åŸºäºPVæ“ä½œåŸè¯­å®ç°ï¼Œwaitå’Œsignalå¯ä»¥æ˜¯<u>ç¨‹åºè¿‡ç¨‹</u>ï¼›å¯ä»¥ä½¿ç”¨è¯­è¨€æœºåˆ¶å®ç°éœå°”ç®¡ç¨‹ã€‚</p><p>ä¸è¦æ±‚signalæ“ä½œæ˜¯è¿‡ç¨‹é¢˜çš„æœ€åä¸€ä¸ªæ“ä½œï¼Œä¸”waitå’Œsignalå¯ä»¥è¢«ä¸­æ–­</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// éœå°”ç®¡ç¨‹ä¸­çš„ä¿¡å·é‡</span><br>mutex; <span class="hljs-comment">// è°ƒç”¨ç®¡ç¨‹è¿‡ç¨‹çš„äº’æ–¥ä¿¡å·é‡</span><br>next; <span class="hljs-comment">// å‘å‡ºsignalæ“ä½œçš„è¿›ç¨‹æŒ‚èµ·è‡ªå·±çš„ä¿¡å·é‡</span><br>next_count; <span class="hljs-comment">// åœ¨nextä¸Šç­‰å¾…çš„ä¿¡å·é‡</span><br><br><span class="hljs-comment">// éœå°”ç®¡ç¨‹ä¸­çš„æ¡ä»¶å˜é‡</span><br>x_sem; <span class="hljs-comment">// ä¸èµ„æºç›¸å…³çš„ä¿¡å·é‡</span><br>x_count; <span class="hljs-comment">// åœ¨x_semä¸Šç­‰å¾…çš„è¿›ç¨‹æ•°</span><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c">procedure <span class="hljs-title function_">wait</span><span class="hljs-params">(var x_sem : semaphore, var x_count : integer, var IM)</span>&#123;<br>    x_count += <span class="hljs-number">1</span><br>    <span class="hljs-comment">// å¦‚æœæœ‰åœ¨nextä¸Šç­‰å¾…çš„è¿›ç¨‹ï¼Œå…ˆé‡Šæ”¾åœ¨nextä¸Šç­‰å¾…çš„è¿›ç¨‹</span><br>    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å°±é‡Šæ”¾ç­‰å¾…è¿›å…¥ç®¡ç¨‹çš„è¿›ç¨‹</span><br>    <span class="hljs-keyword">if</span> IM.next_count &gt; <span class="hljs-number">0</span> then V(IM.next) <span class="hljs-keyword">else</span> V(IM.mutex)<br>    P(x_sem)<br>    x_count -= <span class="hljs-number">1</span><br>&#125;<br><br>procedure signal(var x_sem : semaphore, var x_count : integer, var IM)&#123;<br><span class="hljs-keyword">if</span> x_count &gt; <span class="hljs-number">0</span> then<br>IM.next_count += <span class="hljs-number">1</span><br>V(x_sem)<br>P(IM.next) <span class="hljs-comment">// æ‰§è¡Œsignalæ“ä½œçš„è¿›ç¨‹é˜»å¡è‡ªå·±</span><br>IM.next_count -= <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">enter</span><span class="hljs-params">(InterfaceModule &amp;IM)</span>&#123;<br>    P(IM.mutex);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">leave</span><span class="hljs-params">(InterfaceModule &amp;IM)</span>&#123;<br>    <span class="hljs-keyword">if</span> (IM.next_count &gt; <span class="hljs-number">0</span>)<br>        V(IM.next);<br>    <span class="hljs-keyword">else</span> <br>        V(IM.mutex);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å“²å­¦å®¶é—®é¢˜">å“²å­¦å®¶é—®é¢˜</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230205100248377.png" /></p><ul><li>ç­‰å¾…å‰å­çš„æ–¹æ¡ˆï¼šå¯èƒ½ä¼šäº§ç”Ÿæ­»é”ï¼ˆå…ˆæ‹¿ä¸€ä¸ªå†æ‹¿ä¸€ä¸ªï¼‰</li><li>ç­‰å¾…ç›˜å­çš„æ–¹æ¡ˆï¼šä¸€æ¬¡æ‹¿ä¸¤ä¸ªå‰å­</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230205102006154.png" /></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">process <span class="hljs-title function_">philosopher_i</span><span class="hljs-params">()</span>&#123;<br>    L: thinking();<br>    <span class="hljs-comment">// è¿›å…¥ç®¡ç¨‹çš„é˜Ÿåˆ—</span><br>    P(IM.mutex);<br>    dining_philosopers.pickup(i);<br>    <span class="hljs-keyword">if</span> IM.next_count &gt; <span class="hljs-number">0</span> then <span class="hljs-title function_">V</span><span class="hljs-params">(IM.next)</span>; <span class="hljs-keyword">else</span> V(IM.mutex);<br>    <br>    eating();<br>    <br>    P(IM.mutex);<br>    dining_philosophers.putdown();<br>    <span class="hljs-keyword">if</span> IM.next_count &gt; <span class="hljs-number">0</span> then <span class="hljs-title function_">V</span><span class="hljs-params">(IM.next)</span>; <span class="hljs-keyword">else</span> V(IM.mutex);<br>    <br>    <span class="hljs-keyword">goto</span> L;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è¯»è€…å†™è€…é—®é¢˜">è¯»è€…å†™è€…é—®é¢˜</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230205101343780.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230205101917064.png" /></p><h3 id="ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜">ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211194335363.png" /></p><h3 id="è‹¹æœæ©˜å­é—®é¢˜">è‹¹æœæ©˜å­é—®é¢˜</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230211195116094.png" /></p><h2 id="è¿›ç¨‹é€šä¿¡">6.5 è¿›ç¨‹é€šä¿¡</h2><h3 id="è¿›ç¨‹é€šä¿¡-1">6.5.1 è¿›ç¨‹é€šä¿¡</h3><ul><li>äº¤å¾€è¿›ç¨‹é€šè¿‡ä¿¡å·é‡æ“ä½œå®ç°è¿›ç¨‹äº’æ–¥å’ŒåŒæ­¥ï¼Œè¿™æ˜¯ä¸€ç§ä½çº§é€šä¿¡æ–¹å¼</li><li>è¿›ç¨‹æœ‰æ—¶è¿˜éœ€è¦äº¤æ¢æ›´å¤šçš„ä¿¡æ¯ï¼Œå¯ä»¥å¼•è¿›é«˜çº§é€šä¿¡æ–¹å¼â€”â€”è¿›ç¨‹é€šä¿¡æœºåˆ¶ï¼Œå®ç°è¿›ç¨‹é—´ç”¨==ä¿¡ä»¶==æ¥äº¤æ¢ä¿¡æ¯</li><li>è¿›ç¨‹é€šä¿¡æ‰©å……äº†å¹¶å‘è¿›ç¨‹çš„æ•°æ®å…±äº«ã€</li><li>è¿›ç¨‹ç›´æ¥é€šä¿¡<ul><li>å‘é€æˆ–æ¥æ”¶ä¿¡ä»¶çš„è¿›ç¨‹æŒ‡å‡ºä¿¡ä»¶å‘ç»™è°æˆ–ä»è°é‚£é‡Œæ¥æ”¶ä¿¡ä»¶</li><li><code>send(P, ä¿¡ä»¶)</code>ï¼šæŠŠä¿¡ä»¶å‘é€ç»™è¿›ç¨‹P</li><li><code>receive(Q, ä¿¡ä»¶)</code>ï¼šä»è¿›ç¨‹Qæ¥æ”¶ä¿¡ä»¶</li></ul></li><li>è¿›ç¨‹é—´æ¥é€šä¿¡<ul><li>å‘é€æˆ–è€…æ¥æ”¶ä¿¡ä»¶é€šè¿‡ä¸€ä¸ªä¿¡ç®±æ¥è¿›è¡Œï¼Œè¯¥ä¿¡ç®±æœ‰å”¯ä¸€æ ‡è¯†ç¬¦</li><li>å¤šä¸ªè¿›ç¨‹å…±äº«ä¸€ä¸ªä¿¡ç®±<ul><li><code>send(A, ä¿¡ä»¶)</code>ï¼šæŠŠä¿¡ä»¶å‘é€ç»™ä¿¡ç®±A</li><li><code>receive(A, ä¿¡ä»¶)</code>ï¼šä»ä¿¡ç®±Aæ¥æ”¶ä¿¡ä»¶</li></ul></li><li>ä¿¡ç®±å¯ä»¥åˆ†æˆä¿¡ç®±ç‰¹å¾å’Œä¿¡ç®±ä½“ä¸¤éƒ¨åˆ†<ul><li>ä¿¡ç®±ç‰¹å¾ï¼šæŒ‡å‡ºä¿¡ç®±å®¹é‡ã€ä¿¡ä»¶æ ¼å¼ã€æŒ‡é’ˆç­‰</li><li>ä¿¡ç®±ä½“ç”¨æ¥å­˜æ”¾ä¿¡ä»¶ï¼Œåˆ†æˆè‹¥å¹²ä¸ªåŒºï¼Œæ¯ä¸ªåŒºå®¹çº³ä¸€å°ä¿¡</li></ul></li></ul></li><li>å‘é€ä¿¡ä»¶åŸè¯­å¤„ç†æµç¨‹<ul><li>æŒ‡å®šçš„ä¿¡ç®±æœªæ»¡=ã€‹æŠŠä¿¡ä»¶é€å…¥ä¿¡ç®±ä¸­æŒ‡é’ˆæ‰€æŒ‡ç¤ºä½ç½®ï¼Œé‡Šæ”¾ç­‰å¾…è¯¥ä¿¡ç®±ä¸­æŒ‡é’ˆçš„ç­‰å¾…è€…</li><li>å¦åˆ™=ã€‹å‘é€ä¿¡ä»¶è€…è¢«ç½®æˆ<strong>ç­‰å¾…ä¿¡ç®±</strong>çš„çŠ¶æ€</li></ul></li><li>æ¥æ”¶ä¿¡ä»¶åŸè¯­å¤„ç†æµç¨‹<ul><li>æŒ‡å®šä¿¡ç®±æœ‰ä¿¡ä»¶=ã€‹å–å‡ºä¸€å°ä¿¡ä»¶ï¼Œé‡Šæ”¾ç­‰å¾…ä¿¡ç®±çš„ç­‰å¾…è€…</li><li>å¦åˆ™=ã€‹æ¥æ”¶ä¿¡ä»¶è€…è¢«ç½®æˆ<strong>ç­‰å¾…ä¿¡ç®±ä¸­ä¿¡ä»¶</strong>çš„çŠ¶æ€</li></ul></li></ul><h3 id="é«˜çº§è¿›ç¨‹é€šä¿¡æœºåˆ¶">6.5.2 é«˜çº§è¿›ç¨‹é€šä¿¡æœºåˆ¶</h3><ul><li>åŸºäºå­—èŠ‚æµçš„è¿›ç¨‹ä¿¡æ¯è§„çº¦</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230207153352490.png" /></p><ul><li>åŸºäºRPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰/XDRï¼ˆå¤–éƒ¨æ•°æ®è¡¨ç¤ºï¼‰çš„é«˜çº§é€šä¿¡è§„çº¦</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230207153541833.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230213141912210.png" /></p><h2 id="æ­»é”">6.6 æ­»é”</h2><h3 id="æ­»é”çš„äº§ç”Ÿ">6.6.1 æ­»é”çš„äº§ç”Ÿ</h3><ul><li>==æ­»é”==ï¼šä¸€ç»„è¿›ç¨‹å¤„äºæ­»é”çŠ¶æ€æ˜¯æŒ‡ï¼šæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…è¢«å¦ä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰çš„ã€ä¸èƒ½æŠ¢å çš„èµ„æºã€‚</li><li>æ­»é”çš„äº§ç”Ÿä¸ä»…ä¸ç³»ç»Ÿæ‹¥æœ‰çš„<u>èµ„æºæ•°é‡</u>ç›¸å…³ï¼Œè€Œä¸”ä¸<u>èµ„æºåˆ†é…ç­–ç•¥</u>ï¼Œ<u>è¿›ç¨‹å¯¹èµ„æºçš„ä½¿ç”¨è¦æ±‚</u>ä»¥åŠ<u>å¹¶å‘è¿›ç¨‹çš„æ¨è¿›é¡ºåº</u>æœ‰å…³</li><li>äº§ç”Ÿæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶ï¼š<ol type="1"><li>==äº’æ–¥æ¡ä»¶==ï¼šè¿›ç¨‹åº”äº’æ–¥ä½¿ç”¨èµ„æºï¼Œä»»ä¸€æ—¶åˆ»ä¸€ä¸ªèµ„æºä»…ä¸ºä¸€ä¸ªè¿›ç¨‹ç‹¬å </li><li>==å æœ‰å’Œç­‰å¾…æ¡ä»¶==ï¼šä¸€ä¸ªè¿›ç¨‹è¯·æ±‚ä¸åˆ°èµ„æºå¾—ä¸åˆ°æ»¡è¶³è€Œç­‰å¾…æ—¶ï¼Œä¸é‡Šæ”¾å·²å æœ‰çš„èµ„æº</li><li>==ä¸å‰¥å¤ºæ¡ä»¶==ï¼šä»»ä¸€è¿›ç¨‹ä¸èƒ½ä»å¦ä¸€è¿›ç¨‹é‚£é‡ŒæŠ¢å¤ºèµ„æº</li><li>==å¾ªç¯ç­‰å¾…æ¡ä»¶==ï¼šå­˜åœ¨ä¸€ä¸ªå¾ªç¯ç­‰å¾…é“¾ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹åˆ†åˆ«ç­‰å¾…å®ƒå‰ä¸€ä¸ªè¿›ç¨‹æ‰€æŒæœ‰çš„èµ„æº</li></ol></li></ul><h3 id="æ­»é”çš„é˜²æ­¢">6.6.2 æ­»é”çš„é˜²æ­¢</h3><blockquote><p>ç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶ä¹‹ä¸€ï¼Œå°±å¯ä»¥é˜²æ­¢æ­»é”</p></blockquote><ol type="1"><li>äº’æ–¥æ¡ä»¶ï¼šå°†ç‹¬å å‹èµ„æºæ”¹æˆå…±äº«æ€§èµ„æºï¼Œä½¿èµ„æºå¯ä»¥åŒæ—¶è®¿é—®è€Œä¸æ˜¯äº’æ–¥ä½¿ç”¨<ul><li>éƒ¨åˆ†èµ„æºæ˜¯å¤©ç”Ÿå…·æœ‰äº’æ–¥æ€§ï¼Œä¸èƒ½è¢«åŒæ—¶è®¿é—®</li></ul></li><li>å æœ‰å’Œç­‰å¾…æ¡ä»¶ï¼š<strong>é™æ€åˆ†é…</strong>ã€‚ä¸€ä¸ªè¿›ç¨‹å¿…é¡»åœ¨æ‰§è¡Œå‰å°±ç”³è¯·å®ƒæ‰€è¦çš„å…¨éƒ¨èµ„æºï¼Œå¹¶ä¸”ç›´åˆ°å®ƒæ‰€è¦çš„èµ„æºéƒ½å¾—åˆ°æ»¡è¶³ä¹‹åæ‰å¼€å§‹æ‰§è¡Œ<ul><li>å®ç°ç®€å•ï¼Œä½†æ˜¯ä¼šä¸¥é‡é™ä½æ“ä½œç³»ç»Ÿèµ„æºåˆ©ç”¨ç‡</li></ul></li><li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šé‡‡ç”¨å‰¥å¤ºå¼è°ƒåº¦æ–¹æ³•</li><li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼š<strong>å±‚æ¬¡åˆ†é…</strong>ï¼ŒåŠ¨æ€åˆ†é…ã€‚èµ„æºè¢«åˆ†æˆå¤šä¸ªå±‚æ¬¡ï¼ˆæ’åºï¼‰ï¼›<ul><li>ä¸€ä¸ªè¿›ç¨‹å¾—åˆ°æŸä¸€å±‚çš„ä¸€ä¸ªèµ„æºåï¼Œåªèƒ½å†ç”³è¯·åœ¨è¾ƒé«˜å±‚çš„èµ„æºï¼›</li><li>ä¸€ä¸ªè¿›ç¨‹è¦é‡Šæ”¾æŸä¸€å±‚çš„ä¸€ä¸ªèµ„æºï¼Œå¿…é¡»å…ˆé‡Šæ”¾æ‰€å ç”¨çš„è¾ƒé«˜å±‚çš„èµ„æºï¼›</li><li>å¯¹äºåŒä¸€å±‚çš„èµ„æºï¼Œåªèƒ½ä¸€ä¸ªä¸€ä¸ªåœ°å æœ‰ã€‚</li></ul></li></ol><h3 id="æ­»é”çš„é¿å…">6.6.3 æ­»é”çš„é¿å…</h3><blockquote><p>åœ¨ä¸ºç”³è¯·è€…åˆ†é…èµ„æºå‰å…ˆæµ‹è¯•ç³»ç»ŸçŠ¶æ€ï¼Œè‹¥æŠŠèµ„æºåˆ†é…ç»™ç”³è¯·è€…ä¼šäº§ç”Ÿæ­»é”çš„è¯ï¼Œåˆ™æ‹’ç»åˆ†é…ï¼Œå¦åˆ™æ¥å—ç”³è¯·ï¼Œåˆ†é…èµ„æº</p></blockquote><p>==é“¶è¡Œå®¶ç®—æ³•==ï¼šæ£€æŸ¥ç”³è¯·è€…å¯¹èµ„æºçš„æœ€å¤§éœ€æ±‚é‡ï¼Œå¦‚æœç°å­˜çš„èµ„æºå¯ä»¥æ»¡è¶³å®ƒçš„æœ€å¤§éœ€æ±‚é‡å°±å…è®¸å½“å‰çš„ç”³è¯·ã€‚</p><ul><li>ç»™å®šå››ä¸ªé›†åˆï¼š<spanclass="math inline">\(Rã€Vã€Cã€A\)</span>ï¼Œåˆ†åˆ«è¡¨ç¤ºèµ„æºæ€»æ•°ã€å½“å‰å¯ç”¨èµ„æºæ€»æ•°ã€è¿›ç¨‹å£°ç§°éœ€è¦çš„æœ€å¤§èµ„æºæ•°ã€å·²ç»åˆ†é…ç»™è¿›ç¨‹çš„èµ„æºæ•°</li><li>å¦‚æœå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªè¿›ç¨‹åºåˆ—ï¼ŒæŒ‰ç…§è¯¥è¿›ç¨‹åºåˆ—å»åˆ†é…èµ„æºï¼Œå¯ä»¥æ»¡è¶³æ‰€æœ‰èµ„æºçš„éœ€è¦ï¼Œåˆ™ç§°ç³»ç»Ÿå¤„äºå®‰å…¨æ€§çŠ¶æ€</li></ul><h3 id="æ­»é”çš„æ£€æµ‹">6.6.4 æ­»é”çš„æ£€æµ‹</h3><blockquote><p>å®šæ—¶è¿è¡Œä¸€ä¸ªâ€æ­»é”æ£€æµ‹â€œç¨‹åºï¼Œåˆ¤æ–­ç³»ç»Ÿå†…æ˜¯å¦å·²å‡ºç°æ­»é”ï¼Œè‹¥æ£€æµ‹åˆ°æ­»é”åˆ™è®¾æ³•åŠ ä»¥è§£é™¤</p></blockquote><ul><li>å»ºç«‹ä¸¤å¼ è¡¨ï¼šç­‰å¾…èµ„æºè¡¨å’Œå ç”¨èµ„æºè¡¨</li><li>åˆ—å‡ºæ‰€æœ‰çš„â€ç­‰å¾…å ç”¨å…³ç³»â€œ</li><li>ç”¨Warshallä¼ é€’é—­åŒ…ç®—æ³•æ£€æµ‹æ˜¯å¦æœ‰æ­»é”å‘ç”Ÿ</li><li>è§£å†³æ–¹æ³•ï¼ˆæ­»é”æ˜¯ä¸€ä¸ªå°æ¦‚ç‡äº‹ä»¶ï¼‰<ul><li>é‡æ–°æ‰§è¡Œ</li><li>è®¾ç½® <strong>æ ¡éªŒç‚¹</strong>ï¼Œå›é€€åˆ°æ ¡éªŒç‚¹å¼€å§‹æ‰§è¡Œ</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> nju-course-review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab7 networking</title>
      <link href="/2023/02/02/6.S081/6.S081-lab7-net/"/>
      <url>/2023/02/02/6.S081/6.S081-lab7-net/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯è¦æ±‚">1 èƒŒæ™¯è¦æ±‚</h2><ul><li><p>ä½¿ç”¨ä¸€ä¸ªç½‘ç»œè®¾å¤‡E1000æ¥å¤„ç†ç½‘ç»œé€šä¿¡ã€‚</p></li><li><p>åœ¨æ¨¡æ‹Ÿçš„LANä¸‹ï¼Œxv6çš„IPåœ°å€ä¸º<code>10.0.2.15</code>ï¼Œä¸»æœºçš„IPåœ°å€ä¸º<code>10.0.2.2</code></p></li><li><p>å½“xv6ä½¿ç”¨E1000å‘ç”Ÿä¸€ä¸ªæŠ¥æ–‡åˆ°<code>10.0.2.2</code>ï¼Œqemuä¼šå°†è¯¥æŠ¥æ–‡ä¼ é€’ç»™çœŸå®ä¸»æœºçš„æ­£ç¡®åº”ç”¨</p></li><li><p>è¦ä½¿ç”¨QEMUçš„<ahref="https://wiki.qemu.org/Documentation/Networking#User_Networking_.28SLIRP.29"><code>user-mode network stack</code></a></p></li><li><p>æ‰€æœ‰çš„æ¥å¾€packetséƒ½è®°å½•åœ¨<code>packets.pcap</code>æ–‡ä»¶ä¸­</p></li><li><p><code>kernel/e1000.c</code>åŒ…å«äº†åˆå§‹åŒ–ä»£ç ä»¥åŠå‘é€å’Œæ¥æ”¶packetsçš„ç©ºå‡½æ•°</p></li><li><p><code>kernel/e1000_dev.h</code>åŒ…å«äº†<ahref="https://pdos.csail.mit.edu/6.828/2021/readings/8254x_GBe_SDM.pdf">å¯„å­˜å™¨å’Œæ ‡å¿—ä½çš„å®šä¹‰</a></p></li><li><p><code>kernel/net.c</code>å’Œ<code>kernel/net.h</code>åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ç½‘ç»œæ ˆï¼Œå®ç°äº†IPã€UDPã€ARPåè®®ï¼›è¿˜åŒ…å«äº†ä¸€ä¸ªå­˜æ”¾packetçš„æ•°æ®ç»“æ„<code>mbuf</code></p></li><li><p><code>kernel/pci.c</code>åŒ…å«äº†åœ¨xv6å¯åŠ¨æ—¶åœ¨PCIæ€»çº¿ä¸Šæœç´¢E1000ç½‘å¡çš„ä»£ç </p></li><li><p>å®ç°<code>e1000_transmit()</code>å’Œ<code>e1000_recv()</code>ï¼Œä½¿å¾—é©±åŠ¨ç¨‹åºå¯ä»¥ä¼ è¾“å’Œæ¥æ”¶packet</p></li><li><p><code>e1000_init()</code>å‡½æ•°é…ç½®E1000ä»RAMè¯»å–packetå¹¶å°†æ¥æ”¶åˆ°çš„packetå†™è¿›RAMï¼ˆDMAæ–¹å¼ï¼‰</p></li><li><p>ç”±äºpacketsçªå‘åˆ°è¾¾çš„é€Ÿåº¦å¯èƒ½æ¯”é©±åŠ¨ç¨‹åºå¤„ç†ä»–ä»¬çš„é€Ÿåº¦æ›´å¿«ï¼Œ<code>e1000_init()</code>æä¾›äº†å¤šä¸ªbufferç»™E1000å»å†™packets</p></li><li><p>E1000è¦æ±‚è¿™äº›buffersç”±RAMä¸­çš„æè¿°ç¬¦æ•°ç»„æ¥æè¿°ï¼Œæ¯ä¸ªæè¿°ç¬¦åŒ…å«äº†RAMçš„ä¸€ä¸ªåœ°å€ï¼ŒE1000å¯ä»¥åœ¨å…¶ä¸­å†™å…¥æ¥æ”¶åˆ°çš„packet</p></li><li><p><code>struct rx_desc</code>æè¿°äº†æè¿°ç¬¦çš„æ ¼å¼ï¼Œæè¿°ç¬¦çš„æ•°ç»„è¢«ç§°ä¸ºæ¥æ”¶å¾ªç¯é˜Ÿåˆ—</p></li><li><p><code>e1000_init()</code>ä½¿ç”¨<code>mbufalloc()</code>å°†E1000çš„<code>mbuf</code>æ•°æ®åŒ…ç¼“å†²åŒºåˆ†é…åˆ°DMAä¸­</p></li><li><p>è¿˜æœ‰ä¸€ä¸ªä¼ è¾“å¾ªç¯é˜Ÿåˆ—ç”¨æ¥å­˜æ”¾éœ€è¦å‘é€çš„packet</p></li><li><p>è¿™ä¸ªä¸¤ä¸ªå¾ªç¯é˜Ÿåˆ—çš„å¤§å°ä¸º<code>RX_RING_SIZE</code>å’Œ<code>TX_RING_SIZE</code></p></li><li><p>å½“<code>net.c</code>ä¸­çš„ç½‘ç»œæ ˆéœ€è¦å‘é€ä¸€ä¸ªpacketæ—¶ï¼Œä¼šè°ƒç”¨<code>e1000_transmit()</code>å¸¦æœ‰ä¸€ä¸ªå­˜æ”¾äº†éœ€è¦å‘é€çš„packetçš„<code>mbuf</code>ã€‚</p></li></ul><p>å®Œæˆ <code>e1000_transmit</code>ï¼š</p><ul><li>TDTå¯„å­˜å™¨ï¼šå­˜æ”¾äº†ä¼ è¾“æè¿°ç¬¦å¾ªç¯ç¼“å†²åŒºçš„æœ«å°¾æŒ‡é’ˆï¼Œæ˜¯ä¸€ä¸ªåç§»é‡ã€‚</li></ul><h2 id="å®ç°">2 å®ç°</h2><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230316235026877.png" /></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230316235343584.png"alt="Transmit Descriptor Ring Structure" /><figcaption aria-hidden="true">Transmit Descriptor RingStructure</figcaption></figure><ul><li>ç™½è‰²éƒ¨åˆ†æ˜¯ç”±ç¡¬ä»¶ç®¡ç†çš„ï¼›ç°è‰²éƒ¨åˆ†æ˜¯ç”±è½¯ä»¶ç®¡ç†çš„ï¼Œè¡¨ç¤ºçš„æ˜¯å·²ç»å‘é€è¿˜æœªè¢«å›æ”¶çš„packet</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span><br><span class="hljs-title function_">e1000_transmit</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> mbuf *m)</span><br>&#123;<br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// Your code here.</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// the mbuf contains an ethernet frame; program it into</span><br>  <span class="hljs-comment">// the TX descriptor ring so that the e1000 sends it. Stash</span><br>  <span class="hljs-comment">// a pointer so that it can be freed after sending.</span><br>  <span class="hljs-comment">//</span><br><br>  <span class="hljs-comment">// 1.acquire the lock</span><br>  acquire(&amp;e1000_lock);<br>  <span class="hljs-comment">// 2.reading the E1000_TDT control register =&gt; get the tail index of the tx ring</span><br>  uint32 tx_desc_tail_idx = regs[E1000_TDT];<br>  <span class="hljs-comment">// 3.check if the ring overflowing...</span><br>  <span class="hljs-keyword">if</span> ((tx_ring[tx_desc_tail_idx].status &amp; E1000_TXD_STAT_DD) == <span class="hljs-number">0</span>) &#123;<br>    release(&amp;e1000_lock);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; <span class="hljs-comment">// hasn&#x27;t finish last transmition</span><br>  &#125;<br>  <span class="hljs-comment">// 4. free the mbuf if needed</span><br>  <span class="hljs-keyword">if</span> (tx_mbufs[tx_desc_tail_idx]) &#123;<br>    mbuffree(tx_mbufs[tx_desc_tail_idx]);<br>  &#125;<br>  <span class="hljs-comment">// 5. fill the descriptor</span><br>  tx_mbufs[tx_desc_tail_idx] = m;<br>  tx_ring[tx_desc_tail_idx].length = m-&gt;len;<br>  tx_ring[tx_desc_tail_idx].addr = (uint64)m-&gt;head;<br>  tx_ring[tx_desc_tail_idx].cmd = (E1000_TXD_CMD_EOP | E1000_TXD_CMD_RS); <span class="hljs-comment">// set the cmd flags</span><br>  <span class="hljs-comment">// 6. update the tail pointer</span><br>  regs[E1000_TDT] = (tx_desc_tail_idx + <span class="hljs-number">1</span>) % TX_RING_SIZE;<br>  <span class="hljs-comment">// 7.release the lock</span><br>  release(&amp;e1000_lock);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230316235048924.png" /></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230316235439080.png"alt="Receive Descriptor Ring Structure" /><figcaption aria-hidden="true">Receive Descriptor RingStructure</figcaption></figure><ul><li>ç™½è‰²éƒ¨åˆ†æ˜¯ç”±ç¡¬ä»¶ç®¡ç†çš„ï¼›ç°è‰²éƒ¨åˆ†æ˜¯ç”±è½¯ä»¶ç®¡ç†çš„ï¼Œè¡¨ç¤ºè¢«ç¡¬ä»¶æ¥æ”¶ä½†æ˜¯è¿˜æœªè¢«è½¯ä»¶è¯†åˆ«å¤„ç†çš„packet</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">static</span> <span class="hljs-type">void</span><br><span class="hljs-title function_">e1000_recv</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// Your code here.</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-comment">// Check for packets that have arrived from the e1000</span><br>  <span class="hljs-comment">// Create and deliver an mbuf for each packet (using net_rx()).</span><br>  <span class="hljs-comment">//</span><br>  <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-comment">// 1. acquire the lock</span><br>    <span class="hljs-comment">// acquire(&amp;e1000_lock);</span><br>    <span class="hljs-comment">// 2. get the position of the next received packet</span><br>    uint32 next_packet_idx = (regs[E1000_RDT] + <span class="hljs-number">1</span>) % RX_RING_SIZE;<br>    <span class="hljs-comment">// 3. check if new packet available</span><br>    <span class="hljs-keyword">if</span> ((rx_ring[next_packet_idx].status &amp; E1000_RXD_STAT_DD) == <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-comment">// release(&amp;e1000_lock);</span><br>      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// no available packet</span><br>    &#125;<br>    <span class="hljs-comment">// 4. set the length and deliver the packet to the networking stack</span><br>    rx_mbufs[next_packet_idx]-&gt;len = rx_ring[next_packet_idx].length;<br>    net_rx(rx_mbufs[next_packet_idx]);<br>    <span class="hljs-comment">// 5. refresh the mbuf</span><br>    <span class="hljs-keyword">if</span> ((rx_mbufs[next_packet_idx] = mbufalloc(<span class="hljs-number">0</span>)) == <span class="hljs-number">0</span>)<br>      panic(<span class="hljs-string">&quot;e1000_recv&quot;</span>);<br>    <span class="hljs-comment">// 6. refresh the metadata in rx_ring</span><br>    rx_ring[next_packet_idx].addr = (uint64) rx_mbufs[next_packet_idx]-&gt;head;<br>    rx_ring[next_packet_idx].status &amp;= <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// 7. update the E1000_RDT</span><br>    regs[E1000_RDT] = next_packet_idx;<br>    <span class="hljs-comment">// 8. release the lock</span><br>    <span class="hljs-comment">// release(&amp;e1000_lock);</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„<code>e1000_recv</code>ä¸éœ€è¦è·å–é”ï¼Œå› ä¸ºè¯¥å‡½æ•°æ˜¯åœ¨å¤„ç†ä¸­æ–­æ—¶è¢«è°ƒç”¨çš„ï¼Œåº”è¯¥å·²ç»åœ¨ä¹‹å‰å°±è·å¾—è¿‡é”äº†ã€‚</p></blockquote><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230304194643726.png"alt="æµ‹è¯•ç»“æœ" /><figcaption aria-hidden="true">æµ‹è¯•ç»“æœ</figcaption></figure>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab5 Copy-on-Write</title>
      <link href="/2023/01/31/6.S081/6.S081-lab5-cow/"/>
      <url>/2023/01/31/6.S081/6.S081-lab5-cow/</url>
      
        <content type="html"><![CDATA[<h2 id="cowæœºåˆ¶ä»‹ç»">COWæœºåˆ¶ä»‹ç»</h2><p>COWçš„æœºåˆ¶å…¶å®éå¸¸ç®€å•ï¼Œæ ¸å¿ƒæ€æƒ³è¿˜æ˜¯å°†å†…å­˜çš„åˆ†é…æ¨è¿Ÿï¼šåœ¨<code>fork()</code>çš„æ—¶å€™åªæ˜¯å°†å­è¿›ç¨‹çš„è™šæ‹Ÿé¡µæ˜ å°„åˆ°çˆ¶è¿›ç¨‹çš„ç‰©ç†å†…å­˜ä¸Šï¼›å½“ä¹‹åå‘ç”Ÿäº†å®é™…çš„å†™å†…å­˜æ“ä½œå¼•å‘<code>page fault</code>åï¼Œå†è¿›è¡Œå®é™…çš„å†…å­˜åˆ†é…ã€‚</p><h2 id="cowå®ç°">COWå®ç°</h2><blockquote><p>å°½ç®¡COWçš„æœºåˆ¶éå¸¸ç®€å•ï¼Œå®ç°èµ·æ¥ä¹Ÿçœ‹ä¼¼ç®€å•ï¼Œä½†æ˜¯éå¸¸æ˜“é”™ï¼Œä¸”è°ƒè¯•éš¾åº¦ä¹Ÿæ¯”è¾ƒå¤§ï¼ˆå¤šæ ¸å¹¶å‘ï¼‰</p><p>å…·ä½“ä»£ç è§ï¼š<ahref="https://github.com/zhc-njdx/6.S081-Labs/tree/cow">cow lab</a></p></blockquote><p>å®ç°è¿‡ç¨‹åŸºæœ¬ä¸Šå‚è€ƒæ‰‹å†Œçš„é‚£å‡ æ­¥å°±è¡Œï¼š</p><p>1ã€ä¿®æ”¹ <code>uvmcopy()</code>å‡½æ•°ï¼Œå°†<code>parent</code>çš„ç‰©ç†é¡µæ˜ å°„åˆ°<code>child</code>çš„é¡µè¡¨ä¸­ï¼Œè€Œä¸æ˜¯åˆ†é…æ–°çš„ç‰©ç†é¡µï¼Œå¹¶ä¸”æ¸…ç©º<code>PTE_W</code>æ ‡å¿—ï¼Œè®¾ç½®<code>cow page</code>çš„æ ‡è¯†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// uvmcopy for cow fork</span><br><span class="hljs-comment">// it maps the parent&#x27;s physical pages into the child</span><br><span class="hljs-comment">// instead of allocating the new pages</span><br><span class="hljs-comment">// and clear the PTE_W flag and set the cow page sign</span><br><span class="hljs-type">int</span><br><span class="hljs-title function_">uvmcopy</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> old, <span class="hljs-type">pagetable_t</span> new, uint64 sz)</span><br>&#123;<br>  <span class="hljs-type">pte_t</span> *pte;<br>  uint64 pa, i;<br>  uint flags;<br><br>  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; sz; i += PGSIZE)&#123;<br>    <span class="hljs-keyword">if</span>((pte = walk(old, i, <span class="hljs-number">0</span>)) == <span class="hljs-number">0</span>)<br>      panic(<span class="hljs-string">&quot;uvmcopy: pte should exist&quot;</span>);<br>    <span class="hljs-keyword">if</span>((*pte &amp; PTE_V) == <span class="hljs-number">0</span>)<br>      panic(<span class="hljs-string">&quot;uvmcopy: page not present&quot;</span>);<br>    pa = PTE2PA(*pte);<br>    flags = PTE_FLAGS(*pte);<br><br>    flags = (flags &amp; (~PTE_W)) | PTE_COW; <span class="hljs-comment">// clear the PTE_W and set the cow sign</span><br>    *pte = PA2PTE(pa) | flags; <span class="hljs-comment">// update the parent&#x27;s pte flags</span><br><br>    <span class="hljs-keyword">if</span>(mappages(new, i, PGSIZE, pa, flags) != <span class="hljs-number">0</span>)&#123;<br>      panic(<span class="hljs-string">&quot;uvmcopy: can&#x27;t map the parent&#x27;s physical pages into child.&quot;</span>);<br>      <span class="hljs-keyword">goto</span> err;<br>    &#125;<br>    add_refcount(PGROUNDDOWN(pa));<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>  err:<br>    uvmunmap(new, <span class="hljs-number">0</span>, i / PGSIZE, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨<code>usertrap()</code>ä¸­è¯†åˆ«<code>page fault</code>ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230131231225955.png" /></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">...<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (scause == <span class="hljs-number">15</span> || scause == <span class="hljs-number">12</span>)&#123;<br>    <span class="hljs-comment">// page fault</span><br>    uint64 va = r_stval(); <span class="hljs-comment">// error va</span><br>    <span class="hljs-keyword">if</span> (cowcopy(p-&gt;pagetable, va) != <span class="hljs-number">0</span>) &#123;<br>      p-&gt;killed = <span class="hljs-number">1</span>;<br>    &#125;<br>&#125; <br>...<br></code></pre></td></tr></table></figure><p><strong>3ã€å¯¹ç‰©ç†é¡µè®¾ç½®å¼•ç”¨è®¡æ•°æœºåˆ¶</strong></p><blockquote><p>è¿™ä¸€éƒ¨åˆ†åº”è¯¥æ˜¯æœ€éš¾çš„ä¸€å—ï¼Œéœ€è¦è€ƒè™‘å¹¶å‘åŠ é”ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">spinlock</span> <span class="hljs-title">lock</span>;</span><br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">run</span> *<span class="hljs-title">freelist</span>;</span><br>  uint8 page_references[(PHYSTOP-KERNBASE)/PGSIZE];<br>&#125; kmem;<br></code></pre></td></tr></table></figure><p>4ã€ä¿®æ”¹<code>copyout</code>ï¼Œæœºåˆ¶å’Œå¤„ç†<code>page fault</code>ä¸€æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">...<br>va0 = PGROUNDDOWN(dstva);<br><br>   <span class="hljs-keyword">if</span> (cowcopy(pagetable, va0) != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>   pa0 = walkaddr(pagetable, va0);<br>...<br></code></pre></td></tr></table></figure><h2 id="é”™è¯¯æ±‡æ€»">é”™è¯¯æ±‡æ€»</h2><p>1ã€æŠ¥é”™ remap</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230201113935903.png" /></p><blockquote><p>åŸå› æ˜¯åœ¨å»ºç«‹æ–°çš„æ˜ å°„ä¹‹å‰ï¼Œè¦å…ˆå°†åŸæ¥çš„æ˜ å°„å–æ¶ˆæ‰ï¼›</p></blockquote><p><strong>2ã€scause = 2 éæ³•æŒ‡ä»¤</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230201124453515.png" /></p><blockquote><p>æ€è€ƒæ’é”™çš„è¿‡ç¨‹ï¼š</p><p>åˆæ­¥çŒœæµ‹æ˜¯ï¼šåœ¨ç”¨æˆ·ç©ºé—´ä½¿ç”¨å†…æ ¸æŒ‡ä»¤ï¼Ÿ</p><p>æ ¹æ®backtraceå‡ºé”™çš„ä½ç½®ï¼šåœ¨ç”¨æˆ·ç©ºé—´æ˜¯ <code>cowtest</code> ä¸­çš„<code>simpletest</code>ï¼Œåœ¨<code>wait(0)</code>åé¢çš„<code>print</code>è¯­å¥å¼•å‘äº†é”™è¯¯ï¼›åœ¨å†…æ ¸ç©ºé—´æ˜¯<code>r_scause()</code> å¼•å‘äº†é”™è¯¯</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230202162913328.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230202163324569.png" /></p><p><strong>å¯èƒ½æ˜¯åœ°å€ç©ºé—´å‡ºç°é”™è¯¯ï¼</strong>éœ€è¦ä¸¥æ ¼æ£€æŸ¥åœ°å€æ˜¯å¦è¶Šç•Œç­‰ï¼</p><p>ä½†æ˜¯ è¯¥é”™è¯¯ä¸€ç›´æ²¡æœ‰å¾—åˆ°è§£å†³</p></blockquote><p><font color='red'>ç»è¿‡é•¿æ—¶é—´çš„debugï¼Œå‘ç°å‡ºç°é”™è¯¯çš„åŸå› æ˜¯æ²¡æœ‰æ­£ç¡®åœ°å®ç°å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼Œå‡ºç°äº†å¹¶å‘çš„é”™è¯¯ã€‚</font>æœ¬æ¥åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯æƒ³å®ç°ä¸€ç‚¹æµ‹è¯•ä¸€ç‚¹çš„ï¼Œä»¥ä¸ºå®ç°å¥½äº†åŸºæœ¬çš„åŠŸèƒ½åº”è¯¥èƒ½è·‘è¿‡ç®€å•æµ‹è¯•ï¼Œæ‰€ä»¥åœ¨æ’é”™çš„æ—¶å€™ä¸€ç›´æ²¡æœ‰è€ƒè™‘æ˜¯å¼•ç”¨è®¡æ•°çš„é—®é¢˜ï¼</p><p><strong>3ã€å‡å°‘å¼•ç”¨è®¡æ•°çš„ä½ç½®</strong></p><p>åœ¨ä¿®æ”¹å¼•ç”¨è®¡æ•°æœºåˆ¶çš„æ—¶å€™ï¼Œæˆ‘æ˜¯å¸Œæœ›å°†å¼•ç”¨çš„æ›´æ–°ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œç„¶åå½“æ›´æ–°åçš„å¼•ç”¨ä¸º<code>0</code>çš„æ—¶å€™å†è°ƒç”¨<code>kfree</code>é‡Šæ”¾ç‰©ç†å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ ·å®ç°ç›¸å½“äºåœ¨<code>kfree</code>çš„å‰é¢åŠ äº†ä¸€å±‚å¼•ç”¨æ›´æ–°å‡½æ•°ï¼Œåœ¨<code>cow page</code>çš„ç›¸å…³å®ç°ä¸­æ˜¯å¯ä»¥æ­£ç¡®è°ƒåº¦å†…å­˜çš„é‡Šæ”¾ï¼Œä½†æ˜¯ç³»ç»Ÿçš„å…¶ä»–åœ°æ–¹ä¼šæœ‰ç›´æ¥è°ƒç”¨kfreeçš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´å³ä½¿è¯¥å†…å­˜é¡µçš„å¼•ç”¨ä¸ä¸º0è¯¥å†…å­˜é¡µè¿˜æ˜¯è¢«é‡Šæ”¾äº†çš„æƒ…å†µï¼Œæ‰€ä»¥å‡å°‘å¼•ç”¨è®¡æ•°çš„ä½ç½®åº”è¯¥åœ¨<code>kfree</code>ä¸­ã€‚</p><h2 id="ç»“æœ">ç»“æœ</h2><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230210104747576.png" /></p>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜æ€§èƒ½Goè¯­è¨€å‘è¡Œç‰ˆä¼˜åŒ–ä¸è½åœ°å®è·µ</title>
      <link href="/2023/01/19/Go/Memory-Management/"/>
      <url>/2023/01/19/Go/Memory-Management/</url>
      
        <content type="html"><![CDATA[<h2 id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–</h2><h3 id="æ¦‚è¿°">æ¦‚è¿°</h3><ul><li>ä»€ä¹ˆæ˜¯æ€§èƒ½ä¼˜åŒ–ï¼šæå‡è½¯ä»¶ç³»ç»Ÿå¤„ç†èƒ½åŠ›ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¶ˆè€—ï¼Œå……åˆ†å‘æ˜è®¡ç®—æœºç®—åŠ›</li><li>ä¸ºä»€ä¹ˆè¦åšæ€§èƒ½ä¼˜åŒ–<ul><li>ç”¨æˆ·ä½“éªŒï¼šå¸¦æ¥ç”¨æˆ·ä½“éªŒçš„æå‡</li><li>èµ„æºé«˜æ•ˆåˆ©ç”¨ï¼šé™ä½æˆæœ¬ï¼Œæé«˜æ•ˆç‡</li></ul></li></ul><h3 id="æ€§èƒ½ä¼˜åŒ–çš„å±‚é¢">æ€§èƒ½ä¼˜åŒ–çš„å±‚é¢</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119075809089.png" /></p><h3 id="æ€§èƒ½ä¼˜åŒ–çš„å¯ç»´æŠ¤æ€§">æ€§èƒ½ä¼˜åŒ–çš„å¯ç»´æŠ¤æ€§</h3><ul><li>ä¿è¯æ¥å£ç¨³å®šçš„å‰æä¸‹æ”¹è¿›å…·ä½“å®ç°</li><li>æµ‹è¯•ç”¨ä¾‹ï¼šè¦†ç›–å°½å¯èƒ½å¤šçš„åœºæ™¯ï¼Œæ–¹ä¾¿å›å½’</li><li>æ–‡æ¡£ï¼šåšäº†ä»€ä¹ˆï¼Œæ²¡åšä»€ä¹ˆï¼Œèƒ½è¾¾åˆ°æ€æ ·çš„æ•ˆæœ</li><li>éš”ç¦»ï¼šé€šè¿‡é€‰é¡¹æ§åˆ¶æ˜¯å¦å¼€å¯ä¼˜åŒ–</li><li>å¯è§‚æµ‹ï¼šå¿…è¦çš„æ—¥å¿—è¾“å‡º</li></ul><h2 id="è‡ªåŠ¨å†…å­˜ç®¡ç†">è‡ªåŠ¨å†…å­˜ç®¡ç†</h2><h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3><ul><li><p>åŠ¨æ€å†…å­˜</p><ul><li>ç¨‹åºåœ¨è¿è¡Œæ—¶æ ¹æ®éœ€æ±‚åŠ¨æ€åˆ†é…å†…å­˜ï¼š<code>malloc()</code></li></ul></li><li><p>è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼šæœ‰ç¨‹åºè¯­è¨€çš„è¿è¡Œæ—¶ç³»ç»Ÿç®¡ç†åŠ¨æ€å†…å­˜</p><ul><li>é¿å…æ‰‹åŠ¨å†…å­˜ç®¡ç†ï¼Œä¸“æ³¨äºå®ç°ä¸šåŠ¡é€»è¾‘</li><li>ä¿è¯å†…å­˜ä½¿ç”¨çš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ï¼š<code>double-free</code>ã€<code>use-after-free</code></li></ul></li><li><p>ä¸‰ä¸ªä»»åŠ¡</p><ul><li>ä¸ºæ–°å¯¹è±¡åˆ†é…ç©ºé—´</li><li>æ‰¾åˆ°å­˜æ´»å¯¹è±¡</li><li>å›æ”¶æ­»äº¡å¯¹è±¡çš„å†…å­˜ç©ºé—´</li></ul></li><li><p>ç›¸å…³æ¦‚å¿µ</p><ul><li><p><code>Mutator</code>ï¼šä¸šåŠ¡çº¿ç¨‹ï¼Œåˆ†é…æ–°å¯¹è±¡ï¼Œä¿®æ”¹å¯¹è±¡æŒ‡å‘å…³ç³»</p></li><li><p><code>Collector</code>ï¼š<code>GC</code>çº¿ç¨‹ï¼Œæ‰¾åˆ°å­˜æ´»å¯¹è±¡ï¼Œå›æ”¶æ­»äº¡å¯¹è±¡çš„å†…å­˜ç©ºé—´</p></li><li><p><code>Serial GC</code>ï¼šåªæœ‰ä¸€ä¸ª<code>collector</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119080759828.png" /></p></li><li><p><code>Parallel GC</code>ï¼šæ”¯æŒå¤šä¸ª<code>collectors</code>åŒæ—¶å›æ”¶çš„<code>GC</code>ç®—æ³•</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119080851305.png" /></p></li><li><p><code>Concurrent GC</code>ï¼š<code>mutator</code>å’Œ<code>collector</code>å¯ä»¥åŒæ—¶æ‰§è¡Œ</p><ul><li><strong><code>collectors</code>å¿…é¡»æ„ŸçŸ¥å¯¹è±¡æŒ‡å‘å…³ç³»çš„æ”¹å˜</strong></li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119080911240.png" /></p></li></ul></li><li><p>è¯„ä»·<code>GC</code>ç®—æ³•</p><ul><li>å®‰å…¨æ€§ï¼šä¸èƒ½å›æ”¶å­˜æ´»å¯¹è±¡</li><li>ååç‡ï¼šèŠ±åœ¨<code>GC</code>ä¸Šçš„æ—¶é—´</li><li>æš‚åœæ—¶é—´ï¼š<code>stop the world</code> ä¸šåŠ¡æ˜¯å¦æ„ŸçŸ¥</li><li>å†…å­˜å¼€é”€ï¼š<code>GC</code>å…ƒæ•°æ®å¼€é”€</li></ul></li></ul><h3 id="tracing-gc">Tracing GC</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119081945860.png" /></p><ul><li><p>å¯¹è±¡è¢«å›æ”¶çš„æ¡ä»¶ï¼šæŒ‡é’ˆæŒ‡å‘å…³ç³»ä¸å¯è¾¾çš„å¯¹è±¡</p></li><li><p>æ ‡è®°è·Ÿå¯¹è±¡</p><ul><li>é™æ€å˜é‡ã€å…¨å±€å˜é‡ã€å¸¸é‡ã€çº¿ç¨‹æ ˆ</li></ul></li><li><p>æ ‡è®°ï¼šæ‰¾åˆ°å¯è¾¾å¯¹è±¡</p><ul><li>æ±‚æŒ‡é’ˆæŒ‡å‘å…³ç³»çš„ä¼ é€’é—­åŒ…ï¼šä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯è¾¾å¯¹è±¡</li></ul></li><li><p>æ¸…ç†ï¼šæ‰€æœ‰ä¸å¯è¾¾å¯¹è±¡</p><ul><li><p>å°†å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–çš„å†…å­˜ç©ºé—´ï¼ˆ<code>Copying GC</code>ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119081533782.png" /></p></li><li><p>å°†æ­»äº¡å¯¹è±¡çš„å†…å­˜æ ‡è®°ä¸ºâ€œå¯åˆ†é…â€ï¼ˆ<code>Mark-sweep GC</code>ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119081739822.png" /></p></li><li><p>ç§»åŠ¨å¹¶æ•´ç†å­˜æ´»å¯¹è±¡ï¼ˆ<code>Mark-compact GC</code>ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119081843993.png" /></p></li></ul></li><li><p><strong>æ ¹æ®å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä½¿ç”¨ä¸åŒçš„æ ‡è®°å’Œæ¸…ç†ç­–ç•¥</strong></p></li></ul><h3 id="generational-gc">Generational GC</h3><ul><li>åˆ†ä»£å‡è¯´ï¼š<code>most objects die young</code></li><li><code>Intuition</code>ï¼šå¾ˆå¤šå¯¹è±¡åœ¨åˆ†é…å‡ºæ¥åå¾ˆå¿«å°±ä¸å†ä½¿ç”¨äº†</li><li>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰å¹´é¾„ï¼šç»å†<code>GC</code>çš„æ¬¡æ•°</li><li>ç›®çš„ï¼šå¯¹äºå¹´è½»å’Œè€å¹´çš„å¯¹è±¡ï¼Œåˆ¶å®šä¸åŒçš„<code>GC</code>ç­–ç•¥ï¼Œ<strong>é™ä½æ•´ä½“å†…å­˜ç®¡ç†çš„å¼€é”€</strong></li><li>ä¸åŒå¹´é¾„çš„å¯¹è±¡å¤„äº<code>heap</code>çš„ä¸åŒåŒºåŸŸ</li><li>å¹´è½»ä»£ï¼ˆ<code>Yong Generation</code>ï¼‰<ul><li>å¸¸è§„çš„å¯¹è±¡åˆ†é…</li><li>ç”±äºå­˜æ´»å¯¹è±¡å¾ˆå°‘ï¼ˆåŸºäºå‡è¯´ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨<code>copying collection</code></li><li><code>GC</code>ååç‡é«˜</li></ul></li><li>è€å¹´ä»£ï¼ˆ<code>Old Generation</code>ï¼‰<ul><li>å¯¹è±¡è¶‹å‘äºä¸€ç›´æ´»ç€ï¼Œåå¤å¤åˆ¶å¼€é”€è¾ƒå¤§</li><li>å¯ä»¥é‡‡ç”¨<code>mark-sweep collection</code></li></ul></li></ul><h3 id="reference-counting">Reference Counting</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119083041067.png" /></p><ul><li><p>æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å¼•ç”¨æ•°ç›®</p></li><li><p>å­˜æ´»æ¡ä»¶ï¼šå½“ä¸”ä»…å½“å¼•ç”¨æ•°&gt;0</p></li><li><p>ä¼˜ç‚¹</p><ul><li>å†…å­˜ç®¡ç†æ“ä½œè¢«å¹³æ‘Šåˆ°ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­</li><li>å†…å­˜ç®¡ç†ä¸éœ€è¦äº†è§£<code>runtime</code>çš„å®ç°ç»†èŠ‚ï¼š<code>C++</code>æ™ºèƒ½æŒ‡é’ˆï¼ˆ<code>smart pointer</code>ï¼‰</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>ç»´æŠ¤å¼•ç”¨è®¡è¾“çš„å¼€é”€è¾ƒå¤§ï¼šé€šè¿‡<strong>åŸå­æ“ä½œ</strong>ä¿è¯å¯¹å¼•ç”¨è®¡æ•°æ“ä½œçš„<strong>åŸå­æ€§</strong>å’Œ<strong>å¯è§æ€§</strong>ï¼ˆå¤šçº¿ç¨‹ï¼‰</li><li>æ— æ³•å›æ”¶ç¯å½¢æ•°æ®ç»“æ„â€”â€”<code>weak reference</code></li><li>å†…å­˜å¼€é”€ï¼šæ¯ä¸ªå¯¹è±¡éƒ½å¼•å…¥é¢å¤–å†…å­˜ç©ºé—´å­˜å‚¨å¼•ç”¨æ•°ç›®</li><li>å›æ”¶å†…å­˜æ—¶ä¾èµ–å¯èƒ½å¼•å‘æš‚åœï¼šå¦‚æœéœ€è¦å›æ”¶å¤§é‡å¯¹è±¡</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119083113960.png" /></p></li></ul><h2 id="goå†…å­˜ç®¡ç†åŠä¼˜åŒ–">Goå†…å­˜ç®¡ç†åŠä¼˜åŒ–</h2><h3 id="goå†…å­˜åˆ†é…">Goå†…å­˜åˆ†é…</h3><h4 id="åˆ†å—">åˆ†å—</h4><ul><li>ç›®æ ‡ï¼šä¸ºå¯¹è±¡åœ¨<code>heap</code>ä¸Šåˆ†é…å†…å­˜</li><li>æå‰å°†å†…å­˜åˆ†å—<ul><li>è°ƒç”¨ç³»ç»Ÿè°ƒç”¨<code>mmap</code>å‘<code>OS</code>ç”³è¯·ä¸€å¤§å—å†…å­˜ï¼Œä¾‹å¦‚<code>4MB</code></li><li>å…ˆå°†å†…å­˜åˆ’åˆ†æˆå¤§å—ï¼Œä¾‹å¦‚<code>8KB</code>ï¼Œç§°ä½œ<code>mspan</code></li><li>å†å°†å¤§å—ç»§ç»­åˆ’åˆ†æˆç‰¹å®šå¤§å°çš„å°å—ï¼Œç”¨äºå¯¹è±¡åˆ†é…</li><li><code>noscan mspan</code>ï¼šåˆ†é…ä¸åŒ…å«æŒ‡é’ˆçš„å¯¹è±¡â€”â€”<code>GC</code>ä¸éœ€è¦æ‰«æ</li><li><code>scan mspan</code>ï¼šåˆ†é…åŒ…å«æŒ‡é’ˆçš„å¯¹è±¡â€”â€”<code>GC</code>éœ€è¦æ‰«æ</li></ul></li><li>å¯¹è±¡åˆ†é…ï¼šæ ¹æ®å¯¹è±¡çš„å¤§å°ï¼Œé€‰æ‹©æœ€åˆé€‚çš„å—è¿”å›</li></ul><h4 id="ç¼“å­˜">ç¼“å­˜</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119093459144.png" /></p><ul><li>å€Ÿé‰´äº†<code>TCMalloc</code>çš„æ€æƒ³ï¼š<code>thread caching</code></li><li>æ¯ä¸€ä¸ª<code>p</code>åŒ…å«ä¸€ä¸ª<code>mcache</code>ç”¨äºå¿«é€Ÿåˆ†é…ï¼Œç”¨äºä¸ºç»‘å®šäºpä¸Šçš„gåˆ†é…å¯¹è±¡</li><li><code>mcache</code>ç®¡ç†ä¸€ç»„<code>mspan</code></li><li>å½“<code>mcache</code>ä¸­çš„<code>mspan</code>åˆ†é…å®Œæ¯•ï¼Œå†å‘<code>mcentral</code>ç”³è¯·å¸¦æœ‰æœªåˆ†é…å—çš„<code>mspan</code></li><li>å½“<code>mspan</code>ä¸­æ²¡æœ‰åˆ†é…çš„å¯¹è±¡ï¼Œ<strong><code>mspan</code>ä¼šè¢«ç¼“å­˜åœ¨<code>mcentral</code>ä¸­ï¼Œè€Œä¸æ˜¯ç«‹åˆ»é‡Šæ”¾å¹¶å½’è¿˜ç»™<code>OS</code></strong></li></ul><blockquote><p>å½“éœ€è¦ä¸ºå¯¹è±¡åˆ†é…ç©ºé—´æ—¶ï¼Œé¦–å…ˆä¼šåœ¨<code>mcache</code>ä¸­å¯»æ‰¾æ˜¯å¦å­˜åœ¨ç©ºé—²çš„åˆé€‚çš„å†…å­˜å—ï¼Œæœ‰åˆ™è¿”å›æŒ‡é’ˆï¼›æ— åˆ™å‘ä¸‹ä¸€å±‚<code>mcentral</code>å¯»æ‰¾å†…å­˜å—ã€‚</p></blockquote><h3 id="goå†…å­˜ç®¡ç†ä¼˜åŒ–">Goå†…å­˜ç®¡ç†ä¼˜åŒ–</h3><ul><li>å¯¹è±¡åˆ†é…æ˜¯éå¸¸é«˜é¢‘çš„æ“ä½œï¼š<strong>æ¯ç§’åˆ†é…<code>GB</code>çº§åˆ«çš„å†…å­˜</strong></li><li>å°å¯¹è±¡å æ¯”è¾ƒé«˜</li><li><code>Go</code>å†…å­˜åˆ†é…æ¯”è¾ƒè€—æ—¶<ul><li>åˆ†é…è·¯å¾„é•¿ï¼š<code>g -&gt; m -&gt; p -&gt; mcache -&gt; mspan -&gt; memory block -&gt; return pointer</code></li><li><code>pprof</code>ï¼šå¯¹è±¡åˆ†é…çš„å‡½æ•°æ—¶æœ€é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ä¹‹ä¸€</li></ul></li></ul><h3 id="balanced-gc">Balanced GC</h3><ul><li><p>æ¯ä¸ª<code>g</code>éƒ½ç»‘å®šä¸€å¤§å—å†…å­˜ï¼ˆ<code>1KB</code>ï¼‰ï¼Œç§°ä½œ<code>goroutine allocation buffer</code>(<code>GAB</code>)</p></li><li><p><code>GAB</code>ç”¨äº<code>noscan</code>ç±»å‹çš„å°å¯¹è±¡åˆ†é…ï¼š&lt;128B</p></li><li><p>ä½¿ç”¨3ä¸ªæŒ‡é’ˆç»´æŠ¤<code>GAB</code>ï¼š<code>base</code>ã€<code>end</code>ã€<code>top</code></p></li><li><p><code>Bump pointer</code>ï¼ˆæŒ‡é’ˆç¢°æ’ï¼‰é£æ ¼å¯¹è±¡åˆ†é…</p><ul><li>æ— é¡»å’Œå…¶ä»–åˆ†é…è¯·æ±‚äº’æ–¥ï¼ˆæ¯ä¸ª<code>g</code>éƒ½ç»‘å®šå†…å­˜ï¼‰</li><li>åˆ†é…åŠ¨ä½œç®€å•é«˜æ•ˆ</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">if</span> top + size &lt;= end &#123;<br>    addr := top<br>    top += size <br>    <span class="hljs-keyword">return</span> addr<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><code>GAB</code>å¯¹äº<code>Go</code>å†…å­˜ç®¡ç†æ¥è¯´æ˜¯ä¸€ä¸ªå°å¯¹è±¡</p></li><li><p>æœ¬è´¨ï¼š<strong>å°†å¤šä¸ªå°å¯¹è±¡çš„åˆ†é…åˆå¹¶æˆä¸€æ¬¡å¤§å¯¹è±¡çš„åˆ†é…</strong></p></li><li><p>é—®é¢˜ï¼š<code>GAB</code>çš„å¯¹è±¡åˆ†é…æ–¹å¼ä¼šå¯¼è‡´å†…å­˜è¢«å»¶è¿Ÿé‡Šæ”¾ã€‚</p></li></ul><blockquote><p><code>GAB</code>çš„åˆ†é…è¿˜æ˜¯è¦èµ°ä¹‹å‰é‚£æ¡å¾ˆé•¿çš„åˆ†é…è·¯å¾„çš„ï¼Œå¯¹äº<code>GC</code>æ¥è¯´ï¼Œä¸€æ•´ä¸ª<code>GAB</code>æ‰æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚æ‰€ä»¥ï¼Œå½“<code>GAB</code>ä¸­å­˜åœ¨æŸä¸€ä¸ªå°å¯¹è±¡å­˜æ´»æ—¶ï¼Œ<code>GC</code>ä¼šå°†æ•´ä¸ª<code>GAB</code>æ ‡è¯†ä¸ºå­˜æ´»ã€‚</p></blockquote><ul><li>æ–¹æ¡ˆï¼šç§»åŠ¨<code>GAB</code>ä¸­å­˜æ´»çš„å¯¹è±¡<ul><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119101254147.png" /></li><li>å½“<code>GAB</code>æ€»å¤§å°è¶…è¿‡ä¸€å®šé˜ˆå€¼æ—¶ï¼Œå°†<code>GAB</code>ä¸­å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–åˆ†é…çš„<code>GAB</code>ä¸­</li><li>åŸå…ˆçš„<code>GAB</code>å¯ä»¥é‡Šæ”¾ï¼Œé¿å…å†…å­˜é‡Šæ”¾</li><li>æœ¬è´¨ï¼š<strong>ç”¨<code>copying GC</code>çš„ç®—æ³•ç®¡ç†å°å¯¹è±¡</strong></li></ul></li></ul><h2 id="ç¼–è¯‘å™¨å’Œé™æ€åˆ†æ">ç¼–è¯‘å™¨å’Œé™æ€åˆ†æ</h2><h3 id="åŸºæœ¬ä»‹ç»">åŸºæœ¬ä»‹ç»</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119101410988.png" /></p><h3 id="æ•°æ®æµå’Œæ§åˆ¶æµ">æ•°æ®æµå’Œæ§åˆ¶æµ</h3><ul><li>é™æ€åˆ†æï¼šä¸æ‰§è¡Œç¨‹åºä»£ç ï¼Œæ¨å¯¼ç¨‹åºçš„è¡Œä¸ºï¼Œåˆ†æç¨‹åºçš„æ€§è´¨</li><li>æ§åˆ¶æµï¼šç¨‹åºæ‰§è¡Œçš„æµç¨‹ =&gt; æ§åˆ¶æµå›¾</li><li>æ•°æ®æµï¼šæ•°æ®åœ¨æ§åˆ¶æµä¸Šçš„ä¼ é€’</li><li>é€šè¿‡åˆ†ææ§åˆ¶æµå’Œæ•°æ®æµï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ›´å¤šå…³äºç¨‹åºçš„æ€§è´¨ï¼Œæ ¹æ®è¿™äº›æ€§è´¨ä¼˜åŒ–ä»£ç </li></ul><h3 id="è¿‡ç¨‹å†…å’Œè¿‡ç¨‹åˆ†æ">è¿‡ç¨‹å†…å’Œè¿‡ç¨‹åˆ†æ</h3><ul><li>è¿‡ç¨‹å†…åˆ†æï¼ˆ<code>Intra-procedural analysis</code>ï¼‰<ul><li>ä»…åœ¨å‡½æ•°å†…éƒ¨è¿›è¡Œåˆ†æ</li></ul></li><li>è¿‡ç¨‹é—´åˆ†æï¼ˆ<code>Inter-procedural analysis</code>ï¼‰<ul><li>è€ƒè™‘è¿‡ç¨‹è°ƒç”¨æ—¶å‚æ•°ä¼ é€’å’Œè¿”å›å€¼çš„æ•°æ®æµå’Œæ§åˆ¶æµ</li></ul></li><li>ä¸ºä»€ä¹ˆè¿‡ç¨‹åˆ†ææ˜¯ä¸€ä¸ªé—®é¢˜ï¼Ÿ<ul><li><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230119102344793.png" /></li><li>éœ€è¦é€šè¿‡æ•°æ®æµåˆ†æå¾—çŸ¥içš„å…·ä½“ç±»å‹ï¼Œæ‰èƒ½çŸ¥é“<code>i.foo()</code>è°ƒç”¨çš„æ˜¯å“ªä¸ª<code>foo()</code></li><li>æ ¹æ®<code>i</code>çš„å…·ä½“ç±»å‹ï¼Œäº§ç”Ÿäº†æ–°çš„æ§åˆ¶æµï¼Œ<code>A.foo()</code>ï¼Œåˆ†æç»§ç»­</li><li>è¿‡ç¨‹é—´åˆ†æéœ€è¦åŒæ—¶åˆ†ææ§åˆ¶æµå’Œæ•°æ®æµâ€”â€”è”åˆæ±‚è§£ï¼Œæ¯”è¾ƒå¤æ‚</li></ul></li></ul><h2 id="goç¼–è¯‘å™¨ä¼˜åŒ–">Goç¼–è¯‘å™¨ä¼˜åŒ–</h2><h3 id="èƒŒæ™¯">èƒŒæ™¯</h3><ul><li>ä¸ºä»€ä¹ˆè¦åšç¼–è¯‘å™¨ä¼˜åŒ–<ul><li>ç”¨æˆ·æ— æ„ŸçŸ¥ï¼Œé‡æ–°ç¼–è¯‘å³å¯è·å¾—æ€§èƒ½æ”¶ç›Š</li><li>é€šç”¨æ€§ä¼˜åŒ–</li></ul></li><li>ç°çŠ¶<ul><li>é‡‡ç”¨çš„ä¼˜åŒ–å°‘</li><li>ç¼–è¯‘æ—¶é—´è¾ƒçŸ­ï¼Œæ²¡æœ‰è¿›è¡Œè¾ƒå¤æ‚çš„ä»£ç åˆ†æå’Œä¼˜åŒ–</li></ul></li><li>ç¼–è¯‘ä¼˜åŒ–çš„æ€è·¯<ul><li>åœºæ™¯ï¼šé¢å‘åç«¯é•¿æœŸæ‰§è¡Œä»»åŠ¡</li><li><code>Tradeoff</code>ï¼š<strong>ç”¨ç¼–è¯‘æ—¶é—´æ¢å–æ›´é«˜æ•ˆçš„æœºå™¨ç </strong></li></ul></li><li><code>Beast mode</code>ï¼ˆç¼–è¯‘ä¼˜åŒ–äº§å“ï¼‰<ul><li><strong>å‡½æ•°å†…è”</strong></li><li><strong>é€ƒé€¸åˆ†æ</strong></li><li>é»˜è®¤æ ˆå¤§å°è°ƒæ•´</li><li>è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤</li><li>å¾ªç¯å±•å¼€</li><li>...</li></ul></li></ul><h3 id="å‡½æ•°å†…è”">å‡½æ•°å†…è”</h3><ul><li>å†…è”ï¼šå°†è¢«è°ƒç”¨å‡½æ•°çš„å‡½æ•°ä½“ï¼ˆ<code>callee</code>ï¼‰çš„å‰¯æœ¬æ›¿æ¢åˆ°è°ƒç”¨ä½ç½®ï¼ˆ<code>caller</code>ï¼‰ä¸Šï¼ŒåŒæ—¶é‡å†™ä»£ç ä»¥åæ˜ å‚æ•°çš„ç»‘å®š</li><li>ä¼˜ç‚¹<ul><li><strong>æ¶ˆé™¤å‡½æ•°è°ƒç”¨å¼€é”€</strong>ï¼Œä¾‹å¦‚ä¼ é€’å‚æ•°ã€ä¿å­˜å¯„å­˜å™¨ç­‰</li><li><strong>å°†è¿‡ç¨‹é—´åˆ†æè½¬åŒ–ä¸ºè¿‡ç¨‹å†…åˆ†æ</strong>ï¼Œå¸®åŠ©å…¶ä»–ä¼˜åŒ–ï¼Œä¾‹å¦‚é€ƒé€¸åˆ†æ</li></ul></li><li>ç¼ºç‚¹<ul><li>å‡½æ•°ä½“å˜å¤§ï¼Œ<code>instruction cache</code>ä¸å‹å¥½ï¼Œå‘½ä¸­ç‡é™ä½</li><li>ç¼–è¯‘ç”Ÿæˆçš„<code>Go</code>é•œåƒå˜å¤§</li></ul></li><li>å‡½æ•°å†…è”åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯æ­£å‘ä¼˜åŒ–</li><li>å†…è”ç­–ç•¥<ul><li>è°ƒç”¨å’Œè¢«è°ƒå‡½æ•°çš„è§„æ¨¡...</li></ul></li></ul><h3 id="é€ƒé€¸åˆ†æ">é€ƒé€¸åˆ†æ</h3><ul><li>é€ƒé€¸åˆ†æï¼šåˆ†æä»£ç ä¸­æŒ‡é’ˆçš„åŠ¨æ€ä½œç”¨åŸŸï¼šæŒ‡é’ˆåœ¨ä½•å¤„å¯ä»¥è¢«è®¿é—®</li><li>å¤§è‡´æ€è·¯<ul><li>ä»å¯¹è±¡åˆ†é…å¤„å‡ºå‘ï¼Œæ²¿ç€æ§åˆ¶æµï¼Œè§‚å¯Ÿå¯¹è±¡çš„æ•°æ®æµ</li><li>è‹¥å‘ç°æŒ‡é’ˆ<code>p</code>åœ¨å½“å‰ä½œç”¨åŸŸ<code>s</code>ï¼š<ul><li>ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°</li><li>ä¼ é€’ç»™å…¨å±€å˜é‡</li><li>ä¼ é€’ç»™å…¶ä»–çš„<code>goroutine</code></li><li>ä¼ é€’ç»™å·²é€ƒé€¸çš„æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡</li></ul></li><li>åˆ™æŒ‡é’ˆpæŒ‡å‘çš„å¯¹è±¡é€ƒé€¸å‡º<code>s</code>ï¼Œåä¹‹åˆ™æ²¡æœ‰é€ƒé€¸å‡º<code>s</code></li></ul></li><li><code>Beast Mode</code>ï¼šå‡½æ•°å†…è”æ‹“å±•äº†å‡½æ•°çš„è¾¹ç•Œï¼Œæ›´å¤šå¯¹è±¡ä¸é€ƒé€¸</li><li>ä¼˜åŒ–ï¼šä¸ºé€ƒé€¸çš„å¯¹è±¡å¯ä»¥åœ¨<strong>æ ˆä¸Šåˆ†é…</strong><ul><li>å¯¹è±¡åœ¨æ ˆä¸Šåˆ†é…å’Œå›æ”¶å¾ˆå¿«ï¼šç§»åŠ¨<code>sp</code></li><li>å‡å°‘åœ¨<code>heap</code>ä¸Šçš„åˆ†é…ï¼Œé™ä½<code>GC</code>è´Ÿæ‹…</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goé«˜è´¨é‡ç¼–ç¨‹ä¸æ€§èƒ½è°ƒä¼˜</title>
      <link href="/2023/01/17/Go/high-quailty-programming-and-performance-tuning/"/>
      <url>/2023/01/17/Go/high-quailty-programming-and-performance-tuning/</url>
      
        <content type="html"><![CDATA[<h1 id="é«˜è´¨é‡ç¼–ç¨‹">é«˜è´¨é‡ç¼–ç¨‹</h1><h2 id="é«˜è´¨é‡ç¼–ç¨‹ç®€ä»‹">é«˜è´¨é‡ç¼–ç¨‹ç®€ä»‹</h2><blockquote><p>ç¼–å†™çš„ä»£ç èƒ½å¤Ÿè¾¾åˆ°æ­£ç¡®å¯é ã€ç®€ä»‹æ¸…æ™°çš„ç›®æ ‡å¯ç§°ä¹‹ä¸ºé«˜è´¨é‡ä»£ç </p></blockquote><ul><li>å„ç§è¾¹ç•Œæ¡ä»¶æ˜¯å¦è€ƒè™‘å®Œå¤‡</li><li>å¼‚å¸¸æƒ…å†µå¤„ç†ã€ç¨³å®šæ€§ä¿è¯</li><li>æ˜“è¯»æ˜“ç»´æŠ¤</li></ul><h3 id="ç¼–ç¨‹åŸåˆ™">ç¼–ç¨‹åŸåˆ™</h3><p>ç®€å•æ€§</p><ul><li>æ¶ˆé™¤â€œå¤šä½™çš„å¤æ‚æ€§â€ï¼Œä»¥ç®€å•æ¸…æ™°çš„é€»è¾‘ç¼–å†™ä»£ç </li><li>ä¸ç†è§£çš„ä»£ç æ— æ³•ä¿®å¤æ”¹è¿›</li></ul><p>å¯è¯»æ€§</p><ul><li>ä»£ç æ˜¯ç»™äººçœ‹çš„ï¼Œè€Œä¸æ˜¯æœºå™¨</li><li>ç¼–å†™å¯ç»´æŠ¤ä»£ç çš„ç¬¬ä¸€æ­¥æ˜¯ç¡®ä¿ä»£ç å¯è¯»</li></ul><p>ç”Ÿäº§åŠ›</p><ul><li>å›¢é˜Ÿæ•´ä½“å·¥ä½œæ•ˆç‡éå¸¸é‡è¦</li></ul><h2 id="ç¼–ç è§„èŒƒ">ç¼–ç è§„èŒƒ</h2><h3 id="ä»£ç æ ¼å¼">ä»£ç æ ¼å¼</h3><p>æ¨èä½¿ç”¨<code>gofmt</code>æˆ–è€…<code>goimports</code>å·¥å…·è‡ªåŠ¨åŒ–æ ¼å¼åŒ–ä»£ç </p><blockquote><p>åœ¨<code>vscode</code>ä¸­å¯ä»¥åœ¨<code>settings.json</code>ä¸­è¿›è¡Œé…ç½®</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117132719395.png" /></p></blockquote><h3 id="æ³¨é‡Š">æ³¨é‡Š</h3><ol type="1"><li><p>è§£é‡Šä»£ç ä½œç”¨ï¼šæ³¨é‡Šå…¬å…±ç¬¦å·ï¼ˆå‡½æ•°ã€å˜é‡ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117132901852.png" /></p></li><li><p>è§£é‡Šä»£ç å¦‚ä½•åšçš„ï¼šæ³¨é‡Šå®ç°è¿‡ç¨‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117132920134.png" /></p></li><li><p>è§£é‡Šä»£ç å®ç°çš„åŸå› ï¼šè§£é‡Šä»£ç å¤–éƒ¨å› ç´ ï¼Œæä¾›é¢å¤–ä¸Šä¸‹æ–‡</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117132940650.png" /></p></li><li><p>è§£é‡Šä»£ç ä»€ä¹ˆæƒ…å†µä¼šå‡ºé”™ï¼šè§£é‡Šä»£ç çš„é™åˆ¶æ¡ä»¶</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117133009300.png" /></p></li></ol><blockquote><p>ä»£ç æ˜¯æœ€å¥½çš„æ³¨é‡Šï¼Œæ³¨é‡Šåº”è¯¥ç»™å‡ºä»£ç ä¸ºè¡¨è¾¾å‡ºçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</p></blockquote><h3 id="å‘½åè§„èŒƒ">å‘½åè§„èŒƒ</h3><h4 id="å˜é‡">å˜é‡</h4><ul><li>ç®€æ´èƒœäºå†—é•¿</li><li>ç¼©ç•¥è¯å…¨å¤§å†™ï¼Œä½†å½“å…¶ä½äºå˜é‡å¼€å¤´ä¸”ä¸éœ€è¦å¯¼å‡ºæ—¶ï¼Œä½¿ç”¨å…¨å°å†™</li><li>å˜é‡è·ç¦»å…¶è¢«ä½¿ç”¨çš„åœ°æ–¹è¶Šè¿œï¼Œåˆ™éœ€è¦æºå¸¦è¶Šå¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li></ul><h4 id="å‡½æ•°">å‡½æ•°</h4><ul><li>å‡½æ•°åä¸æºå¸¦åŒ…åçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå› ä¸ºåŒ…åå’Œå‡½æ•°åæ€»æ˜¯æˆå¯¹å‡ºç°</li><li>å‡½æ•°åå°½é‡ç®€çŸ­</li><li>å½“åä¸º<code>foo</code>çš„åŒ…æŸä¸ªå‡½æ•°è¿”å›ç±»å‹<code>Foo</code>æ—¶ï¼Œå¯ä»¥çœç•¥ç±»å‹ä¿¡æ¯è€Œä¸å¯¼è‡´æ­§ä¹‰</li><li>å½“åä¸º<code>foo</code>çš„åŒ…æŸä¸ªå‡½æ•°è¿”å›ç±»å‹<code>T</code>æ—¶ï¼ˆä¸æ˜¯<code>Foo</code>ï¼‰ï¼Œå¯ä»¥åœ¨å‡½æ•°åä¸­åŠ å…¥ç±»å‹ä¿¡æ¯</li></ul><h4 id="package">package</h4><ul><li>åªç”±å°å†™å­—æ¯ç»„æˆã€‚ä¸åŒ…å«å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿ç­‰å­—ç¬¦</li><li>ç®€çŸ­å¹¶åŒ…å«ä¸€å®šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li><li>ä¸è¦ä¸æ ‡å‡†åº“åŒå</li><li>ä¸ä½¿ç”¨å¸¸ç”¨å˜é‡åä½œä¸ºåŒ…åï¼Œä¾‹å¦‚ä½¿ç”¨<code>bufio</code>è€Œä¸æ˜¯<code>buf</code></li><li>ä½¿ç”¨å•æ•°è€Œä¸æ˜¯å¤æ•°</li><li>è°¨æ…åœ°ä½¿ç”¨ç¼©å†™ï¼Œåœ¨ä¸ç ´åä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æ¯”å°½å¯èƒ½ç®€çŸ­ï¼Œä¾‹å¦‚<code>fmt</code>åŒ…</li></ul><h3 id="æ§åˆ¶æµç¨‹">æ§åˆ¶æµç¨‹</h3><ul><li>é¿å…åµŒå¥—ï¼Œä¿æŒæ­£å¸¸æµç¨‹æ¸…æ™°</li><li>å°½é‡ä¿æŒæ­£å¸¸ä»£ç è·¯å¾„ä¸ºæœ€å°è·¯å¾„ï¼šä¼˜å…ˆå¤„ç†é”™è¯¯æƒ…å†µå’Œç‰¹æ®Šæƒ…å†µï¼Œå°½æ—©è¿”å›æˆ–ç»§ç»­å¾ªç¯æ¥å‡å°‘åµŒå¥—</li><li>çº¿æ€§åŸç†ï¼Œå¤„ç†é€»è¾‘å°½é‡èµ°ç›´çº¿ï¼Œé¿å…å¤æ‚çš„åµŒå¥—åˆ†æ”¯</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117164220641.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117164241983.png" /></p><h3 id="é”™è¯¯å’Œå¼‚å¸¸å¤„ç†">é”™è¯¯å’Œå¼‚å¸¸å¤„ç†</h3><h4 id="error">error</h4><ul><li>ç®€å•é”™è¯¯ï¼šä»…å‡ºç°ä¸€æ¬¡çš„é”™è¯¯ï¼Œä¸”åœ¨å…¶ä»–åœ°æ–¹ä¸éœ€è¦æ•è·è¯¥é”™è¯¯ï¼Œä¼˜å…ˆä½¿ç”¨<code>errors.New</code>æ¥åˆ›å»ºåŒ¿åå˜é‡ç›´æ¥è¡¨ç¤ºç®€å•é”™è¯¯ï¼›å¦‚æœéœ€è¦æ ¼å¼åŒ–å¤„ç†ï¼Œä½¿ç”¨<code>fmt.Errorf()</code></li><li>é”™è¯¯çš„<code>Wrap</code>å’Œ<code>Unwrap</code>ï¼šé”™è¯¯çš„<code>Wrap</code>å®é™…ä¸Šæ˜¯æä¾›äº†ä¸€ä¸ª<code>error</code>åµŒå¥—å¦ä¸€ä¸ª<code>error</code>çš„èƒ½åŠ›ï¼Œä»è€Œç”Ÿæˆä¸€ä¸ª<code>error</code>çš„è·Ÿè¸ªé“¾ï¼Œåœ¨<code>fmt.Errorf</code>ä¸­ä½¿ç”¨<code>%w</code>å…³é”®å­—æ¥å°†ä¸€ä¸ªé”™è¯¯å…³è”è‡³é”™è¯¯é“¾ä¸­</li></ul><h4 id="panic">panic</h4><ul><li>ä¸å»ºè®®åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨<code>panic</code></li><li>è°ƒç”¨å‡½æ•°ä¸åŒ…æ‹¬<code>recover</code>ä¼šé€ æˆç¨‹åºçš„å´©æºƒ</li><li>è‹¥é—®é¢˜å¯ä»¥è¢«å±è”½æˆ–è€…è§£å†³ï¼Œå»ºè®®ä½¿ç”¨<code>error</code>ä»£æ›¿<code>panic</code></li><li>å¦‚æœåœ¨ç¨‹åºå¯åŠ¨é˜¶æ®µå°±å‘ç”Ÿäº†ä¸å¯é€†çš„é”™è¯¯æ—¶ï¼Œå¯ä»¥åœ¨<code>init</code>æˆ–è€…<code>main</code>å‡½æ•°ä¸­ä½¿ç”¨<code>panic</code></li></ul><h4 id="recover">recover</h4><ul><li><code>recover</code>åªèƒ½åœ¨è¢«<code>defer</code>çš„å‡½æ•°ä¸­ä½¿ç”¨</li><li>åµŒå¥—æ— æ³•ç”Ÿæ•ˆ</li><li>åªåœ¨å½“å‰çš„<code>goroutine</code>ç”Ÿæ•ˆ</li><li><code>defer</code>çš„è¯­å¥æ˜¯åè¿›å…ˆå‡º</li></ul><h2 id="æ€§èƒ½ä¼˜åŒ–å»ºè®®">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2><h3 id="é¢„åˆ†é…å†…å­˜">é¢„åˆ†é…å†…å­˜</h3><p>å¯¹äº<code>slice</code>ã€<code>map</code>ã€<code>strings.Builder</code>å’Œ<code>bytes.Buffer</code>è¿™å‡ ç§åœ¨ä½¿ç”¨æ—¶æœ€å¥½éƒ½è¦é¢„åˆ†é…å†…å­˜ï¼Œå¦åˆ™åœ¨è¿›è¡Œæ“ä½œæ—¶ä¼šéœ€è¦ç»å¸¸è¿›è¡Œæ‰©å®¹ä»è€Œé¢‘ç¹æ“ä½œå†…å­˜ã€‚</p><h3 id="å­—ç¬¦ä¸²å¤„ç†">å­—ç¬¦ä¸²å¤„ç†</h3><p><code>go</code>ä¸­å­˜åœ¨3ä¸­å­—ç¬¦ä¸²å¤„ç†æ–¹å¼ï¼šç”¨<code>+</code>æ‹¼æ¥ã€<code>strings.Builder</code>ã€<code>bytes.Buffer</code>ï¼›å¯ä»¥çœ‹å‡º<code>strings.Builder</code>å’Œ<code>bytes.Buffer</code>ä¸¤ç§æ–¹å¼å¤„ç†å­—ç¬¦ä¸²çš„æ•ˆç‡æ›´é«˜ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230117170015817.png" /></p><ul><li>å­—ç¬¦ä¸²åœ¨<code>Go</code>è¯­è¨€ä¸­æ˜¯ä¸å¯å˜ç±»å‹ï¼Œå ç”¨å†…å­˜å¤§å°æ˜¯å›ºå®šçš„</li><li>ä½¿ç”¨<code>+</code>æ¯æ¬¡éƒ½ä¼šé‡æ–°åˆ†é…å†…å­˜</li><li>å¦å¤–ä¸¤ç§æ–¹å¼çš„å®ç°åº•å±‚éƒ½æ˜¯<code>byte[]</code>ï¼Œå¹¶ä¸”å­˜åœ¨å†…å­˜æ‰©å®¹ç­–ç•¥ï¼Œä¸éœ€è¦æ¯æ¬¡æ‹¼æ¥é‡æ–°åˆ†é…å†…å­˜</li></ul><blockquote><p>å’Œ<code>Java</code>çš„å­—ç¬¦ä¸²å¤„ç†æ¯”è¾ƒç±»ä¼¼</p></blockquote><p>å¯¹äº<code>strings.Builder</code>å’Œ<code>bytes.Buffer</code>è¿™ä¸¤ç§æ–¹å¼ï¼Œä¹Ÿå­˜åœ¨åŒºåˆ«ï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹å‡º<code>strings.Builder</code>æ˜¯æ›´å¿«çš„ï¼Œä»ä¸‹é¢<code>strings.Builder</code>å’Œ<code>bytes.Buffer</code>çš„<code>String()</code>å‡½æ•°æºç å¯ä»¥çœ‹å‡ºä¸€ç‚¹åŸå› ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// To build strings more efficiently, see the strings.Builder type</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b *Buffer)</span></span> String() <span class="hljs-type">string</span> &#123;<br>    <span class="hljs-keyword">if</span> b == <span class="hljs-literal">nil</span> &#123;<br>        <span class="hljs-comment">// Special case, useful in debugging.</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;nil&gt;&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(b.buf[b.off:])<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// String returns the accumulated string</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b *Builder)</span></span> String() <span class="hljs-type">string</span> &#123;<br>    <span class="hljs-keyword">return</span> *(*<span class="hljs-type">string</span>)(unsafe.Pointer(&amp;b.buf))<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>bytes.Buffer</code>è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é‡æ–°ç”³è¯·äº†ä¸€å—ç©ºé—´</li><li><code>strings.Builder</code>ç›´æ¥å°†åº•å±‚çš„<code>[]byte</code>è½¬æ¢æˆäº†å­—ç¬¦ä¸²ç±»å‹è¿”å›</li></ul><h3 id="ç©ºç»“æ„ä½“">ç©ºç»“æ„ä½“</h3><ul><li>ç©ºç»“æ„ä½“<code>struct&#123;&#125;</code>å®ä¾‹ä¸å æ®ä»»ä½•å†…å­˜ç©ºé—´</li><li>å¯ä»¥ä½œä¸ºå„ç§åœºæ™¯ä¸‹çš„å ä½ç¬¦ä½¿ç”¨</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å€ŸåŠ©ç©ºç»“æ„ä½“å¯ä»¥é€šè¿‡mapæ¥å®ç°set</span><br>m := <span class="hljs-built_in">make</span>([<span class="hljs-type">int</span>]<span class="hljs-keyword">struct</span>&#123;&#125;) <span class="hljs-comment">// hash set</span><br></code></pre></td></tr></table></figure><h3 id="atomicåŒ…">atomicåŒ…</h3><ul><li>é”çš„å®ç°æ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿæ¥å®ç°ï¼Œå±äºç³»ç»Ÿè°ƒç”¨</li><li><code>atomic</code>æ“ä½œæ˜¯é€šè¿‡ç¡¬ä»¶å®ç°ï¼Œæ•ˆç‡æ¯”é”é«˜</li><li><code>sync.Mutex</code>åº”è¯¥ç”¨æ¥ä¿æŠ¤ä¸€æ®µé€»è¾‘è€Œä¸æ˜¯ä»…ä»…ä¿æŠ¤ä¸€ä¸ªå˜é‡</li><li>å¯¹äºéæ•°å€¼æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨<code>atomic.Value</code>ï¼Œèƒ½æ‰¿è½½ä¸€ä¸ª<code>interface()</code></li></ul><h1 id="æ€§èƒ½è°ƒä¼˜å®æˆ˜">æ€§èƒ½è°ƒä¼˜å®æˆ˜</h1>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè¯­è¨€è¿›é˜¶â€”â€”å¹¶å‘ç¼–ç¨‹</title>
      <link href="/2023/01/16/Go/go-concurrency/"/>
      <url>/2023/01/16/Go/go-concurrency/</url>
      
        <content type="html"><![CDATA[<h2 id="å¹¶å‘ä¸å¹¶è¡Œ">å¹¶å‘ä¸å¹¶è¡Œ</h2><ul><li>å¹¶å‘ï¼šå¤šä¸ªçº¿ç¨‹é€šè¿‡åˆ‡æ¢æ—¶é—´ç‰‡çš„æ–¹å¼åœ¨ä¸€ä¸ª<code>cpu</code>ä¸Šè¿›è¡Œè°ƒåº¦è¿è¡Œ</li><li>å¹¶è¡Œï¼šå¤šä¸ªçº¿ç¨‹åœ¨<code>cpu</code>çš„å¤šä¸ªæ ¸ä¸Šè¿è¡Œï¼ŒçœŸæ­£çš„åŒæ—¶è¿è¡Œ</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116082029712.png" /></p><h2 id="çº¿ç¨‹ä¸åç¨‹">çº¿ç¨‹ä¸åç¨‹</h2><ul><li>çº¿ç¨‹ï¼šå†…æ ¸æ€ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šå¯ä»¥è·‘å¤šä¸ªæºç¨‹ï¼Œæ ˆå¤§å°åœ¨MBçº§åˆ«</li><li>åç¨‹ï¼šç”¨æˆ·æ€ï¼Œç”±<code>Go</code>ç®¡ç†ï¼Œè½»é‡çº§çº¿ç¨‹ï¼Œæ ˆå¤§å°åœ¨KBçº§åˆ«</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116082257503.png" /></p><p><code>Go</code>ä¸­ä½¿ç”¨<code>go</code>è¯­å¥åˆ›å»ºåç¨‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> concurrence<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;sync&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">hello</span><span class="hljs-params">(i <span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-built_in">println</span>(<span class="hljs-string">&quot;hello world : &quot;</span> + fmt.Sprint(i))<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ManyGo</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ &#123;<br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(j <span class="hljs-type">int</span>)</span></span> &#123;<br>hello(j)<br>&#125;(i)<br>&#125;<br>time.Sleep(time.Second)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¾“å…¥å¦‚ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116083908419.png" /></p><p>å¯ä»¥çœ‹åˆ°è¾“å‡ºå¹¶ä¸æ˜¯é¡ºåºçš„ï¼Œè¯´æ˜ç¡®å®åç¨‹æ˜¯å¹¶å‘æ‰§è¡Œçš„</p><h2 id="csp">CSP</h2><ul><li>é€šè¿‡é€šä¿¡å…±äº«å†…å­˜ï¼šé€šè¿‡é€šé“çš„æ–¹å¼å®ç°è¿›ç¨‹ä¹‹é—´ä¿¡æ¯çš„äº¤æ¢ï¼ˆ<code>Go</code>è¯­è¨€æå€¡ï¼‰</li><li>é€šè¿‡å…±äº«å†…å­˜å®ç°é€šä¿¡ï¼šæ“ä½œç³»ç»Ÿä¸­è¿›ç¨‹é€šä¿¡çš„ç»å…¸æ–¹å¼ï¼Œé€šè¿‡è¯»å†™ä¿¡å·é‡å®ç°å¯¹ä¸´ç•ŒåŒºå†…å­˜çš„æ­£ç¡®è®¿é—®</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116084547715.png" /></p><h3 id="channel">Channel</h3><p><code>make(chan &lt;eleType&gt;, [size])</code></p><ul><li>æ— ç¼“å†²é€šé“ï¼š<code>make(chan int)</code></li><li>æœ‰ç¼“å†²é€šé“ï¼š<code>make(chan int, 2)</code></li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116085248292.png" /></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> concurrence<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">CalSquare</span><span class="hljs-params">()</span></span> &#123;<br>src := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<br>dest := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">3</span>)<br><span class="hljs-comment">// åç¨‹A: å°†æ•°å­—æ”¾è¿›æ— ç¼“å†²é€šé“srcä¸­</span><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">defer</span> <span class="hljs-built_in">close</span>(src)<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ &#123;<br>src &lt;- i<br>&#125;<br>&#125;()<br><span class="hljs-comment">// åç¨‹B: å°†æ•°å­—ä»srcä¸­å–å‡ºï¼Œå¹³æ–¹åæ”¾å…¥æœ‰ç¼“å†²é€šé“dest</span><br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">defer</span> <span class="hljs-built_in">close</span>(dest)<br><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> src &#123;<br>dest &lt;- i * i<br>&#125;<br>&#125;()<br><span class="hljs-comment">// ä¸»çº¿ç¨‹: å°†æ•°å­—ä»destä¸­å–å‡ºå¹¶æ‰“å°</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-keyword">range</span> dest &#123;<br><span class="hljs-built_in">println</span>(i)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="lock">Lock</h3><p>ä½¿ç”¨ä¿¡å·é‡çš„æ–¹å¼å¯¹ä¸´ç•ŒåŒºçš„è®¿é—®è¿›è¡Œæ§åˆ¶ï¼Œä½¿å¾—å¹¶å‘çš„åç¨‹èƒ½å¤Ÿæ­£ç¡®è®¿é—®ä¸´ç•ŒåŒº</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> concurrence<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;sync&quot;</span><br><br><span class="hljs-keyword">var</span> (<br>x    <span class="hljs-type">int64</span><br>lock sync.Mutex<br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">addWithLock</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2000</span>; i++ &#123;<br>lock.Lock()<br>x += <span class="hljs-number">1</span><br>lock.Unlock()<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">addWithoutLock</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2000</span>; i++ &#123;<br>x += <span class="hljs-number">1</span><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•æ˜¯å„åˆ›å»º5ä¸ªåç¨‹è°ƒç”¨ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•ï¼Œç»“æœå¦‚ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116090515359.png" /></p><p>å¯ä»¥çœ‹åˆ°åŠ é”æ–¹æ³•å¯ä»¥ä¿è¯æ¯æ¬¡éƒ½æ­£ç¡®å¾—åˆ°ç»“æœï¼›ä½†æ˜¯ä¸åŠ é”çš„æ–¹æ³•æ¯æ¬¡å¾—åˆ°çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„</p><h2 id="waitgroup">WaitGroup</h2><p>å‰é¢åœ¨ä¸»çº¿ç¨‹åˆ›å»ºäº†åç¨‹ä¹‹åï¼Œä¸»çº¿ç¨‹æ˜¯ä½¿ç”¨<code>time.Sleep()</code>æ–¹æ³•æ¥é˜»å¡è‡ªå·±çš„ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶ä¸çŸ¥é“åç¨‹åˆ°åº•ä»€ä¹ˆæ—¶å€™æ‰§è¡Œç»“æŸï¼Œæˆ‘ä»¬åªèƒ½ä¼ å…¥ä¸€ä¸ªå¤§æ¦‚çš„æ¯”è¾ƒå¤§çš„å€¼è¿›å»ã€‚</p><p><code>sync</code>åŒ…ä¸‹æœ‰ä¸€ä¸ªç»“æ„ä½“ï¼š<code>WaitGroup</code>ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•ä¼˜é›…åœ°å®ç°ä¸»è¿›ç¨‹çš„é˜»å¡</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116091334976.png" /></p><p>è¯¥ç»“æ„ä½“å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¹¶ä¸”æš´éœ²äº†ä¸‰ä¸ªæ–¹æ³•å‡ºæ¥</p><ul><li><code>Add</code>ï¼šåˆ›å»ºäº†å¤šå°‘ä¸ªåç¨‹ï¼Œå°±ä¼ å…¥ç›¸åº”çš„<code>delta</code></li><li><code>Done</code>ï¼šå½“åç¨‹è¿è¡Œç»“æŸæ—¶ï¼Œè°ƒç”¨<code>Done()</code></li><li><code>Wait</code>ï¼šè¯¥æ–¹æ³•ç”¨æ¥é˜»å¡ç›´åˆ°æ‰€æœ‰çš„åç¨‹æ‰§è¡Œç»“æŸ</li></ul><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸‰ä¸ªæ–¹æ³•æ¥å®ç°ä¸»è¿›ç¨‹çš„é˜»å¡ï¼ˆä»¥ç¬¬ä¸€ä¸ªä¾‹å­ä¸ºä¾‹ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ManyGo</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-keyword">var</span> wg sync.WaitGroup<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ &#123;<br>wg.Add(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(j <span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-keyword">defer</span> wg.Done()<br>hello(j)<br>&#125;(i)<br>&#125;<br>wg.Wait()<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue3-script-setup</title>
      <link href="/2023/01/13/front-end-technology/script-setup/"/>
      <url>/2023/01/13/front-end-technology/script-setup/</url>
      
        <content type="html"><![CDATA[<p>1ã€<code>setup</code>æ˜¯<code>vue3</code>æ–°å¢çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå®ƒçš„åŠ å…¥ä¸»è¦æ˜¯ä¸ºäº†<code>vue3</code>çš„ç»„åˆå¼<code>API</code>å¾—ä»¥ä½¿ç”¨ã€‚</p><p>2ã€<code>setup</code>ä½äº<code>beforeCreated</code>ä¹‹å‰ï¼Œç”¨äºä»£æ›¿<code>created</code>å’Œ<code>beforeCreated</code>ï¼Œç”±äº<code>setup</code>å‡½æ•°æ‰§è¡Œçš„æ—¶å€™é¡¹ç›®è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥ä¸èƒ½è®¿é—®<code>data</code>æˆ–<code>methods</code>ä¸­çš„æ•°æ®ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨<code>this</code>ã€‚</p><blockquote><p>ç”±äºä¸èƒ½ä½¿ç”¨<code>this</code>ï¼Œåœ¨ä½¿ç”¨å¾ˆå¤šå˜é‡ä¸Šä¼šå’Œ<code>vue2</code>æœ‰ä¸€å®šåŒºåˆ«</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// $router</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>; <span class="hljs-comment">// vue2</span><br><span class="hljs-comment">// vue3</span><br><span class="hljs-keyword">import</span> &#123; useRoute, useRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><span class="hljs-keyword">const</span> $router = <span class="hljs-title function_">useRouter</span>();<br></code></pre></td></tr></table></figure><p><ahref="https://www.yisu.com/zixun/697588.html#:~:text=%3Cscript%20setup%3E%20import%20%7B%20storeToRefs%20%7D%20from%20%27pinia%27,%7B%20count%2C%20double%20%7D%20%3D%20storeToRefs%20%28counter%29%20%3C%2Fscript%3E">setupè¯­æ³•ç³–ä¸­ä½¿ç”¨piniaåšæ•°æ®æŒä¹…åŒ–</a></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// è·å–proxy, å’Œthisç±»ä¼¼ä½œç”¨</span><br><span class="hljs-keyword">import</span> &#123; getCurrentInstance &#125; <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">let</span> &#123; proxy &#125; = <span class="hljs-title function_">getCurrentInstance</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">ComponentInternalInstance</span>;<br>proxy.<span class="hljs-property">$router</span> <span class="hljs-comment">// é€šè¿‡proxyè·å–$router</span><br></code></pre></td></tr></table></figure></blockquote><p>3ã€å¦‚æœè¦åœ¨<code>&lt;script setup&gt;</code>ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œè°ƒç”¨<code>onXXX</code>æ–¹æ³•å³å¯ï¼Œä¾‹å¦‚<code>mounted</code>æ–¹æ³•å°±æ˜¯<code>onMounted</code>æ–¹æ³•ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230114111916648.png" /></p><blockquote><p><code>ref</code>å±æ€§</p><ol type="1"><li>è¢«ç”¨æ¥ç»™å…ƒç´ æˆ–è€…å­ç»„ä»¶æ³¨å†Œå¼•ç”¨ä¿¡æ¯</li><li>åº”ç”¨åœ¨<code>html</code>æ ‡ç­¾ä¸Šè·å–çš„æ˜¯çœŸæ˜¯<code>DOM</code>å…ƒç´ ï¼Œåº”ç”¨åœ¨ç»„ä»¶æ ‡ç­¾ä¸Šæ˜¯ç»„ä»¶å®ä¾‹å¯¹è±¡</li><li>ä½¿ç”¨æ–¹å¼ï¼Œåœ¨æ ‡ç­¾ä¸­å¢åŠ <code>ref="xxx"</code>ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡<code>this.$refs.xxx</code>æ¥è·å–</li></ol><p>æ³¨æ„åœ¨<code>&lt;script setup&gt;</code>ä¸­ï¼Œä½¿ç”¨æ–¹å¼æœ‰æ‰€æ”¹å˜ï¼Œå› ä¸ºä¸èƒ½ä½¿ç”¨<code>this</code>æŒ‡é’ˆ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ChildVue</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;childRef&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&#x27;ts&#x27;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> childRef = <span class="hljs-title function_">ref</span>();</span><br><span class="language-javascript"><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(childRef.<span class="hljs-property">value</span>); <span class="hljs-comment">// Proxy&#123;...&#125;</span></span><br><span class="language-javascript">&#125;);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>ç¢°åˆ°ä¸€ä¸ªé”™è¯¯å°±æ˜¯ä½¿ç”¨<code>refName.value.xxx='xx'</code>å»åšä¿®æ”¹çš„æ—¶å€™æŠ¥é”™ï¼š<ahref="https://salesforce.stackexchange.com/questions/256761/uncaught-typeerror-set-on-proxy-trap-returned-falsish-for-property-name">'set'on proxy: trap returned falsish for property'direction'</a>ï¼Œå¤§æ¦‚åŸå› æ˜¯ä¿®æ”¹äº†åªè¯»å˜é‡ï¼Œå¦‚æœè¦åšä¿®æ”¹éœ€è¦å°†å…¶å˜æˆå¯ä¿®æ”¹çš„å˜é‡ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> s = <span class="hljs-title class_">Object</span>(&#123;&#125;, steps.<span class="hljs-property">value</span>);<br>steps.<span class="hljs-property">value</span> = s; <span class="hljs-comment">// è¿™æ ·steps.valueå°±å¯ä»¥ä¿®æ”¹äº†</span><br></code></pre></td></tr></table></figure></blockquote><p>å¦‚æœåœ¨çˆ¶ç»„ä»¶ä¸­éœ€è¦è°ƒç”¨å­ç»„ä»¶å†…çš„æ–¹æ³•ï¼Œéœ€è¦åœ¨å­ç»„ä»¶ä¸­å°†æ–¹æ³•å…¬å¼€</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">foo</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-comment">//...  </span><br>&#125;;<br><span class="hljs-title function_">defineExpose</span>(&#123;<br>    foo<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨</p></blockquote><blockquote><p>ç›¸å…³æ–‡ç« ï¼š</p><p><a href="https://juejin.cn/post/7009282373476941831">Vue3 scriptsetup è¯­æ³•ç³–è¯¦è§£</a></p><p><ahref="https://www.jianshu.com/p/5096bfb42e5a">Vue3ä¹‹script-setupå…¨é¢è§£æ</a></p><p><ahref="https://www.cnblogs.com/Joannamo/p/15396039.html#script-setup%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">setupå‡½æ•°å’Œscriptsetup</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> front-end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Goè¯­è¨€åŸºç¡€</title>
      <link href="/2023/01/13/Go/go-language-learning/"/>
      <url>/2023/01/13/Go/go-language-learning/</url>
      
        <content type="html"><![CDATA[<h2 id="goè¯­è¨€ç¯å¢ƒæ­å»º">Goè¯­è¨€ç¯å¢ƒæ­å»º</h2><h3 id="å®‰è£…go">å®‰è£…Go</h3><p>åœ¨<ahref="https://go.dev/dl/">å®˜ç½‘</a>ä¸‹è½½Goè¯­è¨€çš„å®‰è£…åŒ…ï¼Œç„¶åæŒ‰ç…§è¦æ±‚å®‰è£…å³å¯ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230114183054321.png" /></p><p>å®‰è£…å®Œæ¯•åï¼Œéœ€è¦æ·»åŠ ç³»ç»Ÿç¯å¢ƒå˜é‡<code>GOROOT</code>ï¼Œå…¶å€¼ä¸º<code>Go</code>çš„å®‰è£…ç›®å½•ï¼ˆå®‰è£…è¿‡ç¨‹ä¸­å¯ä»¥è‡ªå®šä¹‰ï¼‰ï¼Œä»¥åŠåœ¨<code>Path</code>é‡ŒåŠ ä¸Šå®‰è£…ç›®å½•ä¸‹çš„<code>bin</code>ç›®å½•ï¼Œç„¶ååœ¨<code>cmd</code>ä¸­è¾“å…¥<code>go version</code>ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230114183357126.png" /></p><p>ç„¶åå°±æ˜¯é…ç½®IDEï¼Œæˆ‘é€‰æ‹©çš„æ˜¯<code>vscode</code>ã€‚éœ€è¦å®‰è£…<code>Go</code>æ’ä»¶ï¼›å¹¶ä¸”å®‰è£…æ’ä»¶ä¾èµ–å·¥å…·ï¼šè°ƒå‡ºå‘½ä»¤é¢æ¿è¾“å…¥<code>go install tools</code>ï¼Œé€‰æ‹©<code>Go: Install/Update Tools</code>ã€‚</p><h3 id="å·¥ä½œç©ºé—´">å·¥ä½œç©ºé—´</h3><blockquote><p><code>Go</code>çš„å·¥ä½œç©ºé—´æ˜¯ç”±<code>GOPATH</code>ç¯å¢ƒå˜é‡æŒ‡å®šçš„ï¼Œåœ¨<code>Go</code>æ—©æœŸç‰ˆæœ¬ï¼Œ<code>GOPATH</code>æ˜¯å¿…é¡»çš„ï¼Œå³æ‰€æœ‰çš„<code>Go</code>é¡¹ç›®ä»£ç éƒ½è¦ä¿å­˜åœ¨<code>GOPATH</code>æŒ‡å®šçš„ç›®å½•ä¸‹ã€‚ä½†æ˜¯åé¢<code>Go</code>å¼•å…¥äº†<code>Go Module</code>ï¼Œä½¿ç”¨<code>Go Module</code>ç®¡ç†çš„é¡¹ç›®å¯ä»¥æ”¾åœ¨<code>GOPATH</code>ä¹‹å¤–ã€‚</p></blockquote><p>å·¥ä½œç©ºé—´æ˜¯<code>Go</code>æ¯”è¾ƒç‰¹åˆ«çš„åœ°æ–¹ï¼Œå®ƒè¦æ±‚æ‰€æœ‰çš„é¡¹ç›®ä»£ç éƒ½è¦æ”¾åœ¨å·¥ä½œç©ºé—´ä¸­ï¼ŒåŒ…æ‹¬è‡ªå·±å†™çš„é¡¹ç›®ä»£ç ä»¥åŠä»å¤–éƒ¨è·å–çš„ä»£ç å¯ä»¥å­˜åœ¨è¯¥ç©ºé—´å†…ã€‚å·¥ä½œç©ºé—´ä¸­å­˜åœ¨ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼š</p><ul><li><code>src</code>ï¼šå­˜æ”¾é¡¹ç›®æºä»£ç </li><li><code>pkg</code>ï¼šå­˜æ”¾ç¼–è¯‘ç”Ÿæˆçš„ä»£ç </li><li><code>bin</code>ï¼šå­˜æ”¾ç¼–è¯‘ç”Ÿæˆçš„<strong>å¯æ‰§è¡Œ</strong>ä»£ç </li></ul><p><strong>åœ¨Goä¸­ï¼Œæ˜¯å°†æ¯ä¸€ä¸ªé¡¹ç›®éƒ½å½“ä½œ<code>$GOPATH\src</code>çš„ä¸€ä¸ªåŒ…æ¥çœ‹å¾…</strong>ï¼Œå·¥ä½œç©ºé—´çš„æ¦‚å¿µå°±æœ‰ç‚¹ç±»ä¼¼äº<code>Java</code>ä¸­çš„<code>classpath</code>ã€‚</p><blockquote><p><code>classpath</code>æ˜¯<code>JVM</code>ç”¨åˆ°çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå®ƒç”¨æ¥æŒ‡ç¤ºJVMå¦‚ä½•æœç´¢<code>class</code>ã€‚</p><p>å¾ˆå¤šæ•™ç¨‹åœ¨é…ç½®Javaç¯å¢ƒæ—¶éƒ½ä¼šåœ¨ç³»ç»Ÿå˜é‡ä¸­åŠ ä¸Š<code>CLASSPATH</code>ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­<code>.</code>ä»£è¡¨å½“å‰ç›®å½•ã€‚è¯¦è§<ahref="https://www.liaoxuefeng.com/wiki/1252599548343744/1260466914339296">classpathå’Œjar</a>ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230115101414843.png" /></p><p>åœ¨<code>Go</code>ä¸­ï¼Œ<code>GOPATH</code>çš„ä½œç”¨å°±æ˜¯æŒ‡ç¤ºä¸€ä¸ªå·¥ä½œç©ºé—´ï¼šå½“<code>Go</code>ç¼–è¯‘æ–‡ä»¶æ—¶ï¼Œåœ¨å·¥ä½œç©ºé—´ä¸­æœç´¢éœ€è¦çš„åŒ…ã€‚</p></blockquote><blockquote><p>ç›¸å…³æ–‡ç« ï¼š<ahref="https://stackoverflow.com/questions/24306183/can-someone-explain-why-gopath-is-convenient-and-how-it-should-be-used-in-genera">Cansomeone explain why GOPATH is convenient and how it should be used ingeneral?</a></p></blockquote><h2 id="goè¯­è¨€åŸºç¡€">Goè¯­è¨€åŸºç¡€</h2><h3 id="å˜é‡">å˜é‡</h3><p>å®šä¹‰å˜é‡æœ‰å¤šç§æ–¹å¼ï¼š</p><ul><li><code>var &lt;varName&gt; &lt;varType&gt; = &lt;value&gt;</code></li><li><code>var &lt;varName&gt; = &lt;value&gt;</code></li><li><code>varName := value</code></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> var1 <span class="hljs-type">string</span> = <span class="hljs-string">&quot;go&quot;</span><br><span class="hljs-keyword">var</span> var2 = <span class="hljs-number">10</span><br>var3 := <span class="hljs-literal">true</span><br><br><span class="hljs-comment">// å¸¸é‡å°±æ˜¯å°†varæ¢æˆconst</span><br><span class="hljs-keyword">const</span> const1 = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><blockquote><ul><li><code>_</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡åï¼Œä»»ä½•èµ‹äºˆå®ƒçš„å€¼éƒ½ä¼šè¢«ä¸¢å¼ƒã€‚</li><li><code>Go</code>å¯¹äºå·²å£°æ˜ä½†æœªä½¿ç”¨çš„å˜é‡ä¼šåœ¨ç¼–è¯‘é˜¶æ®µæŠ¥é”™</li></ul></blockquote><h3 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-type">int8</span>, <span class="hljs-type">int16</span>, <span class="hljs-type">int32</span>(<span class="hljs-type">rune</span>), <span class="hljs-type">int64</span> <span class="hljs-comment">// æœ‰ç¬¦å·æ•´æ•°</span><br><span class="hljs-type">uint8</span>(<span class="hljs-type">byte</span>), <span class="hljs-type">uint16</span>, <span class="hljs-type">uint32</span>, <span class="hljs-type">uint64</span> <span class="hljs-comment">// æ— ç¬¦å·æ•´æ•°</span><br><span class="hljs-type">bool</span> <span class="hljs-comment">// å¸ƒå°”ç±»å‹</span><br><span class="hljs-type">float32</span>, <span class="hljs-type">float64</span> <span class="hljs-comment">// æµ®ç‚¹æ•°</span><br><span class="hljs-type">complex64</span>, <span class="hljs-type">complex128</span> <span class="hljs-comment">// å¤æ•° ä¸€åŠä½æ•°ä½œå®æ•°ï¼Œä¸€åŠä½æ•°ä½œè™šæ•°</span><br><span class="hljs-type">string</span> <span class="hljs-comment">// å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><blockquote><p>ä¸åŒç±»å‹ä¹‹é—´çš„å˜é‡ä¸å…è®¸ç›¸äº’èµ‹å€¼æˆ–æ“ä½œï¼Œä¾‹å¦‚<code>int</code>å’Œ<code>int32</code>ä¹‹é—´çš„èµ‹å€¼</p></blockquote><h3 id="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</h3><ul><li><p><code>array</code>ï¼šé™æ€æ•°ç»„ï¼ˆæ•°ç»„é•¿åº¦ä¸å¯å˜ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// var &lt;arrayName&gt; [&lt;size&gt;]&lt;typeName&gt;</span><br><span class="hljs-keyword">var</span> arr [<span class="hljs-number">10</span>]<span class="hljs-type">int</span><br><span class="hljs-comment">// &lt;arrayName&gt; := [&lt;size&gt;]&lt;typeName&gt;&#123;&lt;initVals&gt;&#125;</span><br>a := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br>b := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125; <span class="hljs-comment">// è‡ªåŠ¨æ ¹æ®å…ƒç´ ä¸ªæ•°æ¥è®¡ç®—é•¿åº¦</span><br></code></pre></td></tr></table></figure></li><li><p><code>slice</code>ï¼šåŠ¨æ€æ•°ç»„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å£°æ˜æ–¹å¼å’Œarrayç›¸æ¯”å°±æ˜¯å°‘äº†[]ä¸­çš„é•¿åº¦</span><br><span class="hljs-keyword">var</span> slice []<span class="hljs-type">int</span><br><span class="hljs-keyword">var</span> s1 := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;<br><br><span class="hljs-comment">// å¯ä»¥é€šè¿‡appendæ¥å‘sliceä¸­å¢åŠ å†…å®¹</span><br>s1 = <span class="hljs-built_in">append</span>(s1, <span class="hljs-number">3</span>) <span class="hljs-comment">// [1, 2, 3, 3]</span><br></code></pre></td></tr></table></figure></li><li><p><code>map</code>ï¼šå­—å…¸</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// var &lt;mapName&gt; map[&lt;keyType&gt;]&lt;valueType&gt;</span><br><span class="hljs-keyword">var</span> m <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span><br><span class="hljs-comment">// &lt;mapName&gt; := make(map[&lt;keyType&gt;valueType])</span><br>mp := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)<br>m1 := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-string">&quot;c&quot;</span>:<span class="hljs-number">1</span>, <span class="hljs-string">&quot;c++&quot;</span>:<span class="hljs-number">2</span>, <span class="hljs-string">&quot;go&quot;</span>:<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="æ§åˆ¶æµ">æ§åˆ¶æµ</h3><blockquote><p>åœ¨<code>Go</code>æœ‰<code>if-else</code>ã€<code>for</code>ã€<code>switch-case</code>ä¸‰å¤§ç»“æ„ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯<strong><code>Go</code>ä¸­æ¡ä»¶è¡¨è¾¾å¼ä¸éœ€è¦ç”¨æ‹¬å·åŒ…è£¹</strong>ã€‚</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// if-else</span><br>i := <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-comment">// for</span><br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i ++ &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-comment">// switch-case</span><br><span class="hljs-keyword">switch</span> i &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// ....</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">// ...</span><br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-keyword">default</span>: <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°">å‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">/*</span><br><span class="hljs-comment">func funcName(arg1 type1, arg2 type2, ... ) (ret1 type1, ret2 type2) &#123;</span><br><span class="hljs-comment">    // ...</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">add</span><span class="hljs-params">(a <span class="hljs-type">int</span>, b <span class="hljs-type">int</span>)</span></span> (res <span class="hljs-type">int</span>, ok <span class="hljs-type">bool</span>) &#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="fmt">fmt</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br>fmt.Println() <span class="hljs-comment">// æ‰“å°ä¸€è¡Œ</span><br>fmt.Printf(<span class="hljs-string">&quot;%v&quot;</span>, s) <span class="hljs-comment">// æ‰€æœ‰ç±»å‹çš„å˜é‡éƒ½æ˜¯ç”¨vé€šé…ç¬¦</span><br>fmt.Printf(<span class="hljs-string">&quot;%+v&quot;</span>, s) <span class="hljs-comment">// è¾“å‡ºå…³äºså˜é‡çš„è¯¦ç»†ä¿¡æ¯</span><br>fmt.Printf(<span class="hljs-string">&quot;%#v&quot;</span>, s) <span class="hljs-comment">// æ›´åŠ è¯¦ç»†</span><br>f := <span class="hljs-number">3.1415</span><br>fmt.Printf(<span class="hljs-string">&quot;%.2f&quot;</span>, f)<br></code></pre></td></tr></table></figure><blockquote><p>æ‹¥æœ‰ä»¥ä¸ŠçŸ¥è¯†åŸºæœ¬ä¸Šå°±å¯ä»¥å†™ä¸€äº›ç®€å•çš„ç¨‹åºäº†</p></blockquote><h2 id="goä¾èµ–ç®¡ç†">Goä¾èµ–ç®¡ç†</h2><h3 id="ä¾èµ–ç®¡ç†æ¼”è¿›">ä¾èµ–ç®¡ç†æ¼”è¿›</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116104940464.png" /></p><h3 id="gopath">GOPATH</h3><p>åœ¨<code>GOPTAH</code>æŒ‡å®šå·¥ä½œç©ºé—´çš„æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„é¡¹ç›®ä»£ç éƒ½è¦å­˜æ”¾åœ¨<code>$GOPATH/src</code>ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬é¡¹ç›®ä»£ç ä¾èµ–çš„åŒ…ä¹Ÿæ˜¯å­˜æ”¾åœ¨è¯¥ç›®å½•ä¸‹ï¼Œå°±ä¼šå¯¼è‡´ä¸‹é¢çš„é—®é¢˜ï¼šä¸¤ä¸ªé¡¹ç›®ä¾èµ–äºä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„åŒ…ï¼Œä½†æ˜¯ç”±äºä¸¤ä¸ªç‰ˆæœ¬çš„åŒ…ä¸å…¼å®¹å°±å¯¼è‡´ä¸¤ä¸ªé¡¹ç›®ä¼šæœ‰ä¸€ä¸ªæœ‰é—®é¢˜ï¼Œå³<strong>æ— æ³•å®ç°packageçš„å¤šç‰ˆæœ¬æ§åˆ¶</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116105024051.png" /></p><h3 id="go-vender">Go Vender</h3><p>é¡¹ç›®ç›®å½•ä¸‹å¢åŠ <code>vendor</code>æ–‡ä»¶ï¼Œåœ¨æ¯ä¸ªé¡¹ç›®å†…é…ç½®è¯¥é¡¹ç›®æ‰€ä¾èµ–çš„åŒ…</p><p>ä¾èµ–å¯»å€æ–¹å¼ï¼šå…ˆ<code>vender</code> å <code>GOPATH</code></p><p>è¿™ä¸ªæ–¹å¼ä¹Ÿä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªé¡¹ç›®ä¾èµ–äºä¸¤ä¸ª<code>package</code>ï¼Œè¿™ä¸¤ä¸ª<code>package</code>åˆä¾èµ–äºä¸åŒç‰ˆæœ¬çš„<code>package</code>ï¼Œè¿™æ ·è¿˜æ˜¯ä¼šå¯¼è‡´å†²çªã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116080132092.png" /></p><h2 id="go-module">Go Module</h2><blockquote><p>å®ç°äº†ç»ˆæç›®æ ‡ï¼šå®šä¹‰ç‰ˆæœ¬è§„åˆ™å’Œç®¡ç†é¡¹ç›®ä¾èµ–å…³ç³»</p></blockquote><ul><li>é€šè¿‡<code>go.mod</code>æ–‡ä»¶ç®¡ç†ä¾èµ–åŒ…ç‰ˆæœ¬</li><li>é€šè¿‡<code>go get/go mod</code>æŒ‡ä»¤å·¥å…·ç®¡ç†ä¾èµ–åŒ…</li></ul><h3 id="é…ç½®æ–‡ä»¶go.mod">é…ç½®æ–‡ä»¶â€”â€”go.mod</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116110311906.png" /></p><p>å¯ä»¥çœ‹åˆ°ä¾èµ–ç”±å‡ éƒ¨åˆ†ç»„æˆï¼šåŒ…è·¯å¾„ã€ç‰ˆæœ¬å·ã€ä»¥åŠä¸€äº›ç‰¹æ®Šæ ‡å¿—</p><h4 id="ç‰ˆæœ¬å·">ç‰ˆæœ¬å·</h4><ul><li>è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼š<code>$&#123;MAJOR&#125;.$&#123;MINOR&#125;.$&#123;PATCH&#125;</code></li><li>åŸºäº<code>commit</code>çš„ä¼ªç‰ˆæœ¬ï¼š<code>vx.0.0-yyyymmddhhmmss-&lt;12ä½hashç &gt;</code></li></ul><h4 id="ç‰¹æ®Šæ ‡å¿—">ç‰¹æ®Šæ ‡å¿—</h4><ul><li><code>indirect</code>ï¼šè¡¨ç¤ºçš„æ˜¯é—´æ¥ä¾èµ–ã€‚<code>A-&gt;B-&gt;C</code>ï¼Œ<code>A</code>å¯¹<code>C</code>å°±æ˜¯é—´æ¥ä¾èµ–</li><li>ä¸»ç‰ˆæœ¬<code>2+</code>æ¨¡å—ä¼šåœ¨æ¨¡å—è·¯å¾„åå¢åŠ <code>/vN</code>åç¼€</li><li><code>+incompatible</code>ï¼šå¯¹äºæ²¡æœ‰<code>go.mod</code>æ–‡ä»¶ä¸”ä¸»ç‰ˆæœ¬<code>2+</code>çš„ä¾èµ–ï¼Œè¡¨ç¤ºå¯èƒ½å‡ºç°ä¸å…¼å®¹çš„ä»£ç é€»è¾‘</li></ul><h4 id="ä¾èµ–å›¾">ä¾èµ–å›¾</h4><p>æœ€ç»ˆç¼–è¯‘çš„æ—¶å€™ä¼šä½¿ç”¨<code>C 1.4</code>ï¼š<strong>å› ä¸ºä¼šé€‰æ‹©æœ€ä½å…¼å®¹ç‰ˆæœ¬</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116111321724.png" /></p><h3 id="proxy">Proxy</h3><p>å¯¹äº<code>go.mod</code>æ‰€ç”¨åˆ°çš„ä¾èµ–åº”è¯¥å»å“ªé‡Œä¸‹è½½ä»¥åŠå¦‚ä½•ä¸‹è½½ï¼Œå¸¸è§çš„æœ‰<code>Github</code>ç­‰ç¬¬ä¸‰æ–¹ä»£ç æ‰˜ç®¡å¹³å°ï¼Œåƒä¹‹å‰åœ¨é…ç½®Goè¯­è¨€å¼€å‘ç¯å¢ƒæ—¶å°±éœ€è¦åˆ°<code>Github</code>ä¸Šä¸‹è½½å¯¹åº”çš„ä¾èµ–å·¥å…·ã€‚ä½†æ˜¯ä¾èµ–ç¬¬ä¸‰æ–¹ä»£ç æ‰˜ç®¡å¹³å°ä¸Šä¸‹è½½ä¾èµ–ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ul><li>æ— æ³•ä¿è¯æ„å»ºç¨³å®šæ€§ä»¥åŠä¾èµ–å¯ç”¨æ€§ï¼šå› ä¸ºä½œè€…éšæ—¶å¯ä»¥ä¿®æ”¹åˆ é™¤è½¯ä»¶ç‰ˆæœ¬ç”šè‡³æ˜¯æ•´ä¸ªè½¯ä»¶</li><li>å¢åŠ ç¬¬ä¸‰æ–¹å¹³å°å‹åŠ›</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116111648728.png" /></p><p>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯å¼•å…¥<code>Proxy</code>ï¼šå®ƒå…¶å®æ˜¯ä¸€ä¸ªæœåŠ¡ç«™ç‚¹ï¼Œç”¨æ¥ç¼“å­˜æºç«™ä¸­çš„è½¯ä»¶ä»¥åŠå¯¹åº”çš„è½¯ä»¶ç‰ˆæœ¬ï¼Œä¸ä¼šæ”¹å˜ï¼Œå®ç°ä¾èµ–çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116112115698.png" /></p><p>ä½¿ç”¨<code>GOPROXY</code>é…ç½®ï¼ŒæŒ‡å®šä¸€ä¸ªæœåŠ¡ç«™ç‚¹<code>url</code>åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼š<code>GOPROXY="https://proxy1.cn, https://proxy2.cn, direct(æºç«™ç‚¹)"</code>ï¼Œé‚£ä¹ˆå°±ä¼š<strong>ä¾æ¬¡</strong>åˆ°æŒ‡å®šå‡ ä¸ªç½‘ç«™ä¸­ä¸‹è½½ä¾èµ–ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116112411670.png" /></p><h3 id="go-getgo-mod">go get/go mod</h3><p>ä½¿ç”¨<code>go get/go mod</code>æ¥ç®¡ç†å’Œå®‰è£…é¡¹ç›®çš„ä¾èµ–</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116112745496.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230116112802277.png" /></p>]]></content>
      
      
      <categories>
          
          <category> Go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Go </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab4 Traps</title>
      <link href="/2023/01/13/6.S081/6.S081-lab4-traps/"/>
      <url>/2023/01/13/6.S081/6.S081-lab4-traps/</url>
      
        <content type="html"><![CDATA[<h2 id="risc-v-assembly">RISC-V Assembly</h2><blockquote><p>ä¸»è¦æ˜¯å›ç­”ä¸€ä¸‹å…³äºæ±‡ç¼–çš„é—®é¢˜ï¼Œéš¾åº¦ä¸å¤§</p></blockquote><h2 id="backtrace">Backtrace</h2><p>å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½å¤Ÿæ‰“å°å‡ºæ ˆä¸Šå‡½æ•°è°ƒç”¨é“¾ï¼Œä»¥å¸®åŠ©å‡ºé”™æ—¶çš„è°ƒè¯•ã€‚</p><p>åŸç†ä¹Ÿæ¯”è¾ƒç®€å•ï¼šåˆ©ç”¨æ ˆç»“æ„çš„æ€§è´¨ï¼ˆè¿”å›åœ°å€å’Œä¸Šä¸€ä¸ªæ ˆå¸§æŒ‡é’ˆåœ¨æ ˆä¸­å­˜æ”¾ä½ç½®æ˜¯å›ºå®šçš„ï¼‰ï¼Œç”±å½“å‰æ ˆå¸§æŒ‡é’ˆå¼€å§‹ï¼Œä¸æ–­å‘ä¸Šå¾—åˆ°æ ˆä¸­è¿”å›åœ°å€ï¼Œç›´åˆ°åˆ°è¾¾æ ˆçš„åº•éƒ¨ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230103182903462.png" /></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span><br><span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;backtrace:\n&quot;</span>);<br>  <span class="hljs-comment">// get the current frame pointer</span><br>  uint64 fp = r_fp();<br>  <span class="hljs-comment">// attention: stack grow from high address to low address</span><br>  uint64 stack_bottom = PGROUNDUP(fp); <span class="hljs-comment">// note the bottom of stack</span><br>  <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) &#123;<br>    uint64 ret_addr = *((uint64 *)(fp - <span class="hljs-number">8</span>)); <span class="hljs-comment">// get the return address</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%p\n&quot;</span>, ret_addr);<br>    fp = *((uint64 *)(fp - <span class="hljs-number">16</span>)); <span class="hljs-comment">// get the previous frame pointer</span><br>    <span class="hljs-keyword">if</span> (PGROUNDUP(fp) != stack_bottom) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// judge the fp cross over the stack_bottom or not</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="alarm">Alarm</h2><blockquote><p>è¦æ±‚å®ç°ä¸€ä¸ªæœºåˆ¶ï¼Œåœ¨è°ƒç”¨äº†<code>sigalarm(interval, handler)</code>åï¼Œè¯¥è¿›ç¨‹æ¯æ¶ˆè€—<code>interval</code>ä¸ªæ—¶é—´ç‰‡ï¼Œå°±è¦è°ƒç”¨ä¸€æ¬¡<code>handler</code>å‡½æ•°ã€‚</p></blockquote><h3 id="æ€è·¯">æ€è·¯</h3><p>å®ç°çš„æ ¸å¿ƒæ˜¯ï¼šç¼–å†™<code>sigalarm</code>ã€<code>sigreturn</code>ä¸¤ä¸ª<strong>ç³»ç»Ÿè°ƒç”¨</strong>å’Œä¿®æ”¹<code>usertrap</code>ä¸­å¤„ç†<strong>æ—¶é’Ÿä¸­æ–­</strong>çš„éƒ¨åˆ†ä»£ç ã€‚</p><p>ä¸‹å›¾æ˜¯æ ¸å¿ƒå‡½æ•°ä¹‹é—´çš„è°ƒç”¨å…³ç³»ï¼Œä¹Ÿæ˜¯è¯¥éƒ¨åˆ†çš„é‡ç‚¹å’Œéš¾ç‚¹ï¼Œå› ä¸ºæ¶‰åŠå†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´çš„é¢‘ç¹åˆ‡æ¢ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230125072846825.png" /></p><p>é‡ç‚¹éœ€è¦ç†è§£çš„æœ‰ä¸¤ç‚¹ï¼š</p><ol type="1"><li><p><code>usertrap</code>ä½äºå†…æ ¸ç©ºé—´ï¼Œè€Œ<code>handler function</code>ä½äºç”¨æˆ·ç©ºé—´ï¼Œ<code>3</code>å·ç®­å¤´åº”è¯¥å¦‚ä½•å‘ç”Ÿï¼Ÿ</p><p><font color='red'><strong>ç”±äº<code>usertrap</code>æ˜¯åœ¨å¤„ç†å¼‚å¸¸çš„ä¸€ä¸ªç¯èŠ‚ä¸­ï¼Œæœ€åè¿˜æ˜¯ä¼šè¿”å›åˆ°ç”¨æˆ·ç©ºé—´ä¸­ï¼Œå¦‚æœä¸åšå¤„ç†è¿”å›çš„æ˜¯æºä»£ç å‘ç”Ÿä¸­æ–­çš„ä½ç½®ï¼Œè€Œè¯¥ä½ç½®æ˜¯ç”±<code>sepc</code>å¯„å­˜å™¨ä¿å­˜çš„ï¼Œåœ¨<code>usertrap</code>ä¸­<code>sepc</code>å¯„å­˜å™¨ä¸­çš„å€¼è¢«ä¿å­˜åœ¨äº†<code>p-&gt;trapframe-&gt;epc</code>ä¸­ï¼Œæ‰€ä»¥åªè¦å°†<code>p-&gt;trapframe-&gt;epc</code>çš„å€¼è®¾ç½®æˆ<code>handler function</code>çš„åœ°å€å³å¯</strong></font></p></li><li><p><code>sigreturn</code>ç³»ç»Ÿè°ƒç”¨æ˜¯<code>handler function</code>è°ƒç”¨çš„ï¼Œå¦‚ä½•ä½¿å…¶è¿”å›æ—¶å›åˆ°<code>user code</code>åŸå…ˆè¢«æ—¶é’Ÿä¸­æ–­çš„é‚£éƒ¨åˆ†ä»£ç ï¼Œå³<code>5</code>å·ç®­å¤´å¦‚ä½•å‘ç”Ÿï¼Ÿ</p><p><strong><font color='red'>è¿™ä¸€éƒ¨åˆ†å…¶å®å’Œç¬¬ä¸€ç‚¹ç±»ä¼¼ï¼Œåªè¦è®¾ç½®<code>p-&gt;trapframe-&gt;epc</code>å°±å¯ä»¥ä½¿å…¶è¿”å›åˆ°åŸå…ˆè¢«ä¸­æ–­å¤„ï¼Œä½†æ˜¯è¿˜éœ€è¦è€ƒè™‘å¦‚ä½•æ¢å¤æºä»£ç çš„ä¸Šä¸‹æ–‡ï¼Œå°±éœ€è¦æ¢å¤æ‰€æœ‰çš„å¯„å­˜å™¨ã€‚æ‰€ä»¥éœ€è¦åœ¨<code>usertrap</code>ä¸­ä¿å­˜<code>p-&gt;trapframe</code>ä¸­çš„æ‰€æœ‰å€¼ï¼Œç„¶ååœ¨<code>sys_sigreturn</code>å¤„æ¢å¤</font></strong></p></li></ol><h3 id="å®ç°">å®ç°</h3><p>ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// return from the handler function to user code which interrupted by time interrupt</span><br><span class="hljs-type">int</span> <br><span class="hljs-title function_">sys_sigreturn</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span>* <span class="hljs-title">p</span> =</span> myproc();<br>  memmove(p-&gt;trapframe, p-&gt;savedtrapframe, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> trapframe)); <span class="hljs-comment">// restore all the registers</span><br>  p-&gt;inhandler = <span class="hljs-number">0</span>;<br>  p-&gt;ticksincelast = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">int</span><br><span class="hljs-title function_">sys_sigalarm</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>  <span class="hljs-type">int</span> ticks; uint64 fn_addr;<br>  <span class="hljs-keyword">if</span> (argint(<span class="hljs-number">0</span>, &amp;ticks) &lt; <span class="hljs-number">0</span> || argaddr(<span class="hljs-number">1</span>, &amp;fn_addr) &lt; <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">proc</span>* <span class="hljs-title">p</span> =</span> myproc();<br>  <span class="hljs-keyword">if</span> (ticks == <span class="hljs-number">0</span> &amp;&amp; fn_addr == <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// stop generating periodic alarm calls. </span><br>    p-&gt;ticks = <span class="hljs-number">-1</span>;<br>    p-&gt;handler_p = <span class="hljs-number">0</span>;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    p-&gt;ticks = ticks;<br>    p-&gt;handler_p = fn_addr;<br>  &#125;<br>  p-&gt;ticksincelast = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>usertrap</code>ä¸­é’ˆå¯¹æ—¶é’Ÿä¸­æ–­çš„çš„å®ç°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span>(which_dev == <span class="hljs-number">2</span>)&#123;<br>    <span class="hljs-keyword">if</span> (ticks &gt;= <span class="hljs-number">0</span> &amp;&amp; !p-&gt;inhandler)&#123;<br>        p-&gt;ticksincelast ++;<br>        <span class="hljs-comment">// kernel cause the user process to call the handler function</span><br>        <span class="hljs-comment">// current is in kernelspace, while the handler function address is in userspace</span><br>        <span class="hljs-comment">// so just set the p-&gt;trapframe-&gt;epc to the address of the handler function</span><br>        <span class="hljs-comment">// when return to userspace, will call the handler function </span><br>        <span class="hljs-keyword">if</span> (p-&gt;ticksincelast == p-&gt;ticks) &#123;<br>            memmove(p-&gt;savedtrapframe, p-&gt;trapframe, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> trapframe));<br>            p-&gt;trapframe-&gt;epc = p-&gt;handler_p;<br>            p-&gt;inhandler = <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    yield();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é—®é¢˜">é—®é¢˜</h3><p>1ã€<code>usertrap</code>ä¸­åªä¿å­˜äº†handlerå‡½æ•°å¤„ç†å®Œçš„è¿”å›åœ°å€ï¼Œå¹¶æ²¡æœ‰ä¿å­˜ä¸€æ•´å¥—å¯„å­˜å™¨ï¼Œå¯¼è‡´å›åˆ°<code>user code</code>ä¹‹åï¼Œä¸Šä¸‹æ–‡æ”¹å˜äº†ï¼Œæ‰€ä»¥å‘ç”Ÿäº†å¼‚å¸¸</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230125055351113.png" /></p><p>2ã€<code>p-&gt;savedtrapframe</code>åœ¨åˆå§‹åŒ–æ—¶æ²¡æœ‰åˆ†é…å†…å­˜ï¼Œå¯¼è‡´å‘ç”Ÿäº†å†…å­˜<code>store</code>æ—¶çš„ç¼ºé¡µå¼‚å¸¸ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230125055254773.png" /></p><p>3ã€<code>p-&gt;savedtrapframe</code>æ²¡æœ‰é‡Šæ”¾</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230125063126826.png" /></p>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcodeå‘¨èµ›ç¬”è®°</title>
      <link href="/2023/01/09/leetcode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/01/09/leetcode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="å•å‘¨èµ›">311å•å‘¨èµ›</h2><blockquote><p>æ—¶é—´ï¼š2022.09.18</p><p>ã€è¿‡ç¨‹ã€‘</p><p>å‰ä¸¤é“é¢˜å¾ˆå¿«å°±å†™å‡ºæ¥äº†</p><p>ç¬¬ä¸‰é“é¢˜ï¼Œå¾ˆéš¾å—ï¼Œä¸€ç§æ„Ÿè§‰èƒ½å†™å‡ºæ¥ä½†æ˜¯å°±æ˜¯å†™ä¸å‡ºæ¥çš„æ„Ÿè§‰ï¼Œè¿˜æ˜¯å¯¹äºäºŒå‰æ ‘çš„é€’å½’ä¸å¤Ÿæ·±å…¥</p><p>ç¬¬å››é“é¢˜ç”¨å¸¸è§„æ–¹æ³•å†™å‡ºæ¥ï¼Œä½†æ˜¯è¶…æ—¶...</p></blockquote><h3 id="æœ€é•¿çš„å­—æ¯åºè¿ç»­å­å­—ç¬¦ä¸²çš„é•¿åº¦">6181.æœ€é•¿çš„å­—æ¯åºè¿ç»­å­å­—ç¬¦ä¸²çš„é•¿åº¦</h3><blockquote><p><ahref="https://leetcode.cn/problems/length-of-the-longest-alphabetical-continuous-substring/">é¢˜ç›®</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ¯”èµ›å†™çš„æ—¶å€™æ˜¯ç”¨æ ˆå†™çš„ï¼Œä½†æ˜¯å…¶å®åªæ˜¯ç”¨åˆ°æ ˆçš„æ€æƒ³ï¼Œä¸ç”¨æ ˆä¹Ÿæ˜¯å®Œå…¨å¯ä»¥çš„</span><br><span class="hljs-comment">// æŠ“ä½ 1ã€è¿ç»­ 2ã€å­—æ¯åº 3ã€æœ€å¤§</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">longestContinuousSubstring</span><span class="hljs-params">(String s)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">maxLen</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">need</span> <span class="hljs-operator">=</span> s.charAt(<span class="hljs-number">0</span>); <span class="hljs-comment">// ä¸‹ä¸€ä¸ªéœ€è¦çš„å­—ç¬¦</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; s.length(); i++)&#123;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.charAt(i);<br>        <span class="hljs-keyword">if</span>(c == need)&#123;<br>            cnt ++;<br>            need ++;<br>        &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// å¦‚æœä¸æ»¡è¶³çš„è¯ï¼Œä»è¿™ä¸ªä½ç½®é‡æ–°å¼€å§‹å‘åå¯»æ‰¾</span><br>            need = c + <span class="hljs-number">1</span>;<br>            cnt = <span class="hljs-number">1</span>;<br>        &#125;<br>        maxLen = Math.max(maxLen, cnt);<br>    &#125;<br>    <span class="hljs-keyword">return</span> maxLen;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åè½¬äºŒå‰æ ‘çš„å¥‡æ•°å±‚">6182. åè½¬äºŒå‰æ ‘çš„å¥‡æ•°å±‚</h3><blockquote><p><ahref="https://leetcode.cn/problems/reverse-odd-levels-of-binary-tree/">é¢˜ç›®</a></p></blockquote><p>ã€ç­”é¢˜ã€‘</p><p>è§£é¢˜è¿‡ç¨‹ä¸­ï¼Œæƒ³è¿‡é€’å½’å’Œé˜Ÿåˆ—ä¸¤ç§æ–¹å¼ã€‚</p><p>ä½†æ˜¯ï¼Œé€’å½’æƒ³çš„ä¸€ç›´éƒ½æ˜¯å¦‚ä½•äº¤æ¢èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¾ˆå¿«å°±æ”¾å¼ƒäº†</p><p>ä½¿ç”¨é˜Ÿåˆ—ï¼Œæƒ³çš„æ˜¯åœ¨å¥‡æ•°å±‚ç”¨éå†å°†å€¼å€’è¿‡æ¥ï¼Œå†™çš„è¿‡ç¨‹ä¸­ä¸æ˜¯å¾ˆé¡ºåˆ©</p><p>ã€æ€è·¯ã€‘</p><p><strong>æ ¸å¿ƒæ€æƒ³å°±æ˜¯äº¤æ¢å€¼ï¼Œä¸äº¤æ¢ç»“ç‚¹</strong></p><h4 id="dfs-é€’å½’">DFS é€’å½’</h4><p>å…¶å®ä½¿ç”¨DFSé€’å½’çš„è¿‡ç¨‹ä¸­åªè¦äº¤æ¢ç»“ç‚¹çš„å€¼å°±å¯ä»¥äº†ï¼Œè¿™æ ·å°±ä¸ä¼šå½±å“ä¸‹é¢çš„å­èŠ‚ç‚¹ï¼Œåªè¦è€ƒè™‘å¦‚ä½•é€’å½’èƒ½å¤Ÿå°†ä¸€å±‚çš„ç»“ç‚¹å€¼å€’è¿‡æ¥ã€‚</p><p>è¿ç”¨åˆ°äºŒå‰æ ‘é€’å½’çš„ä¸€ä¸ªæŠ€å·§ï¼Œã€å½“é€’å½’å‡½æ•°å‚æ•°åªæœ‰ä¸€ä¸ªç»“ç‚¹éš¾ä»¥å®ç°é€’å½’æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸¤ä¸ªç»“ç‚¹å‚æ•°çš„é€’å½’å‡½æ•°ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">reverseOddLevels</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <br>&#125;<br><br><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">reverseOddLevelsByDFS</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    dfs(root.left, root.right, <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(TreeNode node1, TreeNode node2, <span class="hljs-type">int</span> level)</span>&#123;<br>    <span class="hljs-keyword">if</span>(node1 == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <br><span class="hljs-comment">// å¦‚æœæ˜¯å¥‡æ•°å±‚ï¼Œå°±äº¤æ¢å¯¹åº”ç»“ç‚¹çš„å€¼</span><br>    <span class="hljs-keyword">if</span>(level % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> node1.val;<br>        node1.val = node2.val;<br>        node2.val = tmp;<br>    &#125;<br><span class="hljs-comment">// é€šè¿‡ä¸¤ä¸ªç»“ç‚¹ä¸€èµ·é€’å½’ï¼Œä¸”è¯¥ä¸¤ä¸ªç»“ç‚¹æ˜¯å¤„äºå¯¹ç§°ä½ç½®</span><br>    dfs(node1.left, node2.right, level+<span class="hljs-number">1</span>);<br>    dfs(node1.right, node2.left, level+<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="bfs-è¿­ä»£">BFS è¿­ä»£</h4><p>BFSè¿­ä»£å°±æ˜¯å€ŸåŠ©é˜Ÿåˆ—å®ç°å±‚æ¬¡éå†ï¼Œå¦‚æœæ˜¯å¥‡æ•°å±‚åšå‡ºå¯¹ç»“ç‚¹å€¼çš„æ”¹å˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] values;<br><span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">reverseOddLevelsByBFS</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>    queue.offer(root);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">level</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (!queue.isEmpty())&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> queue.size();<br><br>        <span class="hljs-comment">// å¦‚æœé˜Ÿåˆ—ä¸­æ”¾çš„æ˜¯å¥‡æ•°å±‚ï¼Œå°†è¿™ä¸€å±‚çš„å€¼å–å‡ºæ¥æ”¾åœ¨valuesæ•°ç»„ä¸­</span><br>        <span class="hljs-keyword">if</span>(level % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>)&#123;<br>            values = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[size];<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++)&#123;<br>                <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>                values[i] = node.val;<br>                queue.offer(node);<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-comment">// æ”¹é€ ä¸€ä¸‹å¸¸è§„æ¡†æ¶ï¼Œå¦‚æœæ˜¯å¥‡æ•°å±‚ï¼Œå†å°†ç»“ç‚¹pollå‡ºæ¥ä¹‹åï¼Œæ ¹æ®valuesæ•°ç»„æ”¹å˜å…¶å€¼</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++)&#123;<br>            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>            <span class="hljs-keyword">if</span>(level % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>)&#123; <span class="hljs-comment">// å¦‚æœæ˜¯å¥‡æ•°å±‚å°±æ”¹å˜å€¼</span><br>                node.val = values[size - i - <span class="hljs-number">1</span>];<br>            &#125;<br>            <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>) queue.offer(node.left);<br>            <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>) queue.offer(node.right);<br>        &#125;<br><br>        level++;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å­—ç¬¦ä¸²çš„å‰ç¼€åˆ†æ•°å’Œ">6183. å­—ç¬¦ä¸²çš„å‰ç¼€åˆ†æ•°å’Œ</h3><blockquote><p><ahref="https://leetcode.cn/problems/sum-of-prefix-scores-of-strings/">é¢˜ç›®</a></p></blockquote><p>åœ¨å‰ç¼€æ ‘çš„åŸºç¡€ä¸Šï¼Œè¿™é“é¢˜å°±ååˆ†ç®€å•äº†ï¼Œåªéœ€è¦ç¨å¾®æ”¹é€ ä¸€ä¸‹å‰ç¼€æ ‘ï¼Œåœ¨æ’å…¥wordçš„è¿‡ç¨‹ä¸­æ¯ç»è¿‡ä¸€ä¸ªç»“ç‚¹å°±+1ï¼Œç„¶åå†æä¾›ä¸€ä¸ªè®¡ç®—wordå¾—åˆ†çš„å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">æ”¹é€  Trie æ ‘ åœ¨æ¯ä¸€ä¸ªç»“ç‚¹é‡Œå¢åŠ ä¸€ä¸ª cnt ç»Ÿè®¡åœ¨æ’å…¥è¿‡ç¨‹ä¸­ ç»è¿‡è¯¥ç»“ç‚¹çš„å•è¯ä¸ªæ•°</span><br><span class="hljs-comment">ä¹Ÿå°±æ˜¯ä»¥ åˆ°è¿™ä¸ªç»“ç‚¹ä¸ºè‡³å½¢æˆçš„prefix å¼€å§‹çš„å•è¯æ•°</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] sumPrefixScores(String[] words) &#123;<br>    <span class="hljs-type">Trie</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Trie</span>();<br>    <span class="hljs-keyword">for</span> (String word : words) &#123;<br>        root.insert(word);<br>    &#125;<br>    <span class="hljs-type">int</span>[] answer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[words.length];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; words.length; i++) &#123;<br>        answer[i] = root.getScores(words[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> answer;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Trie</span> &#123;<br>    <span class="hljs-keyword">public</span> Trie[] children;<br>    <span class="hljs-type">boolean</span> isEnd;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> cnt;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Trie</span><span class="hljs-params">()</span> &#123;<br>        children = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Trie</span>[<span class="hljs-number">26</span>];<br>        isEnd = <span class="hljs-literal">false</span>;<br>        cnt = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(String word)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> word.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span>(cur.children[idx] == <span class="hljs-literal">null</span>) &#123;<br>                cur.children[idx] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Trie</span>();<br>            &#125;<br>            cur.children[idx].cnt ++; <span class="hljs-comment">// ç»è¿‡è¿™ä¸ªç»“ç‚¹çš„å•è¯æ•°++</span><br>            cur = cur.children[idx];<br>        &#125;<br>        cur.isEnd = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// è·å¾—è¯¥wordçš„å¾—åˆ†</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getScores</span><span class="hljs-params">(String word)</span>&#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> word.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (cur.children[idx] == <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// ä¸å­˜åœ¨è¿™ä¸ªword, å¯¹äºå·²å­˜åœ¨çš„wordè‚¯å®šä¸ä¼šå‡ºç°è¿™ä¸ªæƒ…å†µ</span><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                score += cur.children[idx].cnt;<br>                cur = cur.children[idx];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> score;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">search</span><span class="hljs-params">(String word)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> word.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (cur.children[idx] == <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cur = cur.children[idx];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cur.isEnd;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">startsWith</span><span class="hljs-params">(String prefix)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prefix.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> prefix.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span>(cur.children[idx] == <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cur = cur.children[idx];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ¨¡æ¿-208.-å®ç°-trie-å‰ç¼€æ ‘">æ¨¡æ¿: 208. å®ç° Trie (å‰ç¼€æ ‘)</h4><blockquote><p><ahref="https://leetcode.cn/problems/implement-trie-prefix-tree/">é¢˜ç›®</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">Trieçš„åŸç†: æ¯ä¸€ä¸ªç»“ç‚¹éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘ size = 26 çš„æ•°ç»„çš„å¼•ç”¨</span><br><span class="hljs-comment">æ’å…¥ä¸€ä¸ªå•è¯å°±æ˜¯ ä»æ ¹èŠ‚ç‚¹ä¾æ¬¡å‘ä¸‹æ–°å¢ç»“ç‚¹ åœ¨æ•°ç»„å¯¹åº”ä½ç½®(å¯¹åº”ä¸‹æ ‡çš„å­—ç¬¦ - &#x27;a&#x27;) åˆ›å»ºç»“ç‚¹Trie</span><br><span class="hljs-comment">26cha&#x27;shu</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Trie</span> &#123;<br>    <span class="hljs-keyword">public</span> Trie[] children;<br>    <span class="hljs-type">boolean</span> isEnd;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Trie</span><span class="hljs-params">()</span> &#123;<br>        children = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Trie</span>[<span class="hljs-number">26</span>];<br>        isEnd = <span class="hljs-literal">false</span>;<br>        cnt = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(String word)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> word.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span>(cur.children[idx] == <span class="hljs-literal">null</span>) &#123;<br>                cur.children[idx] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Trie</span>();<br>            &#125;<br>            cur = cur.children[idx];<br>        &#125;<br>        cur.isEnd = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">search</span><span class="hljs-params">(String word)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> word.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span> (cur.children[idx] == <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cur = cur.children[idx];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cur.isEnd;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">startsWith</span><span class="hljs-params">(String prefix)</span> &#123;<br>        <span class="hljs-type">Trie</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prefix.length(); i++)&#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> prefix.charAt(i);<br>            <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> c - <span class="hljs-string">&#x27;a&#x27;</span>;<br>            <span class="hljs-keyword">if</span>(cur.children[idx] == <span class="hljs-literal">null</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cur = cur.children[idx];<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å•å‘¨èµ›-1">327å•å‘¨èµ›</h2><blockquote><p>æ—¶é—´ï¼š2023-01-08</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230108222540372.png" /></p><p>åœ¨ç¬¬ä¸‰é“é¢˜æµªè´¹äº†å¤ªå¤šæ—¶é—´ï¼Œç¬¬å››é“é¢˜æ¯”è¾ƒå¤æ‚ï¼Œæ€è·¯ä¸æ¸…æ™°ã€‚</p></blockquote><h3 id="ä½¿å­—ç¬¦ä¸²æ€»ä¸åŒå­—ç¬¦çš„æ•°ç›®ç›¸ç­‰ç¬¬ä¸‰é¢˜"><ahref="https://leetcode.cn/problems/make-number-of-distinct-characters-equal/">6284.ä½¿å­—ç¬¦ä¸²æ€»ä¸åŒå­—ç¬¦çš„æ•°ç›®ç›¸ç­‰(ç¬¬ä¸‰é¢˜)</a></h3><blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230108222913402.png" /></p></blockquote><p>è¿™é“é¢˜åœ¨åšé¢˜æ—¶æŠŠé—®é¢˜æƒ³ç®€å•äº†ï¼Œå¯¼è‡´æ²¡æœ‰è€ƒè™‘å…¨é¢ï¼Œé€šè¿‡åˆ¤é¢˜ç½šæ—¶æ‰¾åˆ°æ¼æ´ã€‚</p><p>å…¶å®å¯ä»¥å°†ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å­—ç¬¦å‡ºç°æƒ…å†µç”¨ä¸¤ä¸ªæ•°ç»„è®°å½•ä¸‹æ¥ï¼Œç„¶ååŒé‡å¾ªç¯å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isItPossible</span><span class="hljs-params">(string word1, string word2)</span> </span>&#123;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a1</span><span class="hljs-params">(<span class="hljs-number">26</span>)</span></span>; <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">a2</span><span class="hljs-params">(<span class="hljs-number">26</span>)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : word1) a1[c-<span class="hljs-string">&#x27;a&#x27;</span>] ++;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : word2) a2[c-<span class="hljs-string">&#x27;a&#x27;</span>] ++;<br>    <br>    <span class="hljs-type">int</span> s1 = <span class="hljs-number">0</span>, s2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i : a1) s1 += i &gt; <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i : a2) s2 += i &gt; <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(s1 - s2) &gt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">26</span>; j++)&#123;<br>            <span class="hljs-keyword">if</span> (a1[i] &gt; <span class="hljs-number">0</span> &amp;&amp; a2[j] &gt; <span class="hljs-number">0</span>)&#123;<br>                a1[j]++; a1[i]--; a2[j]--; a2[i]++;<br>                s1 = <span class="hljs-number">0</span>; s2 = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k : a1) s1 += k &gt; <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k : a2) s2 += k &gt; <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">if</span> (s1 == s2) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                a1[j]--; a1[i]++; a2[j]++; a2[i]--;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ¡¥çš„æ—¶é—´ç¬¬å››é¢˜"><ahref="https://leetcode.cn/problems/time-to-cross-a-bridge/">6306.è¿‡æ¡¥çš„æ—¶é—´(ç¬¬å››é¢˜)</a></h3><blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230108223927959.png" /></p></blockquote><p>çœ‹äº†é¢˜è§£ï¼Œæ ¸å¿ƒå°±æ˜¯<strong>å››ä¸ªå †</strong>ï¼Œå› ä¸ºä¸Šé¢çš„æµç¨‹æ— éå°±æ˜¯å››ä¸ªæ­¥éª¤ï¼šä»æ¡¥çš„å·¦è¾¹åˆ°å³è¾¹ã€ä»æ—§ä»“åº“å–ç®±å­ã€ä»æ¡¥çš„å³è¾¹åˆ°å·¦è¾¹ã€ä»æ–°ä»“åº“æ”¾ç®±å­ï¼Œå°±å¯ä»¥å¯¹åº”è¿™å››ä¸ªæ­¥éª¤å»ºç«‹å››ä¸ªå †ã€‚æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œéœ€è¦ä»”ç»†ç†è§£ã€‚</p><ul><li>==wait_l==ï¼šåœ¨æ¡¥å·¦è¾¹ç­‰å¾…çš„å·¥äºº</li><li>==wait_r==ï¼šåœ¨æ¡¥å³è¾¹ç­‰å¾…çš„å·¥äºº</li><li>==box_l==ï¼šåœ¨æ–°ä»“åº“æ”¾ç®±å­çš„å·¥äºº</li><li>==box_r==ï¼šåœ¨æ—§ä»“åº“å–ç®±å­çš„å·¥äºº</li></ul><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230109143846728.png" /></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; p;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findCrossingTime</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span> k, vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; time)</span> </span>&#123;<br>    <span class="hljs-type">int</span> size = time.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; size; i ++) time[i].<span class="hljs-built_in">push_back</span>(i);<br>    <span class="hljs-comment">// æŒ‰ç…§æ•ˆç‡ä»é«˜åˆ°ä½æ’åº ä½¿å¾—ä¸‹æ ‡æœ€å¤§çš„å·¥äººæ•ˆç‡æœ€ä½</span><br>    <span class="hljs-built_in">sort</span>(time.<span class="hljs-built_in">begin</span>(), time.<span class="hljs-built_in">end</span>(), [](vector&lt;<span class="hljs-type">int</span>&gt;&amp; a, vector&lt;<span class="hljs-type">int</span>&gt;&amp; b)&#123;<br>        <span class="hljs-type">int</span> prof_a = a[<span class="hljs-number">0</span>] + a[<span class="hljs-number">2</span>]; <span class="hljs-type">int</span> prof_b = b[<span class="hljs-number">0</span>] + b[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">if</span> (prof_a != prof_b) <span class="hljs-keyword">return</span> prof_a &lt; prof_b;<br>        <span class="hljs-keyword">return</span> a[<span class="hljs-number">4</span>] &lt; b[<span class="hljs-number">4</span>];<br>    &#125;);<br><br>    priority_queue&lt;<span class="hljs-type">int</span>&gt; wait_l, wait_r; <span class="hljs-comment">// å¤§é¡¶å † top()æ˜¯æ•ˆç‡æœ€ä½çš„å·¥äºº</span><br>    priority_queue&lt;p, vector&lt;p&gt;, greater&lt;p&gt;&gt; box_l, box_r; <span class="hljs-comment">// å°é¡¶å † top()æ˜¯æœ€å¿«å®Œæˆboxä»»åŠ¡çš„å·¥äºº</span><br><br>    <span class="hljs-type">int</span> cur = <span class="hljs-number">0</span>; <span class="hljs-comment">// è®°å½•æ—¶é—´</span><br><br>    <span class="hljs-comment">// ä¸€å¼€å§‹å…¨éƒ¨åœ¨å·¦è¾¹ç­‰å¾…</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i ++) wait_l.<span class="hljs-built_in">push</span>(i);<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-type">bool</span> LtoR = n &gt; <span class="hljs-number">0</span> &amp;&amp; !wait_l.<span class="hljs-built_in">empty</span>();<br>        <span class="hljs-type">bool</span> RtoL = !wait_r.<span class="hljs-built_in">empty</span>();<br><br>        <span class="hljs-keyword">if</span> (!LtoR &amp;&amp; !RtoL) &#123; <span class="hljs-comment">// å·¦å³ä¸¤è¾¹éƒ½æ²¡æœ‰å·¥äººç­‰å¾…</span><br>            <span class="hljs-comment">// æ‰¾åˆ°box_lå’Œbox_rä¸­æœ€å¿«å®Œæˆä»»åŠ¡çš„å·¥äºº æ›´æ–°æ—¶é—´</span><br>            <span class="hljs-type">int</span> x = INT_MAX;<br>            <span class="hljs-keyword">if</span>(!box_l.<span class="hljs-built_in">empty</span>()) x = <span class="hljs-built_in">min</span>(x, box_l.<span class="hljs-built_in">top</span>().first);<br>            <span class="hljs-keyword">if</span>(!box_r.<span class="hljs-built_in">empty</span>()) x = <span class="hljs-built_in">min</span>(x, box_r.<span class="hljs-built_in">top</span>().first);<br>            cur = x;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (RtoL)&#123; <span class="hljs-comment">// å³è¾¹åˆ°å·¦è¾¹</span><br>            <span class="hljs-type">int</span> x = wait_r.<span class="hljs-built_in">top</span>(); <span class="hljs-comment">// å–å‡ºå³è¾¹æ•ˆç‡æœ€ä½çš„å·¥äººx</span><br>            wait_r.<span class="hljs-built_in">pop</span>();<br>            cur += time[x][<span class="hljs-number">2</span>]; <span class="hljs-comment">// è®©xå·¥äººè¿‡æ¡¥</span><br>            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªå·¥äººåˆ°è¾¾æ¡¥å·¦å²¸</span><br>            <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span> &amp;&amp; wait_r.<span class="hljs-built_in">empty</span>() &amp;&amp; box_r.<span class="hljs-built_in">empty</span>()) <span class="hljs-keyword">return</span> cur;<br>            box_l.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">p</span>(cur+time[x][<span class="hljs-number">3</span>], x)); <span class="hljs-comment">// è¿‡æ¡¥ååˆ°æ–°ä»“åº“æ”¾ç®±å­ æ”¾å…¥box_lå †ä¸­</span><br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (LtoR) &#123; <span class="hljs-comment">// å·¦è¾¹åˆ°å³è¾¹</span><br>            <span class="hljs-type">int</span> x = wait_l.<span class="hljs-built_in">top</span>(); <span class="hljs-comment">// å–å‡ºå·¦è¾¹æ•ˆç‡æœ€ä½çš„å·¥äººx</span><br>            wait_l.<span class="hljs-built_in">pop</span>();<br>            cur += time[x][<span class="hljs-number">0</span>]; <span class="hljs-comment">// è®©xå·¥äººè¿‡æ¡¥</span><br>            box_r.<span class="hljs-built_in">push</span>(<span class="hljs-built_in">p</span>(cur+time[x][<span class="hljs-number">1</span>], x)); <span class="hljs-comment">// è¿‡æ¡¥ååˆ°æ—§ä»“åº“å–ç®±å­ æ”¾å…¥box_rå †ä¸­</span><br>            n--; <span class="hljs-comment">// ç®±å­æ•°-1</span><br>        &#125;<br><br>        <span class="hljs-keyword">while</span> (!box_l.<span class="hljs-built_in">empty</span>()) &#123;<br>            p worker = box_l.<span class="hljs-built_in">top</span>();<br>            <span class="hljs-comment">// å¦‚æœåœ¨æ¡¥ä¸Šçš„å·¥äººè¿‡æ¡¥çš„æ—¶é—´é‡Œï¼Œæœ‰å·¥äººèƒ½å¤Ÿå®Œæˆboxä»»åŠ¡ï¼Œå°±å°†ä»–ä»¬æ”¾åˆ°å¯¹åº”çš„æ¡¥è¾¹ç­‰å¾…é˜Ÿåˆ—ä¸­</span><br>            <span class="hljs-keyword">if</span> (worker.first &gt; cur) <span class="hljs-keyword">break</span>;<br>            box_l.<span class="hljs-built_in">pop</span>();<br>            wait_l.<span class="hljs-built_in">push</span>(worker.second);<br>        &#125;<br><br>        <span class="hljs-keyword">while</span> (!box_r.<span class="hljs-built_in">empty</span>()) &#123;<br>            p worker = box_r.<span class="hljs-built_in">top</span>();<br>            <span class="hljs-comment">// å¦‚æœåœ¨æ¡¥ä¸Šçš„å·¥äººè¿‡æ¡¥çš„æ—¶é—´é‡Œï¼Œæœ‰å·¥äººèƒ½å¤Ÿå®Œæˆboxä»»åŠ¡ï¼Œå°±å°†ä»–ä»¬æ”¾åˆ°å¯¹åº”çš„æ¡¥è¾¹ç­‰å¾…é˜Ÿåˆ—ä¸­</span><br>            <span class="hljs-keyword">if</span> (worker.first &gt; cur) <span class="hljs-keyword">break</span>;<br>            box_r.<span class="hljs-built_in">pop</span>();<br>            wait_r.<span class="hljs-built_in">push</span>(worker.second);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ç±»ä¼¼çš„é¢˜ç›®ï¼š</p><p><a href="https://leetcode.cn/problems/single-threaded-cpu/">1834.å•çº¿ç¨‹ CPU</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºé—´æ±‚å’Œ</title>
      <link href="/2023/01/05/leetcode/%E5%8C%BA%E9%97%B4%E6%B1%82%E5%92%8C/"/>
      <url>/2023/01/05/leetcode/%E5%8C%BA%E9%97%B4%E6%B1%82%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://leetcode.cn/problems/range-sum-query-mutable/">307.åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹</a></p></blockquote><p>åŒºé—´æ±‚å’Œæ˜¯ç®—æ³•ä¸­éå¸¸å¸¸è§çš„ä¸€ä¸ªç±»å‹é¢˜ç›®ï¼Œä¸€èˆ¬æœ‰ä¸¤ä¸ªæ“ä½œï¼š</p><ol type="1"><li>å•ç‚¹æ›´æ–°</li><li>åŒºé—´æ±‚å’Œ</li></ol><p>ç„¶åä¸åŒçš„é¢˜ç›®ä¼šå¯¹ä¸Šé¢ä¸¤ç§æ“ä½œçš„è°ƒç”¨æ¬¡æ•°ä¸åŒ</p><h2 id="æ™®é€šæ–¹æ³•">1ã€æ™®é€šæ–¹æ³•</h2><h3 id="æ™®é€šæ•°ç»„">1.1ã€æ™®é€šæ•°ç»„</h3><ul><li>å•ç‚¹æ›´æ–°ï¼š<span class="math inline">\(O(1)\)</span></li><li>åŒºé—´æ±‚å’Œï¼š<span class="math inline">\(O(N)\)</span></li></ul><h3 id="å‰ç¼€å’Œæ•°ç»„">1.2ã€å‰ç¼€å’Œæ•°ç»„</h3><ul><li>å•ç‚¹æ›´æ–°ï¼š<span class="math inline">\(O(N)\)</span></li><li>åŒºé—´æ±‚å’Œï¼š<span class="math inline">\(O(1)\)</span></li></ul><blockquote><p>æ— è®ºæ˜¯å“ªä¸€ç§æ–¹å¼ï¼Œå¦‚æœå•ç‚¹æ›´æ–°å’ŒåŒºé—´æ±‚å’Œçš„æ¬¡æ•°ç›¸å½“ï¼Œå¹¶ä¸”éƒ½ååˆ†å¤šæ—¶ï¼Œæ•ˆç‡æ˜¯ä¸é«˜çš„ã€‚</p><p>ä½†æ˜¯å¦‚æœæŸä¸€ç§æ“ä½œçš„è°ƒç”¨æ¬¡æ•°éå¸¸é«˜ï¼Œå¯ä»¥ä½¿ç”¨å¯¹åº”çš„æ–¹å¼ã€‚</p><p>ä¾‹å¦‚æœ‰äº›é¢˜ç›®ï¼Œæ•°ç»„åˆå§‹åŒ–åå°±ä¸å†æ”¹å˜ï¼Œåªæ˜¯ä¸æ–­åœ°æ±‚åŒºé—´å’Œï¼Œå°±å¯ä»¥ä½¿ç”¨å‰ç¼€å’Œã€‚</p></blockquote><h2 id="åˆ†å—">2ã€åˆ†å—</h2><blockquote><p>åˆ†å—çš„æ€æƒ³æ˜¯ï¼Œç”±äºå•ç‚¹æ›´æ–°å’ŒåŒºé—´æ±‚å’Œçš„è°ƒç”¨æ¬¡æ•°ç›¸å½“ï¼Œæ‰€ä»¥å¸Œæœ›å°½å¯èƒ½å¹³æ‘Šåœ¨ä¸¤ä¸ªæ“ä½œä¸Šçš„æ—¶é—´å¤æ‚åº¦</p></blockquote><p>ã€æ“ä½œã€‘</p><ol type="1"><li>å°†æ•°ç»„åˆ†æˆ <span class="math inline">\(\sqrt{N}\)</span> å—ï¼Œæ¯å—æœ‰<span class="math inline">\(\sqrt{N}\)</span> ä¸ªå…ƒç´ </li><li>å•ç‚¹æ›´æ–°ï¼šåœ¨æŸä¸ªå—å†…éå†ï¼š<spanclass="math inline">\(O(\sqrt{N})\)</span></li><li>åŒºé—´æ±‚å’Œï¼šæœ€å¤šå°† <span class="math inline">\(\sqrt{N}\)</span>ä¸ªå—åŠ åœ¨ä¸€èµ·ï¼š<span class="math inline">\(O(\sqrt{N})\)</span></li></ol><h2 id="æ ‘å½¢æ•°ç»„">3ã€æ ‘å½¢æ•°ç»„</h2><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029210540933.png"alt="image-20221029210540933" /><figcaption aria-hidden="true">image-20221029210540933</figcaption></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Binary Index Tree</span><br><span class="hljs-comment"> * æ ‘çŠ¶æ•°ç»„</span><br><span class="hljs-comment"> * æ€æƒ³æ˜¯: å‰ç¼€åŒºé—´çš„å·®é›†</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BIT</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] tree;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> len;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BIT</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>        len = n + <span class="hljs-number">1</span>;<br>        tree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[len];<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åšå•ç‚¹æ›´æ–°</span><br><span class="hljs-comment">     * è¦æŠŠåŒ…å«äº†nums[i]çš„å…ƒç´ å…¨éƒ¨æ›´æ–°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> i ä¸‹æ ‡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> delta å¢åŠ çš„å€¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> delta)</span>&#123;<br>        i = i + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &lt; len)&#123;<br>            tree[i] += delta;<br>            i += lowbit(i);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> i ä¸‹æ ‡ i</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å‰ i ä¸ªå…ƒç´ ä¹‹å’Œ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        i = i + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>)&#123;<br>            sum += tree[i];<br>            i -= lowbit(i); <span class="hljs-comment">// ä¸æ–­å»æ‰(äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹)æœ€åä¸€ä¸ª1</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">lowbit</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span>&#123;<br>        <span class="hljs-keyword">return</span> x &amp; (-x);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="çº¿æ®µæ ‘">4ã€çº¿æ®µæ ‘</h2><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029210553764.png"alt="image-20221029210553764" /><figcaption aria-hidden="true">image-20221029210553764</figcaption></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * çº¿æ®µæ ‘</span><br><span class="hljs-comment"> * ç”¨äºŒåˆ†çš„æ–¹å¼æ¥å¯¹æ ‘è¿›è¡Œåˆ’åˆ†</span><br><span class="hljs-comment"> * æ€æƒ³æ˜¯: è‹¥å¹²åŒºé—´çš„å¹¶é›†</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SegmentTree</span> &#123;<br>    <span class="hljs-type">int</span>[] st;<br>    <span class="hljs-type">int</span> n;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SegmentTree</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span>&#123;<br>        buildTree(nums);<br>    &#125;<br>    <br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    äºŒå‰æ ‘çš„æ€§è´¨:</span><br><span class="hljs-comment">            1ã€å·²çŸ¥çˆ¶èŠ‚ç‚¹ä¸‹æ ‡ iï¼Œæ±‚å‡ºå·¦å³å­èŠ‚ç‚¹çš„ä¸‹æ ‡ i &gt;&gt; 1 å’Œ (i &gt;&gt; 1) | 1</span><br><span class="hljs-comment">            2ã€å·²çŸ¥å·¦å³å­èŠ‚ç‚¹ä¸‹æ ‡ iï¼Œæ±‚å‡ºçˆ¶èŠ‚ç‚¹ä¸‹æ ‡ i &lt;&lt; 1</span><br><span class="hljs-comment">            3ã€å¯¹äºå®Œç¾äºŒå‰æ ‘æ¥è¯´ï¼Œæ•´æ£µæ ‘çš„èŠ‚ç‚¹æ€»æ•° = 2 * å¶å­èŠ‚ç‚¹æ€»æ•°</span><br><span class="hljs-comment">    ä»æœ€åº•å±‚å¼€å§‹å»ºæ ‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">buildTree</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span>&#123;<br>        n = nums.length;<br>        st = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span> * n];<br>        <span class="hljs-comment">// å…ˆæ„å»ºå¶å­èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n; i &lt; <span class="hljs-number">2</span> * n; i++)&#123;<br>            st[i] = nums[i - n];<br>        &#125;<br>        <span class="hljs-comment">// æ„å»ºéå¶å­èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n - <span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; i--)&#123;<br>            <span class="hljs-comment">// st[i &lt;&lt; 1] å’Œ st[(i &lt;&lt; 1) | 1] åˆ†åˆ«ä»£è¡¨ å·¦å­èŠ‚ç‚¹ å’Œ å³å­èŠ‚ç‚¹</span><br>            st[i] = st[i &lt;&lt; <span class="hljs-number">1</span>] + st[(i &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-number">1</span>];<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> index, <span class="hljs-type">int</span> delta)</span>&#123;<br>        index += n;<br>        <span class="hljs-keyword">while</span> ( index &gt; <span class="hljs-number">0</span>)&#123;<br>            st[index] += delta;<br>            index = index &gt;&gt; <span class="hljs-number">1</span>; <span class="hljs-comment">// å‘ä¸Šæ‰¾åˆ°çˆ¶èŠ‚ç‚¹</span><br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> l, <span class="hljs-type">int</span> r)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        l += n; r += n;<br>        <span class="hljs-keyword">for</span> (; l &lt;= r; l &gt;&gt;= <span class="hljs-number">1</span>, r &gt;&gt;= <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">if</span>( (l &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">1</span> )&#123; <span class="hljs-comment">// læ˜¯å³å­èŠ‚ç‚¹</span><br>                sum += st[l];<br>                l++;<br>            &#125;<br>            <span class="hljs-keyword">if</span>( (r &amp; <span class="hljs-number">1</span>) == <span class="hljs-number">0</span> )&#123; <span class="hljs-comment">// ræ˜¯å·¦å­èŠ‚ç‚¹</span><br>                sum += st[r];<br>                r--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> sum;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘åŸç†Lab5</title>
      <link href="/2022/12/30/compilation-principle/compilation-principle-lab5/"/>
      <url>/2022/12/30/compilation-principle/compilation-principle-lab5/</url>
      
        <content type="html"><![CDATA[<h2 id="å®éªŒè¿‡ç¨‹">å®éªŒè¿‡ç¨‹</h2><blockquote><p><ahref="http://47.122.3.40:8081/#/lab5-function-and-var/lab5-function-and-var">æœ¬æ¬¡å®éªŒ</a>é€šè¿‡é‡æ–°è®¾è®¡ç¬¦å·è¡¨ï¼Œä½¿ç”¨Visitorå‡½æ•°éå†è¯­æ³•æ ‘å¹¶åœ¨åˆé€‚çš„å‡½æ•°å†…è°ƒç”¨LLVMçš„APIå®Œæˆäº†å¯¹å‡½æ•°å®šä¹‰å’Œå‡½æ•°è°ƒç”¨ï¼Œä»¥åŠå±€éƒ¨å˜é‡çš„å£°æ˜ã€å®šä¹‰å’Œä½¿ç”¨çš„ç¿»è¯‘ã€‚</p></blockquote><p>==é‡æ–°è®¾è®¡ç¬¦å·è¡¨==ï¼šæ•´ä½“ä¸Šç¬¦å·è¡¨çš„ç»“æ„æ²¡æœ‰æ”¹å˜ï¼Œåªæ˜¯éœ€è¦è®°å½•çš„ä¿¡æ¯å˜æˆäº†<code>LLVMValueRef</code>å’Œ<code>LLVMTypeRef</code>ã€‚<u>æ³¨æ„å­˜åœ¨ç¬¦å·è¡¨é‡Œçš„<code>LLVMValueRef</code>æ˜¯æŒ‡é’ˆï¼Œè€Œä¸æ˜¯å˜é‡æœ¬èº«ã€‚</u></p><p>==ç¿»è¯‘==ï¼šç¿»è¯‘è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å¾ˆå¤šç»†èŠ‚ï¼</p><h2 id="é‡åˆ°çš„é—®é¢˜">é‡åˆ°çš„é—®é¢˜</h2><p>==BUGs==ï¼š<strong>1</strong>ã€<code>void</code>å‡½æ•°å¯ä»¥æ²¡æœ‰è¿”å›è¯­å¥ï¼Œä½†æ˜¯ç¿»è¯‘æ—¶è¦å°†å…¶åŠ ä¸Šï¼›<strong>2</strong>ã€<code>(exp)</code>çš„<code>visitor</code>å‡½æ•°éœ€è¦é‡å†™ä½¿å…¶è¿”å›<code>exp</code>çš„<code>LLVMValueRef</code>ï¼›<strong>3</strong>ã€å½¢å¦‚<code>x[x[0]]</code>çš„ç¿»è¯‘ä¸­ï¼Œå½“å…¶ä½œä¸ºå·¦å€¼æ—¶è¦æ³¨æ„ï¼Œé‡Œé¢çš„<code>x[0]</code>è¿”å›çš„åº”æ˜¯æœ¬èº«çš„å€¼ï¼Œè€Œå¤–é¢çš„<code>x[]</code>è¿”å›çš„åº”è¯¥æ˜¯æŒ‡é’ˆï¼Œç”±äºä¸¤è€…éƒ½å±äº<code>LVal</code>ï¼Œæ‰€ä»¥åœ¨éå†ç¿»è¯‘æ˜¯éœ€è¦åŠ ä»¥åŒºåˆ†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–è¯‘åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lab3 Page Tables</title>
      <link href="/2022/12/27/6.S081/6.S081-lab3-pgtbl/"/>
      <url>/2022/12/27/6.S081/6.S081-lab3-pgtbl/</url>
      
        <content type="html"><![CDATA[<h2 id="lecture-4-chapter-3">0 lecture 4 &amp; chapter 3</h2><h3 id="lecture-4">Lecture 4</h3><h3 id="chapter-3-page-tables">Chapter 3 Page tables</h3><h4 id="xv6çš„é¡µè¡¨æ˜ å°„æœºåˆ¶">xv6çš„é¡µè¡¨æ˜ å°„æœºåˆ¶</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221225144537100.png" /></p><h4 id="xv6-å†…æ ¸åœ°å€ç©ºé—´">xv6 å†…æ ¸åœ°å€ç©ºé—´</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221225144757600.png" /></p><h4 id="xv6çš„é¡µè¡¨ä»£ç ">xv6çš„é¡µè¡¨ä»£ç </h4><blockquote><p><code>vm.c</code></p></blockquote><p>æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š==pagetable_t==</p><p>æ ¸å¿ƒå‡½æ•°ï¼š==walk== å’Œ ==mappages==</p><h4 id="ç‰©ç†åœ°å€åˆ†é…ä»£ç ">ç‰©ç†åœ°å€åˆ†é…ä»£ç </h4><blockquote><p><code>kalloc.c</code></p></blockquote><p>æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š==kmem==</p><p>æ ¸å¿ƒå‡½æ•°ï¼š==kfree== å’Œ ==kalloc==</p><h4 id="è¿›ç¨‹åœ°å€ç©ºé—´">è¿›ç¨‹åœ°å€ç©ºé—´</h4><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221225152730759.png" /></p><h4 id="ç³»ç»Ÿè°ƒç”¨sbrk-å’Œ-exec">ç³»ç»Ÿè°ƒç”¨ï¼šsbrk å’Œ exec</h4><p><strong>sbrk</strong>ï¼šä¸ºä¸€ä¸ªè¿›ç¨‹å»å‡å°‘æˆ–è€…å¢åŠ å®ƒçš„å†…å­˜ï¼ˆ<code>kernel/sysproc.c</code>ï¼‰</p><p><strong>exec</strong>ï¼šåˆ›å»ºä¸€ä¸ªåœ°å€ç©ºé—´çš„ç”¨æˆ·éƒ¨åˆ†</p><blockquote><p><font color='red'>what is trampoline?</font></p><p>trampolinepageå­˜å‚¨äº†ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ç›¸äº’åˆ‡æ¢çš„ä»£ç ï¼Œæ— è®ºæ˜¯åœ¨å†…æ ¸ç©ºé—´è¿˜æ˜¯åœ¨ç”¨æˆ·ç©ºé—´å®ƒéƒ½æ˜ å°„åœ¨ç›¸åŒçš„è™šæ‹Ÿåœ°å€ï¼Œè¿™æ ·åœ¨åˆ‡æ¢ä¹‹åè¿˜å¯ä»¥ç»§ç»­å·¥ä½œã€‚</p><p>ç›¸å…³æ–‡ç« ï¼š<ahref="https://xiayingp.gitbook.io/build_a_os/traps-and-interrupts/untitled-3">Whatis trampoline?</a></p><p><font color='red'>what is trapframe?</font></p><p><code>trapframe</code>æ˜¯å­˜åœ¨äºç”¨æˆ·åœ°å€ç©ºé—´ï¼Œä½äº<code>trampoline</code>ä¸‹é¢çš„å¤§å°ä¸º<code>PGSIZE</code>ï¼ˆ4096å­—èŠ‚ï¼‰çš„ä¸€å—å†…å­˜ï¼Œç”¨äºåœ¨ç”¨æˆ·åœ°å€ç©ºé—´å‘å†…æ ¸åœ°å€ç©ºé—´åˆ‡æ¢æ—¶ä¿å­˜ç”¨æˆ·ç©ºé—´çš„å¯„å­˜å™¨ã€‚</p></blockquote><h2 id="speed-up-system-calls">1 Speed up system calls</h2><p><u>ä»»åŠ¡æè¿°</u>ï¼šåŠ é€Ÿ<code>getpid()</code>ç³»ç»Ÿè°ƒç”¨ã€‚æ–¹æ³•æ˜¯åœ¨<code>trapframe</code>å‰é¢æ˜ å°„ä¸€ä¸ªåªè¯»çš„é¡µï¼Œåœ¨è¿™ä¸ªé¡µçš„å¼€å§‹ï¼Œå­˜å‚¨ä¸€ä¸ªç»“æ„ä½“<code>syscall</code>ï¼Œç»“æ„ä½“é‡Œå­˜å‚¨å½“å‰è¿›ç¨‹çš„<code>pid</code>ï¼Œç„¶åé€šè¿‡å·²ç»æä¾›çš„<code>ugetpid()</code>å‡½æ•°è·å¾—<code>pid</code>ã€‚</p><p><u>æ€è·¯</u>ï¼šå¯ä»¥å‚è€ƒ<code>trapframe</code>çš„æ„é€ ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// æ­¥éª¤</span><br><span class="hljs-comment">// 1. åœ¨procç»“æ„ä½“ä¸­å¢åŠ ä¸€ä¸ªusyscallå­—æ®µ</span><br><span class="hljs-comment">// 2. åœ¨allocproc()å‡½æ•°ä¸ºusyscallåˆ†é…ç©ºé—´ï¼Œå¹¶ä¸”å°†pidå­˜å‚¨åœ¨usyscallä¸­</span><br><span class="hljs-comment">// 3. åœ¨proc_pagetable()å‡½æ•°ä¸­å°†p-&gt;usyscallï¼ˆç‰©ç†åœ°å€ï¼‰æ˜ å°„åˆ°USYSCALLï¼ˆè™šæ‹Ÿåœ°å€ï¼‰</span><br><span class="hljs-comment">// 4. åœ¨freeproc()å‡½æ•°ä¸­å°†usyscallçš„ç©ºé—´é‡Šæ”¾</span><br><span class="hljs-comment">// 5. åœ¨proc_freepagetable()å‡½æ•°ä¸­å–æ¶ˆä¹‹å‰å»ºç«‹çš„æ˜ å°„</span><br></code></pre></td></tr></table></figure><h2 id="print-a-page-table">2 Print a page table</h2><p><u>ä»»åŠ¡æè¿°</u>ï¼šå¦‚é¢˜è¦æ±‚æ‰“å°é¡µè¡¨ã€‚</p><p><u>æ€è·¯</u>ï¼šå‚è€ƒ<code>freewalk</code>å‡½æ•°è¿›è¡Œé€’å½’ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> level = <span class="hljs-number">1</span>;<br><span class="hljs-type">void</span><br><span class="hljs-title function_">vmprint</span><span class="hljs-params">(<span class="hljs-type">pagetable_t</span> pagetable)</span>&#123;<br>    <span class="hljs-keyword">if</span>(level &gt; <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span>;<br>    <br>    <span class="hljs-keyword">if</span>(level == <span class="hljs-number">1</span>)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;page table %p\n&quot;</span>, pagetable);<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">512</span>; i++)&#123;<br>        <span class="hljs-type">pte_t</span> pte = pagetable[i];<br>        <span class="hljs-keyword">if</span>(pte &amp; PTE_V)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; level; j++)&#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;..&quot;</span>);<br>                <span class="hljs-keyword">if</span>(j != level - <span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot; &quot;</span>);<br>            &#125;<br>            uint64 child = PTE2PA(pte);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d: pte %p pa %p\n&quot;</span>, i, pte, child);<br>            level++;<br>            vmprint((<span class="hljs-type">pagetable_t</span>)child);<br>            level--;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="detecting-which-pages-have-been-accessed">3 Detecting whichpages have been accessed</h2><p><u>ä»»åŠ¡æè¿°</u>ï¼šæ£€æµ‹é¡µè¡¨æ˜¯å¦è¢«è®¿é—®ï¼Œå®ç°<code>pgaccess</code>ç³»ç»Ÿè°ƒç”¨ã€‚</p><p><u>æ€è·¯</u>ï¼šé€šè¿‡<code>walk</code>å‡½æ•°æ‰¾åˆ°è™šæ‹Ÿåœ°å€å¯¹åº”çš„<code>pte</code>ï¼Œæ£€æŸ¥<code>PTE_A</code>ä½å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// sysproc.c</span><br><span class="hljs-type">int</span><br><span class="hljs-title function_">sys_pgaccess</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>&#123;<br>    uint64 base;<br>    <span class="hljs-type">int</span> len;<br>    uint64 mask;<br>    <span class="hljs-keyword">if</span>(argaddr(<span class="hljs-number">0</span>, &amp;base) &lt; <span class="hljs-number">0</span> || argint(<span class="hljs-number">1</span>, &amp;len) &lt; <span class="hljs-number">0</span> || argaddr(<span class="hljs-number">2</span>, &amp;mask) &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <br>    uint64 start = PGROUNDDOWN(base);<br>    uint64 bitmask = <span class="hljs-number">0L</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++, start += PGSIZE)&#123;<br>        <span class="hljs-type">pte_t</span> *pte = walk(myproc()-&gt;pagetable, start, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span>(pte == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; <span class="hljs-comment">// page not map</span><br>        uint64 flag = (*pte &amp; PTE_A) &gt;&gt; <span class="hljs-number">6</span>;<br>        <span class="hljs-keyword">if</span>(flag)&#123;<br>            *pte ^= PTE_A; <span class="hljs-comment">// clear the PTE_A</span><br>        &#125;<br>        bitmask |= (flag &lt;&lt; i);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(copyout(myproc()-&gt;pagetable, mask, (<span class="hljs-type">char</span> *)&amp;bitmask, <span class="hljs-keyword">sizeof</span>(uint64)) &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>:zap:è®¿é—®é¡µè¡¨æ—¶å°†<code>PTE_A</code>ç½®1çš„å·¥ä½œç”±RISC-Vç¡¬ä»¶åšäº†ï¼Œåœ¨ä»£ç ä¸­ä¸éœ€è¦è‡ªå·±è®¾ç½®ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 6.S081-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 6.S081 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘åŸç†-Lab4</title>
      <link href="/2022/12/22/compilation-principle/compilation-principle-lab4/"/>
      <url>/2022/12/22/compilation-principle/compilation-principle-lab4/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼–è¯‘åŸç†lab4">ç¼–è¯‘åŸç†Lab4</h1><h2 id="å®éªŒè¿‡ç¨‹">å®éªŒè¿‡ç¨‹</h2><p>æ€»çš„æ¥è¯´ï¼Œæœ¬æ¬¡å®éªŒæ¯”è¾ƒç®€å•ï¼Œåªè¦å¼„æ¸…æ¥š<code>LLVM</code>çš„<code>API</code>å¦‚ä½•ä½¿ç”¨å³å¯ï¼Œæ ¸å¿ƒåœ¨äºç¼–å†™<code>MyVisitor</code>ç±»ã€‚</p><p>ç”±äºæœ¬æ¬¡å®éªŒåªæ¶‰åŠ<code>main</code>å‡½æ•°ä»¥åŠ<code>return</code>è¯­å¥ï¼Œå¹¶ä¸”<code>return</code>è¯­å¥ä¸­çš„è¡¨è¾¾å¼éƒ½æ˜¯ç”±<code>INTEGR_CONST</code>ç»„æˆï¼Œæ‰€ä»¥åªéœ€è¦é‡å†™å‡½æ•°å®šä¹‰ã€è¿”å›è¯­å¥ã€è¿ç®—è¡¨è¾¾å¼ä»¥åŠæ•°å­—è¿™å‡ ä¸ª<code>visitor</code>å‡½æ•°å³å¯ã€‚æ•´ä½“çš„é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸åšè¯¦ç»†æè¿°ã€‚</p><h2 id="é­é‡çš„é—®é¢˜">é­é‡çš„é—®é¢˜</h2><p>==å…³äºå¦‚ä½•æ‰¾åˆ°æ­£ç¡®API==ï¼šå¯ä»¥å†™ä¸€ä¸ªåŒ…å«æƒ³è¦å¯»æ‰¾çš„æ“ä½œçš„<code>.c</code>æ–‡ä»¶ï¼Œç”¨<code>clang</code>ç¼–è¯‘æˆ<code>.ll</code>ï¼Œä»ä¸­æ‰¾åˆ°<code>API</code>çš„å¤§è‡´åç§°ã€‚æ¯”å¦‚æˆ‘åœ¨å†™<code>%</code>è¿ç®—çš„æ—¶å€™ï¼Œå°±æ˜¯é€šè¿‡è¿™ç§æ–¹æ³•æ‰¾åˆ°<code>srem</code>æ“ä½œå¯¹åº”çš„<code>API</code>ã€‚</p><p>==å…³äºå¯¼å…¥ä¾èµ–çš„æŠ¥é”™==ï¼šå¯¼äº†ä¸€æ™šä¸Šçš„åŒ…ï¼Œæœ€åå‘ç°æœ‰å…³<code>linux</code>çš„åŒ…è¿˜æ˜¯æ²¡æœ‰å¯¼å…¥ã€‚ç»è¿‡æœç´¢åï¼ŒåŠ å…¥é˜¿é‡Œäº‘é•œåƒï¼Œå¹¶ä¸”å¯¹<code>maven</code>çš„<code>import</code>è¿›è¡Œé…ç½®ï¼Œå¾—ä»¥è§£å†³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–è¯‘åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ“ä½œç³»ç»Ÿ-Lab4</title>
      <link href="/2022/12/15/nju-os-labs/OS-Lab4/"/>
      <url>/2022/12/15/nju-os-labs/OS-Lab4/</url>
      
        <content type="html"><![CDATA[<h2 id="å®éªŒè¦æ±‚">å®éªŒè¦æ±‚</h2><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221201103215027.png" /></p><h2 id="æºç ç†è§£">æºç ç†è§£</h2><h3 id="è¿è¡Œæºç ">è¿è¡Œæºç </h3><p><code>make run</code> ä¹‹åæŠ¥é”™</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221201105312262.png" /></p><p>å’ŒLab3ä¸€æ ·</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221201105450390.png" /></p><h3 id="è¿›ç¨‹è°ƒåº¦">è¿›ç¨‹è°ƒåº¦</h3><p>åœ¨<code>kernel_main</code>å‡½æ•°ä¸­ï¼Œä¸ºä¸‰ä¸ªä»»åŠ¡åˆ†é…æ—¶é—´ç‰‡å’Œä¼˜å…ˆçº§å¦‚ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221206092451046.png" /></p><p>ä¹¦ä¸­è¯´æ˜¯æ—¶é’Ÿä¸­æ–­æ¯éš”10mså‘ç”Ÿä¸€æ¬¡ï¼Œæ—¶é’Ÿä¸­æ–­å¤„ç†ç¨‹åºå¦‚ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221206111157768.png" /></p><p>è¿›ç¨‹è°ƒåº¦å‡½æ•°<code>schedule</code></p><p>è°ƒåº¦çš„é€»è¾‘å°±æ˜¯ï¼š<strong>æ‰¾åˆ°å‰©ä½™æ—¶é—´ç‰‡æœ€å¤šï¼ˆä¹Ÿå°±æ˜¯ä¼˜å…ˆçº§æœ€é«˜ï¼‰çš„é‚£ä¸ªè¿›ç¨‹</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221206111347873.png" /></p><h2 id="å®ç°è¿‡ç¨‹">å®ç°è¿‡ç¨‹</h2><h3id="æ·»åŠ ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨print_strchar-s">æ·»åŠ ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼šprint_str(char*s)</h3><p>å®ç°å®Œæ¯•åå‡ºç°bugï¼š</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221201155257376.png" /></p><p>åŸå› æ˜¯ï¼šè¯¥ç³»ç»Ÿè°ƒç”¨éœ€è¦ä¼ é€’å‚æ•°ï¼Œä½†æ˜¯ç”±äºæºä»£ç ä¸­çš„<code>sys_call</code>ä¸æ”¯æŒä¼ é€’å‚æ•°ï¼Œæ‰€ä»¥æŠ¥é”™</p><p>è§£å†³æ–¹æ³•ï¼šä¿®æ”¹<code>sys_call</code>çš„æ±‡ç¼–ä»£ç ï¼Œå°†<code>ebx</code>ä¸­å†…å®¹å‹å…¥æ ˆä¸­ï¼Œç„¶åå†è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè¿™æ ·åªè¦å°†å‚æ•°å­˜æ”¾åœ¨<code>ebx</code>ä¸­å³å¯ã€‚ï¼ˆåç»­å¦‚æœéœ€è¦æ›´å¤šå‚æ•°ï¼Œå°±å¯¹åº”å‹å…¥æ›´å¤šçš„å¯„å­˜å™¨ä¸­çš„å€¼ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221201181325369.png" /></p><h3id="æ·»åŠ ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨sleepint-milli_seconds">æ·»åŠ ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼šsleep(intmilli_seconds)</h3><p>è¯¥ç³»ç»Ÿè°ƒç”¨å®ç°çš„æ˜¯åœ¨æŒ‡å®šçš„<code>milli_seconds</code>ä¸­ä¸è¢«åˆ†é…æ—¶é—´ç‰‡ã€‚</p><p>å®ç°æ–¹å¼ï¼Œæ‰‹å†Œä¸­ç»™äº†æç¤º</p><p>1ã€ä¿®æ”¹<code>PROCESS</code>ç»“æ„ä½“ï¼Œå¢åŠ ä¸€ä¸ª<code>wake_tick</code>å­—æ®µï¼ŒæŒ‡ç¤ºè¯¥è¿›ç¨‹é†’æ¥çš„æ—¶é—´ç‰‡ã€‚</p><p>2ã€ä¿®æ”¹<code>schedule</code>å‡½æ•°ï¼Œåœ¨è¿›ç¨‹è°ƒåº¦æ—¶éœ€è¦å¢åŠ å¯¹<code>wake_tick</code>çš„åˆ¤æ–­ï¼Œå¯ä»¥å‚ä¸è¿›ç¨‹è°ƒåº¦çš„åº”è¯¥æ˜¯<code>wake_tick&lt;=current_tick</code>çš„è¿›ç¨‹ã€‚</p><h3 id="æ¨¡æ‹Ÿè¯»è€…å†™è€…">æ¨¡æ‹Ÿè¯»è€…å†™è€…</h3><blockquote><p><strong>æ³¨æ„ç‚¹</strong></p><p>ä¸€ä¸ªè¯»è¿›ç¨‹è¢«é€‰ä¸­å¼€å§‹è¯»ä¸€ä¸ªæ—¶é—´ç‰‡ä¹‹åï¼Œå¦ä¸€ä¸ªè¯»è¿›ç¨‹è¢«è°ƒå…¥å¼€å§‹è¯»çš„è¿™ä¸€ä¸ªæ—¶é—´ä¸­ï¼Œå‰ä¸€ä¸ªè¯»è¿›ç¨‹åº”è¯¥ä»ç„¶ä¿æŒè¯»çŠ¶æ€ï¼Œç›´è‡³è¯»ç»“æŸã€‚</p></blockquote><blockquote><p>éœ€è¦å®ç°ä¸‰ç§ç­–ç•¥ï¼šè¯»è€…ä¼˜å…ˆã€å†™è€…ä¼˜å…ˆã€è¯»å†™å…¬å¹³ï¼ˆé˜²æ­¢é¥¿æ­»ï¼‰</p><p>å…è®¸åŒæ—¶è¯»çš„è¿›ç¨‹æ•°éœ€è¦èƒ½å¤Ÿæ”¹å˜ï¼ˆ<code>n=1,2,3</code>ï¼‰</p><p>æ¯ä¸ªè¿›ç¨‹è¯»å†™ç»“æŸä¹‹åä¼‘æ¯çš„æ—¶é—´ç‰‡å¯ä»¥éšæ„ä¿®æ”¹(<spanclass="math inline">\(t \ge 0\)</span>)</p><p>ï¼ˆå…·ä½“çš„PVæ“ä½œä»¥åŠä¸‰ç§ç­–ç•¥å¯¹åº”çš„è¯»å†™å‡½æ•°è§ä»£ç ï¼‰</p></blockquote><p>1ã€<strong>ä¸‰ç§ç­–ç•¥</strong></p><p>ä½¿ç”¨è¡¨é©±åŠ¨çš„å®ç°æ–¹å¼ï¼Œå»ºç«‹å‡½æ•°æ•°ç»„ï¼Œä¾æ®ä¸åŒçš„ç­–ç•¥å»è°ƒç”¨æ•°ç»„ä¸­å¯¹åº”çš„è¯»å†™å‡½æ•°å³å¯ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// type.h</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-title function_">void</span> <span class="hljs-params">(* reader_func)</span><span class="hljs-params">()</span>; <span class="hljs-comment">// è¯»è€…å‡½æ•°</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-title function_">void</span> <span class="hljs-params">(* writer_func)</span><span class="hljs-params">()</span>; <span class="hljs-comment">// å†™è€…å‡½æ•°</span><br><br><span class="hljs-comment">// const.h</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> STRATEGY    3</span><br><span class="hljs-comment">// è¯»å†™ç­–ç•¥</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> READER_FIRST 0</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> WRITER_FIRST 1</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> RW_EQUALITY  2</span><br><br><span class="hljs-comment">// global.c</span><br>PUBLIC reader_func readers[STRATEGY] = &#123;<br>    reader_first_r,<br>    writer_first_r,<br>    rw_equality_r<br>&#125;;<br><br>PUBLIC writer_func writers[STRATEGY] = &#123;<br>    reader_first_w,<br>    writer_first_w,<br>    rw_equality_w<br>&#125;;<br><br><span class="hljs-comment">// main.c</span><br>strategy = READER_FIRST;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">ReadB</span><span class="hljs-params">()</span>&#123;<br>readers[strategy]();<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">WriteE</span><span class="hljs-params">()</span>&#123;<br>writers[strategy]();<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åŒæ—¶è¯»çš„è¿›ç¨‹æ•°</p><p>ä½¿ç”¨ä¸€ä¸ªä¿¡å·é‡æ§åˆ¶è¯»è€…è¿›ç¨‹æ•°é‡<code>r_mutex</code>ï¼Œå…¶<code>value</code>åˆå€¼ä¸º<code>READER_MAX</code></p><p>3ã€è¯»å†™ä¹‹åçš„ä¼‘æ¯æ—¶é—´</p><p>åœ¨<code>PROCESS</code>ç»“æ„ä½“ä¸­å¢åŠ ä¸€ä¸ª<code>sleep_time</code>å­—æ®µï¼Œåœ¨å®Œæˆè¯»å†™åè°ƒç”¨<code>sleep</code>å‡½æ•°å³å¯</p><p>4ã€<code>PROCESS</code>ç»“æ„ä½“</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">s_proc</span> &#123;</span><br>...<br>        <br><span class="hljs-type">int</span> wake_tick;  <span class="hljs-comment">// è¿›ç¨‹é†’æ¥çš„æ—¶é—´ç‰‡</span><br><span class="hljs-type">int</span> state;<span class="hljs-comment">// è¿›ç¨‹çš„çŠ¶æ€</span><br><span class="hljs-type">int</span> type; <span class="hljs-comment">// è¿›ç¨‹çš„ç±»å‹</span><br><span class="hljs-type">int</span> run_after_sleep; <span class="hljs-comment">// åˆ¤æ–­è¿›ç¨‹æ­¤æ—¶æ˜¯å¦æ˜¯é†’æ¥ç«‹åˆ»è¿è¡Œçš„</span><br><span class="hljs-type">int</span> sleep_time; <span class="hljs-comment">// è¿›ç¨‹ä¼‘æ¯çš„æ—¶é—´ç‰‡æ•°é‡</span><br>&#125;PROCESS;<br></code></pre></td></tr></table></figure><p>5ã€<strong><code>schedule</code>å‡½æ•°</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221217144338875.png" /></p><blockquote><p>æ³¨æ„ï¼šè¦è°ƒåº¦<strong>æ‰€æœ‰çš„</strong>ç¡é†’çš„è¿›ç¨‹ã€è°ƒåº¦<strong>æ‰€æœ‰çš„</strong>ç»“æŸè¿›ç¨‹é‡Šæ”¾èµ„æºã€è°ƒåº¦<strong>æ‰€æœ‰çš„</strong>waitingè¿›ç¨‹ã€‚å› ä¸ºé€»è¾‘ä¸Šä»–ä»¬å°±æ˜¯è¦åŒæ­¥è¿›è¡Œçš„ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs c">PUBLIC <span class="hljs-type">void</span> <span class="hljs-title function_">schedule</span><span class="hljs-params">()</span><br>&#123;<br>PROCESS* p = proc_table;<br><br><span class="hljs-keyword">if</span>(isRunnable(p))&#123; <span class="hljs-comment">// ä¼˜å…ˆé€‰æ‹©A</span><br>p_proc_ready = p;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-comment">// å…ˆå»æ‰¾åˆšç¡é†’çš„è¿›ç¨‹ï¼Œå°è¯•è°ƒåº¦ä»–ä»¬</span><br><span class="hljs-keyword">for</span> (PROCESS* i = proc_table + <span class="hljs-number">1</span>; i &lt; proc_table + NR_TASKS; i++)&#123;<br><span class="hljs-keyword">if</span> (i-&gt;state == SLEEPING &amp;&amp; i-&gt;wake_tick &lt;= get_ticks())&#123;<br>i-&gt;state = RUNNING;<br>i-&gt;run_after_sleep = <span class="hljs-number">1</span>;<br>p_proc_ready = i;<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// å†æ‰¾åˆ°tick=0çš„è¿›ç¨‹ å»é‡Šæ”¾èµ„æº</span><br><span class="hljs-keyword">for</span> (PROCESS* i = proc_table + <span class="hljs-number">1</span>; i &lt; proc_table + NR_TASKS; i++)&#123;<br><span class="hljs-keyword">if</span> (i-&gt;ticks == <span class="hljs-number">0</span>)&#123;<br>p_proc_ready = i;<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// è°ƒåº¦waitingçš„è¿›ç¨‹ ä¸ç”¨ç­‰ä¿¡å·é‡çš„è¿›ç¨‹</span><br><span class="hljs-keyword">for</span> (PROCESS* i = proc_table + <span class="hljs-number">1</span>; i &lt; proc_table + NR_TASKS; i++)&#123;<br><span class="hljs-keyword">if</span>(i-&gt;state == WAITING)&#123;<br>i-&gt;state = RUNNING;<br>p_proc_ready = i;<br><span class="hljs-keyword">return</span>;<br>&#125;<br>&#125;<br><span class="hljs-comment">// éƒ½ä¸å­˜åœ¨æŒ‰ä¹‹å‰çš„é¡ºåºç»§ç»­è°ƒåº¦</span><br>p = prev_proc + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">while</span>(!isRunnable(p))&#123;<br>p++;<br><span class="hljs-keyword">if</span>(p &gt;= proc_table + NR_TASKS)&#123;<br>p = proc_table;<br>&#125;<br>&#125;<br>p_proc_ready = p;<br>prev_proc = p;<br>&#125;<br>p_proc_ready-&gt;state = RUNNING;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè°ƒåº¦äº†åˆšç¡é†’çš„è¿›ç¨‹åï¼Œå¦‚æœå…¶å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œè¦åœ¨å¼€å§‹æ‰§è¡Œååœæ­¢å†æ¬¡æ‰§è¡Œè°ƒåº¦å‡½æ•°ï¼Œå› ä¸ºéœ€è¦å°†ç»“æŸçš„è¿›ç¨‹çš„èµ„æºè¿”å›ï¼ŒåŒæ—¶å°è¯•å¼€å¯å…¶ä»–è¿›ç¨‹ã€‚ï¼ˆ<code>run_after_sleep</code>å­—æ®µå°±æ˜¯ä¸ºäº†æ‰§è¡Œè¿™ä¸ªåŠŸèƒ½ï¼‰</p></blockquote><p>6ã€ä¸€ä¸ªé—®é¢˜<code>reader_max=2 &amp;&amp; sleep_time=2</code>ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šBè¿›ç¨‹ç»“æŸå¼€å§‹ç¡è§‰ï¼ŒCè¿›ç¨‹ç¡é†’ï¼ŒDè¿›ç¨‹åœ¨ç¡è§‰ï¼Œæ­¤æ—¶<code>rw_mutex</code>è¢«å†™è€…è¿›ç¨‹æŠ¢èµ°ã€‚</p><p>è§£å†³ï¼š<u>å…ˆè°ƒåº¦åˆšç¡é†’çš„è¿›ç¨‹ï¼Œç„¶åè°ƒåº¦è¦ç»“æŸçš„è¿›ç¨‹</u>ï¼Œä¿è¯åˆšç¡é†’çš„è¿›ç¨‹å¯ä»¥å’Œå…¶ä»–è¿›ç¨‹ä¸€æ ·åœ¨ç»“æŸçš„è¿›ç¨‹è¿”å›èµ„æºä¹‹åä¸€èµ·ç«äº‰ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221215210022614.png" /></p><h2 id="å®éªŒ">å®éªŒ</h2><h3 id="ä¸­æ–­è¿”å›">ä¸­æ–­è¿”å›</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221208101839093.png" /></p><p>scheduleè°ƒåº¦ç­–ç•¥é‡‡ç”¨é¡ºåºè°ƒåº¦ï¼Œå¦‚ä¸‹ç»“æœå¯ä»¥å‘ç°ï¼Œå½“å†æ¬¡è°ƒåº¦åˆ°Açš„æ—¶å€™æ˜¯å…ˆæ‰“å°çš„æ˜¯<code>a.</code>ï¼Œå¯è§å†æ¬¡è°ƒåº¦ä¹‹åç¡®å®æ˜¯ä»ä¸­æ–­å¤„ç»§ç»­æ‰§è¡Œçš„ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221208101741056.png" /></p><h3 id="è¿›ç¨‹è°ƒåº¦-1">è¿›ç¨‹è°ƒåº¦</h3><p>åŒæ ·çš„sleepå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯æ™®é€šå‡½æ•°å®ç°ï¼Œä¸€ä¸ªæ˜¯ç³»ç»Ÿè°ƒç”¨å®ç°ï¼Œç»“æœæ˜¯åªæœ‰ç³»ç»Ÿè°ƒç”¨æ‰èƒ½æ­£ç¡®å®ç°è¿›ç¨‹è°ƒåº¦ã€‚</p><p>å› ä¸ºç³»ç»Ÿè°ƒç”¨è¿”å›åå›åˆ°<code>p_proc_ready</code>æ‰€æŒ‡çš„è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œè€Œæ™®é€šå‡½æ•°è¿”å›åä»ç„¶åœ¨åŸæ¥å‡½æ•°ä¸­æ‰§è¡Œï¼Œå³ä½¿<code>p_proc_ready</code>å·²ç»æ”¹å˜ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221208113136173.png" /></p><p><strong>å¥‡æ€ªçš„é—®é¢˜ï¼š</strong></p><p>å³ä¾§åªæ˜¯åšäº†ä¸€äº›è¾“å‡ºï¼Œç»“æœå°±å’Œå·¦è¾¹ä¸ä¸€æ ·ï¼</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221216001730954.png" /></p><p><strong>åŸå› ï¼š</strong>åœ¨è¿›ç¨‹ä¸­ç›´æ¥è°ƒç”¨äº†<code>schedule</code>å‡½æ•°æ”¹å˜äº†<code>p_proc_ready</code>ï¼Œä½†æ˜¯ç”±äº<code>schedule</code>å‡½æ•°åœ¨ç”¨æˆ·æ€æ‰§è¡Œå®Œæ¯•åè¿”å›åŸè¿›ç¨‹ï¼Œå°±æ²¡æœ‰èµ·åˆ°é¢„æƒ³ä¸­çš„è°ƒåº¦çš„ä½œç”¨ã€‚ä½†æ˜¯å¢åŠ äº†ä¸€äº›è¾“å‡ºå°±åšåˆ°äº†ï¼Œæ˜¯å› ä¸ºè¾“å‡ºæ–¹æ³•æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œä¼šè¿›å…¥å†…æ ¸æ€ï¼Œç„¶åä»å†…æ ¸æ€è¿”å›ä¹‹åï¼Œå°±è¿›å…¥äº†<code>p_proc_ready</code>æ‰€æŒ‡å®šçš„è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œèµ·åˆ°äº†è°ƒåº¦çš„ä½œç”¨ï¼</p><p>åœ¨å›¾ä¸­çº¢æ¡†éƒ¨åˆ†ï¼Œ<code>0</code>å’Œ<code>t</code>æœ¬åº”è¯¥æ˜¯<code>schedule</code>å‡½æ•°ä¸­ç›¸é‚»çš„ä¸¤æ¬¡è¾“å‡ºï¼Œä½†æ˜¯ä¸­é—´å´å¤¹ç€ä¸€éƒ¨åˆ†å­—ç¬¦ï¼Œè¿™ä¸€éƒ¨åˆ†å­—ç¬¦å°±æ˜¯ä»ç¬¬ä¸€ä¸ªæ‰“å°ç³»ç»Ÿè°ƒç”¨ä¸­è¿”å›åè¿›å…¥æ–°çš„<code>p_proc_ready</code>æŒ‡å®šçš„è¿›ç¨‹ä¸­æ‰§è¡Œçš„è¾“å‡ºï¼Œå‡ºç°ä¹±ç ä¹Ÿåº”è¯¥æ˜¯å› ä¸ºä¹‹å‰ä¸æ­£å½“ä½¿ç”¨<code>schedule</code>å‡½æ•°å¼•èµ·çš„ã€‚</p><p><strong>è§£å†³ï¼š</strong>ç”¨ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å°è£…<code>schedule</code>å‡½æ•°ä¾›è¿›ç¨‹è°ƒç”¨ï¼Œä¿®æ”¹åå‘ç°ç¨‹åºè¡Œä¸ºæ­£å¸¸ä¸”ä¸€è‡´ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221216002321372.png" /></p><h3 id="sleepå’Œmilli_delayçš„å¯¹æ¯”">sleepå’Œmilli_delayçš„å¯¹æ¯”</h3><p>å¯¹Aä»»åŠ¡è¿›ç¨‹æ‰§è¡Œ <code>milli_delay(100)</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221206112309949.png" /></p><p>å¯¹Aä»»åŠ¡è¿›ç¨‹æ‰§è¡Œ<code>sleep(100)</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221206112729973.png" /></p><p>ä¸¤è€…çš„åŒºåˆ«å°±åœ¨äºï¼šå¯¹Aæ‰§è¡Œ<code>sleep(100)</code>åå°±ä¸å‚ä¸è¿›ç¨‹è°ƒåº¦äº†ï¼Œæ‰€ä»¥åªæœ‰Bå’ŒCè¿›ç¨‹å‚ä¸è°ƒåº¦ï¼›ä½†æ˜¯å¯¹Aæ‰§è¡Œ<code>miili_delay(100)</code>ï¼ŒAåªæ˜¯åœ¨è¿™<code>100ms</code>ä¸­ä¸æ‰§è¡Œä»»ä½•æ“ä½œè€Œå·²ï¼Œä»ç„¶å‚ä¸è¿›ç¨‹çš„è°ƒåº¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> nju-os-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘åŸç†-Lab3</title>
      <link href="/2022/12/13/compilation-principle/compilation-principle-lab3/"/>
      <url>/2022/12/13/compilation-principle/compilation-principle-lab3/</url>
      
        <content type="html"><![CDATA[<blockquote><p><ahref="http://47.122.3.40:8081/#/lab3-type-and-rename/lab3-type-and-rename">æœ¬æ¬¡å®éªŒ</a>ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><p>1ã€å¯¹ç¨‹åºè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæ‰¾åˆ°æ‰€æœ‰çš„è¯­ä¹‰é”™è¯¯ï¼ˆ11ç§ï¼‰</p><p>2ã€è‹¥ç¨‹åºæ²¡æœ‰è¯­ä¹‰é”™è¯¯ï¼Œåˆ™å®Œæˆå˜é‡é‡å‘½ååæ‰“å°è¯­æ³•æ ‘</p></blockquote><h2 id="ç±»å‹æ£€æŸ¥">ç±»å‹æ£€æŸ¥</h2><h3 id="è®¾è®¡ç±»å‹">è®¾è®¡ç±»å‹</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221217001208028.png" /></p><h3 id="è®¾è®¡ç¬¦å·è¡¨">è®¾è®¡ç¬¦å·è¡¨</h3><p>==Symbolç±»==</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Symbol</span>&#123;<br>    <span class="hljs-keyword">public</span> Type type;<br>    <span class="hljs-keyword">public</span> String name;<br>    <span class="hljs-keyword">public</span> Scope scope;<br>    <span class="hljs-keyword">public</span> List&lt;<span class="hljs-type">int</span>[]&gt; usePos;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> isNeedReplace;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> row;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> col;<br>    <br>    <span class="hljs-comment">// æ„é€ å‡½æ•°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Symbol</span><span class="hljs-params">(...)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªè¯¥ç¬¦å·è¢«ä½¿ç”¨çš„ä½ç½®</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addUsePos</span><span class="hljs-params">(<span class="hljs-type">int</span> row, <span class="hljs-type">int</span> col)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// è°ƒè¯•ä½¿ç”¨</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span>&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>==Scopeç±»==</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Scope</span>&#123;<br>    Scope enclosingScope;<br>    Map&lt;String, Symbol&gt; symbols;<br>    List&lt;Scope&gt; childScope;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Scope</span><span class="hljs-params">(...)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç¬¦å·</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">define</span><span class="hljs-params">(Symbol symbol)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// (å…¨å±€)è§£æä¸€ä¸ªç¬¦å·</span><br>    <span class="hljs-keyword">public</span> Symbol <span class="hljs-title function_">resolve</span><span class="hljs-params">(String name)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// (åœ¨å½“å‰ä½œç”¨åŸŸä¸‹)è§£æä¸€ä¸ªç¬¦å·</span><br>    <span class="hljs-keyword">public</span> Symbol <span class="hljs-title function_">resolveCurrentScope</span><span class="hljs-params">(String name)</span>&#123;&#125;<br>    <br>    <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªè¯¥ä½œç”¨åŸŸçš„å­ä½œç”¨åŸŸ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addChildScope</span><span class="hljs-params">(Scope s)</span>&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¹‹ååªéœ€è¦åœ¨éå†è¯­æ³•æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨åˆé€‚çš„ä½ç½®åˆ›å»ºä½œç”¨åŸŸï¼Œå¹¶åœ¨åˆé€‚çš„ä½ç½®é€€å‡ºä½œç”¨åŸŸï¼Œä»¥åŠåœ¨å‡½æ•°å®šä¹‰ã€å˜é‡å£°æ˜çš„å¯¹åº”å¤„ç†å‡½æ•°ä¸­å°†å˜é‡åŒ…è£…æˆç¬¦å·åŠ å…¥åˆ°ä½œç”¨åŸŸçš„ç¬¦å·åˆ—è¡¨ä¸­ã€‚</p><h3 id="å¤„ç†è¯­ä¹‰é”™è¯¯">å¤„ç†è¯­ä¹‰é”™è¯¯</h3><p>éœ€è¦é’ˆå¯¹11ç§é”™è¯¯ä¾æ¬¡è¿›è¡Œåˆ†æå¤„ç†</p><table><thead><tr class="header"><th>é”™è¯¯ç¼–å·</th><th>é”™è¯¯è¯´æ˜</th><th>åˆ†æ</th></tr></thead><tbody><tr class="odd"><td>1</td><td>å˜é‡æœªå£°æ˜</td><td>åœ¨ä½¿ç”¨å˜é‡çš„ä½ç½®ï¼Œå…¨å±€è§£æè¯¥ç¬¦å·ï¼Œçœ‹æ˜¯å¦å®šä¹‰è¯¥å˜é‡ï¼Œå¯åœ¨<code>visitTerminal</code>å‡½æ•°ä¸­å¤„ç†</td></tr><tr class="even"><td>2</td><td>å‡½æ•°æœªå®šä¹‰</td><td>åœ¨å‡½æ•°è°ƒç”¨ä¸­å¤„ç†ï¼Œè§£æè¢«è°ƒç”¨çš„å‡½æ•°åï¼ŒæŸ¥çœ‹æ˜¯å¦è¢«å®šä¹‰</td></tr><tr class="odd"><td>3</td><td>å˜é‡é‡å¤å£°æ˜</td><td>åœ¨å£°æ˜å˜é‡çš„ä½ç½®ï¼šå‡½æ•°å½¢å‚ï¼Œå¸¸é‡å£°æ˜ã€å˜é‡å£°æ˜ä¸‰ä¸ªåœ°æ–¹ï¼Œ<u>æ³¨æ„è§£ææ—¶åªè¦åœ¨å½“å‰ä½œç”¨åŸŸä¸‹è§£æ</u>ï¼ˆå’Œå…¨å±€åŒåå˜é‡ä¸å†²çªï¼‰</td></tr><tr class="even"><td>4</td><td>å‡½æ•°é‡å¤å®šä¹‰</td><td>åœ¨å‡½æ•°å®šä¹‰çš„ä½ç½®ï¼Œè§£æè¦å®šä¹‰çš„å‡½æ•°åï¼Œæ˜¯å¦å·²ç»å®šä¹‰è¿‡</td></tr><tr class="odd"><td>5</td><td>èµ‹å€¼å·ä¸¤ä¾§ç±»å‹ä¸åŒ¹é…</td><td>å‡ºç°åœ¨æœ‰èµ‹å€¼ç¬¦å·çš„ä½ç½®ï¼šå¸¸é‡å£°æ˜ã€å˜é‡å£°æ˜å¹¶åˆå§‹åŒ–ã€èµ‹å€¼è¯­å¥ï¼Œå¤„ç†æ–¹å¼å°±æ˜¯å–å¾—ä¸¤è¾¹çš„ç±»å‹ï¼Œè¿›è¡Œæ¯”è¾ƒåˆ¤æ–­</td></tr><tr class="even"><td>6</td><td>è¿ç®—ç¬¦éœ€æ±‚ç±»å‹ä¸æä¾›ç±»å‹ä¸åŒ¹é…</td><td>å‡ºç°åœ¨æœ‰è¿ç®—ç¬¦çš„åœ°æ–¹ï¼Œ<u>æ³¨æ„ä¸‹æ ‡è¿ç®—ç¬¦<code>[]</code></u>ï¼Œå¤„ç†æ–¹å¼ä¹Ÿæ˜¯è·å–æ“ä½œæ•°çš„ç±»å‹ï¼Œæ£€æŸ¥æ˜¯å¦åŒ¹é…</td></tr><tr class="odd"><td>7</td><td>è¿”å›å€¼ç±»å‹ä¸åŒ¹é…</td><td>å‡ºç°åœ¨è¿”å›è¯­å¥ä¸­ï¼Œç”±äºå‡½æ•°ç±»å‹åªæœ‰<code>int</code>å’Œ<code>void</code>ï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼åˆ¤æ–­æ˜¯å¦æ˜¯<code>void</code>ï¼Œå¦‚æœæœ‰è¿”å›å€¼å°±éœ€è¦åˆ¤æ–­<code>return</code>åé¢çš„è¡¨è¾¾å¼è¿”å›çš„ç±»å‹æ˜¯å¦ä¸º<code>int</code></td></tr><tr class="even"><td>8</td><td>å‡½æ•°å‚æ•°ä¸é€‚ç”¨</td><td>å‡ºç°åœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œå¯ä»¥å…ˆåˆ¤æ–­å½¢å‚æ•°é‡å’Œå®å‚æ•°é‡ï¼Œå¦‚æœç›¸åŒå†è¿›è¡Œä¸€ä¸ªä¸€ä¸ªçš„æ£€æŸ¥åˆ¤æ–­</td></tr><tr class="odd"><td>9</td><td>å¯¹éæ•°ç»„ä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦</td><td>åœ¨å‡ºç°ä¸‹æ ‡è¿ç®—ç¬¦æ—¶æ£€æŸ¥å˜é‡æ˜¯å¦æ˜¯æ•°ç»„ç±»å‹ï¼Œ<u>æ³¨æ„å¯¹æ•°ç»„ç±»å‹å˜é‡ä½¿ç”¨è¶…è¿‡å…¶ç»´æ•°çš„ä¸‹æ ‡è¿ç®—ç¬¦ä¸ªæ•°</u>ï¼ˆä¾‹å¦‚å¯¹ä¸€ç»´æ•°ç»„ä½¿ç”¨ä¸¤ä¸ªä¸‹æ ‡è¿ç®—ç¬¦ï¼‰</td></tr><tr class="even"><td>10</td><td>å¯¹å˜é‡ä½¿ç”¨å‡½æ•°è°ƒç”¨</td><td>å‡ºç°åœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œåˆ¤æ–­å˜é‡ç±»å‹æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹</td></tr><tr class="odd"><td>11</td><td>èµ‹å€¼å·å·¦ä¾§éå˜é‡æˆ–æ•°ç»„å…ƒç´ </td><td>å‡ºç°åœ¨å·¦å€¼è¡¨è¾¾å¼ä¸­ï¼Œå¦‚æœæ˜¯èµ‹å€¼è¯­å¥ï¼Œåˆ¤æ–­å·¦ä¾§çš„ç¬¦å·ç±»å‹æ˜¯å¦ä¸ºå‡½æ•°ç±»å‹</td></tr></tbody></table><blockquote><p>è¿™ä¸€éƒ¨åˆ†æœ€éº»çƒ¦çš„æ˜¯ï¼Œä¸€ä¸ªé”™è¯¯ä¼šå¼•èµ·è¿é”é”™è¯¯ï¼Œä½†æ˜¯è¦æ±‚åªæ‰“å°"æœ€æœ¬è´¨é”™è¯¯"ã€‚</p><p>æˆ‘åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­é‡‡ç”¨ï¼šä¸€æ—¦å‡ºç°é”™è¯¯ä¹‹åï¼Œè¿”å›çš„ç±»å‹éƒ½æ˜¯<code>null</code>ï¼Œè€Œä¸Šå±‚çš„å‡½æ•°åªæœ‰åœ¨ä¸‹å±‚å‡½æ•°ä¸è¿”å›<code>null</code>æ˜¯æ‰ä¼šåœ¨è¿™ä¸€å±‚è¿›è¡Œé”™è¯¯æ£€æŸ¥ï¼Œå¦åˆ™ç›´æ¥è¿”å›ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸æ˜¯æ¯ä¸€ä¸ªå‡½æ•°è¿”å›nulléƒ½ä»£è¡¨å‡ºç°é”™è¯¯ï¼Œè¿˜éœ€è¦ç»“åˆå…·ä½“æƒ…å†µåˆ†æï¼Œä¸è¿‡å¤§éƒ¨åˆ†éƒ½é€‚ç”¨ã€‚</p></blockquote><h2 id="é‡å‘½å">é‡å‘½å</h2><blockquote><p>ä¸ºæ‰€æœ‰ä¸é€‰ä¸­å˜é‡<strong>ç”Ÿå‘½å‘¨æœŸä¸€è‡´</strong>çš„<strong>åŒåå˜é‡</strong>é‡å‘½å</p></blockquote><p>æ€è·¯ï¼š</p><p>åœ¨ç¬¬ä¸€æ¬¡éå†è¯­æ³•æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œè§£æå˜é‡ä¹‹åå°†è¯¥å˜é‡çš„ä½ç½®åŠ å…¥åˆ°ç¬¦å·çš„<code>usePos</code>åˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”æ‰¾åˆ°éœ€è¦é‡å‘½åçš„é‚£ä¸ªå˜é‡(<code>isNeedReplace</code>)ã€‚åœ¨ç¬¬äºŒæ¬¡éå†è¿‡ç¨‹ä¸­ï¼Œå°†éœ€è¦é‡å‘½åçš„é‚£ä¸ªç¬¦å·çš„<code>usePos</code>å–å‡ºï¼Œéå†åˆ°å¯¹åº”ä½ç½®åè¿›è¡Œé‡å‘½åå³å¯ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221217105317387.png" /></p><h2 id="ç¢°åˆ°çš„é—®é¢˜">ç¢°åˆ°çš„é—®é¢˜</h2><p>æ„Ÿè§‰æ¯”è¾ƒå›°éš¾çš„åœ°æ–¹ä¸»è¦è¿˜æ˜¯åœ¨ç¬¬ä¸€éƒ¨åˆ†è¯­ä¹‰é”™è¯¯æ£€æŸ¥ï¼Œå› ä¸ºå‡ºé”™äº†ä¹‹åéœ€è¦è‡ªå·±æƒ³ç”¨ä¾‹å»æ’æŸ¥ï¼Œè€Œä¸”â€œæœ€æœ¬è´¨é”™è¯¯â€çš„è¦æ±‚å¯¼è‡´bugæ¯”è¾ƒéš¾ä»¥æ‰¾åˆ°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–è¯‘åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘åŸç†-Lab2</title>
      <link href="/2022/11/24/compilation-principle/compilation-principle-lab2/"/>
      <url>/2022/11/24/compilation-principle/compilation-principle-lab2/</url>
      
        <content type="html"><![CDATA[<blockquote><p><ahref="http://47.122.3.40:8081/#/lab2-parser/lab2-parser">å®éªŒå†…å®¹</a>ï¼šç¼–å†™SysYè¯­è¨€çš„è¯­æ³•åˆ†æå™¨ï¼Œå¹¶å®ç°é«˜äº®ã€‚</p></blockquote><h2 id="å®éªŒæ€è·¯">å®éªŒæ€è·¯</h2><p>é¦–å…ˆéœ€è¦æ ¹æ®<ahref="https://github.com/courses-at-nju-by-hfwei/compilers-lab-docs/raw/main/docs/docs/SysY%E8%AF%AD%E8%A8%80%E5%AE%9A%E4%B9%89.pdf">SysYè¯­è¨€å®šä¹‰</a>ç¼–å†™Parserï¼Œè¿™éƒ¨åˆ†åŸºæœ¬ä¸Šå°±æ˜¯å°†æ‰‹å†Œä¸Šçš„è¯­æ³•è§„åˆ™æ”¹å†™æˆ<code>Antrl</code>è¯­å¥å³å¯ã€‚</p><p>ç„¶åå°±å¯ä»¥åˆ°<code>Main</code>ç±»ä¸­ç¼–å†™ç›¸åº”çš„é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">if</span>(args.length == <span class="hljs-number">0</span>)&#123;<br>            System.err.println(<span class="hljs-string">&quot;input path is required&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">// get input file and generate the Lexer</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> args[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">CharStream</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> CharStreams.fromFileName(source);<br>        <span class="hljs-type">SysYLexer</span> <span class="hljs-variable">sysYLexer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SysYLexer</span>(input);<br><br>        <span class="hljs-comment">// generate the Parser</span><br>        <span class="hljs-type">CommonTokenStream</span> <span class="hljs-variable">tokens</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CommonTokenStream</span>(sysYLexer);<br>        <span class="hljs-type">SysYParser</span> <span class="hljs-variable">sysYParser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SysYParser</span>(tokens);<br><br>        <span class="hljs-type">Visitor</span> <span class="hljs-variable">visitor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Visitor</span>();<br><br>        <span class="hljs-comment">// add error listener</span><br>        sysYParser.removeErrorListeners();<br>        <span class="hljs-type">MyParserErrorListener</span> <span class="hljs-variable">myParserErrorListener</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyParserErrorListener</span>(visitor);<br>        sysYParser.addErrorListener(myParserErrorListener);<br><br>        <span class="hljs-comment">// DFS the tree</span><br>        <span class="hljs-type">ParseTree</span> <span class="hljs-variable">tree</span> <span class="hljs-operator">=</span> sysYParser.program();<br>        visitor.visit(tree);<br>    &#125;<br></code></pre></td></tr></table></figure><p>ç±»ä¼¼äºLab1ï¼Œéœ€è¦å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„<code>ErrorListener</code>ï¼Œä¼ é€’ç»™<code>Parser</code>ï¼Œä½¿å¾—åœ¨å‘ç°è¯­æ³•é”™è¯¯æ—¶æ‰§è¡ŒæŠ¥é”™è¾“å‡ºã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦ä¼ é€’<code>Visitor</code>?</p><p>ç”±äºä¸€æ—¦å‡ºç°è¯­æ³•é”™è¯¯ï¼Œå°±ä¸éœ€è¦æ‰“å°è¯­æ³•æ ‘äº†ï¼Œæ‰€ä»¥éœ€è¦åœ¨<code>ErrorListener</code>ç›‘å¬åˆ°è¯­æ³•é”™è¯¯æ—¶è®©<code>Visitor</code>ä¸è¦åšè¾“å‡ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyParserErrorListener</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseErrorListener</span>&#123;<br>    Visitor visitor;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyParserErrorListener</span><span class="hljs-params">(Visitor v)</span>&#123; <span class="hljs-built_in">this</span>.visitor = v; &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syntaxError</span><span class="hljs-params">(Recognizer&lt;?, ?&gt; recognizer,</span><br><span class="hljs-params">                            Object offendingSymbol,</span><br><span class="hljs-params">                            <span class="hljs-type">int</span> line,</span><br><span class="hljs-params">                            <span class="hljs-type">int</span> charPositionInLine,</span><br><span class="hljs-params">                            String msg,</span><br><span class="hljs-params">                            RecognitionException e)</span><br>    &#123;<br>        <span class="hljs-built_in">this</span>.visitor.hasError = <span class="hljs-literal">true</span>;<br>        System.err.println(<span class="hljs-string">&quot;Error type B at Line &quot;</span> + line + <span class="hljs-string">&quot;: &quot;</span> + msg);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åä¹Ÿæ˜¯æœ€å…³é”®çš„ï¼Œç¼–å†™ç»§æ‰¿è‡ª<code>SysYParserBaseVisitor&lt;Void&gt;</code>çš„<code>Visitor</code>ï¼Œå®ç°æ‰“å°è¯­æ³•æ ‘ä»¥åŠé«˜äº®çš„åŠŸèƒ½ã€‚</p><ol type="1"><li>å¦‚ä½•æ‰“å°èŠ‚ç‚¹ä¿¡æ¯ï¼šåœ¨<code>visitChildren</code>å’Œ<code>visitTerminal</code>ä¸¤ä¸ªå‡½æ•°ä¸­ï¼Œè°ƒç”¨å‚æ•°<code>node</code>çš„ç›¸å…³æ–¹æ³•å°±å¯ä»¥è·å¾—<code>type</code>ã€<code>text</code>ç­‰ä¿¡æ¯ã€‚</li><li>å¦‚ä½•å®ç°ç¼©è¿›ï¼šå­˜åœ¨<code>depth</code>å­—æ®µï¼Œè°ƒç”¨<code>node.getRuleContext().depth()</code>è·å¾—ï¼›æ³¨æ„åœ¨<code>visitTerminal</code>å‡½æ•°ä¸­éœ€è¦å¼ºè½¬ä¸€ä¸‹ç±»å‹ã€‚</li><li>å¦‚ä½•å®ç°é«˜äº®ï¼šåœ¨<code>SysYParser</code>ä¸­æ‰¾åˆ°å¯¹åº”çš„å­˜æ”¾èŠ‚ç‚¹ç±»å‹çš„æ•°ç»„ï¼Œå°†æ•°ç»„ä¸­çš„å€¼ä¿®æ”¹ä¸ºå¯¹åº”çš„é¢œè‰²å€¼ï¼Œæ¯æ¬¡æ ¹æ®<code>type</code>è·å–å¯¹åº”é¢œè‰²ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Visitor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SysYParserBaseVisitor</span>&lt;Void&gt;&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">hasError</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getColor</span><span class="hljs-params">(<span class="hljs-type">int</span> type)</span> &#123;<br>        <span class="hljs-keyword">if</span> (type &lt; <span class="hljs-number">0</span> || type &gt;= _COLOR_NAMES.length) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">return</span> _COLOR_NAMES[type];<br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] _COLOR_NAMES = &#123;<br>            <span class="hljs-literal">null</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[orange]&quot;</span>,<br>            <span class="hljs-string">&quot;[orange]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>,<br>            <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;[blue]&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;[green]&quot;</span>,<br>            <span class="hljs-string">&quot;[red]&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span><br>    &#125;;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printIndents</span><span class="hljs-params">(<span class="hljs-type">int</span> depth)</span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; depth * <span class="hljs-number">2</span>; i++)&#123;<br>            System.err.print(<span class="hljs-string">&quot; &quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Void <span class="hljs-title function_">visitChildren</span><span class="hljs-params">(RuleNode node)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">ruleIdx</span> <span class="hljs-operator">=</span> node.getRuleContext().getRuleIndex();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">rule</span> <span class="hljs-operator">=</span> SysYParser.ruleNames[ruleIdx];<br>        <span class="hljs-keyword">if</span> (!hasError)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">depth</span> <span class="hljs-operator">=</span> node.getRuleContext().depth();<br>            printIndents(depth-<span class="hljs-number">1</span>); <span class="hljs-comment">// need -1: depth begin from 1</span><br>            System.err.println(rule.toUpperCase().charAt(<span class="hljs-number">0</span>) + rule.substring(<span class="hljs-number">1</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.visitChildren(node);<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Void <span class="hljs-title function_">visitTerminal</span><span class="hljs-params">(TerminalNode node)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">type</span> <span class="hljs-operator">=</span> node.getSymbol().getType(); <span class="hljs-comment">// node type</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">color</span> <span class="hljs-operator">=</span> getColor(type);<br>        <span class="hljs-keyword">if</span> (!hasError &amp;&amp; !color.equals(<span class="hljs-string">&quot;&quot;</span>))&#123; <span class="hljs-comment">// &quot;&quot; means the terminal node we need, such as &#x27;&#123;&#x27; &#x27;&#125;&#x27;</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">literal_name</span> <span class="hljs-operator">=</span> node.toString();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">symbol_name</span> <span class="hljs-operator">=</span> SysYParser.VOCABULARY.getSymbolicName(type);<br>            <span class="hljs-comment">// deal with numbers</span><br>            <span class="hljs-keyword">if</span> (type == SysYParser.INTEGR_CONST)&#123;<br>                literal_name = convert_to_dec(literal_name);<br>            &#125;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">depth</span> <span class="hljs-operator">=</span> ((RuleNode)node.getParent()).getRuleContext().depth(); <span class="hljs-comment">// the depth in parser tree</span><br>            printIndents(depth);<br>            System.err.println(literal_name + <span class="hljs-string">&quot; &quot;</span> + symbol_name + color);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">convert_to_dec</span><span class="hljs-params">(String number)</span>&#123;<br>        <span class="hljs-keyword">if</span> (number.equals(<span class="hljs-string">&quot;0&quot;</span>))&#123;<br>            number = <span class="hljs-string">&quot;0&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number.startsWith(<span class="hljs-string">&quot;0x&quot;</span>) || number.startsWith(<span class="hljs-string">&quot;0X&quot;</span>))&#123;<br>            number = Integer.parseInt(number.substring(<span class="hljs-number">2</span>), <span class="hljs-number">16</span>) + <span class="hljs-string">&quot;&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number.startsWith(<span class="hljs-string">&quot;0&quot;</span>))&#123;<br>            number = Integer.parseInt(number.substring(<span class="hljs-number">1</span>), <span class="hljs-number">8</span>) + <span class="hljs-string">&quot;&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> number;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç¢°åˆ°çš„é—®é¢˜">ç¢°åˆ°çš„é—®é¢˜</h2><h3 id="ç¼©è¿›">ç¼©è¿›</h3><p>å¦‚ä½•æŒ‰å±‚æ¬¡ç¼©è¿›æ˜¯åšå®éªŒçš„æ—¶å€™ç¢°åˆ°çš„æœ€å¤§çš„ä¸€ä¸ªé—®é¢˜ã€‚ä¸€å¼€å§‹æ²¡æƒ³åˆ°ä¼šæœ‰<code>depth</code>å­—æ®µï¼Œä¸€ç›´åœ¨æƒ³å¦‚ä½•é€šè¿‡ä¸€ä¸ªå˜é‡æ¥æ ‡è®°å±‚æ¬¡ï¼Œç»“æœä¸€ç›´æ²¡æœ‰æˆåŠŸï¼Œå› ä¸ºä¸¤ä¸ª<code>visit</code>å‡½æ•°éƒ½æ˜¯è¿›å…¥èŠ‚ç‚¹ä¹‹å‰è°ƒç”¨ï¼Œè€Œæ²¡æœ‰å¯¹åº”çš„ç¦»å¼€åè°ƒç”¨çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡åœ¨ä¸¤ä¸ªå‡½æ•°å†…çš„å¢å‡å˜åŒ–å®ç°å±‚æ¬¡çš„å˜åŒ–ï¼ˆä¹Ÿè®¸<code>Listener</code>åº”è¯¥æ˜¯å¯ä»¥çš„ï¼‰</p><h3 id="æ‹¼å†™">æ‹¼å†™</h3><p><code>INTEGR_CONST</code>ã€‚æµ‹è¯•çš„æ—¶å€™çœ‹å®ƒè¾“å‡ºåœ¨æ–‡ä»¶é‡ŒæŠ¥æ‹¼å†™é”™è¯¯ï¼Œè¿˜ä»¥ä¸ºæ˜¯è‡ªå·±å†™é”™äº†ï¼Œå…¨éƒ¨æ”¹æˆ<code>INTEGER_CONST</code>ï¼Œç»“æœ<code>OJ</code>è¿‡ä¸äº†ï¼Œåæ¥å‘ç°åœ¨<code>Lab1</code>çš„<code>Lexer</code>ä¸­å†™çš„å°±æ˜¯<code>INTEGR_CONST</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–è¯‘åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ“ä½œç³»ç»Ÿ-Lab3</title>
      <link href="/2022/11/21/nju-os-labs/OS-Lab3/"/>
      <url>/2022/11/21/nju-os-labs/OS-Lab3/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡†å¤‡">å‡†å¤‡</h2><p>å®éªŒä»¥ã€Šorange'sï¼šä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å®ç°ã€‹çš„<ahref="https://github.com/wlmnzf/oranges/tree/master/chapter7/o">ä»£ç </a>ä¸ºåŸºç¡€</p><h3 id="è¿è¡Œ">è¿è¡Œ</h3><h4 id="é—®é¢˜1">é—®é¢˜1</h4><p>make imageå¤±è´¥</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221108200704537.png" /></p><p>è§£å†³æ–¹æ³•</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221108200905099.png" /></p><p>ç»“æœ</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221108201025947.png" /></p><h4 id="é—®é¢˜2">é—®é¢˜2</h4><p><code>make image</code>ç»“æŸä¹‹åï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¤±è´¥</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">bochs -f bochsrc</span><br></code></pre></td></tr></table></figure><p>æŠ¥é”™ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">dlopen failed for module &#x27;x&#x27;: file not found<br></code></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install bochs-x<br></code></pre></td></tr></table></figure><p>ç»“æœæ˜¾ç¤º</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221108201337846.png" /></p><h3 id="å·²å®ç°å’Œå¾…å®ç°">å·²å®ç°å’Œå¾…å®ç°</h3><h4 id="å·²å®ç°">å·²å®ç°</h4><ol type="1"><li>ä»å±å¹•å·¦ä¸Šè§’å¼€å§‹ï¼Œä»¥ç™½è‰²æ˜¾ç¤ºé”®ç›˜è¾“å…¥çš„å­—ç¬¦ï¼Œå¯ä»¥è¾“å…¥å¹¶æ˜¾ç¤ºa-z,A-Zå’Œ0-9å­—ç¬¦ã€‚</li><li>æ”¯æŒå¤§å°å†™åˆ‡æ¢åŒ…æ‹¬ Shift ç»„åˆé”®ä»¥åŠå¤§å†™é”å®šä¸¤ç§æ–¹å¼ï¼Œå¤§å†™é”å®šåå†ç”¨Shift ç»„åˆé”®å°†ä¼šè¾“å…¥å°å†™å­—æ¯</li><li>æ”¯æŒå›è½¦é”®æ¢è¡Œ</li><li>æ”¯æŒç”¨é€€æ ¼é”®åˆ é™¤è¾“å…¥å†…å®¹</li><li>æ”¯æŒç©ºæ ¼é”®</li><li>æœ‰å…‰æ ‡æ˜¾ç¤º</li><li>è¾“å…¥å­—ç¬¦æ— ä¸Šé™</li></ol><h4 id="å¾…å®ç°">å¾…å®ç°</h4><ul class="task-list"><li><label><input type="checkbox" checked="" />make runç›´æ¥è¿è¡Œ</label></li><li><label><input type="checkbox" checked="" />æ”¯æŒTabé”®</label></li><li><label><input type="checkbox"checked="" />æ¸…ç©ºå±å¹•ä»¥åŠæ¯éš”20ç§’æ¸…ç©ºå±å¹•</label></li><li><label><input type="checkbox"checked="" />é€€æ ¼æ¢è¡Œå’ŒTABéœ€è¦ä¸€æ¬¡å®Œæˆ</label></li><li><label><input type="checkbox" checked="" />æŸ¥æ‰¾åŠŸèƒ½</label></li><li><label><input type="checkbox" checked="" />control + zç»„åˆé”®æ’¤å›</label></li></ul><h2 id="ç†è§£ä»£ç ">ç†è§£ä»£ç </h2><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112082935878.png" /></p><p>é¦–å…ˆï¼Œéœ€è¦ç†è§£ä»£ç ï¼Œå¯ä»¥ç…§ç€ã€Šorange'sï¼šä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å®ç°ã€‹ç¬¬ä¸ƒç« çš„è®²è§£ä¸€èµ·çœ‹ã€‚</p><p>è¾“å‡ºä¸€ä¸ªå­—ç¬¦çš„å‡½æ•°è°ƒç”¨é€»è¾‘</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221110203047699.png" /></p><p>å½“åˆå§‹åŒ–ç»“æŸåï¼Œå°±ä¼šè¿›å…¥åˆ°<code>task_tty()</code>å‡½æ•°ä¸­ï¼Œè¿›è¡Œä¸æ–­çš„å¾ªç¯ã€‚</p><h3id="æ¢ç©¶consoleç»“æ„ä½“ä¸­å››ä¸ªå˜é‡çš„å«ä¹‰">æ¢ç©¶CONSOLEç»“æ„ä½“ä¸­å››ä¸ªå˜é‡çš„å«ä¹‰</h3><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111162034665.png" /></p><p><strong>åˆ†æè¿‡ç¨‹</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111090406115.png" /></p><p><u>å±å¹•ä¸€è¡Œ80ä¸ªå­—ç¬¦ï¼Œå±å¹•æ€»å…±25è¡Œã€‚</u></p><p>åœ¨æ•²å­—ç¬¦è¿‡ç¨‹ä¸­ï¼Œ<u><code>cursor</code>åœ¨ä¸æ–­åŠ 1</u>ï¼Œ<u><code>original_addr</code>å§‹ç»ˆä¸º<code>0x0</code></u>ï¼Œ<code>current_start_addr</code>æ˜¯<u>å½“å‰å±å¹•å¯è§èŒƒå›´çš„å¼€å§‹ä½ç½®</u>è·ç¦»<u>æœ€å¼€å§‹æ˜¾ç¤ºä½ç½®</u>çš„åç§»ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111091301955.png" /></p><p>æŒ‰åˆ°æœ€å</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111162617930.png" /></p><p>å¯ä»¥å‘ç°<code>cursor</code>çš„å€¼æœ€å¤§åªèƒ½åˆ°<code>0x1554</code>ï¼Œå› ä¸ºè¢«<code>v_mem_limit</code>æ‰€é™åˆ¶ã€‚</p><p>ç»è¿‡åˆ†æå°±å¯ä»¥åŸºæœ¬ç¡®å®šCONSOLEç»“æ„ä½“å››ä¸ªå˜é‡çš„å«ä¹‰ï¼Œç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºä¸€ä¸‹</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111164821213.png" /></p><h2 id="å®ç°åŠŸèƒ½">å®ç°åŠŸèƒ½</h2><h3 id="tab">TAB</h3><p>åœ¨<code>keyboard.h</code>ä¸­å¯ä»¥å‘ç°TABæ˜¯ä¸€ä¸ªä¸å¯æ˜¾ç¤ºçš„å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨<code>tty.c</code>çš„<code>in_process</code>ä¸­è¦å¢åŠ å¯¹äº<code>TAB</code>çš„è¯†åˆ«ï¼Œå°†å…¶æ”¾è¿›ç¼“å†²åŒºå†…ã€‚ç„¶ååœ¨<code>console.c</code>çš„<code>out_char</code>å‡½æ•°ä¸­å¢åŠ å¯¹<code>\t</code>çš„è¾“å‡ºå¤„ç†ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112160733005.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112160949600.png" /></p><h3 id="æ¸…å±">æ¸…å±</h3><p>æ¸…å±çš„åŠŸèƒ½å®ç°åœ¨é€»è¾‘ä¸Šæ¯”è¾ƒç®€å•ï¼Œåªè¦ä¸æ–­åœ°è°ƒç”¨<code>out_char()</code>å‡½æ•°ï¼Œä¼ å…¥<code>\b</code>ï¼Œç›´åˆ°<code>cursor</code>å›åˆ°<code>original_addr</code>ä½ç½®ã€‚</p><p>ä½†æ˜¯å¦‚ä½•åœ¨å®ç°æ¯20ç§’æ¸…å±ä¸€æ¬¡å‘¢ï¼Ÿè¦ç†è§£<code>kernel_main()</code>å‡½æ•°ä¸­çš„ä»»åŠ¡ï¼Œå¯ä»¥æ–°å¢ä¸€ä¸ªä»»åŠ¡ï¼Œ<code>task_clear_screen</code>ï¼Œç„¶ååœ¨å…¶ä¸­æ‰§è¡Œæ¸…å±ä»»åŠ¡ï¼Œå¹¶ä¸”æ¯æ¬¡æ‰§è¡Œå®Œæ¯•åå»¶è¿Ÿ20sã€‚</p><p>1ã€å°†<code>task_clear_screen</code>å£°æ˜æˆä¸€ä¸ªä»»åŠ¡ï¼Œä¸æ–­æ‰§è¡Œ</p><p>åœ¨<code>global.c</code>ä¸­åšç›¸åº”ä¿®æ”¹ï¼Œå¹¶ä¿®æ”¹å¯¹åº”çš„å®</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112161118740.png" /></p><p>2ã€åœ¨<code>task_clear_screen</code>ä»»åŠ¡ä¸­å®Œæˆæ¸…å±é€»è¾‘ï¼Œå¹¶ä¸”å»¶è¿Ÿ20s</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111215247007.png" /></p><blockquote><p>æ¯ä¸ªä»»åŠ¡ä¸­whileå¾ªç¯ä¸èƒ½breakï¼Œå¦åˆ™æ‰§è¡Œä¼šæŠ¥é”™ã€‚</p></blockquote><h3 id="é€€æ ¼ä¸€æ¬¡å®Œæˆ">é€€æ ¼ä¸€æ¬¡å®Œæˆ</h3><p>æºä»£ç çš„åˆ é™¤åŠŸèƒ½åªå®ç°äº†ä¸€ä¸ªä¸€ä¸ªåˆ é™¤ï¼Œå³ä½¿æ˜¯å¯¹äº<code>\n</code>å’Œ<code>\t</code>ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸ç¬¦åˆå®é™…æƒ…å†µï¼Œéœ€è¦åšä¿®æ”¹ï¼Œå®ç°ä¸€æ¬¡åˆ é™¤<code>\t</code>å’Œ<code>\n</code>ã€‚</p><p><strong>æ€è·¯</strong></p><p>è¦æƒ³å®ç°ä¸€æ¬¡é€€æ ¼ï¼Œå°±éœ€è¦çŸ¥é“å‰ä¸€ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆï¼Œå¦‚æœæ˜¯æ™®é€šå­—ç¬¦é‚£ä¹ˆè®©å…‰æ ‡ä½ç½®å‡ä¸€å³å¯ï¼Œå¦‚æœæ˜¯ç‰¹æ®Šçš„<code>\n</code>å’Œ<code>\t</code>å°±éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä½¿å…‰æ ‡å›åˆ°æŒ‰ä¸‹<code>\n</code>å’Œ<code>\t</code>å‰çš„ä½ç½®ã€‚</p><p>å¯¹äº<code>\t</code>è¿˜å¥½è¯´ï¼Œåªè¦æŠŠå…‰æ ‡å‡4å³å¯ï¼›ä½†æ˜¯å¯¹äº<code>\n</code>æ¥è¯´ï¼Œå°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚</p><p>ä¸€å¼€å§‹ï¼Œæƒ³è®©å…‰æ ‡ä¸€ç›´å¾€å›ç§»åŠ¨ç›´åˆ°é‡åˆ°ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚ä½†æ˜¯å¦‚æœåœ¨è¾“å…¥<code>\n</code>ä¹‹å‰åˆšè¾“å…¥äº†ç©ºæ ¼å‘¢ï¼Ÿè¿™æ ·æ˜¾ç„¶å°±ä¸å¯¹ï¼Œè€Œä¸”å®ç°èµ·æ¥è¿˜å¾ˆå¤æ‚ã€‚</p><p>æ‰€ä»¥éœ€è¦å€ŸåŠ©æ–°çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨å·²ç»æ˜¾ç¤ºçš„å­—ç¬¦ï¼Œå¹¶ä¸”å¯¹æ˜¾ç¤ºçš„å­—ç¬¦åšä¸€ä¸ªåŒ…è£…ï¼Œåšæˆä¸€ä¸ªç»“æ„ä½“ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111192544494.png" /></p><p>å†æ„å»ºä¸€ä¸ªå­˜å‚¨å½“å‰å±å¹•ä¸­æ‰€æœ‰æ˜¾ç¤ºçš„å­—ç¬¦çš„ç»“æ„ä½“</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111192521635.png" /></p><p>ç„¶åéœ€è¦åœ¨é€‚å½“çš„åœ°æ–¹å°†è¿™ä¸ªæ•°æ®ç»“æ„æ’å…¥</p><p><strong>è¿‡ç¨‹</strong></p><p>1ã€åˆå§‹åŒ–C_BUFç»“æ„ä½“</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111193022381.png" /></p><p>2ã€åœ¨å°†å­—ç¬¦æ”¾å…¥TTYä¸­çš„åŒæ—¶ï¼Œä¹Ÿå°†å°è£…èµ·æ¥çš„å­—ç¬¦æ”¾è¿›C_BUFä¸­</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111193053341.png" /></p><p>3ã€<strong>åœ¨<code>out_char</code>å‡½æ•°ä¸­å®ç°å¯¹åº”é€»è¾‘</strong></p><p>åœ¨å…¶ä»–è¾“å‡ºå­—ç¬¦çš„ä½ç½®éœ€è¦åŠ ä¸Šå¯¹CHARç»“æ„ä½“ä¸­before_cursorå’Œafter_cursorçš„èµ‹å€¼ï¼Œä¾‹å¦‚ï¼š</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111193614434.png" /></p><p>ç„¶ååœ¨å¤„ç†é€€æ ¼é”®æ—¶å°±å¯ä»¥ç”¨å¦‚ä¸‹ä¸€æ®µä»£ç è§£å†³</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111193431518.png" /></p><p>4ã€æ˜¾ç¤ºå­—ç¬¦ç»“æŸåï¼Œéœ€è¦ä¿®æ”¹C_BUFä¸­çš„<code>buf_cur_idx</code></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221111193124708.png" /></p><p><strong>è¿™ä¹ˆè®¾è®¡å°±å¯ä»¥æŠŠæ‰€æœ‰çš„å­—ç¬¦ç»Ÿä¸€èµ·æ¥å¤„ç†ï¼Œåœ¨é€€æ ¼æ—¶åªè¦å›åˆ°æŒ‰ä¸‹è¯¥é”®å‰çš„å…‰æ ‡ä½ç½®å³å¯ã€‚</strong></p><blockquote><p>æ³¨æ„éœ€è¦æŠŠp_cbufä½œä¸ºå…¨å±€å˜é‡å£°æ˜ï¼Œè¿™æ ·å¯ä»¥åœ¨æ‰€æœ‰æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œè€Œä¸ç”¨ä½œä¸ºå‡½æ•°å‚æ•°ä¼ æ¥ä¼ å»ã€‚</p><p><u>åœ¨global.cå’Œglobal.hä¸­åšå£°æ˜å³å¯</u></p></blockquote><h3 id="æŸ¥æ‰¾åŠŸèƒ½">æŸ¥æ‰¾åŠŸèƒ½</h3><p><strong>æ€è·¯</strong></p><p>æ˜ç¡®å‡ ä¸ªçŠ¶æ€(ä»£ç ä¹Ÿæ˜¯ä¾æ®çŠ¶æ€ç¼–å†™çš„)</p><p>1ã€æ­£å¸¸çŠ¶æ€ã€‚ä»¥é»‘åº•ç™½å­—æ˜¾ç¤ºå­—ç¬¦ï¼Œä¸€åˆ‡æ­£å¸¸</p><p>2ã€æœç´¢çŠ¶æ€ã€‚åœ¨æ­£å¸¸çŠ¶æ€æŒ‰ä¸‹escåï¼Œ<u>ä»¥é»‘åº•çº¢å­—æ˜¾ç¤ºå­—ç¬¦</u>ï¼Œå¹¶<u>è®°å½•è¿™æ®µæ—¶é—´æ•²ä¸‹çš„å­—ç¬¦</u>ã€‚</p><p>3ã€åŒ¹é…çŠ¶æ€ã€‚æœç´¢çŠ¶æ€æŒ‰ä¸‹enteråï¼Œè¿›è¡Œmatchï¼Œæ€è·¯æ˜¯<u>ä»å¤´éå†C_BUFç»“æ„ä½“æ•°ç»„ï¼Œæ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²åæŠŠç›¸åº”çš„å­—ç¬¦é¢œè‰²æ”¹æˆé»‘åº•çº¢å­—ï¼Œå†ä»å¤´æ˜¾ç¤º</u>ã€‚</p><p>4ã€ä»åŒ¹é…æ€é€€å‡ºã€‚<u>åˆ å»æœç´¢å­—ç¬¦ä¸²</u>ï¼Œ<u>æŠŠé»‘åº•çº¢å­—çš„æ”¹æˆé»‘åº•ç™½å­—</u>ï¼Œ<u>é‡æ–°æ˜¾ç¤º</u>ã€‚</p><p><strong>è¿‡ç¨‹</strong></p><p>1ã€å®šä¹‰ä¸€äº›å…¨å±€å˜é‡å’Œå¸¸é‡ï¼Œå¯¹CHARç»“æ„ä½“è¿›è¡Œè°ƒæ•´(å¢åŠ colorå­—æ®µ)</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145803256.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112144313280.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112144339441.png" /></p><p>çŠ¶æ€çš„å˜åŒ–</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">INIT(æŒ‰ESC) -&gt; SEARCH(æŒ‰Enter) -&gt; MATCH(æŒ‰ESC) -&gt; INIT<br></code></pre></td></tr></table></figure><p>2ã€åœ¨æ¯ä¸ªçŠ¶æ€ç¼–å†™ç›¸åº”é€»è¾‘</p><p><strong>INIT</strong></p><p>åœ¨<code>in_process</code>å‡½æ•°ä¸­å¢åŠ å¯¹ESCçš„è¯†åˆ«</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112144935869.png" /></p><p>è¿™ä¸ªåˆå§‹åŒ–è¦å°å¿ƒï¼Œæ¯æ¬¡è¿›å…¥æœç´¢çŠ¶æ€éƒ½è¦è¿›è¡Œåˆå§‹åŒ–</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145609113.png" /></p><p><strong>SEARCH</strong></p><p>æ”¹å˜in_processä¸­å¯¹Enteré”®çš„å¤„ç†</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145035952.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145542894.png" /></p><p><strong>MATCH</strong></p><p>åœ¨in_processå‡½æ•°å¼€å¤´åŠ ä¸Šåˆ¤æ–­ï¼Œåªæ¥æ”¶ESC</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145201780.png" /></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145515851.png" /></p><p>åœ¨out_charå‡½æ•°ä¸­ä¹Ÿè¦åšç›¸åº”å¤„ç†</p><p>1ã€MATCHçŠ¶æ€ä¸‹æ˜¯ä¸éœ€è¦å‘C_BUFæ•°ç»„ä¸­å¢æ·»CHARçš„ï¼Œåªåšè¾“å‡ºã€‚</p><p>2ã€SEARCHçŠ¶æ€ä¸‹è¦è®°å½•æœç´¢å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ³¨æ„SEARCHçŠ¶æ€ä¸‹æ˜¯é»‘åº•çº¢è‰²ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112145247460.png" /></p><blockquote><p>æ³¨æ„ï¼šåœ¨é€€æ ¼æœç´¢å­—ç¬¦ä¸²æ—¶(<code>SEARCH</code>çŠ¶æ€)ï¼Œä¸èƒ½å°†åŸæ¥çš„å­—ç¬¦ä¸²åˆ é™¤ã€‚</p></blockquote><h3 id="controlzæ’¤é”€">control+zæ’¤é”€</h3><p>è¿™ä¸ªä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆè¦åˆ¤æ–­å‡ºæ˜¯å¦æ˜¯æŒ‰ä¸‹<code>ctrl+z</code>ç»„åˆé”®ï¼Œç„¶åæ‰§è¡Œé€€æ ¼æ“ä½œå³å¯ã€‚</p><p>ä¼¼ä¹æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œå› ä¸ºæ—¢è¦æ’¤é”€æ˜¾ç¤ºå‡ºæ¥çš„å­—ç¬¦ï¼Œè¿˜è¦æ’¤é”€åˆ é™¤ï¼Œä»¥åŠéœ€è¦èƒ½å¤Ÿä¸€ç›´æ’¤é”€ç›´åˆ°åˆå§‹çŠ¶æ€ã€‚</p><p>æƒ³æ³•1ï¼šå†å»ºç«‹ä¸€ä¸ªACTIONçš„åˆ—è¡¨ï¼Œè®°å½•æ‰€æœ‰çš„æ“ä½œã€‚ä½†æ˜¯å®ç°èµ·æ¥å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºéœ€è¦åŒæ­¥å¥½å‡ ä¸ªæ•°æ®ç»“æ„æ•°ç»„ä¹‹é—´çš„å…³ç³»ã€‚</p><p>æƒ³æ³•2ï¼šæ”¹é€ C_BUFæ•°æ®ç»“æ„ã€‚å…¶å®æ’¤é”€çš„ä¸»è¦éš¾ç‚¹åœ¨äºæ’¤é”€é€€æ ¼ï¼Œæ‰€ä»¥åœ¨C_BUFä¸­ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆã€‚ä¹Ÿä¸è¡Œï¼Œå¯æ“ä½œæ€§ä¸é«˜ï¼ŒæŒ‡é’ˆç§»åŠ¨æ¯”è¾ƒå¤æ‚ã€‚</p><p>æœ€ç»ˆé‡‡ç”¨æƒ³æ³•1ï¼Œéœ€è¦ç†æ¸…ACTIONæ•°ç»„åœ¨ä»€ä¹ˆä½ç½®æ›´æ–°ï¼</p><p>1ã€åˆ›å»ºæ•°æ®ç»“æ„</p><p>å…¶ä¸­<code>MAX_ACTION</code>ä¸º1000ï¼Œå³æ”¯æŒå¤§çº¦1000æ¬¡æ’¤é”€ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112155756326.png" /></p><p>2ã€åˆå§‹åŒ–ACTIONåˆ—è¡¨</p><p>åœ¨task_ttyå‡½æ•°ä¸­è°ƒç”¨åˆå§‹åŒ–å‡½æ•°å³å¯</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112155904351.png" /></p><p>3ã€å‘åˆ—è¡¨ä¸­å¢åŠ ACTION</p><p>ç»è¿‡æ€è€ƒï¼Œé€‰åœ¨tty_do_writeå‡½æ•°çš„out_charåé¢</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112160009078.png" /></p><p>4ã€æ’¤é”€æ“ä½œ</p><p>åœ¨in_processå‡½æ•°ä¸­å¢åŠ ä»¥ä¸‹é€»è¾‘ï¼Œå°±æ˜¯åœ¨åˆ¤æ–­å‡ºæ˜¯<code>Ctrl+z</code>ç»„åˆé”®åï¼Œå›é€€ACTIONæ•°ç»„ï¼Œåšé€†æ“ä½œã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221112160101647.png" /></p><blockquote><p>æ³¨æ„è™šæ‹Ÿæœºä¸­çš„çƒ­é”® VirtualBoxé»˜è®¤æ˜¯ Right Ctrl</p><p>å¯¼è‡´Right CtrlæŒ‰ä¸å‡ºæ¥</p></blockquote><h3 id="æ€»ç»“">æ€»ç»“</h3><p>ç”±äºä¸Šé¢çš„æè¿°æ˜¯å†™å®Œä¸€ä¸ªåŠŸèƒ½åç«‹åˆ»å†™ä¸‹çš„ï¼Œæ‰€ä»¥å¯¼è‡´ä»£ç å‰åä¼šå‡ºç°ä¸ä¸€è‡´ã€‚</p><p>æ„Ÿè§‰ååˆ†é‡è¦çš„è°ƒæ•´æ˜¯ ã€å°†å­—ç¬¦åŠ è¿›C_BUFç»“æ„ä½“ä¸­buf ã€‘çš„ä½ç½® å’Œ ã€æ›´æ–°C_BUFç»“æ„ä½“ä¸­ buf_cur_idxã€‘ çš„ä½ç½®ï¼Œæœ€åæ˜¯éƒ½æ”¾åœ¨äº†out_charå‡½æ•°ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> nju-os-labs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°11--é¢è¯•å¿…çŸ¥å¿…ä¼š</title>
      <link href="/2022/11/19/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B011%EF%BC%88%E9%9D%A2%E8%AF%95%EF%BC%89/"/>
      <url>/2022/11/19/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B011%EF%BC%88%E9%9D%A2%E8%AF%95%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="nsumé—®é¢˜">nSumé—®é¢˜</h2><blockquote><p>nSumé—®é¢˜å°±æ˜¯ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ª<code>target</code>ï¼Œè¦æ±‚æ‰¾åˆ° <code>n</code>ä¸ª<code>nums</code>ä¸­çš„å…ƒç´ ï¼Œä½¿å¾—è¿™<code>n</code>ä¸ªå…ƒç´ çš„å’Œç­‰äº<code>target</code>ï¼Œè¦æ±‚è¿”å›æ‰€æœ‰å¯èƒ½çš„ä¸é‡å¤çš„æƒ…å†µã€‚</p></blockquote><p>ã€2Sumã€‘é—®é¢˜æ˜¯è¿™ç±»çš„åŸºæœ¬æƒ…å†µï¼Œå°†æ•°ç»„æ’åºåä½¿ç”¨åŒæŒ‡é’ˆå³å¯è§£å†³é—®é¢˜ã€‚å¯¹äº<spanclass="math inline">\(n &gt;2\)</span>çš„æƒ…å†µï¼Œå°¤å…¶æ˜¯<code>n</code>æ¯”è¾ƒå¤§æ—¶ï¼Œç›´æ¥è§£å†³æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå¯ä»¥é‡‡ç”¨==é€’å½’==è§£å†³ã€‚ä¸‹é¢ç»™å‡ºè§£å†³ã€nSumã€‘é—®é¢˜çš„ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">/** </span><br><span class="hljs-comment">nums: sortedä¹‹åçš„æ•°ç»„</span><br><span class="hljs-comment">start: å¼€å§‹å¯»æ‰¾çš„ä½ç½®</span><br><span class="hljs-comment">k: éœ€è¦å¯»æ‰¾å¤šå°‘ä¸ªå…ƒç´ ä¹‹å’Œ</span><br><span class="hljs-comment">target: ç›®æ ‡å€¼</span><br><span class="hljs-comment">*/</span><br>vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-built_in">nSum</span>(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> k, <span class="hljs-type">int</span> target) &#123;<br>    <span class="hljs-type">int</span> n = nums.<span class="hljs-built_in">size</span>();<br>    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; res;<br>    <span class="hljs-keyword">if</span>(k == <span class="hljs-number">2</span>)&#123; <span class="hljs-comment">// base case k ==</span><br>        <span class="hljs-type">int</span> i = start; <span class="hljs-type">int</span> j = n - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span>(i &lt; j)&#123;<br>            <span class="hljs-type">int</span> left = nums[i]; <span class="hljs-type">int</span> right = nums[j];<br>            <span class="hljs-type">int</span> sum = left + right;<br>            <span class="hljs-keyword">if</span>(sum == target)&#123;<br>                res.<span class="hljs-built_in">push</span>(&#123;left, right&#125;);<br>                <span class="hljs-keyword">while</span>(i &lt; j &amp;&amp; nums[i] == left) i++;<br>                <span class="hljs-keyword">while</span>(i &lt; j &amp;&amp; nums[j] == right) j--;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(sum &gt; target)&#123;<br>                <span class="hljs-keyword">while</span>(i &lt; j &amp;&amp; nums[j] == right) j--;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">while</span>(i &lt; j &amp;&amp; nums[i] == left) i++;<br>            &#125;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// other case k &gt; 2</span><br>        <span class="hljs-type">int</span> i = start;<br>        <span class="hljs-keyword">while</span>(i &lt; n)&#123;<br>            <span class="hljs-type">int</span> val = nums[i];<br>            <span class="hljs-type">int</span> sub_target = target - val;<br>            vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; sub_res = <span class="hljs-built_in">nSum</span>(nums, i+<span class="hljs-number">1</span>, k<span class="hljs-number">-1</span>, sub_target);<br>            <span class="hljs-keyword">for</span>(vector&lt;<span class="hljs-type">int</span>&gt; sub_res_i : sub_res)&#123;<br>                sub_res_i.<span class="hljs-built_in">push_back</span>(val);<br>                res.<span class="hljs-built_in">push_back</span>(sub_res_i);<br>            &#125;<br>            <span class="hljs-keyword">while</span>(i &lt; n &amp;&amp; nums[i] == val) i++;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åŒºé—´é—®é¢˜">åŒºé—´é—®é¢˜</h2><blockquote><p>åŒºé—´é—®é¢˜å°±æ˜¯ç»™å®šä¸€äº›åŒºé—´ï¼Œç„¶åéœ€è¦æ±‚è§£è¿™äº›åŒºé—´çš„äº¤é›†ã€æˆ–è€…åˆå¹¶åŒºé—´ç­‰é—®é¢˜</p></blockquote><p>è§£å†³è¿™ç±»é—®é¢˜æœ€æ ¸å¿ƒçš„æ€æƒ³å°±æ˜¯==æ’åº==+==è®¨è®º==ã€‚</p><p>é’ˆå¯¹ä¸åŒçš„é—®é¢˜ï¼Œéœ€è¦è¿›è¡Œä¸åŒçš„æ’åºï¼Œå¯èƒ½æ˜¯å¯¹èµ·ç‚¹æ’åºï¼Œä¹Ÿå¯èƒ½æ˜¯å¯¹ç»ˆç‚¹æ’åºï¼Œæœ‰å¯èƒ½æ˜¯å‡åºï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯é™åºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; a, vector&lt;<span class="hljs-type">int</span>&gt;&amp; b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(a[<span class="hljs-number">0</span>] != b[<span class="hljs-number">0</span>]) <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>] &lt; b[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> a[<span class="hljs-number">1</span>] &gt; b[<span class="hljs-number">1</span>];<br>&#125;<br><br><span class="hljs-comment">// å¯¹numsè¿›è¡Œæ’åºï¼Œå·¦ç«¯ç‚¹å‡åºæ’åˆ—ï¼Œå·¦ç«¯ç‚¹ç›¸åŒå³ç«¯ç‚¹é™åºæ’åˆ—</span><br><span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>(), cmp);<br></code></pre></td></tr></table></figure><blockquote><p>é¢˜ç›®åˆ—è¡¨ï¼š</p><p><ahref="https://leetcode.cn/problems/minimum-number-of-arrows-to-burst-balloons/">452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</a></p><p><ahref="https://leetcode.cn/problems/non-overlapping-intervals/">435.æ— é‡å åŒºé—´</a></p><p><ahref="https://leetcode.cn/problems/remove-covered-intervals/">1288.åˆ é™¤è¢«è¦†ç›–åŒºé—´</a></p><p><a href="https://leetcode.cn/problems/merge-intervals/">56.åˆå¹¶åŒºé—´</a></p><p><ahref="https://leetcode.cn/problems/interval-list-intersections/">986.åŒºé—´åˆ—è¡¨çš„äº¤é›†</a></p></blockquote><blockquote><p><a href="https://leetcode.cn/problems/video-stitching/">1024.è§†é¢‘æ‹¼æ¥</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230105224256015.png" /></p></blockquote><p>ä¸€é“åˆ«è‡´çš„åŒºé—´é—®é¢˜ï¼è¿™é“é¢˜åœ¨å¯¹åŒºé—´è¿›è¡Œæ’åºä¹‹åçš„æ“ä½œæ›´ä¸ºå¤æ‚ä¸€äº›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">videoStitching</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; clips, <span class="hljs-type">int</span> time)</span> </span>&#123;<br>    <span class="hljs-built_in">sort</span>(clips.<span class="hljs-built_in">begin</span>(), clips.<span class="hljs-built_in">end</span>(), cmp);<br>    <br>    <span class="hljs-comment">// ç”±äºæ˜¯éœ€è¦æ‰¾å‡ºæœ€å°‘ï¼Œæ‰€ä»¥å°±éœ€è¦æŒ‘é€‰å‡ºæœ€åˆé€‚çš„ç‰‡æ®µ</span><br>    <span class="hljs-type">int</span> n = clips.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> end = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(i &lt; n)&#123;<br>        <span class="hljs-type">int</span> max = <span class="hljs-number">-1</span>;<br>        <span class="hljs-comment">// åœ¨åé¢æœ‰é‡å çš„åŒºé—´ä¸­æ‰¾åˆ°ç»ˆç‚¹æœ€å¤§çš„é‚£ä¸ªåŒºé—´</span><br>        <span class="hljs-keyword">while</span>(i &lt; n &amp;&amp; clips[i][<span class="hljs-number">0</span>] &lt;= end)&#123;<br>            <span class="hljs-keyword">if</span> (clips[i][<span class="hljs-number">1</span>] &gt; max) max = clips[i][<span class="hljs-number">1</span>];<br>            i++;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(max == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>; <span class="hljs-comment">// ä¸­é—´æœ‰æ–­å¼€æˆ–è€…ç‰‡æ®µç”¨å®Œäº†ä½†æ˜¯æ²¡åˆ°time</span><br>        end = max;<br>        cnt ++;<br>        <span class="hljs-keyword">if</span> (end &gt;= time) <span class="hljs-keyword">return</span> cnt;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å¿«é€Ÿé€‰æ‹©ç®—æ³•">å¿«é€Ÿé€‰æ‹©ç®—æ³•</h2><blockquote><p><ahref="https://leetcode.cn/problems/kth-largest-element-in-an-array/">215.æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221127115141557.png" /></p></blockquote><h3 id="å¿«é€Ÿæ’åºç®—æ³•">å¿«é€Ÿæ’åºç®—æ³•</h3><p>å¿«æ’ï¼ˆquick-sortï¼‰æ˜¯ä¸€ç§ç»å…¸çš„æ’åºç®—æ³•ï¼Œå’Œå½’å¹¶æ’åºï¼ˆmerge-sortï¼‰ä¸€æ ·éƒ½æ˜¯divide-and-conquer ç±»å‹çš„ç®—æ³•ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º <spanclass="math inline">\(O(NlogN)\)</span></p><p>ã€æ€è·¯ã€‘</p><p>å¿«æ’çš„æ€è·¯æ˜¯ï¼Œè¦å¯¹<code>nums[lo...hi]</code>æ’åºï¼Œå…ˆæ‰¾åˆ°ä¸€ä¸ªåˆ†ç•Œç‚¹<code>pivot</code>ï¼Œç„¶åä½¿å¾—<code>nums[lo...pivot-1]</code>éƒ½å°äº<code>nums[pivot]</code>ï¼Œ<code>nums[pivot+1...hi]</code>éƒ½å¤§äº<code>nums[pivot]</code>ï¼Œç„¶åé€’å½’åœ°åœ¨<code>nums[lo...pivot-1]</code>å’Œ<code>nums[pivot+1...hi]</code>ä¸Šæ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚</p><p>ã€å®ç°è¿‡ç¨‹ã€‘</p><p>é¦–å…ˆå¯ä»¥è½»æ˜“å†™å‡ºä¸‹é¢ä¸¤ä¸ªå‡½æ•°ï¼Œæœ€ä¸»è¦çš„éš¾ç‚¹æ˜¯å®ç°<code>partition</code>å‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span></span>&#123;<br>    <span class="hljs-built_in">quick_sort_helper</span>(nums, <span class="hljs-number">0</span>, nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">quick_sort_helper</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(i &gt;= j) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-type">int</span> pivot = <span class="hljs-built_in">partition</span>(nums, i, j);<br>    <span class="hljs-built_in">quick_sort_helper</span>(nums, i, pivot<span class="hljs-number">-1</span>);<br>    <span class="hljs-built_in">quick_sort_helper</span>(nums, pivot+<span class="hljs-number">1</span>, j);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>partition</code>å‡½æ•°æ‰€åšçš„å·¥ä½œå°±æ˜¯ï¼Œå¯¹ä¸€ä¸ªæ•°ç»„<code>nums[lo...hi]</code>ï¼Œè¿”å›ä¸€ä¸ªä¸‹æ ‡<code>pivot</code>ï¼Œä½¿å¾—æ•°ç»„<code>nums[lo...pivot-1]</code>éƒ¨åˆ†çš„å…ƒç´ å…¨éƒ¨éƒ½å°äº<code>nums[pivot]</code>ï¼Œæ•°ç»„<code>nums[pivot+1...hi]</code>éƒ¨åˆ†çš„å…ƒç´ å…¨éƒ¨éƒ½å¤§äº<code>nums[pivot]</code>ã€‚</p><blockquote><ol type="1"><li>é¦–å…ˆä»»æ„é€‰å–ä¸€ä¸ªå€¼ä½œä¸ºpivotï¼Œæ¯”å¦‚é€‰æ‹©æœ€åä¸€ä¸ªå…ƒç´ `</li><li><code>smaller_idx</code>å˜é‡æ˜¯ç”¨æ¥è®°å½•æ‰€æœ‰<code>&lt;=nums[pivot]</code>çš„å…ƒç´ çš„ä¸‹æ ‡</li><li>éå†æ•°ç»„ï¼Œå½“é‡åˆ°<code>&lt;=nums[pivot]</code>çš„å…ƒç´ æ—¶ï¼Œå°±è¦æŠŠå®ƒæ”¾åœ¨<code>smaller_idx</code>æŒ‡å®šçš„ä½ç½®ä¸Šï¼ˆforå¾ªç¯ä¸­ifå—ä¸­çš„å†…å®¹ï¼‰</li></ol></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">partition</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> lo, <span class="hljs-type">int</span> hi)</span></span>&#123;<br>    <span class="hljs-type">int</span> pivot = nums[hi];<br>    <span class="hljs-type">int</span> smaller_idx = lo<span class="hljs-number">-1</span>; <span class="hljs-comment">// æ ‡è®°&lt;=nums[pivot]å…ƒç´ çš„ä¸‹æ ‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = lo; i &lt;= hi; i++)&#123;<br>        <span class="hljs-keyword">if</span>(nums[i] &lt;= pivot)&#123;<br>            smaller_idx ++;<br>            <span class="hljs-built_in">swap</span>(nums, smaller_idx, i);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> smaller_idx;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span></span>&#123;<br>    <span class="hljs-type">int</span> tmp = nums[i];<br>    nums[i] = nums[j];<br>    nums[j] = tmp;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><ahref="https://www.geeksforgeeks.org/quick-sort/">quick-sort</a></p></blockquote><p>ä¸Šé¢çš„<code>partition</code>å‡½æ•°è¿”å›çš„<code>pivot</code>å…¶å®å°±æ˜¯æ•°ç»„çš„ç¬¬<code>pivot</code>å¤§å…ƒç´ ï¼Œè€Œé—®é¢˜éœ€è¦çš„æ˜¯ç¬¬<code>k</code>å¤§å…ƒç´ ï¼Œæ‰€ä»¥å¯ä»¥å€Ÿç”¨ã€äºŒåˆ†æœç´¢ã€‘æ€æƒ³è¿›è¡Œæ±‚è§£ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-type">int</span> lo = <span class="hljs-number">0</span>; <span class="hljs-type">int</span> hi = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> idx = nums.<span class="hljs-built_in">size</span>() - k;<br>    <span class="hljs-keyword">while</span>(lo &lt;= hi)&#123;<br>        <span class="hljs-type">int</span> pi = <span class="hljs-built_in">partition</span>(nums, lo, hi);<br>        <span class="hljs-keyword">if</span>(idx &gt; pi)&#123;<br>            lo = pi+<span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (idx &lt; pi)&#123;<br>            hi = pi<span class="hljs-number">-1</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> nums[pi];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äºŒå‰å †">äºŒå‰å †</h3><p>è¿™é“é¢˜æœ€ç®€å•çš„è¿˜æ˜¯é‡‡ç”¨äºŒå‰å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰çš„è§£æ³•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findKthLargest</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, std::greater&lt;<span class="hljs-type">int</span>&gt;&gt; pq; <span class="hljs-comment">// é‡‡ç”¨å°é¡¶å †</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : nums)&#123;<br>        pq.<span class="hljs-built_in">push</span>(i);<br>        <span class="hljs-keyword">if</span>(pq.<span class="hljs-built_in">size</span>() &gt; k)&#123;<br>            pq.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> pq.<span class="hljs-built_in">top</span>();<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><font color='red'><code>priority_queue</code>æ•°æ®ç»“æ„è‡ªå®šä¹‰æ¯”è¾ƒå¦‚ä½•ä¹¦å†™ï¼Ÿ</font></p><p>1ã€é¦–å…ˆä¼˜å…ˆé˜Ÿåˆ—é»˜è®¤æƒ…å†µä¸‹æ˜¯ä½¿ç”¨lessæ¯”è¾ƒï¼Œå³å¤§é¡¶å †ï¼ˆæœ€å¤§å…ƒç´ ä½œä¸ºå †é¡¶å‡ºç°ï¼‰ã€‚å¦‚æœæƒ³è¦æ”¹æˆå°é¡¶å †ï¼Œéœ€è¦ä½¿ç”¨greateræ¯”è¾ƒã€‚</p><p>2ã€å¦‚æœè¦è‡ªå®šä¹‰ä¼˜å…ˆé˜Ÿåˆ—çš„æ¯”è¾ƒï¼Œå¯ä»¥åœ¨ä¸€ä¸ª<strong>ç»“æ„ä½“</strong>é‡Œ==é‡è½½()è¿ç®—ç¬¦==</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">cmp</span>&#123;<br>  <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; a, vector&lt;<span class="hljs-type">int</span>&gt;&amp; b)</span></span>&#123;<br>      <span class="hljs-comment">// ...</span><br>  &#125;  <br>&#125;;<br></code></pre></td></tr></table></figure><p>3ã€æˆ–è€…å¯ä»¥é‡è½½å¤åˆæ•°æ®ç±»å‹çš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆæ”¹å˜åŸæœ¬lesså’Œgreaterä¸­æ¯”è¾ƒè¿ç®—ç¬¦çš„å«ä¹‰ï¼‰</p><p><font color='red'>sortå‡½æ•°ä¸­çš„è‡ªå®šä¹‰æ¯”è¾ƒåº”è¯¥å¦‚ä½•ä¹¦å†™ï¼Ÿ</font></p><p>1ã€é»˜è®¤æƒ…å†µä¸‹æŒ‰ç…§å‡åºå¯¹å®¹å™¨å†…å…ƒç´ è¿›è¡Œæ’åºã€‚</p><p>2ã€ä¸€èˆ¬æƒ…å†µä¸‹åªè¦é‡å†™ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ä¼ å…¥sortå‡½æ•°å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; a, vector&lt;<span class="hljs-type">int</span>&gt;&amp; b)</span></span>&#123;<br>    <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-built_in">sort</span>(container.<span class="hljs-built_in">begin</span>(), container.<span class="hljs-built_in">end</span>(), cmp); <span class="hljs-comment">// container æ˜¯ vector&lt;vector&lt;int&gt;&gt;</span><br></code></pre></td></tr></table></figure><p><strong>ä½†æ˜¯å¦‚æœè¦åœ¨ç±»ä¸­ä½¿ç”¨ï¼Œè‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°ä¸€å®šå¾—æ˜¯é™æ€æˆå‘˜å‡½æ•°æˆ–è€…å…¨å±€å‡½æ•°</strong></p><p>å› ä¸º<code>std::sort</code>å‡½æ•°æ˜¯å…¨å±€çš„ï¼Œä¸èƒ½ä¾èµ–äºåªæœ‰åˆ›å»ºå®ä¾‹åæ‰èƒ½ä½¿ç”¨çš„æ™®é€šæˆå‘˜å‡½æ•°</p></blockquote><h2 id="è¿ç®—ä¼˜å…ˆçº§åˆ†æ²»ç®—æ³•">è¿ç®—ä¼˜å…ˆçº§ï¼šåˆ†æ²»ç®—æ³•</h2><blockquote><p><ahref="https://leetcode.cn/problems/different-ways-to-add-parentheses/">241.ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230104002637818.png" /></p></blockquote><p>ä½¿ç”¨é€’å½’æ€æƒ³è§£å†³é—®é¢˜ï¼Œä¸€å®šè¦ä»æ•´ä½“å‡ºå‘è€ƒè™‘é—®é¢˜çš„ç»“æ„ï¼Œè€Œä¸èƒ½å±€é™äºæŸä¸ªç»†èŠ‚ã€‚å°†å¤§é—®é¢˜ä¸æ–­åˆ†è§£æˆè§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œå½“è§„æ¨¡å°åˆ°ä¸€å®šç¨‹åº¦æ—¶å°±å¯ä»¥è½»æ˜“æ±‚è§£ï¼Œç„¶åå†å°†å°è§„æ¨¡é—®é¢˜çš„ç­”æ¡ˆåˆå¹¶ï¼Œå¾—åˆ°æœ€ç»ˆé—®é¢˜çš„ç»“æœï¼Œè¿™å°±æ˜¯åˆ†æ²»çš„æ€æƒ³ã€‚</p><p>è¿™é“é¢˜ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç»™å®šä¸€ä¸ªè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œè¦æ±‚å‡ºè¯¥è¡¨è¾¾å¼æ‰€æœ‰å¯èƒ½çš„ç»“æœã€‚æ— è®ºå¦‚ä½•æ”¹å˜è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼Œæˆ–è€…è¯´å¢åŠ æ‹¬å·ï¼Œæœ¬è´¨ä¸Šè¡¨è¾¾å¼çš„è®¡ç®—éƒ½å¯ä»¥å›åˆ°ã€æ“ä½œæ•°1æ“ä½œç¬¦æ“ä½œæ•°2ã€‘è¿™ç§å½¢å¼ä¸Šï¼Œåªæ˜¯è¿™ä¸ªæ“ä½œæ•°å¯ä»¥åˆæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä»¥æ­¤æ¥å¢åŠ å¤æ‚åº¦ã€‚</p><p>å¦‚ä½•åˆ†è§£å¤æ‚åº¦å‘¢ï¼Ÿå¯ä»¥é€‰å®šä¸€ä¸ªæ“ä½œç¬¦ï¼Œç„¶åé€’å½’å¤„ç†ä¸¤è¾¹çš„è¡¨è¾¾å¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">diffWaysToCompute</span><span class="hljs-params">(string expression)</span> </span>&#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; res;<br>    <span class="hljs-type">int</span> n = expression.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-type">char</span> c = expression[i];<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;+&#x27;</span> || c == <span class="hljs-string">&#x27;-&#x27;</span> || c == <span class="hljs-string">&#x27;*&#x27;</span>)&#123;<br>            vector&lt;<span class="hljs-type">int</span>&gt; left = <span class="hljs-built_in">diffWaysToCompute</span>(expression.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, i));<br>            vector&lt;<span class="hljs-type">int</span>&gt; right = <span class="hljs-built_in">diffWaysToCompute</span>(expression.<span class="hljs-built_in">substr</span>(i+<span class="hljs-number">1</span>, n - i));<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> op1 : left)&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> op2 : right)&#123;<br>                    <span class="hljs-keyword">switch</span>(c)&#123;<br>                        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;+&#x27;</span>: res.<span class="hljs-built_in">push_back</span>(op1+op2); <span class="hljs-keyword">break</span>;<br>                        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;-&#x27;</span>: res.<span class="hljs-built_in">push_back</span>(op1-op2); <span class="hljs-keyword">break</span>;<br>                        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;*&#x27;</span>: res.<span class="hljs-built_in">push_back</span>(op1*op2); <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (res.<span class="hljs-built_in">empty</span>())&#123;<br>        <span class="hljs-type">int</span> val = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++)&#123;<br>            val = <span class="hljs-number">10</span> * val + expression[i] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>        &#125;<br>        res.<span class="hljs-built_in">push_back</span>(val);<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è´ªå¿ƒç®—æ³•">è´ªå¿ƒç®—æ³•</h2><h3 id="åŠ æ²¹ç«™">åŠ æ²¹ç«™</h3><blockquote><p><a href="https://leetcode.cn/problems/gas-station/">134.åŠ æ²¹ç«™</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230105224152317.png" /></p></blockquote><p>çœ‹åˆ°é—®é¢˜çš„ä¸€ä¸ªååº”å°±æ˜¯æŠŠä¸¤ä¸ªæ•°ç»„å˜æˆä¸€ä¸ªæ•°ç»„<code>diff</code>ï¼Œ<code>diff[i]</code>è¡¨ç¤ºåœ¨<code>i</code>åŠ æ²¹ç«™åŠ å®Œæ²¹å¼€åˆ°<code>i+1</code>åŠ æ²¹ç«™çš„æ²¹é‡å˜åŒ–ã€‚é‚£ä¹ˆè¦æ‰¾åˆ°é‚£ä¸ªç‚¹ï¼Œåº”è¯¥å°½å¯èƒ½çš„è®©è½¦åœ¨åˆšå¼€å§‹ä¸€æ®µæ—¶é—´æ²¹é‡å°½å¯èƒ½å¤šï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æœ€åå¯ä»¥èµ°å®Œä¸€åœˆã€‚å¯ä»¥å°†<code>diff</code>çš„å€¼æ ‡åœ¨å›¾ä¸Šï¼Œè¿èµ·æ¥ä¹‹åæœ€ä½ç‚¹çš„ä¸‹ä¸€ä¸ªç‚¹å°±åº”è¯¥æ˜¯å‡ºå‘çš„ä½ç½®</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">canCompleteCircuit</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; gas, vector&lt;<span class="hljs-type">int</span>&gt;&amp; cost)</span> </span>&#123;<br>    <span class="hljs-type">int</span> n = gas.<span class="hljs-built_in">size</span>();<br>    vector&lt;<span class="hljs-type">int</span>&gt; diff; <span class="hljs-comment">// ä»iåŠ å®Œæ²¹å¼€åˆ°i+1å‰©ä¸‹çš„æ²¹é‡</span><br>    <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-type">int</span> onediff = gas[i] - cost[i];<br>        diff.<span class="hljs-built_in">push_back</span>(onediff);<br>        sum += onediff;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (sum &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-type">int</span> total = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>; <span class="hljs-type">int</span> min = <span class="hljs-number">10000</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++)&#123;<br>        total += diff[i];<br>        <span class="hljs-keyword">if</span> (total &lt; min)&#123;<br>            min = total;<br>            res = i;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> (res+<span class="hljs-number">1</span>)%n;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¢ä¸€ä¸ªæ€è·¯ï¼Œè¿™é“é¢˜æ›´ä¸ºæ™®éçš„æƒ³æ³•åº”è¯¥æ˜¯ç”¨ä¸€ä¸ªåŒé‡å¾ªç¯å»æšä¸¾æ‰€æœ‰çš„æƒ…å†µã€‚å¯ä»¥å¢åŠ ä¸€ä¸ª<code>trick</code>ï¼š<strong>å½“å‘ç°ä»<code>i</code>å¼€åˆ°<code>j</code>ä¸èƒ½åˆ°è¾¾æ—¶ï¼Œé‚£ä¹ˆ<code>i</code>åˆ°<code>j</code>ä¸­é—´çš„ä»»ä½•ä¸€ä¸ªç‚¹å‡ºå‘éƒ½è¡Œä¸é€š</strong>ã€‚è¿™æ ·å°±é¿å…äº†å¾ˆå¤šé‡å¤çš„æƒ…å†µï¼Œå¤æ‚åº¦å¯ä»¥è¾¾åˆ°çº¿æ€§ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">canCompleteCircuit</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; gas, vector&lt;<span class="hljs-type">int</span>&gt;&amp; cost)</span></span>&#123;<br>    <span class="hljs-type">int</span> n = gas.<span class="hljs-built_in">size</span>();<br>    vector&lt;<span class="hljs-type">int</span>&gt; diff; <span class="hljs-comment">// ä»iåŠ å®Œæ²¹å¼€åˆ°i+1å‰©ä¸‹çš„æ²¹é‡</span><br>    <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-type">int</span> onediff = gas[i] - cost[i];<br>        diff.<span class="hljs-built_in">push_back</span>(onediff);<br>        sum += onediff;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (sum &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">if</span> (diff[i] &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-type">int</span> j = (i+<span class="hljs-number">1</span>)%n;<br>        <span class="hljs-type">int</span> total = diff[i];<br>        <span class="hljs-keyword">for</span> (; j != i; j = (j+<span class="hljs-number">1</span>)%n)&#123;<br>            total += diff[j];<br>            <span class="hljs-keyword">if</span>(total &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (j == i) <span class="hljs-keyword">return</span> i;<br>        i = (j + n - <span class="hljs-number">1</span>) % n; <span class="hljs-comment">// trick</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†å‰²æ•°ç»„ä¸ºè¿ç»­å­åºåˆ—">åˆ†å‰²æ•°ç»„ä¸ºè¿ç»­å­åºåˆ—</h3><blockquote><p><ahref="https://leetcode.cn/problems/split-array-into-consecutive-subsequences/">659.åˆ†å‰²æ•°ç»„ä¸ºè¿ç»­å­åºåˆ—</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230110180018694.png" /></p></blockquote><p>è´ªå¿ƒç®—æ³•ï¼šè¦æƒ³æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œ<strong>åº”è¯¥ä½¿å¾—æ¯ä¸ªå­åºåˆ—å°½å¯èƒ½åœ°é•¿ï¼Œå³å°½å¯èƒ½ä¸è¦å»ºé€ æ–°çš„å­åºåˆ—</strong>ã€‚</p><p>æ‰€ä»¥å½“éå†åˆ°<code>nums</code>ä¸­<code>x</code>æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ä»¥<code>x-1</code>ç»“å°¾çš„å­åºåˆ—ï¼Œå¦‚æœæœ‰ï¼šå°†<code>x</code>åŠ åœ¨å­åºåˆ—çš„åé¢ï¼›å¦‚æœæ²¡æœ‰ï¼šçœ‹<code>x+1</code>å’Œ<code>x+2</code>è¿™ä¸¤ä¸ªæ•°å­—æ˜¯å¦è¿˜æœ‰ï¼Œå¦‚æœè¿˜æœ‰ï¼Œåˆ™å»ºé€ ä¸€ä¸ªä»¥<code>x+2</code>ç»“å°¾çš„å­åºåˆ—ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isPossible</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; cnt; <span class="hljs-comment">// å­˜å‚¨numsä¸­æ¯ä¸ªæ•°å­—çš„ä¸ªæ•°</span><br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; endx; <span class="hljs-comment">// å­˜å‚¨ä»¥xç»“å°¾çš„å­åºåˆ—çš„ä¸ªæ•°</span><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) cnt[num] ++;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x : nums) &#123;<br>        <span class="hljs-keyword">if</span> (cnt[x] &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// è¯¥æ•°å­—è¿˜æœ‰</span><br>            <span class="hljs-keyword">if</span> (endx[x<span class="hljs-number">-1</span>] &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// å­˜åœ¨ä»¥x-1ç»“å°¾çš„å­åºåˆ—</span><br>                endx[x<span class="hljs-number">-1</span>] --;<br>                endx[x] ++;<br>                cnt[x] --;<br>            &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// ä¸å­˜åœ¨ä»¥x-1ç»“å°¾çš„å­åºåˆ—</span><br>                <span class="hljs-keyword">if</span> (cnt[x+<span class="hljs-number">1</span>] &gt; <span class="hljs-number">0</span> &amp;&amp; cnt[x+<span class="hljs-number">2</span>] &gt; <span class="hljs-number">0</span>) &#123;<br>                    endx[x+<span class="hljs-number">2</span>]++;<br>                    cnt[x]--; cnt[x+<span class="hljs-number">1</span>]--; cnt[x+<span class="hljs-number">2</span>]--;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è®¡ç®—å™¨">è®¡ç®—å™¨</h2><blockquote><p><a href="https://leetcode.cn/problems/basic-calculator/">224.åŸºæœ¬è®¡ç®—å™¨</a></p><p><a href="https://leetcode.cn/problems/basic-calculator-ii/">227.åŸºæœ¬è®¡ç®—å™¨ II</a></p></blockquote><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«æ•°å­—ã€å››åˆ™è¿ç®—ç¬¦ã€æ‹¬å·ä»¥åŠç©ºæ ¼ï¼Œè¦æ±‚è®¡ç®—è¯¥è¡¨è¾¾å¼çš„å€¼</p><p>å¯ä»¥å°†è¿™ä¸ªé—®é¢˜è¿›è¡Œåˆ†è§£ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•å°†å­—ç¬¦ä¸²ä¸­çš„æ•°æå–å‡ºæ¥ã€å¦‚ä½•å¤„ç†å››åˆ™è¿ç®—ä»¥åŠå¦‚ä½•å¤„ç†æ‹¬å·ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">calculate</span><span class="hljs-params">(string s)</span></span>&#123;<br>    stack&lt;<span class="hljs-type">int</span>&gt; stk;<br>    <span class="hljs-type">int</span> n = s.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> val = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> sign = <span class="hljs-string">&#x27;+&#x27;</span>;<br>    <span class="hljs-keyword">while</span>(i &lt; n)&#123;<br>        <span class="hljs-comment">// å¤„ç†å­—ç¬¦ä¸²ä¸­çš„æ•°å­—</span><br>        <span class="hljs-keyword">if</span> (s[i] &gt;= <span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; s[i] &lt;= <span class="hljs-string">&#x27;9&#x27;</span>)&#123;<br>            val = <span class="hljs-number">10</span> * val + (s[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br>        &#125;<br>        <span class="hljs-comment">// å¤„ç†å››åˆ™è¿ç®—</span><br>        <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;+&#x27;</span> || s[i] == <span class="hljs-string">&#x27;-&#x27;</span> || s[i] == <span class="hljs-string">&#x27;*&#x27;</span> || s[i] == <span class="hljs-string">&#x27;/&#x27;</span> || i == n<span class="hljs-number">-1</span>)&#123;<br>            <span class="hljs-keyword">switch</span>(s[i])&#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;+&#x27;</span>: stk.<span class="hljs-built_in">push</span>(val); <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;-&#x27;</span>: stk.<span class="hljs-built_in">push</span>(<span class="hljs-number">-1</span> * val); <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;*&#x27;</span>: val = stk.<span class="hljs-built_in">top</span>() * val; stk.<span class="hljs-built_in">pop</span>(); stk.<span class="hljs-built_in">push</span>(val); <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/&#x27;</span>: val = stk.<span class="hljs-built_in">top</span>() / val; stk.<span class="hljs-built_in">pop</span>(); stk.<span class="hljs-built_in">push</span>(val); <span class="hljs-keyword">break</span>;<br>            &#125;<br>            val = <span class="hljs-number">0</span>;<br>            sign = s[i];<br>        &#125;<br>        <span class="hljs-comment">// å¤„ç†æ‹¬å·</span><br>        <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;(&#x27;</span>)&#123;<br>            <span class="hljs-type">int</span> start = i + <span class="hljs-number">1</span>;<br>            <span class="hljs-type">int</span> cnt = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">while</span>(cnt != <span class="hljs-number">0</span>)&#123;<br>                i ++;<br>                <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;(&#x27;</span>) cnt ++;<br>                <span class="hljs-keyword">if</span> (s[i] == <span class="hljs-string">&#x27;)&#x27;</span>) cnt --;<br>            &#125;<br>            val = <span class="hljs-built_in">calculate</span>(s.<span class="hljs-built_in">substr</span>(start, i - start)); <span class="hljs-comment">// é€’å½’</span><br>        &#125;<br>        <br>        i ++;<br>    &#125;<br>    <br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(!stk.<span class="hljs-built_in">empty</span>())&#123;<br>        res += stk.<span class="hljs-built_in">top</span>();<br>        stk.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®Œç¾çŸ©å½¢">å®Œç¾çŸ©å½¢</h2><blockquote><p><a href="https://leetcode.cn/problems/perfect-rectangle/">391.å®Œç¾çŸ©å½¢</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230111192906031.png" /></p><p><u>ç²¾ç¡®è¦†ç›–</u>çš„æ„æ€æ˜¯ï¼šè¿™äº›å°çŸ©å½¢å¯ä»¥æ°å¥½ç»„æˆä¸€ä¸ªå¤§çŸ©å½¢ï¼Œä¸­é—´ä¸èƒ½æœ‰é‡å ï¼Œä¹Ÿä¸èƒ½æœ‰ç©ºéš™ã€‚</p></blockquote><ul><li>é¦–å…ˆï¼Œå¾ˆæ˜æ˜¾å¯ä»¥ä»<strong>é¢ç§¯</strong>å‡ºå‘ã€‚æ‰¾åˆ°ç»„æˆçš„å¤§çŸ©å½¢çš„é¡¶ç‚¹ï¼Œç®—å‡ºå¤§çŸ©å½¢çš„é¢ç§¯ï¼Œå¦‚æœå°çŸ©å½¢é¢ç§¯ä¹‹å’Œä¸ç­‰äºå¤§çŸ©å½¢é¢ç§¯çš„è¯ï¼Œè‚¯å®šå®ç°ä¸äº†ã€‚</li><li>å…¶æ¬¡ï¼Œå°½ç®¡ç®—å‡ºæ¥é¢ç§¯æ˜¯ç›¸ç­‰çš„ï¼Œä¹Ÿä¸èƒ½ä¿è¯å°±å¯ä»¥æ°å¥½ç»„æˆä¸€ä¸ªå¤§çŸ©å½¢ã€‚å¯ä»¥ä»<strong>é¡¶ç‚¹</strong>å‡ºå‘ï¼Œå¦‚æœå¯ä»¥æ°å¥½å›´æˆä¸€ä¸ªå¤§çŸ©å½¢ï¼Œé‚£ä¹ˆåœ¨æ‰€æœ‰å°çŸ©å½¢çš„é¡¶ç‚¹ä¸­ï¼Œæœ‰ä¸”åªæœ‰4ä¸ªé¡¶ç‚¹åªå‡ºç°ä¸€æ¬¡ï¼ˆå›´æˆå¤§çŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹/è§’ï¼‰ï¼Œå…¶ä»–é¡¶ç‚¹ä¸€å®šåªå‡ºç°2æ¬¡æˆ–è€…4æ¬¡ã€‚</li><li>ç”±ä¸‹å›¾å¯ä»¥çœ‹å‡ºï¼Œ<strong>åªæœ‰å½“æŸä¸ªé¡¶ç‚¹åªå‡ºç°å¥‡æ•°æ¬¡æ‰ä¼šä½œä¸ºå›´æˆå›¾å½¢çš„è§’</strong>ã€‚å¾ˆæ˜æ˜¾ï¼Œè¦æƒ³æ°å¥½å›´æˆå¤§çŸ©å½¢ï¼Œå¿…é¡»æœ‰å…¶åªæœ‰4ä¸ªé¡¶ç‚¹ç¬¦åˆæƒ…å†µä¸€ï¼Œä¸”ä¸èƒ½å‡ºç°æƒ…å†µä¸‰ã€‚</li></ul><blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230111195849264.png" /></p><p>å›¾ç‰‡æ¥æºï¼šã€Šlabuladongç®—æ³•ç§˜ç±ã€‹</p></blockquote><blockquote><p>æ³¨æ„ï¼š</p><ol type="1"><li>æ‰¾åˆ°çš„å¤§çŸ©å½¢é¡¶ç‚¹åªæ˜¯ç†è®ºä¸Šçš„ï¼šå°±æ˜¯è¯´ç»™å®šè¿™äº›çŸ©å½¢ï¼Œæ‰€å¯ä»¥å›´æˆçš„å¤§çŸ©å½¢çš„é¡¶ç‚¹ç†è®ºä¸Šæ˜¯è¿™ä¸ªå€¼ã€‚</li><li>è€ƒè™‘é¡¶ç‚¹çš„æ—¶å€™ï¼Œé™¤äº†åˆ¤æ–­åªæœ‰4ä¸ªé¡¶ç‚¹å‡ºç°1æ¬¡ï¼Œè¿˜éœ€è¦åˆ¤æ–­è¿™4ä¸ªé¡¶ç‚¹æ˜¯å¦å°±æ˜¯ç†è®ºä¸Šçš„é‚£4ä¸ªé¡¶ç‚¹ã€‚</li></ol></blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; p;<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isRectangleCover</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt;&amp; rectangles)</span> </span>&#123;<br>    map&lt;p, <span class="hljs-type">int</span>&gt; points;<br>    <span class="hljs-comment">// å¤§çŸ©å½¢çš„å·¦ä¸‹é¡¶ç‚¹åæ ‡å’Œå³ä¸Šé¡¶ç‚¹åæ ‡</span><br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> X1 = INT_MAX, Y1 = INT_MAX, X2 = INT_MIN, Y2 = INT_MIN;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> areaSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (vector&lt;<span class="hljs-type">int</span>&gt; rectangle : rectangles) &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-type">long</span> x1 = rectangle[<span class="hljs-number">0</span>], y1 = rectangle[<span class="hljs-number">1</span>], x2 = rectangle[<span class="hljs-number">2</span>], y2 = rectangle[<span class="hljs-number">3</span>];<br>        X1 = <span class="hljs-built_in">min</span>(X1, x1);<br>        Y1 = <span class="hljs-built_in">min</span>(Y1, y1);<br>        X2 = <span class="hljs-built_in">max</span>(X2, x2);<br>        Y2 = <span class="hljs-built_in">max</span>(Y2, y2);<br>        areaSum += (x2 - x1) * (y2 - y1);<br>        p p1 = &#123;x1, y1&#125;, p2 = &#123;x1, y2&#125;, p3 = &#123;x2, y1&#125;, p4 = &#123;x2, y2&#125;;<br>        points[p1]++;points[p2]++;points[p3]++;points[p4]++;<br>    &#125; <br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> bigArea = (X2 - X1) * (Y2 - Y1);<br>    <span class="hljs-keyword">if</span> (areaSum != bigArea) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// é¢ç§¯ä¸ç›¸ç­‰ false</span><br>    <span class="hljs-type">int</span> v_cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; p0 : points)&#123;<br>        <span class="hljs-comment">// è®¡ç®—å›¾å½¢ä¸­è§’çš„ä¸ªæ•°</span><br>        <span class="hljs-keyword">if</span> (p0.second % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) v_cnt++;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (v_cnt != <span class="hljs-number">4</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å¦‚æœå›´æˆå¤§çŸ©å½¢ï¼Œåªèƒ½æœ‰4ä¸ªè§’</span><br>    <span class="hljs-comment">// æœ€åè¿˜éœ€è¦åˆ¤æ–­è¿™å››ä¸ªè§’ç¡®å®æ˜¯å¤§çŸ©å½¢çš„å››ä¸ªé¡¶ç‚¹</span><br>    p p1 = &#123;X1, Y1&#125;, p2 = &#123;X1, Y2&#125;, p3 = &#123;X2, Y1&#125;, p4 = &#123;X2, Y2&#125;;<br>    <span class="hljs-keyword">return</span> points[p1]==<span class="hljs-number">1</span> &amp;&amp; points[p2]==<span class="hljs-number">1</span> &amp;&amp; points[p3]==<span class="hljs-number">1</span> &amp;&amp; points[p4]==<span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>map</code>è€Œä¸æ˜¯ä¸€èˆ¬çš„<code>unordered_map</code>ï¼ŒåŸå› æ˜¯åœ¨<code>unordered_map</code>æ˜¯ä½¿ç”¨<code>hash</code>æ¥è®¡ç®—<code>key</code>ï¼Œä½†æ˜¯<code>hash</code>ä¸èƒ½å¤„ç†<code>pair</code>ç±»å‹æ•°æ®ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨<code>unordered_map</code>ä¸­ä½¿ç”¨<code>pair</code>æ•°æ®ç±»å‹ã€‚</p><p><ahref="https://blog.csdn.net/weixin_42989041/article/details/113183015">å‚è€ƒæ–‡ç« </a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°7-æš´åŠ›æœç´¢</title>
      <link href="/2022/11/18/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B07%EF%BC%88%E6%9A%B4%E5%8A%9B%E6%90%9C%E7%B4%A2%EF%BC%89/"/>
      <url>/2022/11/18/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B07%EF%BC%88%E6%9A%B4%E5%8A%9B%E6%90%9C%E7%B4%A2%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="dfså›æº¯ç®—æ³•">DFS/å›æº¯ç®—æ³•</h2><p>å›æº¯çš„æ ¸å¿ƒæ€æƒ³åœ¨äºï¼š</p><ul><li>åšå‡ºé€‰æ‹©</li><li>ï¼ˆDFSé€’å½’ï¼‰</li><li>æ’¤é”€é€‰æ‹©</li></ul><p>ä½†æ˜¯é¢å¯¹ä¸åŒçš„é¢˜ç›®ï¼šåšä»€ä¹ˆé€‰æ‹©ï¼Œåœ¨å“ªåšé€‰æ‹©éƒ½æ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚</p><p>å¤§è‡´çš„æ¡†æ¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">ç»“æœé›† = []<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrace</span>(<span class="hljs-params">è·¯å¾„, é€‰æ‹©åˆ—è¡¨</span>):<br>    <span class="hljs-keyword">if</span> æ»¡è¶³ç»“æŸçš„æ¡ä»¶:<br>        ç»“æœé›†.add(è·¯å¾„)<br>        <span class="hljs-keyword">return</span><br>    <br>    <span class="hljs-keyword">for</span> é€‰æ‹© <span class="hljs-keyword">in</span> é€‰æ‹©åˆ—è¡¨:<br>        åšå‡ºé€‰æ‹©<br>        backtrace(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)<br>        æ’¤é”€é€‰æ‹©<br></code></pre></td></tr></table></figure><h3 id="ä¾‹å­">ä¾‹å­</h3><h4 id="å…¨æ’åˆ—">ã€å…¨æ’åˆ—ã€‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; res;<br><br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">permute</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>    res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <br>    List&lt;Integer&gt; path = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    backtrace(nums, path);<br>&#125;<br><br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, List&lt;Integer&gt; path)</span>&#123;<br>    <span class="hljs-comment">// ç»“æŸæ¡ä»¶</span><br>    <span class="hljs-keyword">if</span>(path.size() == nums.length)&#123;<br>        res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(path));<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length; i++)&#123;<br>        <span class="hljs-keyword">if</span>(path.contains(nums[i])) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// ç­›é™¤ä¸åœ¨é€‰æ‹©åˆ—è¡¨ä¸­çš„å…ƒç´ </span><br>        path.add(nums[i]); <span class="hljs-comment">// åšå‡ºé€‰æ‹©</span><br>        backtrace(nums, path);<br>        path.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(nums[i])); <span class="hljs-comment">// æ’¤é”€x</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="nçš‡å">ã€Nçš‡åã€‘</h4><p>åœ¨ n<span class="math inline">\(\times\)</span>n çš„æ£‹ç›˜ä¸Šæ”¾ç½® nä¸ªçš‡åï¼Œä½¿å¾— n ä¸ªçš‡åä¸èƒ½ç›¸äº’æ”»å‡»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> List&lt;List&lt;String&gt;&gt; <span class="hljs-title function_">solveNQueens</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>    List&lt;Integer&gt; board = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å­é›†åˆ’åˆ†">å­é›†åˆ’åˆ†</h3><p>ç»™å®šä¸€ä¸ªæ•°ç»„<code>nums</code>å’Œä¸€ä¸ªæ­£æ•´æ•°<code>k</code>ï¼Œè¿”å›å…¶æ˜¯å¦èƒ½è¢«åˆ†æˆ<code>k</code>ä¸ªå­é›†ï¼Œä¸”æ¯ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸åŒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-comment">// 1. ä»¥æ•°å­—çš„è§†è§’ï¼šæ¯ä¸€ä¸ªæ•°éƒ½æ˜¯å»kä¸ªæ¡¶ä¸­çš„ä¸€ä¸ªæ¡¶</span><br>    <span class="hljs-comment">// O(k^n)</span><br>    <span class="hljs-comment">// ä¼šè¶…æ—¶!</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartitionKSubsets2</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> k)</span> &#123;<br>        <span class="hljs-comment">// å»æ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µ</span><br>        <span class="hljs-keyword">if</span>(k &gt; nums.length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : nums) sum += i;<br>        <span class="hljs-keyword">if</span>(sum % k != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">sub_sum</span> <span class="hljs-operator">=</span> sum / k;<br>        <span class="hljs-type">int</span>[] buckets = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[k];<br><br>        <br>        <span class="hljs-comment">// ç»™æ•°ç»„æŒ‰é™åºæ’åˆ—ï¼Œä½¿å¾—å›æº¯çš„å‰ªæå°½æ—©å‘ç”Ÿ</span><br>        Arrays.sort(nums);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, j = nums.length - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span>(; i &lt; j; i++, j--)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> nums[i];<br>            nums[i] = nums[j];<br>            nums[j] = tmp;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> backtrace(nums, <span class="hljs-number">0</span>, sub_sum, buckets);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span>[] buckets)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index == nums.length)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; buckets.length; i++)&#123;<br>                <span class="hljs-keyword">if</span>(buckets[i] != target) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; buckets.length; i++)&#123;<br>            <span class="hljs-keyword">if</span>(buckets[i] + nums[index] &gt; target) <span class="hljs-keyword">continue</span>;<br>            buckets[i] += nums[index];<br>            <span class="hljs-comment">// å‘åç»§ç»­èµ°</span><br>            <span class="hljs-keyword">if</span>( backtrace(nums, index + <span class="hljs-number">1</span>, target, buckets) )&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-comment">// åé¢çš„æŸä¸ªæƒ…å†µä¸æ»¡è¶³æ¡ä»¶ï¼Œéœ€è¦å›æº¯</span><br>            buckets[i] -= nums[index];<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    å›æº¯ï¼šä¸èƒ½æ²¡æœ‰å°è¯•å®Œå°±åšå†³å®šï¼Œæ²¡åšä¸€æ¬¡å†³å®šéƒ½è¦å‘åç»§ç»­èµ°ï¼Œåªæœ‰æœ€åèƒ½èµ°é€šï¼Œæ‰ç®—æ˜¯æ­£ç¡®çš„é€‰æ‹©</span><br><span class="hljs-comment">    */</span><br><br>    <span class="hljs-comment">// 2.ä»¥æ¡¶çš„è§†è§’ï¼šæ¯ä¸ªæ¡¶éƒ½è¦éå†æ‰€æœ‰å…ƒç´ </span><br>    <span class="hljs-comment">// O(k*2^n)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartitionKSubsets1</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> k)</span> &#123;<br>        <span class="hljs-comment">// å»æ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µ</span><br>        <span class="hljs-keyword">if</span>(k &gt; nums.length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : nums) sum += i;<br>        <span class="hljs-keyword">if</span>(sum % k != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">sub_sum</span> <span class="hljs-operator">=</span> sum / k;<br>        <span class="hljs-type">int</span>[] buckets = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[k];<br><br>        visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[nums.length];<br><br>        <span class="hljs-keyword">return</span> backtrace(nums, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, buckets, sub_sum);<br>    &#125;<br><br>    <span class="hljs-type">boolean</span>[] visited;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span>[] buckets, <span class="hljs-type">int</span> target)</span>&#123;<br>        <span class="hljs-keyword">if</span>(index == buckets.length)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span>(buckets[index] == target) &#123;<br>            <span class="hljs-keyword">return</span> backtrace(nums, <span class="hljs-number">0</span>, index + <span class="hljs-number">1</span>, buckets, target);<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; nums.length; i++)&#123;<br>            <span class="hljs-keyword">if</span>(visited[i] || buckets[index] + nums[i] &gt; target) <span class="hljs-keyword">continue</span>;<br>            buckets[index] += nums[i];<br>            visited[i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-comment">// å‘åç»§ç»­èµ°</span><br>            <span class="hljs-keyword">if</span>( backtrace(nums, i + <span class="hljs-number">1</span>, index, buckets, target) )&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-comment">// å›æº¯</span><br>            visited[i] = <span class="hljs-literal">false</span>;<br>            buckets[index] -= nums[i];<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>    &#125;<br><br>    <span class="hljs-comment">// 3.çŠ¶æ€æ•°ç»„+é€’å½’</span><br>    <span class="hljs-comment">// é‡ç‚¹ç†è§£ä¸‰ä¸ªç‚¹:</span><br>    <span class="hljs-comment">// 1. ä¸ºä»€ä¹ˆåœ¨åˆšè¿›å…¥dfsæ—¶å°±æŠŠ dp[s]è®¾ä¸ºfalse !!!</span><br>    <span class="hljs-comment">// 2. ä¸ºä»€ä¹ˆ nums[i] + p &gt; per åå°± break è¿”å› fasle</span><br>    <span class="hljs-comment">// 3. ä¸ºä»€ä¹ˆ é€’å½’çš„dfs p = (nums[i] + p) % per</span><br><br>    <span class="hljs-type">int</span>[] nums;<br>    <span class="hljs-type">int</span> per, n;<br>    <span class="hljs-type">boolean</span>[] dp;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartitionKSubsets</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> k)</span> &#123;<br>        <span class="hljs-built_in">this</span>.nums = nums;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">all</span> <span class="hljs-operator">=</span> Arrays.stream(nums).sum();<br>        <span class="hljs-keyword">if</span> (all % k != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        per = all / k;<br>        Arrays.sort(nums);<br>        n = nums.length;<br>        <span class="hljs-keyword">if</span> (nums[n - <span class="hljs-number">1</span>] &gt; per) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br><br>        dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">1</span> &lt;&lt; n];<br>        Arrays.fill(dp, <span class="hljs-literal">true</span>);<br>        <span class="hljs-keyword">return</span> dfs((<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span> s, <span class="hljs-type">int</span> p)</span> &#123;<br>        <span class="hljs-keyword">if</span> (s == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!dp[s]) &#123;<br>            <span class="hljs-keyword">return</span> dp[s];<br>        &#125;<br>        <span class="hljs-comment">// é¿å…é‡å¤æ‰§è¡Œç›¸åŒæƒ…å†µ</span><br>        dp[s] = <span class="hljs-literal">false</span>; <span class="hljs-comment">// dp[s] åˆ°åº•ä»£è¡¨äº†ä»€ä¹ˆ?</span><br>                       <span class="hljs-comment">// sä»£è¡¨çš„æ˜¯è¿˜æœ‰å“ªäº›ä½ç½®çš„å…ƒç´ æ˜¯å¯ç”¨çš„,dp[s]æ˜¯ä»£è¡¨åœ¨è¿™ç§æƒ…å†µä¸‹çš„å¯è¡Œæ€§? ä¸ºä»€ä¹ˆåœ¨ä¸€å¼€å§‹å°±æŠŠè¿™ç§æƒ…å†µä½œä¸ºä¸å¯è¡Œ.</span><br>                       <span class="hljs-comment">// å¦‚æœè¿™ç§æŸç§æƒ…å†µå¯è¡Œçš„è¯,é‚£ä¹ˆæ˜¯ä¸ä¼šå†æ¬¡è¢«ç¢°åˆ°çš„,ä¼šç›´æ¥è¿”å›åˆ°ä¸»å‡½æ•°ä¸­</span><br>                       <span class="hljs-comment">// ç›¸åå¦‚æœè¿™ç§æƒ…å†µè¢«å†æ¬¡ç¢°åˆ°,é‚£ä¹ˆä¸Šä¸€æ¬¡ç¢°åˆ°è¿™ç§æƒ…å†µçš„æ—¶å€™è‚¯å®šæ˜¯ä¸å¯è¡Œ,å³false</span><br>                       <span class="hljs-comment">// ä¸‹ä¸€æ¬¡ç¢°åˆ°çš„æ—¶å€™,å°½ç®¡sæ˜¯ç›¸åŒ,pä¹Ÿç›¸åŒå—? æ˜¯çš„</span><br>                       <span class="hljs-comment">// ä»pæ˜¯å¦‚ä½•è¿­ä»£çš„å¯ä»¥çœ‹å‡º,ç”±äºsæ˜¯ç›¸åŒçš„,æ‰€ä»¥ç”¨æ‰çš„nums[i]æ˜¯ä¸€æ ·çš„,è€Œpæ˜¯ç”¨æ‰çš„nums[i]ç›¸åŠ åæ¨¡perå¾—åˆ°çš„,æ‰€ä»¥å½“sæ˜¯ç›¸åŒçš„æ—¶å€™,pä¹Ÿæ˜¯ç›¸åŒçš„.</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-comment">// å› ä¸ºnumsæ˜¯è¢«æ’åºè¿‡çš„ï¼Œæ‰€æœ‰å‰é¢çš„è¦æ˜¯åŠ èµ·æ¥ &gt; per åé¢è‚¯å®šä¹Ÿä¼š æå‰å‰ªæ</span><br>            <span class="hljs-keyword">if</span> (nums[i] + p &gt; per) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (((s &gt;&gt; i) &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-comment">// (p + nums[i]) % per æ˜¯ä¸ºäº†é‡ç½®å½“å‰çš„å­é›†çš„å€¼</span><br>                <span class="hljs-comment">// å³å½“ p + nums[i] == per åï¼Œé‡ç½®ä¸º0</span><br>                <span class="hljs-keyword">if</span> (dfs(s ^ (<span class="hljs-number">1</span> &lt;&lt; i), (p + nums[i]) % per)) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å›æº¯å¾ˆé‡è¦çš„ä¸€ä¸ªç‚¹ï¼šä¸èƒ½æ²¡æœ‰è€ƒè™‘åé¢æƒ…å†µå°±å®šæ­»äº†å‰é¢çš„é€‰æ‹©ã€‚å›æº¯çš„æœ¬è´¨åœ¨äºå…ˆä¸æ–­åœ°åšå†³å®šï¼Œå¦‚æœæˆåŠŸé‚£ä¹ˆä¹‹å‰çš„é€‰æ‹©å°±æ˜¯æ­£ç¡®çš„å¹¶è¿”å›ï¼Œå¦‚æœå‡ºé”™äº†ï¼Œåœ¨ä¸æ–­åœ°æ’¤å›å†³å®šå¹¶ä¸”é‡æ–°åšå†³å®š</strong></p><h3 id="æ€»ç»“">æ€»ç»“</h3><blockquote><p>æ€»ç»“å›æº¯ç®—æ³•åœ¨å­é›†ã€ç»„åˆå’Œæ’åˆ—ä¸‰ç±»é—®é¢˜ä¸Šçš„å¤„ç†</p></blockquote><p>å¯¹äºå­é›†ã€ç»„åˆå’Œæ’åˆ—è¿™ä¸‰ç±»é—®é¢˜ï¼Œå¯ä»¥æŒ‰ç…§å…ƒç´ æ˜¯æ˜¯å¦å¯é‡ã€æ˜¯å¦å¯å¤é€‰ä¸¤æ–¹é¢æ¥åˆ’åˆ†ã€‚</p><blockquote><p>å­é›†é—®é¢˜å’Œæ’åˆ—é—®é¢˜æœ¬è´¨å…¶å®æ˜¯åŒå±ä¸€ç±»é—®é¢˜ï¼Œéƒ½æ˜¯å¯¹é¡ºåºæ²¡æœ‰è¦æ±‚çš„é€‰å–éƒ¨åˆ†åºåˆ—...æ‰€ä»¥å°±å°†ä»–ä»¬å½’ç±»ä¸ºä¸€ç§é—®é¢˜</p></blockquote><h4 id="é›†åˆç»„åˆé—®é¢˜">1ã€é›†åˆ/ç»„åˆé—®é¢˜</h4><ol type="1"><li>é›†åˆ/ç»„åˆé—®é¢˜æ˜¯ä¸å­˜åœ¨é¡ºåºçš„ï¼Œæ‰€ä»¥æ¯æ¬¡<code>backtrace</code>çš„è¿‡ç¨‹ä¸­ï¼Œä¸èƒ½éƒ½ä»ä¸‹æ ‡0å¼€å§‹é€‰æ‹©å…ƒç´ ï¼Œæ‰€ä»¥æ¯æ¬¡è¿›å…¥<code>backtrace</code>æ—¶éƒ½åº”è¯¥æŒ‡æ˜ä¸‹æ¬¡ä»å“ªå¼€å§‹é€‰ã€‚</li><li>é›†åˆ/ç»„åˆé—®é¢˜çš„è¦æ±‚ä¸»è¦æœ‰ä¸¤ç§ï¼š1ã€é€‰å‡ºæŒ‡å®šå…ƒç´ ä¸ªæ•°çš„ç»„åˆï¼ˆå³åŒ…å«æŒ‡å®šæ•°é‡å…ƒç´ çš„å­é›†ï¼‰2ã€é€‰å‡ºå…ƒç´ å’Œç­‰äºæŒ‡å®šå€¼çš„ç»„åˆ</li></ol><h5 id="å…ƒç´ æ— é‡ä¸å¯å¤é€‰">1.1ã€å…ƒç´ æ— é‡+ä¸å¯å¤é€‰</h5><blockquote><p>å­é›†é—®é¢˜</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; ans;<br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">subsets</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>    ans = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    List&lt;Integer&gt; node = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    backtrace(nums, <span class="hljs-number">0</span>, node);<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> start, List&lt;Integer&gt; node)</span>&#123;<br><span class="hljs-comment">// å¦‚æœè¦è¿”å›æŒ‡å®šæ•°é‡å…ƒç´ çš„å­é›†ï¼Œåœ¨è¿™é‡Œå¾®è°ƒå³å¯</span><br>    ans.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(node));<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; nums.length; i++)&#123;<br>        node.add(nums[i]);<br>        backtrace(nums, i + <span class="hljs-number">1</span>, node);<br>        node.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(nums[i]));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="å…ƒç´ å¯é‡ä¸å¯å¤é€‰">1.2ã€å…ƒç´ å¯é‡+ä¸å¯å¤é€‰</h5><blockquote><p>åŒ…å«é‡å¤å…ƒç´ çš„é›†åˆï¼Œé€‰å‡ºå­é›†</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; ans;<br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">subsets</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>    ans = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    List&lt;Integer&gt; node = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    Arrays.sort(nums);<br>    backtrace(nums, <span class="hljs-number">0</span>, node);<br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> start, List&lt;Integer&gt; node)</span>&#123;<br><br>    ans.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(node));<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; nums.length; i++)&#123;<br>        <span class="hljs-comment">// å‰ªæ å¦‚æœå½“å‰å…ƒç´ å’Œå‰ä¸€ä¸ªç›¸åŒ å°±è·³è¿‡</span><br>        <span class="hljs-keyword">if</span>( i &gt; start &amp;&amp; nums[i] == nums[i - <span class="hljs-number">1</span>] ) <span class="hljs-keyword">continue</span>;<br>        node.add(nums[i]);<br>        backtrace(nums, i + <span class="hljs-number">1</span>, node);<br>        node.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(nums[i]));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="å…ƒç´ æ— é‡å¯é‡å¤é€‰">1.3ã€å…ƒç´ æ— é‡+å¯é‡å¤é€‰</h5><blockquote><p>numsæ•°ç»„ï¼ŒæŒ‡å®š targetï¼Œè¿”å›æ‰€æœ‰æ»¡è¶³ å…ƒç´ å’Œç­‰äº target çš„å­åºåˆ—</p><p>å¯ä»¥é‡å¤ä½¿ç”¨å…ƒç´ </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    List&lt;List&lt;Integer&gt;&gt; res;<br>    <span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">combinationSum</span><span class="hljs-params">(<span class="hljs-type">int</span>[] candidates, <span class="hljs-type">int</span> target)</span> &#123;<br>        res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        List&lt;Integer&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        Arrays.sort(candidates);<br>        backtrace(candidates, <span class="hljs-number">0</span>, one, target, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    nums: å…ƒç´ é›†åˆ</span><br><span class="hljs-comment">    start: å¼€å§‹ä½ç½®</span><br><span class="hljs-comment">    one: å­åºåˆ—</span><br><span class="hljs-comment">    target: ç›®æ ‡å€¼</span><br><span class="hljs-comment">    cur_sum: å½“å‰å…ƒç´ å’Œ</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> start, List&lt;Integer&gt; one, <span class="hljs-type">int</span> target, <span class="hljs-type">int</span> cur_sum)</span>&#123;<br>        <span class="hljs-keyword">if</span>(cur_sum == target)&#123;<br>            res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(one));<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; nums.length; i++)&#123;<br>            <span class="hljs-keyword">if</span>(cur_sum + nums[i] &gt; target) <span class="hljs-keyword">break</span>;<br>            one.add(nums[i]);<br>            <span class="hljs-comment">// ä» i å¼€å§‹å‘åèµ°ï¼Œä¿è¯å¯ä»¥é‡å¤ä½¿ç”¨å…ƒç´ ...</span><br>            backtrace(nums, i, one, target, cur_sum + nums[i]);<br>            one.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(nums[i]));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ’åˆ—é—®é¢˜">2ã€æ’åˆ—é—®é¢˜</h4><p>æ’åˆ—é—®é¢˜ä¸€èˆ¬ä¸å­˜åœ¨å¯¹å­åºåˆ—å…ƒç´ å’Œçš„è¦æ±‚ï¼Œæ‰€ä»¥æ¡†æ¶ä¸Šç•¥æœ‰ä¸åŒ</p><ul><li>å…ƒç´ æ— é‡+ä¸å¯å¤é€‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; res;<br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">solve</span><span class="hljs-params">(...)</span>&#123;<br>    res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    List&lt;Integer&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    backtrace(nums, one);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, List&lt;Integer&gt; one)</span>&#123;<br>    <span class="hljs-comment">// ç»“æŸæ¡ä»¶: åŒ…å«äº†æ‰€æœ‰å…ƒç´ </span><br>    <span class="hljs-keyword">if</span>(one.size() == nums.length)&#123;<br>        res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(one));<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length; i++)&#123;<br>        <span class="hljs-keyword">if</span>( one.contains(nums[i]) ) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// æ’é™¤è¢«é€‰ä¸­çš„å…ƒç´ </span><br>        one.add(nums[i]);<br>        backtrace(nums, one);<br>        one.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(nums[i]));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å…ƒç´ æœ‰é‡+ä¸å¯å¤é€‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// éœ€è¦æ’é™¤ä¸€äº›æƒ…å†µ</span><br>List&lt;List&lt;Integer&gt;&gt; res;<br><span class="hljs-type">boolean</span>[] visited;<br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">solve</span><span class="hljs-params">(...)</span>&#123;<br>    res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    List&lt;Integer&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[nums.length];<br>    backtrace(nums, one);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtrace</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, List&lt;Integer&gt; one)</span>&#123;<br>    <span class="hljs-comment">// ç»“æŸæ¡ä»¶: åŒ…å«äº†æ‰€æœ‰å…ƒç´ </span><br>    <span class="hljs-keyword">if</span>(one.size() == nums.length)&#123;<br>        res.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(one));<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length; i++)&#123;<br>        <span class="hljs-comment">/* å‰ªæ: å½“å‰å…ƒç´ å’Œå‰ä¸€ä¸ªå…ƒç´ ç›¸åŒ ä¸” å‰ä¸€ä¸ªè¿˜æ²¡æœ‰éå†åˆ°çš„è¯ å°±è·³è¿‡</span><br><span class="hljs-comment">        å› ä¸ºè¿™ä¸ªæƒ…å†µåœ¨å‰ä¸€ä¸ªå…ƒç´ éå†æ—¶å·²ç»ç»å†äº†</span><br><span class="hljs-comment">        ä¾‹å¦‚: [1,2,1] éå†ç¬¬ä¸€ä¸ª 1 çš„æ—¶å€™å°±å·²ç» éå†å‡ºäº† [1,1,2] å’Œ [1,2,1] äº†</span><br><span class="hljs-comment">        éå†åˆ°ç¬¬äºŒä¸ª 1 å°±å¯ä»¥è·³è¿‡äº†</span><br><span class="hljs-comment">        */</span><br>        <span class="hljs-keyword">if</span>( i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] == nums[i-<span class="hljs-number">1</span>] &amp;&amp; !visited[i-<span class="hljs-number">1</span>] ) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">if</span>( visited[i] ) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// æ’é™¤è¢«é€‰ä¸­çš„å…ƒç´ </span><br>        visited[i] = <span class="hljs-literal">true</span>;<br>        one.add(nums[i]);<br>        backtrace(nums, one);<br>        visited[i] = <span class="hljs-literal">false</span>;<br>        <span class="hljs-comment">//one.remove(new Integer(nums[i])); // remove(Object o) æ˜¯ç§»é™¤ç¬¬ä¸€ä¸ªå‡ºç°çš„è¿™ä¸ªå…ƒç´ </span><br>        one.remove(one.size() - <span class="hljs-number">1</span>); <span class="hljs-comment">// ä½¿ç”¨ä¸‹æ ‡ç§»é™¤</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å²›å±¿é—®é¢˜">å²›å±¿é—®é¢˜</h3><h4 id="å²›å±¿æ•°é‡">1ã€å²›å±¿æ•°é‡</h4><blockquote><p><ahref="https://leetcode.cn/problems/number-of-islands/submissions/">200.å²›å±¿æ•°é‡ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">numIslands</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] grid)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>        <br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i ++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>                <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-keyword">continue</span>;<br>                dfs(grid, i, j);<br>                cnt++;<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> cnt;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] grid, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>        <span class="hljs-comment">/* è¿™ç§è¶Šç•Œåˆ¤æ–­è·Ÿç®€æ´ */</span><br>        <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">0</span> || i &gt;= m || j &lt; <span class="hljs-number">0</span> || j &gt;= n) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// è¶Šç•Œè¿”å›</span><br>        <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-string">&#x27;0&#x27;</span>) <span class="hljs-keyword">return</span>;<br>        <br>        grid[i][j] = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        <br>        dfs(grid, i - <span class="hljs-number">1</span>, j);<br>        dfs(grid, i + <span class="hljs-number">1</span>, j);<br>        dfs(grid, i, j - <span class="hljs-number">1</span>);<br>        dfs(grid, i, j + <span class="hljs-number">1</span>);<br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="å°é—­å²›å±¿æ•°é‡">2ã€å°é—­å²›å±¿æ•°é‡</h4><blockquote><p>å°é—­å²›å±¿å°±æ˜¯<strong>å®Œå…¨</strong>ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰è¢«æ°´åŒ…å›´çš„é™†åœ°</p></blockquote><p>å…¶å® å°é—­å²›å±¿æ•°é‡ = 200.å²›å±¿æ•°é‡ - é è¾¹å²›å±¿æ•°é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-comment">// æŠŠ200.å²›å±¿æ•°é‡ä¸­æ±‚å‡ºæ¥çš„å²›å±¿æ•°å‡å»é è¾¹çš„å²›å±¿æ•°å°±æ˜¯æœ¬é¢˜ç»“æœ</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">closedIsland</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>        <span class="hljs-comment">// Attention: å¾—å…ˆå°†ä¸Šä¸‹å·¦å³è¾¹ä¸Šçš„å²›å±¿ç»™æ·¹æ‰</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-keyword">if</span>(grid[<span class="hljs-number">0</span>][j] == <span class="hljs-number">0</span>) dfs(grid, <span class="hljs-number">0</span>, j);<br>            <span class="hljs-keyword">if</span>(grid[m-<span class="hljs-number">1</span>][j] == <span class="hljs-number">0</span>) dfs(grid, m-<span class="hljs-number">1</span>, j);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>            <span class="hljs-keyword">if</span>(grid[i][<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>) dfs(grid, i, <span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">if</span>(grid[i][n-<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) dfs(grid, i, n-<span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">// å¦‚æœåœ¨è¿™ä¸ªä¸»å¾ªç¯é‡Œæ’é™¤é è¾¹çš„å²›å±¿çš„è¯ï¼Œä¼šå‡ºç°é”™è¯¯</span><br>        <span class="hljs-comment">// å› ä¸ºå­˜åœ¨éå†æ¬¡åº ä¸­é—´çš„0 è‚¯å®šæ¯” æœ€ä¸‹é¢é‚£æ¡è¾¹çš„0 æ›´æ—©è¢«éå†</span><br>        <span class="hljs-comment">// å¦‚æœä¸­é—´çš„0å’Œä¸‹é¢é‚£æ¡è¾¹çš„0æ˜¯ç›¸è¿é€šçš„ï¼Œè¿™ä¸ªå²›å±¿å°±æ˜¯é è¾¹å²›å±¿</span><br>        <span class="hljs-comment">// ä½†æ˜¯è¿™ä¸ªå²›å±¿ä¼šè¢«ç®—è¿›ç­”æ¡ˆä¸­</span><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">        for(int i = 0; i &lt; m; i ++)&#123;</span><br><span class="hljs-comment">            for(int j = 0; j &lt; n; j ++)&#123;</span><br><span class="hljs-comment">                if(grid[i][j] == 1) continue;</span><br><span class="hljs-comment">                if(i == 0 || i == m - 1 || j == 0 || j == n - 1)&#123;</span><br><span class="hljs-comment">                    dfs(grid, i, j);</span><br><span class="hljs-comment">                &#125; else &#123;</span><br><span class="hljs-comment">                    dfs(grid, i, j);</span><br><span class="hljs-comment">                    cnt++;</span><br><span class="hljs-comment">                &#125;</span><br><span class="hljs-comment">            &#125;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i ++)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j ++)&#123;<br>                <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;<br>                dfs(grid, i, j);<br>                cnt++;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> cnt;<br>    &#125;<br><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>        <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">0</span> || i &gt;= m || j &lt; <span class="hljs-number">0</span> || j &gt;= n) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;<br><br>        grid[i][j] = <span class="hljs-number">1</span>;<br><br>        dfs(grid, i - <span class="hljs-number">1</span>, j);<br>        dfs(grid, i + <span class="hljs-number">1</span>, j);<br>        dfs(grid, i, j - <span class="hljs-number">1</span>);<br>        dfs(grid, i, j + <span class="hljs-number">1</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç»Ÿè®¡å­å²›å±¿">3ã€ç»Ÿè®¡å­å²›å±¿</h4><blockquote><p><a href="https://leetcode.cn/problems/count-sub-islands/">1905.ç»Ÿè®¡å­å²›å±¿ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countSubIslands</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid1, <span class="hljs-type">int</span>[][] grid2)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid1.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid1[<span class="hljs-number">0</span>].length;<br>    <br>    <span class="hljs-comment">// å…ˆæ·¹æ‰grid2ä¸­ä¸æ˜¯å­å²›å±¿çš„éƒ¨åˆ†</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-keyword">if</span>(grid1[i][j] == <span class="hljs-number">0</span> &amp;&amp; grid2[i][j] == <span class="hljs-number">1</span>)&#123;<br>                dfs(grid2, i, j);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// ç»Ÿè®¡å­å²›å±¿</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-keyword">if</span>(grid2[i][j] == <span class="hljs-number">1</span>)&#123;<br>                dfs(grid2, i, j);<br>                cnt++;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>    <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">0</span> || i &gt;= m || j &lt; <span class="hljs-number">0</span> || j &gt;= n) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br><br>    grid[i][j] = <span class="hljs-number">0</span>;<br><br>    dfs(grid, i-<span class="hljs-number">1</span>, j);<br>    dfs(grid, i+<span class="hljs-number">1</span>, j);<br>    dfs(grid, i, j-<span class="hljs-number">1</span>);<br>    dfs(grid, i, j+<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ä¸åŒå²›å±¿çš„æ•°é‡">4ã€ä¸åŒå²›å±¿çš„æ•°é‡</h4><p>ç»Ÿè®¡ä¸åŒå½¢çŠ¶çš„å²›å±¿æ•°é‡</p><p>è¿™å°±è¦æ±‚åœ¨dfséå†çš„è¿‡ç¨‹ä¸­ç”¨æŸç§æ–¹æ³•è®°å½•å²›å±¿çš„å½¢çŠ¶ï¼šåœ¨dfsè¿‡ç¨‹ä¸­ç”¨å­—ç¬¦è¿›è¡Œæ‹¼æ¥å½¢æˆå­—ç¬¦ä¸²</p><p>ç”±äºdfsçš„é¡ºåºæ˜¯ä¸€æ ·çš„ã€å›ºå®šçš„ï¼Œæ‰€ä»¥å¦‚æœå²›å±¿å½¢çŠ¶ç›¸åŒï¼Œå¼€å§‹dfsçš„ä½ç½®è‚¯å®šæ˜¯ä¸€æ ·çš„ï¼Œæœ€åå½¢æˆçš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå†é€šè¿‡HashMapè®°å½•å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">numDistinctIslands</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br><br>    Map&lt;String, Integer&gt; mapping = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i ++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-keyword">if</span>(grid[i][j] == <span class="hljs-number">1</span>)&#123;<br>                <br>                <span class="hljs-type">String</span> <span class="hljs-variable">shape</span> <span class="hljs-operator">=</span> dfs(grid, i, j);<br>                System.out.println(<span class="hljs-string">&quot;(&quot;</span> + i + <span class="hljs-string">&quot;, &quot;</span> + j + <span class="hljs-string">&quot;)&quot;</span> + <span class="hljs-string">&quot;: &quot;</span> + shape);<br>                <br>                <span class="hljs-keyword">if</span> (!mapping.containsKey(shape))&#123;<br>                    mapping.put(shape, <span class="hljs-number">1</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> mapping.size();<br>&#125;<br><br><br><span class="hljs-keyword">private</span> String <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] grid, <span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> grid.length; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;<br>    <span class="hljs-comment">// éé™†åœ°çš„ç»Ÿä¸€ç”¨&#x27;0&#x27;è¡¨ç¤º</span><br>    <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">0</span> || i &gt;= m || j &lt; <span class="hljs-number">0</span> || j &gt;= n) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>;<br>    <span class="hljs-keyword">if</span> (grid[i][j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0&quot;</span>;<br><br>    grid[i][j] = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span>  +  dfs(grid, i - <span class="hljs-number">1</span>, j) +<br>                   dfs(grid, i + <span class="hljs-number">1</span>, j) +<br>                   dfs(grid, i, j - <span class="hljs-number">1</span>) +<br>                   dfs(grid, i, j + <span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="bfsç®—æ³•">BFSç®—æ³•</h2><p>BFSç®—æ³•æ˜¯å¹¿åº¦ä¼˜å…ˆï¼Œéå†è¿‡ç¨‹ä¸­ï¼Œä»å¼€å§‹èŠ‚ç‚¹åˆ°ï¼ˆç¬¬ä¸€æ¬¡åˆ°ï¼‰ä»»ä¸€èŠ‚ç‚¹çš„çš„è·ç¦»éƒ½æ˜¯æœ€å°çš„</p><p>ä¼˜ç‚¹ï¼šBFSç®—æ³•çš„æ™®é€‚æ€§å¼ºï¼Œå¯ä»¥é€‚ç”¨äºæ‰€æœ‰æƒ…å†µ</p><p>ç¼ºç‚¹ï¼šæ•ˆç‡ä½ï¼ŒBFSçš„éå†ç”±ä¸€ä¸ªç‚¹ç­‰è·ç¦»çš„å‘å››å‘¨æ‰©æ•£</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029210656103.png"alt="image-20221029210656103" /><figcaption aria-hidden="true">image-20221029210656103</figcaption></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">bfs</span><span class="hljs-params">(Node root, Node target)</span>&#123;<br>    <span class="hljs-comment">// é˜Ÿåˆ—: BFSéå†å¿…å¤‡</span><br>    Queue&lt;Node&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>    queue.offer(root);<br>    <span class="hljs-comment">// è®°å½•å·²ç»èµ°è¿‡çš„èŠ‚ç‚¹</span><br>    Set&lt;Node&gt; visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br>    visited.add(root);<br>    <br>    <span class="hljs-type">int</span> <span class="hljs-variable">step</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// è®°å½•å·²èµ°çš„æ­¥æ•°</span><br>    <br>    <span class="hljs-keyword">while</span>(!queue.isEmpty())&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> queue.size();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++)&#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> queue.poll();<br>            <br>            <span class="hljs-keyword">if</span>(cur is target) <span class="hljs-keyword">return</span> step;<br>            <br>            <span class="hljs-keyword">for</span>(Node n : graph[n])&#123;<br>                <span class="hljs-keyword">if</span>(!visited.contains(n))&#123;<br>                    queue.offer(n);<br>                    visited.add(n);<br>                &#125;<br>            &#125;<br>        &#125;<br>        step ++;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="dijkstraç®—æ³•">Dijkstraç®—æ³•</h2><p>Dijkstraç®—æ³•å°±æ˜¯åœ¨BFSç®—æ³•ä¸Šçš„ä¸€ä¸ªæ”¹è¿›ï¼Œé’ˆå¯¹æœ‰æƒé‡çš„å›¾ï¼Œä¸»è¦çš„åŒºåˆ«å°±åœ¨äºå­˜æ”¾èŠ‚ç‚¹çš„æ•°æ®ç»“æ„ä»æ™®é€šçš„é˜Ÿåˆ—ï¼ˆQueueï¼‰å˜æˆäº†ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆPriorityQueueï¼‰ï¼Œè€Œä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å°±å¯ä»¥æŒ‰ç…§ä»£ä»·ï¼ˆ<strong>è¿™ä¸ªä»£ä»·æ˜¯ä»å¼€å§‹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„ä»£ä»·</strong>ï¼Œæ‰€ä»¥Dijkstraç®—æ³•æ˜¯å¯ä»¥æ±‚å‡ºå¼€å§‹èŠ‚ç‚¹åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„æœ€å°è·ç¦»çš„ï¼‰å¯¹èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œä½¿å¾—æ¯æ¬¡å–å‡ºçš„èŠ‚ç‚¹éƒ½æ˜¯ä»£ä»·æœ€å°çš„ï¼Œä»è€Œå®ç°ç¬¬ä¸€æ¬¡åˆ°æŸèŠ‚ç‚¹æ—¶çš„ä»£ä»·å°±æ˜¯æœ€å°çš„ã€‚</p><h2 id="greedy-best-first-search">Greedy Best-First Search</h2><p>è¿™ä¸ªç®—æ³•å’ŒDijktraç®—æ³•ç±»ä¼¼ï¼Œä½†æ˜¯è¿™é‡Œæ‰€é€‰å–çš„ä»£ä»·æ˜¯<strong>å½“å‰èŠ‚ç‚¹åˆ°targetèŠ‚ç‚¹çš„ç†è®ºä»£ä»·</strong>ã€‚æ‰€ä»¥è¿™ä¸ªç®—æ³•å¯ä»¥<strong>åŸºæœ¬å¯ä»¥</strong>ååˆ†å¿«é€Ÿæ±‚å‡ºåˆ°è¾¾targetèŠ‚ç‚¹çš„æœ€å°ä»£ä»·ï¼Œç‰¹æ®Šæƒ…å†µå°±æ˜¯å›¾ä¸­å­˜åœ¨éšœç¢ç‰©çš„æƒ…å½¢ï¼Œç”±äºæ‰€ç”¨çš„ä»£ä»·æ˜¯ç†è®ºä¸Šçš„ï¼Œå¹¶ä¸æ˜¯å®é™…æƒ…å†µï¼Œæ‰€ä»¥ä¼šå¯¼è‡´"èµ°é”™è·¯"çš„æƒ…å†µã€‚</p><h2 id="aç®—æ³•">A*ç®—æ³•</h2><blockquote><p><a href="">Introduction to A*</a></p></blockquote><p>A*ç®—æ³•æœ‰æ•ˆåœ°ç»“åˆäº†Dijkstraç®—æ³•å’ŒGreedy Best-FirstSearchç®—æ³•ï¼Œ<strong>ç»¼åˆäº†ä¸¤æ–¹é¢çš„ä»£ä»·</strong>ï¼Œä½¿å¾—æ—¢æ‹¥æœ‰äº†ä¸Šè¿°ä¸¤ä¸ªç®—æ³•çš„ä¼˜åŠ¿ã€‚</p><p>ä»£ç æ¡†æ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Solution&#123;<br><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">AStar</span>&#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">            f: ç»¼åˆä»£ä»· f = g + h</span><br><span class="hljs-comment">            g: å¼€å§‹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„ä»£ä»·</span><br><span class="hljs-comment">            h: å½“å‰èŠ‚ç‚¹åˆ°targetèŠ‚ç‚¹çš„ç†è®ºä»£ä»·</span><br><span class="hljs-comment">        */</span><br>        <span class="hljs-type">int</span> f, g, h; <br>        Node cur; <span class="hljs-comment">// æ ‡è¯†å½“å‰èŠ‚ç‚¹</span><br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">AStar</span><span class="hljs-params">(Node cur, <span class="hljs-type">int</span> g, Node target)</span>&#123;<br>            <span class="hljs-built_in">this</span>.cur = cur;<br>            <span class="hljs-built_in">this</span>.h = getH(cur, target);<br>            <span class="hljs-built_in">this</span>.g = g;<br>            <span class="hljs-built_in">this</span>.f = <span class="hljs-built_in">this</span>.g + <span class="hljs-built_in">this</span>.h;<br>        &#125;<br><br>        <span class="hljs-comment">// è®¡ç®— h å€¼</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getH</span><span class="hljs-params">(Node cur, Node target)</span>&#123;<br><br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">solve</span><span class="hljs-params">(Node start, Node target)</span>&#123;<br>        Queue&lt;AStar&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; &#123;<br>            <span class="hljs-keyword">return</span> a.f - b.f;<br>        &#125;);<br>        queue.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AStar</span>(start, <span class="hljs-number">0</span>, target));<br>        <br>        Set&lt;Node&gt; visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br>        visited.add(start);<br>        <br>        <span class="hljs-keyword">while</span>(!queue.isEmpty())&#123;<br>            <span class="hljs-type">AStar</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>            <br>            <span class="hljs-keyword">for</span>(Node n : graph[node.cur])&#123;<br>                <span class="hljs-keyword">if</span>(!visited.contains(n))&#123;<br>                    <span class="hljs-keyword">if</span>(n == target)&#123;<br>                        <span class="hljs-keyword">return</span> node.g + <span class="hljs-number">1</span>;<br>                    &#125;<br>                    queue.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AStar</span>(n, node.g + <span class="hljs-number">1</span>, target));<br>                    visited(n);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>        <br>    &#125;<br>    <br>    <br>&#125;<br><br><br></code></pre></td></tr></table></figure><h2 id="åº”ç”¨">åº”ç”¨</h2><p>ã€773.æ»‘åŠ¨è°œé¢˜ã€‘</p><blockquote><p><a href="https://leetcode.cn/problems/sliding-puzzle/">773. æ»‘åŠ¨è°œé¢˜- åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p></blockquote><p>å…³é”®åœ¨äºå¦‚ä½•å»ºæ¨¡å½¢æˆ graph ä»¥åŠ node æ˜¯ä»€ä¹ˆ</p><p>åœ¨è¿™é“é¢˜ä¸­ï¼Œå°±å¯ä»¥æŠŠ<span class="math inline">\(2 \times3\)</span>çš„çŸ©é˜µæŠ½è±¡æˆ<code>String</code>ä½œä¸ºèŠ‚ç‚¹ï¼Œè€Œæ¯æ¬¡ç§»åŠ¨ä¹‹åå½¢æˆçš„èŠ‚ç‚¹ä½œä¸ºè¯¥èŠ‚ç‚¹çš„é‚»å±…ï¼Œè¿™æ ·å°±å½¢æˆäº†<code>graph</code></p>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°8-åŠ¨æ€è§„åˆ’</title>
      <link href="/2022/11/17/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B08%EF%BC%88%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%EF%BC%89/"/>
      <url>/2022/11/17/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B08%EF%BC%88%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€æ ¸å¿ƒåŸç†">ä¸€ã€æ ¸å¿ƒåŸç†</h2><blockquote><p>åˆ·è¿‡ä¸€äº›é¢˜åï¼Œæ„Ÿè§‰åŠ¨æ€è§„åˆ’æœ€æ ¸å¿ƒçš„å°±æ˜¯ <strong>dp æ•°ç»„</strong> +<strong>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</strong></p><p>ã€dpæ•°ç»„ã€‘æ˜¯ä¸ºäº†é¿å…é‡å¤è®¡ç®—è€Œå¸¦æ¥çš„é«˜å¤æ‚åº¦</p><p>ã€çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‘æ˜¯ä¸ºäº†å°†é—®é¢˜è¿›è¡Œåˆ†è§£æˆæ›´åŠ ç®€å•çš„å­ç»“æ„</p><p>æ‰€ä»¥åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼š</p><p>1ã€è‡ªåº•å‘ä¸Šï¼ˆè¿­ä»£ï¼‰ï¼šä»æœ€ç®€å­ç»“æ„å¼€å§‹ï¼Œä¸æ–­å‘ä¸Šè®¡ç®—ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å°†å¯¹åº”å­ç»“æ„çš„å€¼å­˜åœ¨dpæ•°ç»„ ä¸­ï¼Œä½¿å¾—æ›´å¤æ‚ç»“æ„çš„é—®é¢˜åœ¨åˆ†è§£åå¯ä»¥ç›´æ¥æ‰¾åˆ°ç­”æ¡ˆã€‚</p><p>2ã€è‡ªé¡¶å‘ä¸‹ï¼ˆé€’å½’ï¼‰ ï¼šä»å½“å‰é—®é¢˜è§„æ¨¡å‡ºå‘ï¼Œé€šè¿‡é€’å½’ä¸æ–­åˆ†è§£é—®é¢˜ç›´è‡³base caseï¼Œè®¡ç®—å‡ºbasecaseåï¼Œå†ä»æœ€æ·±çš„é€’å½’å‡½æ•°å¼€å§‹ä¸æ–­è¿”å›ï¼Œå‘ä¸Šè®¡ç®—ï¼Œæœ€åæ±‚è§£å‡ºé—®é¢˜çš„ç­”æ¡ˆã€‚</p></blockquote><p>è¦å†™å‡ºåŠ¨æ€è§„åˆ’çš„è§£æ³•ï¼Œæœ€é‡è¦çš„å°±æ˜¯å†™å‡º<strong>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</strong>ã€‚æœ‰äº†çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œå°±çŸ¥é“éœ€è¦ä¿å­˜ä»€ä¹ˆå€¼ï¼Œå°±å¯ä»¥æ¨å‡ºdpæ•°ç»„çš„å®šä¹‰ã€‚</p><p>é¦–å…ˆè¦æ˜ç¡®<strong>çŠ¶æ€</strong>ã€‚è¿™ä¸ªçŠ¶æ€æ˜¯ä¼šå½±å“é—®é¢˜è§„æ¨¡çš„é‡ã€‚åœ¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œå¾ˆæ˜æ˜¾é—®é¢˜çš„è§„æ¨¡ä¸»è¦å’Œ<strong>ç‰©å“çš„æ•°é‡</strong> ä»¥åŠ <strong>èƒŒåŒ…çš„å®¹é‡</strong>ç›¸å…³ã€‚å› ä¸ºå¦‚æœè¿™ä¸¤ä¸ªé‡çš„å€¼å¾ˆå°ï¼Œé‚£ä¹ˆé—®é¢˜å°±ä¼šå¾ˆç®€å•ï¼Œåä¹‹å°±ä¼šå¾ˆå¤æ‚ã€‚</p><p>æ˜ç¡®çŠ¶æ€ä¹‹åï¼Œå°±è¦å¯»æ‰¾å¦‚ä½•<strong>è½¬ç§»</strong>ã€‚è½¬ç§»çš„ç›®çš„æ˜¯é™ä½é—®é¢˜çš„è§„æ¨¡ï¼ˆé€šè¿‡æ”¹å˜çŠ¶æ€ï¼‰ã€‚é‚£ä¹ˆåœ¨èƒŒåŒ…é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¦æ±‚è§£çš„æ˜¯åœ¨å½“å‰ç»™å®šæ•°é‡(<span class="math inline">\(N\)</span>)çš„ç‰©å“ å’Œç»™å®šå®¹é‡(<spanclass="math inline">\(W\)</span>)çš„èƒŒåŒ…çš„å‰æä¸‹çš„æŸä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”¨ <spanclass="math inline">\(f(N, W)\)</span>æ¥è¡¨ç¤ºã€‚</p><p>è€Œæˆ‘ä»¬æƒ³è¦æ‰¾å‡ºæ¥çš„æ˜¯ <span class="math inline">\(f(N,W)\)</span>èƒ½å¤Ÿç”¨æŸäº›æ›´å°è§„æ¨¡çš„é—®é¢˜æ¥è¡¨ç¤ºï¼ˆå¯ä»¥ç†è§£ä¸ºæ•°åˆ—ä¸­çš„é€’æ¨å…¬å¼ï¼‰ï¼Œä¾‹å¦‚ <spanclass="math inline">\(f(N,W) = f(N-1,W) + f(N, W-1)\)</span></p><p>æœ€åè¦å»æ‰¾åˆ°<code>base case</code>çš„å€¼ï¼Œä¾‹å¦‚<spanclass="math inline">\(f(0,W)\)</span>æˆ–è€…<spanclass="math inline">\(f(N,0)\)</span>ï¼Œå› ä¸ºæ‰€ä»¥çš„çŠ¶æ€è½¬ç§»éƒ½æ˜¯å»ºç«‹åœ¨<code>base case</code>çš„åŸºç¡€ä¸Šçš„ã€‚</p><h2 id="äºŒç»å…¸åŠ¨æ€è§„åˆ’é—®é¢˜">äºŒã€ç»å…¸åŠ¨æ€è§„åˆ’é—®é¢˜</h2><p>è¿™é‡Œä¸»è¦è®²ä¸¤ç±»é—®é¢˜ï¼Œåˆ†ç±»çš„ä¸»è¦æ˜¯çŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„ç±»å‹ã€‚</p><h3 id="å•å‚æ•°">1ã€å•å‚æ•°</h3><blockquote><p>ã€300.æœ€é•¿é€’å¢å­åºåˆ—ã€‘</p><p>ã€53.æœ€å¤§å­åºå’Œã€‘</p></blockquote><p>å®ƒä»¬çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹éƒ½åªæœ‰ä¸€ä¸ªå‚æ•°ï¼ˆdpæ•°ç»„éƒ½æ˜¯ä¸€ç»´çš„ï¼‰</p><p>ã€300.æœ€é•¿é€’å¢å­åºåˆ—ã€‘ä¸­çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š$f(i) = max(f(i), f(j)+1) $<span class="math inline">\(j = [i+1, ... n-1]\)</span>ï¼Œå…¶ä¸­<spanclass="math inline">\(f(i)\)</span>è¡¨ç¤ºä»¥ç¬¬<spanclass="math inline">\(i\)</span>ä¸ªå…ƒç´ ç»“å°¾çš„æœ€é•¿ä¸¥æ ¼é€’å¢å­åºåˆ—çš„é•¿åº¦ã€‚</p><p>é‚£ä¹ˆæ ¸å¿ƒéƒ¨åˆ†çš„ä»£ç ä¹Ÿå°±å¾ˆå¥½å†™äº†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">mem</span><span class="hljs-params">(n, <span class="hljs-number">1</span>)</span></span>;<br><span class="hljs-type">int</span> res = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i++)&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j ++) &#123;<br>        <span class="hljs-keyword">if</span> (nums[j] &gt;= nums[i]) <span class="hljs-keyword">continue</span>;<br>        mem[i] = <span class="hljs-built_in">max</span>(mem[i], mem[j]+<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">if</span> (res &lt; mem[i]) res = mem[i];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åŒå‚æ•°">2ã€åŒå‚æ•°</h3><blockquote><p>ã€1143.æœ€é•¿å…¬å…±å­åºåˆ—ã€‘</p><p>ã€72.ç¼–è¾‘è·ç¦»ã€‘</p><p>ã€10.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‘</p></blockquote><p>è¿™ä¸€ç±»çš„é—®é¢˜æ¶‰åŠåˆ°ä¸¤ä¸ªçŠ¶æ€ï¼Œä½†æœ¬è´¨ä¸Šè¿˜æ˜¯ç¬¬ä¸€ç±»é—®é¢˜ï¼Œåªæ˜¯ç”±äºå­—ç¬¦ä¸²/æ•°ç»„å˜æˆäº†ä¸¤ä¸ªï¼Œæ‰€ä»¥éœ€è¦ä¸¤ä¸ªå‚æ•°æ¥è®°å½•çŠ¶æ€ã€‚</p><p>ä»¥ã€10.æ­£åˆ™è¡¨è¾¾å¼çŠ¶æ€åŒ¹é…ã€‘ä¸ºä¾‹ã€‚å­˜åœ¨ ä¸€ä¸ªå¾…åŒ¹é…çš„å­—ç¬¦ä¸²<code>str</code> å’Œ ä¸€ä¸ªæ¨¡æ¿ä¸² <code>pattern</code>ï¼Œé‚£ä¹ˆçŠ¶æ€å°±æœ‰ä¸¤ä¸ªï¼š<code>str</code> çš„é•¿åº¦å’Œ <code>pattern</code>çš„é•¿åº¦ï¼Œé‚£è¿™ä¸ªé—®é¢˜çš„è§£å°±å¯ä»¥è¡¨ç¤ºä¸º <span class="math inline">\(f(N,M)\)</span></p><p>ç„¶åå°±è¦è€ƒè™‘å¦‚ä½•è½¬ç§»çŠ¶æ€åŒ–ç®€é—®é¢˜çš„è§£ã€‚æˆ‘ä»¬å…ˆä»»å–ä¸¤ä¸ªå€¼<code>i</code>ï¼Œ<code>j</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºã€åªè€ƒè™‘<code>str</code>çš„å‰<code>i</code>ä¸ªå­—ç¬¦ã€‘ä»¥åŠã€åªè€ƒè™‘<code>pattern</code>çš„å‰<code>j</code>ä¸ªå­—ç¬¦ã€‘ï¼Œè¿™æ ·æˆ‘ä»¬è¦æ±‚è§£çš„å°±æ˜¯<code>f(str.length(), pattern.length())</code>äº†ã€‚</p><p>ç”±äº<spanclass="math inline">\(f(i,j)\)</span>ä¹‹å‰çš„å­é—®é¢˜è‚¯å®šéƒ½å·²ç»è®¡ç®—å¥½äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åªè¦è€ƒè™‘å¦‚ä½•å‡å°<code>i</code>ã€<code>j</code>è¿™ä¸¤ä¸ªå‚æ•°ã€‚ä¸‹é¢å°±æ¶‰åŠåˆ°é—®é¢˜çš„ç»†èŠ‚ï¼Œåœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œåˆ°çŠ¶æ€è½¬ç§»åˆ°<code>i</code>å’Œ<code>j</code>æ—¶ï¼Œè€ƒè™‘patternçš„ç¬¬<code>j</code>ä¸ªå­—ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š<code>'*'</code>å’Œä¸æ˜¯<code>'*'</code>ï¼ŒåŸå› åœ¨äº<code>'*'</code>æ˜¯å¯ä»¥åŒ¹é…å¤šä¸ªçš„ï¼Œæ˜¯å˜åŒ–çš„ã€‚</p><ul><li>å¦‚æœæ˜¯<code>'*'</code>ï¼šå°±è¦çœ‹å‰ä¸€ä¸ªå­—ç¬¦æ˜¯å¦å’Œ<code>str</code>çš„ç¬¬<code>i</code>ä¸ªå­—ç¬¦ã€ç›¸åŒã€‘<ul><li>ä¸ç›¸åŒï¼š<code>dp[i][j]</code>è½¬ç§»åˆ°<code>dp[i][j-2]</code></li><li>ç›¸åŒï¼šå°±è¦é€‰æ‹©æ˜¯å¦è¦å»åŒ¹é…<code>str</code>çš„ç¬¬<code>i</code>ä¸ªå­—ç¬¦<ul><li>ä¸å»åŒ¹é…ï¼š<code>dp[i][j]</code>è½¬ç§»åˆ°<code>dp[i][j-2]</code></li><li>è¦åŒ¹é…ï¼š<code>dp[i][j]</code>è½¬ç§»åˆ°<code>dp[i-1][j]</code></li></ul></li></ul></li><li>å¦‚æœä¸æ˜¯<code>'*'</code>ï¼šå°±çœ‹<code>str</code>çš„ç¬¬<code>i</code>ä¸ªå­—ç¬¦å’Œ<code>pattern</code>çš„ç¬¬<code>j</code>ä¸ªå­—ç¬¦æ˜¯å¦ç›¸åŒ<ul><li>ç›¸åŒï¼š<code>dp[i][j]</code>è½¬ç§»åˆ°<code>dp[i-1][j-1]</code></li><li>ä¸ç›¸åŒï¼š<code>dp[i][j] = false</code></li></ul></li></ul><p>ã€å®Œæ•´ä»£ç ã€‘å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isMatch</span><span class="hljs-params">(String s, String p)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> s.length();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> p.length();<br><br>    <span class="hljs-type">boolean</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n+<span class="hljs-number">1</span>][m+<span class="hljs-number">1</span>];<br>    dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= n; i++)&#123; <span class="hljs-comment">// ä»0å¼€å§‹æ˜¯ä¸ºäº†çœ‹æ˜¯å¦èƒ½å¤ŸåŒ¹é…ç©ºä¸²ï¼›å¡«ä¸Šdpæ•°ç»„çš„æœ€ä¸Šé¢ä¸€è¡Œï¼›å°±æ˜¯ç¡®å®šbase case</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= m; j++)&#123;<br>            <span class="hljs-keyword">if</span>(p.charAt(j - <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;*&#x27;</span>)&#123;<br>                <span class="hljs-comment">// åŒ¹é…0ä¸ª</span><br>                dp[i][j] = dp[i][j-<span class="hljs-number">2</span>];<br>                <span class="hljs-comment">// åŒ¹é…1ä¸ª</span><br>                <span class="hljs-keyword">if</span>(i == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">if</span>(s.charAt(i-<span class="hljs-number">1</span>) == p.charAt(j-<span class="hljs-number">2</span>) || p.charAt(j-<span class="hljs-number">2</span>) == <span class="hljs-string">&#x27;.&#x27;</span>)&#123;<br>                    dp[i][j] = dp[i][j] || dp[i-<span class="hljs-number">1</span>][j];<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span>(i == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<br>                <span class="hljs-keyword">if</span>(s.charAt(i-<span class="hljs-number">1</span>) == p.charAt(j-<span class="hljs-number">1</span>) || p.charAt(j-<span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;.&#x27;</span>)&#123;<br>                    dp[i][j] = dp[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>];<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dp[n][m];<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰èƒŒåŒ…é—®é¢˜">ä¸‰ã€èƒŒåŒ…é—®é¢˜</h2><h3 id="ç±»å‹">1ã€ç±»å‹</h3><h4 id="èƒŒåŒ…é—®é¢˜">1.1ã€0-1èƒŒåŒ…é—®é¢˜</h4><p>ã€é—®é¢˜æè¿°ã€‘</p><blockquote><p>ç»™å®šä¸€ä¸ªå¯è£…è½½é‡é‡ä¸º<code>W</code>çš„èƒŒåŒ…å’Œ<code>N</code>ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“æœ‰é‡é‡å’Œä»·å€¼ä¸¤ä¸ªå±æ€§ï¼Œå…¶ä¸­ç¬¬<code>i</code>ä¸ªç‰©å“çš„é‡é‡ä¸º<code>wt[i]</code>ï¼Œä»·å€¼ä¸º<code>val[i]</code>ï¼Œè¯·é—®ç”¨è¿™ä¸ªèƒŒåŒ…æœ€å¤šå¯ä»¥è£…å¤šå°‘ä»·å€¼çš„ç‰©å“ï¼Ÿ</p></blockquote><h4 id="å®Œå…¨èƒŒåŒ…é—®é¢˜">1.2ã€å®Œå…¨èƒŒåŒ…é—®é¢˜</h4><p>ã€518.é›¶é’±å…‘æ¢â…¡ã€‘</p><blockquote><p>ç»™å®šä¸åŒé¢é¢çš„ç¡¬å¸å’Œä¸€ä¸ªæ€»é‡‘é¢ï¼Œè®¡ç®—å‡ºå¯ä»¥å‡‘æˆæ€»é‡‘é¢çš„ç¡¬å¸ç»„åˆæ•°ï¼Œå‡è®¾æ¯ä¸€ç§é¢é¢çš„ç¡¬å¸æœ‰æ— é™ä¸ªã€‚</p></blockquote><p>è½¬æ¢ä¸ºèƒŒåŒ…é—®é¢˜ï¼Œå°±æ˜¯</p><blockquote><p>æœ‰ä¸€ä¸ªæœ€å¤§å®¹é‡ä¸º amount çš„èƒŒåŒ…ï¼Œæœ‰ä¸€ç³»åˆ—ç‰©å“ coinsï¼Œç‰©å“çš„é‡é‡ä¸ºcoins[i]ï¼Œæ¯ä¸ªç‰©å“çš„æ•°é‡æ— é™ï¼Œè¯·é—®æœ‰å¤šå°‘ç§æ–¹æ³•ï¼Œèƒ½å¤Ÿæ°å¥½æŠŠèƒŒåŒ…è£…æ»¡ï¼Ÿ</p></blockquote><p>ç”±äºæ¯ä¸ªç‰©å“çš„æ•°é‡æ˜¯æ— é™çš„ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºã€<strong>å®Œå…¨èƒŒåŒ…é—®é¢˜</strong>ã€‘</p><h4 id="å­é›†èƒŒåŒ…é—®é¢˜">1.3ã€å­é›†èƒŒåŒ…é—®é¢˜</h4><p>ã€416.åˆ†å‰²ç­‰å’Œå­é›†ã€‘</p><blockquote><p>ç»™å®šä¸€ä¸ªåªåŒ…å«æ­£æ•´æ•°çš„éç©ºæ•°ç»„ã€‚æ˜¯å¦å¯ä»¥å°†è¿™ä¸ªæ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸ç­‰ã€‚</p></blockquote><p>å…¶å®ç±»ä¼¼äº0-1èƒŒåŒ…é—®é¢˜</p><blockquote><p>æœ‰ä¸€å †ç‰©å“ numsï¼Œç‰©å“é‡é‡ä¸º nums[i]ï¼Œç‰©å“é‡é‡ä¹‹å’Œä¸º sumã€‚æœ‰ä¸€ä¸ªå®¹é‡ä¸ºsum / 2 çš„èƒŒåŒ…ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæ°å¥½è£…æ»¡è¿™ä¸ªèƒŒåŒ…ï¼Ÿ</p></blockquote><h3 id="åˆ†æ">2ã€åˆ†æ</h3><p>ç”±äºéƒ½å¯ä»¥è½¬æ¢ä¸ºæƒ…æ™¯ç›¸ä¼¼çš„èƒŒåŒ…é—®é¢˜ï¼Œæ‰€ä»¥å°±å¯ä»¥æ”¾åœ¨ä¸€èµ·åˆ†æã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æŒ‘å®Œå…¨èƒŒåŒ…é—®é¢˜ä½œä¸ºä¾‹å­ï¼Œã€518.é›¶é’±å…‘æ¢â…¡ã€‘</p><ol type="1"><li>æ˜ç¡®çŠ¶æ€ï¼š<span class="math inline">\(N\)</span>ï¼šå‰<spanclass="math inline">\(N\)</span>ä¸ªç¡¬å¸ï¼›<spanclass="math inline">\(W\)</span>ï¼šæ€»é‡‘é¢</li><li>æ˜ç¡®è½¬ç§»ï¼šéœ€è¦æ±‚è§£çš„æ˜¯ <span class="math inline">\(f(N,W)\)</span>ï¼Œå³ç»™å®šå‰<spanclass="math inline">\(N\)</span>ä¸ªç¡¬å¸æ°å¥½å¯ä»¥ç»„æˆ<spanclass="math inline">\(W\)</span>é‡‘é¢çš„ç»„åˆæ•°ã€‚è¿™ä¹ˆå®šä¹‰äº†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆè½»æ˜“çš„å†™å‡ºæœ€ç®€å•é—®é¢˜çš„ç­”æ¡ˆï¼š<spanclass="math inline">\(f(0, W) = 0\)</span>å’Œ<spanclass="math inline">\(f(N, 0) = 1\)</span></li><li>å¦‚ä½•è½¬ç§»ï¼šå¯¹äº <spanclass="math inline">\(f(N,W)\)</span>ï¼Œæˆ‘ä»¬è€ƒè™‘ç¬¬<spanclass="math inline">\(N\)</span>ä¸ªç¡¬å¸Pã€‚å¦‚æœæˆ‘ä»¬åœ¨ç»„åˆè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨Pï¼Œé‚£ä¹ˆé—®é¢˜å°±è¢«è½¬åŒ–ä¸ºäº†<spanclass="math inline">\(f(N-1,W)\)</span>ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç»„åˆè¿‡ç¨‹ä¸­è¦ä½¿ç”¨Pï¼Œé‚£ä¹ˆé—®é¢˜å°±è¢«è½¬åŒ–ä¸ºäº†<spanclass="math inline">\(f(N, W-wt[P])\)</span>ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š<span class="math inline">\(f(N,W) =f(N-1,W)+f(N,W-wt[P])\)</span></li></ol><p>å†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“å¦‚ä½•å®šä¹‰ dpæ•°ç»„ äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[][];<br><span class="hljs-comment">// dp[i][j]: å‰iä¸ªç¡¬å¸ç»„åˆå‡ºjé‡‘é¢çš„ç§æ•°</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å°±å¯ä»¥ç”¨dpæ•°ç»„æ¥è¡¨ç¤ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] = dp[i-<span class="hljs-number">1</span>][j] + dp[i][j - &lt;ç¬¬iä¸ªç¡¬å¸çš„é¢å€¼&gt;]<br></code></pre></td></tr></table></figure><blockquote><p>[3]æœ‰ä¸€ä¸ªæ¯”è¾ƒéš¾ç†è§£çš„ç‚¹ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨äº†Pï¼Œé—®é¢˜è¢«è½¬åŒ–æˆäº†<spanclass="math inline">\(f(N, W-wt[P])\)</span>ï¼Œè€Œä¸æ˜¯<spanclass="math inline">\(f(N-1, W-wt[P])\)</span></p><p>â€‹ å¯èƒ½ä¼šæ„Ÿè§‰æ˜¯ <span class="math inline">\(N-1\)</span>ï¼Œæ¯•ç«Ÿç¬¬<spanclass="math inline">\(N\)</span>ä¸ªç¡¬å¸å·²ç»ç”¨è¿‡äº†ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½<spanclass="math inline">\(W-wt[P]\)</span>é‡‘é¢ç»„åˆä¸­ä¹Ÿç”¨äº†ç¬¬<spanclass="math inline">\(N\)</span>ä¸ªç¡¬å¸ï¼Œæ‰€ä»¥ä¸èƒ½ç¡®å®šç¡¬å¸æ•°ï¼Œåªèƒ½ç¡®å®šé‡‘é¢æ•°ã€‚</p></blockquote><h3 id="ä»£ç å’Œæ”¹è¿›">3ã€ä»£ç å’Œæ”¹è¿›</h3><h4 id="ä»£ç ">ä»£ç </h4><p>ã€518.é›¶é’±å…‘æ¢â…¡ã€‘å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> amount, <span class="hljs-type">int</span>[] coins)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> coins.length;<br>    <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n+<span class="hljs-number">1</span>][amount+<span class="hljs-number">1</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= n; i++) dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// ç›®æ ‡å°±æ˜¯æ±‚ dp[n][amount]</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= amount; j++)&#123;<br>            <span class="hljs-keyword">if</span>(j &lt; coins[i-<span class="hljs-number">1</span>])&#123;<br>                dp[i][j] = dp[i-<span class="hljs-number">1</span>][j];<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                dp[i][j] = dp[i-<span class="hljs-number">1</span>][j] + dp[i][j - coins[i-<span class="hljs-number">1</span>]];<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dp[n][amount];<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="çŠ¶æ€å‹ç¼©">çŠ¶æ€å‹ç¼©</h4><p>æœ€åï¼Œè¿˜è¦å†æ¢è®¨ä¸€ä¸‹çŠ¶æ€å‹ç¼©é—®é¢˜ï¼Œå³å¯ä»¥ä½¿ç”¨ä¸€ç»´dpæ•°ç»„ï¼Œä½¿å¾—ç©ºé—´å¤æ‚åº¦ä»<spanclass="math inline">\(O(NW)\)</span>é™ä¸º<spanclass="math inline">\(O(W)\)</span></p><p>è¿™é‡Œä¸»è¦é€‰å–ã€518.é›¶é’±å…‘æ¢â…¡ã€‘å’Œã€416.åˆ†å‰²ç­‰å’Œå­é›†ã€‘ä¸¤ä¸ªé—®é¢˜</p><p>é¦–å…ˆå†™å‡ºå®ƒä»¬çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 518.é›¶é’±å…‘æ¢â…¡</span><br>dp[i][j] = dp[i-<span class="hljs-number">1</span>][j] + dp[i][j - coins[i-<span class="hljs-number">1</span>]];<br><span class="hljs-comment">// 416.åˆ†å‰²ç­‰å’Œå­é›†</span><br>dp[i][j] = dp[i-<span class="hljs-number">1</span>][j] + dp[i-<span class="hljs-number">1</span>][j - nums[i-<span class="hljs-number">1</span>]];<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œ<code>dp[i][j]</code>åªå’Œ<code>dp[i][...]</code>ä»¥åŠ<code>dp[i-1][...]</code>æœ‰å…³ç³»ã€‚</p><p>æ”¹æˆä¸€ç»´æ•°ç»„å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[amount];<br></code></pre></td></tr></table></figure><p>åœ¨ç¬¬<code>i</code>è½®è¿­ä»£å¼€å§‹ä¹‹å‰ï¼Œdpæ•°ç»„ä¸­çš„å€¼å°±ç­‰ä»·äºä¹‹å‰çš„<code>dp[i-1][...]</code></p><p>æ‰€ä»¥åªè¦æ§åˆ¶éå†é¡ºåºï¼ˆæ­£å‘æˆ–é€†å‘ï¼‰ï¼Œä½¿å¾—åœ¨éå†<code>dp[j]</code>æ—¶ï¼Œ<code>dp[j-?]</code>çš„å€¼å·²ç»æ›´æ–°ï¼ˆ<code>dp[i][j-?]</code>ï¼‰æˆ–è€…æ²¡æœ‰æ›´æ–°ï¼ˆ<code>dp[i-1][j-?]</code>ï¼‰ï¼Œå³å¯å®ç°çŠ¶æ€çš„è½¬ç§»ã€‚</p><p>æœ€åé™„ä¸Šä½¿ç”¨ä¸€ç»´æ•°ç»„è§£å†³çš„ä»£ç </p><blockquote><p><strong>æ³¨æ„ä¸¤æ®µä»£ç çš„ç¬¬äºŒå±‚å¾ªç¯ï¼Œå°±æ˜¯é€šè¿‡æ­£å‘éå†å’Œé€†å‘éå†å®ç°åœ¨è®¡ç®—dp[j]æ—¶dp[j-?]çš„å·²æ›´æ–°å’Œæœªæ›´æ–°</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 518.é›¶é’±å…‘æ¢â…¡</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> amount, <span class="hljs-type">int</span>[] coins)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> coins.length;<br>    <span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[amount+<span class="hljs-number">1</span>];<br>    dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// ç›®æ ‡å°±æ˜¯æ±‚ dp[amount]</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= amount; j++)&#123;<br>            <span class="hljs-keyword">if</span>(j &lt; coins[i]) <span class="hljs-keyword">continue</span>;<br>            dp[j] = dp[j] + dp[j - coins[i]];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dp[amount];<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 416.åˆ†å‰²ç­‰å’Œå­é›†</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>    <span class="hljs-comment">// å‰ç½®åˆ¤æ–­</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length;<br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i : nums) sum += i;<br>    <span class="hljs-keyword">if</span>(sum % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> sum / <span class="hljs-number">2</span>; <span class="hljs-comment">// èƒŒåŒ…ä¸­çš„ç›®æ ‡å€¼</span><br><br>    <span class="hljs-type">boolean</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[target+<span class="hljs-number">1</span>];<br>    dp[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> target; j &gt;= <span class="hljs-number">1</span>; j--)&#123;<br>            <span class="hljs-keyword">if</span>(j &lt; nums[i]) <span class="hljs-keyword">continue</span>;<br>            dp[j] = dp[j] || dp[j - nums[i]];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> dp[target];<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°9-dpåº”ç”¨</title>
      <link href="/2022/11/16/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B09%EF%BC%88dp%E5%BA%94%E7%94%A8%EF%BC%89/"/>
      <url>/2022/11/16/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B09%EF%BC%88dp%E5%BA%94%E7%94%A8%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€è‚¡ç¥¨é—®é¢˜">ä¸€ã€è‚¡ç¥¨é—®é¢˜(*)</h2><blockquote><p><ahref="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/">188.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV</a></p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ prices ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´  prices[i]æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ k ç¬”äº¤æ˜“ã€‚</p><p>æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p></blockquote><p>labuladongç®—æ³•ç§˜ç±ä¸­ä½¿ç”¨äº†ã€ä¸‰ä¸ª<strong>çŠ¶æ€</strong>ã€‘ï¼ˆä¸‰ç»´dpæ•°ç»„ï¼‰</p><ol type="1"><li>ç¬¬å‡ å¤©</li><li>æ‰‹ä¸­æ˜¯å¦æŒæœ‰è‚¡ç¥¨</li><li>æœ€å¤§äº¤æ˜“é™åˆ¶ï¼ˆæœ€å¤§äº¤æ˜“é™åˆ¶åªåœ¨ä¹°å…¥è‚¡ç¥¨æ—¶å‡ä¸€ï¼‰</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// dp[i][j][k] æ„å‘³ç€åœ¨ç¬¬iå¤©ï¼Œæ‰‹ä¸­æŒæœ‰(j=1)æˆ–ä¸æŒæœ‰(j=0)è‚¡ç¥¨ï¼Œæœ€å¤§äº¤æ˜“é™åˆ¶ä¸ºkæƒ…å†µä¸‹çš„æœ€å¤§åˆ©æ¶¦</span><br></code></pre></td></tr></table></figure><p><strong>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][<span class="hljs-number">0</span>][k] = Math.max(<br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][k],  <span class="hljs-comment">// ç¬¬iå¤© ä¸ä¹°å…¥ä¸å–å‡º: ç¬¬i-1å¤©ä¹Ÿæ²¡æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶è¿˜æ˜¯k</span><br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][k]+prices[i-<span class="hljs-number">1</span>] <span class="hljs-comment">// ç¬¬iå¤© å–å‡º: ç¬¬i-1å¤©æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶è¿˜æ˜¯k</span><br>);<br>dp[i][<span class="hljs-number">1</span>][k] = Math.max(<br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][k], <span class="hljs-comment">// ç¬¬iå¤© ä¸ä¹°å…¥ä¸å–å‡º: ç¬¬i-1å¤©æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶ä¸ºk</span><br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][k-<span class="hljs-number">1</span>]-prices[i-<span class="hljs-number">1</span>] <span class="hljs-comment">// ç¬¬iå¤© ä¹°å…¥: ç¬¬i-1å¤©æ²¡æœ‰è‚¡ç¥¨ï¼Œæœ€å¤§äº¤æ˜“æ¬¡æ•°ä¸èƒ½è¶…è¿‡k-1</span><br>);<br></code></pre></td></tr></table></figure><p><strong>base case</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][...] = <span class="hljs-number">0</span>; dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][...] = Integer.MIN_VALUE;<br>dp[...][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; dp[...][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = Integer.MIN_VALUE;<br></code></pre></td></tr></table></figure><h2 id="äºŒæ‰“åŠ«å®¶èˆé—®é¢˜">äºŒã€æ‰“åŠ«å®¶èˆé—®é¢˜</h2><blockquote><p><ahref="%5B198.%20æ‰“å®¶åŠ«èˆ%20-%20åŠ›æ‰£ï¼ˆLeetCodeï¼‰%5D(https://leetcode.cn/problems/house-robber/)">198.æ‰“åŠ«å®¶èˆ</a></p><p><a href="https://leetcode.cn/problems/house-robber-ii/">213. æ‰“å®¶åŠ«èˆII</a></p><p><a href="https://leetcode.cn/problems/house-robber-iii/">337.æ‰“å®¶åŠ«èˆ III</a></p></blockquote><h3 id="æ‰“åŠ«å®¶èˆ">1ã€æ‰“åŠ«å®¶èˆ</h3><p>ã€çŠ¶æ€ã€‘æ˜¯ <u>æŠ¢åŠ«ç¬¬iå®¶æ—¶èƒ½è·å¾—çš„æœ€å¤§é‡‘é¢</u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// çŠ¶æ€è½¬ç§»æ–¹ç¨‹</span><br>dp[i] = Math.max(dp[i-<span class="hljs-number">2</span>], dp[i-<span class="hljs-number">3</span>]) + nums[i];<br></code></pre></td></tr></table></figure><h3 id="æ‰“åŠ«å®¶èˆâ…±">2ã€æ‰“åŠ«å®¶èˆâ…¡</h3><blockquote><p>ç‰¹åˆ«ä¹‹å¤„åœ¨äº nums æ¢æˆäº†ç¯å½¢æ•°ç»„</p></blockquote><p>åº”å¯¹ç­–ç•¥ä¹Ÿååˆ†å·§å¦™</p><p><span class="math inline">\(f([x_{1}, x_{2}, ... , x_{n}]) = max(f([x_{1}, x_{2}, ..., x_{n-1}]), f([x_{2}, ..., x_{n}]) )\)</span></p><p><u><strong>æ—¢ç„¶é¦–å°¾ç›¸è¿äº†ï¼Œé‚£ä¹ˆè‚¯å®šæœ€å¤šåªèƒ½æŠ¢åŠ«ä¸€å®¶ï¼ŒæŠŠå¦å¤–ä¸€å®¶é™¤å»</strong></u>ï¼Œå°±æŠŠç¯å½¢æ•°ç»„åˆå˜æˆäº†æ™®é€šæ•°ç»„äº†ã€‚</p><h3 id="æ‰“åŠ«å®¶èˆâ…²">3ã€æ‰“åŠ«å®¶èˆâ…¢</h3><blockquote><p>æŠŠå®¶èˆçš„å½¢çŠ¶å˜æˆäº†äºŒå‰æ ‘</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">rob</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-type">int</span>[] res = dp(root);<br>        <span class="hljs-keyword">return</span> Math.max(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>]);<br>    &#125;<br><br>    <span class="hljs-comment">// return &#123;x, y&#125; </span><br>    <span class="hljs-comment">// x: åŒ…æ‹¬rootèŠ‚ç‚¹çš„æœ€é«˜é‡‘é¢ </span><br>    <span class="hljs-comment">// y: ä¸åŒ…å«rootèŠ‚ç‚¹çš„æœ€é«˜é‡‘é¢</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] dp(TreeNode root)&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br>        <span class="hljs-type">int</span>[] left = dp(root.left);<br>        <span class="hljs-type">int</span>[] right = dp(root.right);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> left[<span class="hljs-number">1</span>] + right[<span class="hljs-number">1</span>] + root.val;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> Math.max(left[<span class="hljs-number">1</span>], left[<span class="hljs-number">0</span>]) + Math.max(right[<span class="hljs-number">1</span>], right[<span class="hljs-number">0</span>]);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;x, y&#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰åšå¼ˆé—®é¢˜">ä¸‰ã€åšå¼ˆé—®é¢˜</h2><blockquote><p><a href="https://leetcode.cn/problems/predict-the-winner/">486.é¢„æµ‹èµ¢å®¶</a></p></blockquote><p>æœ€æ ¸å¿ƒæœ€å…³é”®çš„è¿˜æ˜¯åœ¨ã€æ‰¾çŠ¶æ€ã€‘ï¼Œç†è§£ï¼ï¼ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¬¬ä¸€ç§æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œä¸‰ç»´æ•°ç»„</span><br><span class="hljs-comment">// dp[i][j][0] è¡¨ç¤ºåœ¨[xi...xj]åŒºé—´æ—¶ï¼Œå…ˆæ‰‹çš„æœ€å¤§å¾—åˆ†</span><br>dp[i][j][<span class="hljs-number">0</span>] = Math.max(nums[i]+dp[i+<span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>], nums[j]+dp[i][j-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);<br><span class="hljs-comment">// [i...j] å…ˆæ‰‹å¯ä»¥é€‰æ‹©iä¹Ÿå¯ä»¥é€‰æ‹©j</span><br><span class="hljs-comment">// é€‰æ‹©iåï¼Œåœ¨[i+1...j]åŒºé—´å°±å˜æˆäº†åæ‰‹ï¼Œå°±æ˜¯dp[i+1][j][1]</span><br><span class="hljs-comment">// é€‰æ‹©jåï¼Œåœ¨[i...j+1]åŒºé—´å°±å˜æˆäº†åæ‰‹ï¼Œå°±æ˜¯dp[i][j-1][1]</span><br><span class="hljs-keyword">if</span> å…ˆæ‰‹é€‰æ‹©äº†i: dp[i][j][<span class="hljs-number">1</span>] = dp[i+<span class="hljs-number">1</span>][j][<span class="hljs-number">0</span>];<br><span class="hljs-keyword">if</span> å…ˆæ‰‹é€‰æ‹©äº†j: dp[i][j][<span class="hljs-number">1</span>] = dp[i][j-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>];<br><br><br><span class="hljs-comment">// ç¬¬äºŒç§ç¨å¾®æ”¹è¿›ä¸€ç‚¹ï¼ŒäºŒç»´æ•°ç»„</span><br><span class="hljs-comment">// dp[i][j][1] è¡¨ç¤ºåœ¨[xi...xj]åŒºé—´æ—¶ï¼Œå…ˆæ‰‹çš„æœ€å¤§å¾—åˆ†-åæ‰‹çš„æœ€å¤§å¾—åˆ†</span><br>dp[i][j] = Math.max(nums[i] - dp[i+<span class="hljs-number">1</span>][j], nums[j] - dp[i][j-<span class="hljs-number">1</span>]);<br><span class="hljs-comment">// åœ¨[i...j]å…ˆæ‰‹åšå‡ºé€‰æ‹©åï¼Œå°±å˜æˆäº†åæ‰‹ï¼Œæ‰€ä»¥æ˜¯&lt;å‡&gt;</span><br></code></pre></td></tr></table></figure><h2 id="å››æ‰”é¸¡è›‹">å››ã€æ‰”é¸¡è›‹ï¼ˆ***ï¼‰</h2><blockquote><p><ahref="https://leetcode.cn/problems/super-egg-drop/">887.é¸¡è›‹æ‰è½</a></p><p>è¿™é“é¢˜ç†è§£ä¸Šéš¾åº¦å¾ˆé«˜...</p></blockquote><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221104212852347.png"alt="image-20221104212852347" /><figcaption aria-hidden="true">image-20221104212852347</figcaption></figure><p>è¿™é‡Œè®²ä¸€ä¸ªé€†å‘æ€ç»´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] è¡¨ç¤ºæœ‰jä¸ªé¸¡è›‹ï¼Œå¯ä»¥æ“ä½œiæ¬¡ï¼Œå¯ä»¥åœ¨æœ€é«˜dp[i][j]çš„å»ºç­‘é‡Œä¿è¯æ‰¾åˆ°f<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚<code>dp[2][1]=2</code>ï¼Œè¡¨ç¤ºæœ‰1ä¸ªé¸¡è›‹ï¼Œå¯ä»¥æ“ä½œ2æ¬¡ï¼Œå¯ä»¥åœ¨æœ€é«˜2æ¥¼çš„å»ºç­‘é‡Œä¿è¯æ‰¾åˆ°<code>f</code>ã€‚æ„æ€å°±æ˜¯å¦‚æœæ¥¼<code>&gt;=</code>3ï¼Œå°±ä¸èƒ½ä¿è¯åœ¨1ä¸ªé¸¡è›‹2æ¬¡æ“ä½œçš„æƒ…å†µä¸‹æ‰¾åˆ°fã€‚è¿™é‡Œçš„ä¿è¯æ˜¯æŒ‡ä¸ç®¡åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éƒ½å¯ä»¥æˆåŠŸæ‰¾åˆ°fï¼Œè€Œä¸æ˜¯è¯´æœ‰ä¸€å®šæ¦‚ç‡å¯ä»¥æ‰¾åˆ°ã€‚å¾ˆå¥½ç†è§£ï¼Œä¸ç®¡å¤šé«˜çš„æ¥¼å±‚ï¼Œå³ä½¿ç»™1ä¸ªé¸¡è›‹1æ¬¡æ“ä½œï¼Œä¹Ÿæœ‰ä¸€å®šæ¦‚ç‡å¯ä»¥æ‰¾åˆ°fï¼ˆç¬¬1å±‚å°±ç¢äº†ï¼Œæ‰€ä»¥<code>f=0</code>ï¼‰</p><p>ç†è§£å®ŒçŠ¶æ€ä¹‹åï¼Œå°±éœ€è¦æ‰¾åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚å…ˆç»™å‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] = <span class="hljs-number">1</span> + dp[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>] + dp[i][j-<span class="hljs-number">1</span>];<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåº”è¯¥æ˜¯è¿™é“é¢˜æœ€éš¾ç†è§£çš„åœ°æ–¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°10â€”å…¶ä»–ç»å…¸ç®—æ³•</title>
      <link href="/2022/11/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B010%EF%BC%88%E5%85%B6%E4%BB%96%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%EF%BC%89/"/>
      <url>/2022/11/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B010%EF%BC%88%E5%85%B6%E4%BB%96%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ç´ æ•°ç­›">1 ç´ æ•°ç­›</h2><p>éå¸¸æ™®éçš„ï¼Œå¯»æ‰¾ç´ æ•°å¯ä»¥ä½¿ç”¨<spanclass="math inline">\(O(N^{2})\)</span>å¤æ‚åº¦çš„ç®—æ³•æ¥è§£å†³ï¼Œä½†æ˜¯ä¸å¤Ÿé«˜æ•ˆã€‚ä¸‹é¢ä»‹ç»å‡ ç§æ›´åŠ é«˜æ•ˆçš„å¯»æ‰¾ç´ æ•°çš„ç®—æ³•â€”ç´ æ•°ç­›ã€‚</p><p>æœ€è¿‘å†çœ‹åˆ°ç´ æ•°çš„ç®—æ³•ï¼Œå°±æƒ³åˆ°äº†6.S081 lab1 ä¸­å†™çš„ primeså‡½æ•°ï¼Œå¥½åƒå…¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç´ æ•°ç­›â€”åŸƒå¼ç­›æ³•</p><h3 id="åŸƒå¼ç­›æ³•">åŸƒå¼ç­›æ³•</h3><p>æ€è·¯å°±æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæ•°æ˜¯ç´ æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ•°çš„å€æ•°å…¨éƒ¨åˆ’æ‰ï¼Œå› ä¸ºå®ƒä»¬ä¸å¯èƒ½æ˜¯ç´ æ•°ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼Œå½“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªç´ æ•°æ—¶ï¼Œæˆ‘ä»¬å°±å°†è¿™ä¸ªç´ æ•°çš„2å€ã€3å€ã€...åˆ’æ‰ï¼Œè€Œæ²¡æœ‰è¢«åˆ’æ‰çš„å°±æ˜¯ç´ æ•°ã€‚</p><p>å¤æ‚åº¦ï¼š<span class="math inline">\(O(N loglogN)\)</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countPrimes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">boolean</span>[] nums = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];<br>    Arrays.fill(nums, <span class="hljs-literal">true</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">if</span>(nums[i])&#123;<br>            cnt ++;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * i; j &lt; n; j += i)&#123;<br>                nums[j] = <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå¾ˆæ˜æ˜¾è¿™ä¸ªè§£æ³•å­˜åœ¨ä¸€å®šçš„å†—ä½™ï¼Œæ¯”å¦‚è¯´ 6 å°±è¢« ç´ æ•°2 å’Œç´ æ•°3é‡å¤æ ‡è®°ï¼Œä¸‹é¢ä»‹ç»å¤æ‚åº¦ä¸º<spanclass="math inline">\(O(N)\)</span>çš„çº¿æ€§ç´ æ•°ç­›</p><h3 id="çº¿æ€§ç­›">çº¿æ€§ç­›</h3><p>çº¿æ€§ç­›å®ç°äº†æ¯ä¸ªåˆæ•°åªè¢«æ ‡è®°ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <spanclass="math inline">\(O(N)\)</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countPrimes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    List&lt;Integer&gt; primes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-type">boolean</span>[] nums = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];<br>    Arrays.fill(nums, <span class="hljs-literal">true</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">if</span>(nums[i])&#123;<br>            primes.add(i);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; primes.size() &amp;&amp; primes.get(j) * i &lt; n; j++)&#123;<br>            nums[primes.get(j) * i] = <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">if</span>(i % primes.get(j) == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> primes.size();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é˜¶ä¹˜">2 é˜¶ä¹˜</h2><blockquote><p><ahref="https://leetcode.cn/problems/factorial-trailing-zeroes/">172.é˜¶ä¹˜åçš„é›¶</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221116121050876.png" /></p></blockquote><p>è¿™é“é¢˜å¾ˆæ˜æ˜¾ç›´æ¥å»ç®—é˜¶ä¹˜è‚¯å®šæ˜¯è¡Œä¸é€šçš„ï¼Œåº”è¯¥è¦è€ƒè™‘æ ¸å¿ƒå› ç´ ã€‚</p><p>äº§ç”Ÿ0çš„åŸå› æ˜¯é˜¶ä¹˜å¼å­ä¸­å­˜åœ¨<span class="math inline">\(2 \times5\)</span>ï¼Œæ‰€ä»¥è¦è®¡ç®—0çš„æ•°é‡ï¼Œåªè¦è®¡ç®—å¼å­ä¸­å‡ºç°äº†å¤šå°‘å¯¹<spanclass="math inline">\(2 \times 5\)</span>ï¼Œå³æœ‰å¤šå°‘å› å­2å’Œå› å­5ã€‚</p><p>å†å¾€ä¸‹è€ƒè™‘ï¼Œå…¶å®åªéœ€è¦è€ƒè™‘å› å­5çš„ä¸ªæ•°å³å¯ï¼Œå› ä¸ºå› å­2åœ¨ä»»ä½•å¶æ•°ä¸­éƒ½å¯ä»¥æå–å‡ºæ¥ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªé˜¶ä¹˜å¼å­ä¸­ï¼Œå› å­2çš„ä¸ªæ•°æ˜¯å¤§äºå› å­5çš„ï¼ˆå¯ä»¥ä¸¥æ ¼è¯æ˜ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">trailingZeroes</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n; i / <span class="hljs-number">5</span> &gt; <span class="hljs-number">0</span>; i /= <span class="hljs-number">5</span>)&#123;<br>        cnt += (i / <span class="hljs-number">5</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><ahref="https://leetcode.cn/problems/preimage-size-of-factorial-zeroes-function/">793.é˜¶ä¹˜å‡½æ•°å K ä¸ªé›¶</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221116121859204.png" /></p></blockquote><p>è¿™ä¸€é¢˜ç›¸å½“äºä¸Šä¸€é¢˜çš„é€†è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆæ˜ç¡®ï¼Œ<spanclass="math inline">\(f(x)\)</span>è‚¯å®šæ˜¯ä¸€ä¸ªå•è°ƒé€’å¢çš„å‡½æ•°ï¼Œ<spanclass="math inline">\(x\)</span>è¶Šå¤§ï¼Œ<spanclass="math inline">\(f(x)\)</span>çš„å€¼è‚¯å®šä¸ä¼šå‡å°‘ã€‚è€Œç°åœ¨æ˜¯ç»™å®š<spanclass="math inline">\(f(x)\)</span>ï¼Œè¦æ±‚å‡º<spanclass="math inline">\(x\)</span>ï¼Œå¾ˆè‡ªç„¶åº”è¯¥ä½¿ç”¨ã€<strong>äºŒåˆ†æŸ¥æ‰¾</strong>ã€‘ã€‚</p><p>1ã€æ³¨æ„æ•°æ®èŒƒå›´ï¼š<span class="math inline">\(k &lt;= 10^9\)</span>ï¼Œæ‰€ä»¥èƒ½å¤Ÿäº§ç”Ÿè¿™ä¸ª<span class="math inline">\(f(x)\)</span>çš„<spanclass="math inline">\(x\)</span>è‚¯å®šå·²ç»è¶…å‡ºäº†<code>int</code>çš„èŒƒå›´éœ€è¦ä½¿ç”¨<code>long</code></p><p>2ã€ä»”ç»†æƒ³ä¸€æƒ³å¯ä»¥å‘ç°ï¼šç»™å®š<code>k</code>ä¹‹åï¼Œè¦ä¹ˆä¸å­˜åœ¨è¿™æ ·çš„<spanclass="math inline">\(x!\)</span>ï¼Œå¦‚æœå­˜åœ¨åªæœ‰5ä¸ªè¿™æ ·çš„<spanclass="math inline">\(x!\)</span>ã€‚</p><p>å›åˆ°ä¸Šä¸€é¢˜çš„æ€è·¯ï¼Œé˜¶ä¹˜æœ«å°¾0çš„ä¸ªæ•° =é˜¶ä¹˜å¼å­ä¸­å› å­5çš„ä¸ªæ•°ã€‚<strong>å¦‚æœå­˜åœ¨çš„è¯ï¼Œåº”è¯¥æ˜¯èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ª<spanclass="math inline">\(x\)</span>ï¼Œæ˜¯5çš„å€æ•°ï¼Œæ»¡è¶³<spanclass="math inline">\(\le x\)</span>çš„æ•°ä¸­å› å­5çš„æ•°é‡ä¹‹å’Œ<spanclass="math inline">\(=k\)</span>ã€‚</strong>ã€ä¸¾ä¸ªä¾‹å­ï¼Œ<spanclass="math inline">\(k=4\)</span>ï¼Œå­˜åœ¨<span class="math inline">\(x =20\)</span>ï¼Œæ»¡è¶³<span class="math inline">\(\lex\)</span>çš„æ•°ä¸­å› å­5çš„æ•°é‡ä¹‹å’Œ<spanclass="math inline">\(=4\)</span>ï¼ˆ<spanclass="math inline">\(5ã€10ã€15ã€20\)</span>ï¼‰ã€‘æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£ä¹ˆç­”æ¡ˆåº”è¯¥å°±åœ¨æ‰¾åˆ°çš„è¿™ä¸ª<spanclass="math inline">\(x\)</span>åˆ°ä¸‹ä¸€ä¸ª5çš„å€æ•°<spanclass="math inline">\(x+5\)</span>ä¹‹é—´ï¼Œå³<spanclass="math inline">\([x, x+5)\)</span>ï¼Œå› ä¸ºåˆ°ä¸‹ä¸€ä¸ª5çš„å€æ•°<spanclass="math inline">\(x+5\)</span>æ—¶ï¼Œ<spanclass="math inline">\(f(x)\)</span>è‚¯å®šå¤§äº<spanclass="math inline">\(k\)</span>ï¼Œæ‰€ä»¥æ€»å…±åªæœ‰5ä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">preimageSizeFZF</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">lo</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-type">long</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> Long.MAX_VALUE;<br>    <span class="hljs-keyword">while</span>(lo &lt;= hi)&#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> lo + (hi - lo) / <span class="hljs-number">2</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">k0</span> <span class="hljs-operator">=</span> trailingZeroes(mid);<br>        <span class="hljs-keyword">if</span>(k0 == k) <span class="hljs-keyword">return</span> <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(k0 &gt; k) hi = mid - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">else</span> lo = mid + <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">trailingZeroes</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> n; i / <span class="hljs-number">5</span> &gt; <span class="hljs-number">0</span>; i /= <span class="hljs-number">5</span>)&#123;<br>        cnt += (i / <span class="hljs-number">5</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ°´å¡˜æŠ½æ ·">3 æ°´å¡˜æŠ½æ ·</h2><p><strong>è¿™ä¸ªç®—æ³•å¯ä»¥å®ç°ã€ä½ç©ºé—´å¤æ‚åº¦ã€‘ä»æ— é™åºåˆ—ä¸­éšæœºæŠ½å–å…ƒç´ ã€‚</strong>å®é™…ä¸Šæ˜¯ç”¨æ—¶é—´æ¢ç©ºé—´çš„ä¸€ç§ç®—æ³•ã€‚</p><h4 id="é—®é¢˜1æ— é‡å¤å…ƒç´ ">é—®é¢˜1ï¼šæ— é‡å¤å…ƒç´ </h4><blockquote><p><a href="https://leetcode.cn/problems/linked-list-random-node/">382.é“¾è¡¨éšæœºèŠ‚ç‚¹</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221117093723012.png" /></p></blockquote><p>æ€è·¯ï¼šå½“é‡åˆ°ç¬¬<code>i</code>ä¸ªå…ƒç´ æ—¶ï¼Œä»<spanclass="math inline">\([0,i)\)</span>ä¹‹é—´éšæœºæŠ½å–ä¸€ä¸ªæ•°ï¼Œå¦‚æœè¿™ä¸ªæ•°ä¸º0ï¼Œåˆ™å°†ç­”æ¡ˆç½®ä¸ºç¬¬<code>i</code>ä¸ªå…ƒç´ ï¼Œå¦åˆ™ç­”æ¡ˆä¸å˜ã€‚è¿™æ ·å¯ä»¥ä½¿å¾—è¿”å›æ¯ä¸ªå…ƒç´ çš„æ¦‚ç‡éƒ½ä¸º<spanclass="math inline">\(\frac{1}{n}\)</span>ã€‚</p><p>è¯æ˜ï¼š <span class="math display">\[P(return \ \  i\text{-}th \ \ element) = \\P(ç¬¬iæ¬¡éšæœºé€‰æ‹©çš„å€¼=0) \times P(ç¬¬i+1æ¬¡éšæœºé€‰æ‹©çš„å€¼\ne0) \times \cdots\times P(ç¬¬næ¬¡éšæœºé€‰æ‹©çš„å€¼\ne0) =\\\frac{1}{i} \times (1 - \frac{1}{i+1}) \times (1 - \frac{1}{i+2}) \times\cdots \times (1 - \frac{1}{n}) = \frac{1}{n}\]</span> ä»£ç ï¼š<code>getRandom</code>å‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º<spanclass="math inline">\(O(N)\)</span>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<spanclass="math inline">\(O(1)\)</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><br>    ListNode head;<br>    Random r;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Solution</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-built_in">this</span>.head = head;<br>        r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>();<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getRandom</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">h0</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span>(h0 != <span class="hljs-literal">null</span>)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> h0.val;<br>            i++;<br>            <span class="hljs-keyword">if</span>(r.nextInt(i) == <span class="hljs-number">0</span>)&#123;<br>                res = val;<br>            &#125;<br>            h0 = h0.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="é—®é¢˜2å­˜åœ¨é‡å¤å…ƒç´ ">é—®é¢˜2ï¼šå­˜åœ¨é‡å¤å…ƒç´ </h4><blockquote><p><a href="https://leetcode.cn/problems/random-pick-index/">398.éšæœºæ•°ç´¢å¼•</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221117095257824.png" /></p></blockquote><p>æ€è·¯ï¼šå½“é‡åˆ°ç¬¬<code>i</code>ä¸ª<code>target</code>æ—¶ï¼Œéšæœºé€‰å–<spanclass="math inline">\([0,i)\)</span>ä¹‹é—´çš„ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚æœå…¶ä¸º0ï¼Œè¿™å°†ç­”æ¡ˆç½®ä¸º<code>target</code>ä¸‹æ ‡ï¼Œå¦åˆ™ç­”æ¡ˆä¸å˜ã€‚å¦‚æœå­˜åœ¨<code>k</code>ä¸ª<code>target</code>ï¼Œä¿è¯è¿”å›æ¯ä¸ªç´¢å¼•çš„æ¦‚ç‡éƒ½ä¸º<spanclass="math inline">\(\frac{1}{k}\)</span>ã€‚</p><p>è¯æ˜åŒä¸Šã€‚</p><p>ä»£ç ï¼š<code>pick</code>å‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º<spanclass="math inline">\(O(N)\)</span>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<spanclass="math inline">\(O(1)\)</span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br><br>    <span class="hljs-type">int</span>[] nums;<br>    Random r;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Solution</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;<br>        <span class="hljs-built_in">this</span>.nums = nums;<br>        r = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>();<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">pick</span><span class="hljs-params">(<span class="hljs-type">int</span> target)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">times</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; nums.length; i++)&#123;<br>            <span class="hljs-keyword">if</span>(nums[i] == target)&#123;<br>                times ++;<br>                <span class="hljs-keyword">if</span>(r.nextInt(times) == <span class="hljs-number">0</span>)&#123;<br>                    res = i;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åƒè‘¡è„">4 åƒè‘¡è„</h2><blockquote><p><ahref="https://www.nowcoder.com/questionTerminal/14c0359fb77a48319f0122ec175c9ada">åƒè‘¡è„</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221118092640002.png" /></p></blockquote><p>ã€è¦æ±‚ã€‘<u>ä¸‰ä¸ªäººä¸­åƒçš„æœ€å¤šçš„é‚£ä¸ªäººåƒå¾—å°½é‡å°‘</u>ï¼Œ<strong>å°±éœ€è¦å°½å¯èƒ½çš„å¹³å‡åˆ†</strong>ã€‚å½“ä¸è€ƒè™‘æ¯ä¸ªäººåªèƒ½åƒä¸¤ç§è‘¡è„çš„é™åˆ¶ï¼Œç­”æ¡ˆåº”è¯¥æ˜¯<spanclass="math inline">\((a+b+c+2)/3\)</span>ï¼Œå°±æ˜¯æ€»å’Œé™¤3å‘ä¸Šå–æ•´ã€‚</p><p>ä½†æ˜¯æœ‰"æ¯ä¸ªäººåªèƒ½åƒä¸¤ç§è‘¡è„"çš„é™åˆ¶å°±ä¸èƒ½è¿™ä¹ˆç®€å•è€ƒè™‘ï¼Œå› ä¸ºå¦‚æœå‡ºç°"å…¶ä¸­ä¸¤ç§è‘¡è„å¾ˆå°‘ï¼Œç¬¬ä¸‰ç§å¾ˆå¤š"çš„æƒ…å†µæ—¶ï¼Œå°±ä¸ä¸€æ ·äº†ã€‚æ¯”å¦‚<spanclass="math inline">\(a =1,\ b=1,\c=10000\)</span>ï¼Œè¿™ä¸ªæ—¶å€™å¾ˆæ˜æ˜¾ç­”æ¡ˆå°±ä¸æ˜¯<spanclass="math inline">\((a+b+c+2)/3\)</span>äº†ï¼Œå› ä¸ºåªèƒ½åƒ<spanclass="math inline">\(a,b\)</span>ä¸¤ç§è‘¡è„çš„äººæœ€å¤šåªèƒ½åƒ2é¢—ï¼Œè¿™ç§æƒ…å†µä¸‹åšä¸åˆ°ä¸‰ä¸ªäººå¹³å‡åˆ†ï¼Œ<strong>åªèƒ½ä¸¤ä¸ªäººå¹³å‡åˆ†</strong>ï¼Œæ¥å®ç°åƒçš„æœ€å¤šçš„äººåƒå¾—å°½é‡å°‘ï¼Œå°±æ˜¯<spanclass="math inline">\((c+1)/2\)</span>ï¼Œå³<spanclass="math inline">\((max+1)/2\)</span></p><p>é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å±äºå“ªç§æƒ…å†µå‘¢ï¼Ÿå½“<spanclass="math inline">\(a,b,c\)</span>ä¸‰è€…æ²¡æœ‰ç›¸å·®å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¾ˆæ˜æ˜¾<spanclass="math inline">\((a+b+c+2)/3 &gt;(max+1)/2\)</span>ï¼›è€Œå½“å…¶ä¸­ä¸€ç§æ°´æœè¿œå¤§äºå¦å¤–ä¸¤ç§æ—¶ï¼Œ<spanclass="math inline">\((a+b+c+2)/3 &lt;(max+1)/2\)</span>ã€‚æ‰€ä»¥ç­”æ¡ˆåº”è¯¥æ˜¯<span class="math inline">\(max( \(a+b+c+2)/3,\ (\ max(a,b,c) + 1 \ )/2 )\)</span></p><p>ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;math.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-type">int</span> n = <span class="hljs-number">0</span>;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span>(n -- &gt; <span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-type">int</span> a, b, c;<br>        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;<br>        <span class="hljs-type">int</span> max_val = <span class="hljs-built_in">max</span>( <span class="hljs-built_in">max</span>(a, b), c );<br>        <span class="hljs-type">int</span> sum = a + b + c;<br>        cout &lt;&lt; <span class="hljs-built_in">max</span>( (sum+<span class="hljs-number">2</span>)/<span class="hljs-number">3</span>, (max_val+<span class="hljs-number">1</span>)/<span class="hljs-number">2</span> ) &lt;&lt; endl;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åŒæ—¶å¯»æ‰¾ç¼ºå¤±å’Œé‡å¤çš„å…ƒç´ ">5 åŒæ—¶å¯»æ‰¾ç¼ºå¤±å’Œé‡å¤çš„å…ƒç´ </h2><blockquote><p><a href="https://leetcode.cn/problems/set-mismatch/">645.é”™è¯¯çš„é›†åˆ</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221118111228487.png" /></p><p><strong>æ³¨æ„æ•°ç»„æ˜¯æ— åºçš„</strong></p></blockquote><p>é¦–å…ˆå¾ˆå¸¸è§„çš„æ–¹æ³•æœ‰ã€æ’åºã€‘ã€ã€å“ˆå¸Œã€‘ï¼Œè¿™äº›éƒ½éœ€è¦ä¸€å®šç©ºé—´å¤æ‚åº¦ã€‚ä¸‹é¢è°ˆè°ˆå¸¸æ•°ç©ºé—´å¤æ‚åº¦çš„ã€æ˜ å°„ã€‘å’Œã€å¼‚æˆ–ã€‘</p><h3 id="æ˜ å°„">æ˜ å°„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] findErrorNums(<span class="hljs-type">int</span>[] nums) &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">dup</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> Math.abs(nums[i]) - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span>(nums[idx] &lt; <span class="hljs-number">0</span>)&#123; <span class="hljs-comment">// é‡å¤å…ƒç´ </span><br>            dup = Math.abs(nums[i]);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            nums[idx] *= -<span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-type">int</span> <span class="hljs-variable">mis</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">if</span>(nums[i] &gt; <span class="hljs-number">0</span>)&#123;<br>            mis = i + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;dup, mis&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¼‚æˆ–">å¼‚æˆ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] findErrorNums(<span class="hljs-type">int</span>[] nums) &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> nums.length;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">xor</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> num : nums) xor ^= num;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++) xor ^= i;<br>    <span class="hljs-comment">// xor = dup ^ mis</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">lowbit</span> <span class="hljs-operator">=</span> xor &amp; (-xor);<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-type">int</span> <span class="hljs-variable">num2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> num : nums)&#123;<br>        <span class="hljs-keyword">if</span>((lowbit &amp; num) == <span class="hljs-number">0</span>)&#123;<br>            num1 ^= num;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            num2 ^= num;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)&#123;<br>        <span class="hljs-keyword">if</span>((lowbit &amp; i) == <span class="hljs-number">0</span>)&#123;<br>            num1 ^= i;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            num2 ^= i;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> num : nums)&#123;<br>        <span class="hljs-keyword">if</span>(num == num1)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;num1, num2&#125;;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(num == num2)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;num2, num1&#125;;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScript</title>
      <link href="/2022/11/12/front-end-technology/TypeScript/"/>
      <url>/2022/11/12/front-end-technology/TypeScript/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€-æ¦‚è¿°">ä¸€ æ¦‚è¿°</h2><ol type="1"><li>TypeScriptæ˜¯JavaScriptçš„è¶…é›†ï¼Œæ”¯æŒES6+æ ‡å‡†</li><li>ç”±å¾®è½¯å¼€å‘çš„è‡ªç”±å’Œå¼€æºçš„å˜æˆè¯­è¨€</li><li>å¯ç¼–è¯‘ä¸ºçº¯JS</li></ol><h2 id="äºŒ-è¯­æ³•">äºŒ è¯­æ³•</h2><h3 id="åŸºç¡€ç±»å‹">1 åŸºç¡€ç±»å‹</h3><p>TypeScriptç›¸æ¯”JavaScriptè€Œè¨€æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ <strong>ç±»å‹</strong></p><h4 id="å¸ƒå°”å€¼">1.1 å¸ƒå°”å€¼</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> isDone : <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;<br></code></pre></td></tr></table></figure><h4 id="æ•°å­—">1.2 æ•°å­—</h4><p>å’ŒJavaScriptä¸€æ ·ï¼ŒTypeScriptä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œä½¿ç”¨ç±»å‹<code>number</code>è¡¨ç¤ºã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> dec : <span class="hljs-built_in">number</span> = <span class="hljs-number">6</span>; <span class="hljs-comment">// åè¿›åˆ¶</span><br><span class="hljs-keyword">let</span> hex : <span class="hljs-built_in">number</span> = <span class="hljs-number">0x0C</span>; <span class="hljs-comment">// åå…­è¿›åˆ¶</span><br><span class="hljs-keyword">let</span> bin : <span class="hljs-built_in">number</span> = <span class="hljs-number">0b01</span>; <span class="hljs-comment">// äºŒè¿›åˆ¶</span><br><span class="hljs-keyword">let</span> oct : <span class="hljs-built_in">number</span> = <span class="hljs-number">0o74</span>; <span class="hljs-comment">// å…«è¿›åˆ¶</span><br></code></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²">1.3 å­—ç¬¦ä¸²</h4><p>ä½¿ç”¨<code>string</code>è¡¨ç¤ºæ–‡æœ¬æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨<code>"</code>æˆ–è€…<code>'</code>æ¥è¡¨ç¤ºå­—ç¬¦ä¸²</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> name : <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;curry&quot;</span>;<br></code></pre></td></tr></table></figure><p><strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong></p><p>æ¨¡æ¿å­—ç¬¦ä¸²ä½¿ç”¨ï¼ˆåå¼•å·ï¼‰åŒ…å›´ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨<code>$&#123; expr &#125;</code>åµŒå…¥è¡¨è¾¾å¼ï¼Œ<code>expr</code>æ—¢å¯ä»¥æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯å¯è®¡ç®—çš„è¡¨è¾¾å¼ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> name : <span class="hljs-built_in">string</span> = <span class="hljs-string">`zhhc`</span>;<br><span class="hljs-keyword">let</span> birth_year : <span class="hljs-built_in">number</span> = <span class="hljs-number">2002</span>;<br><span class="hljs-keyword">let</span> sentence : <span class="hljs-built_in">string</span> = <span class="hljs-string">`hello, i am <span class="hljs-subst">$&#123; name &#125;</span>, and my age is <span class="hljs-subst">$&#123; <span class="hljs-number">2022</span> - birth_year &#125;</span>`</span>;<br></code></pre></td></tr></table></figure><h4 id="æ•°ç»„">1.4 æ•°ç»„</h4><p>ä¸¤ç§å®šä¹‰æ–¹å¼</p><ol type="1"><li>```typescript // ç±»å‹åé¢åŠ [] let list : number[] = [1, 2, 3];<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><br><span class="hljs-number">2.</span> ```<span class="language-javascript">typescript</span><br><span class="language-javascript">   <span class="hljs-comment">// æ•°ç»„æ³›å‹ Array&lt;ç±»å‹&gt;</span></span><br><span class="language-javascript">   <span class="hljs-keyword">let</span> list : <span class="hljs-title class_">Array</span>&lt;number&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];</span><br></code></pre></td></tr></table></figure></li></ol><h4 id="å…ƒç»„">1.5 å…ƒç»„</h4><p>å…ƒç»„ç±»å‹è¡¨ç¤º <u>å·²çŸ¥æ•°é‡å’Œç±»å‹</u> çš„æ•°ç»„ï¼Œå„å…ƒç´ çš„ç±»å‹<u>ä¸å¿…ç›¸åŒ</u></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> x : [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>] = [<span class="hljs-string">&#x27;typescript&#x27;</span>, <span class="hljs-number">10</span>];<br></code></pre></td></tr></table></figure><h4 id="æšä¸¾">1.6 æšä¸¾</h4><p>æšä¸¾æ˜¯TypeScriptä¸­å¤šå‡ºæ¥çš„ï¼Œå’ŒCè¯­è¨€ç­‰é«˜çº§è¯­è¨€ç±»ä¼¼ï¼Œå¯ä»¥ä¸ºä¸€ç»„æ•°ç»„èµ‹äºˆæœ‰æ„ä¹‰çš„åå­—ï¼Œå¸®åŠ©ç†è§£ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<span class="hljs-title class_">Red</span>, <span class="hljs-title class_">Green</span>, <span class="hljs-title class_">Blue</span>&#125;<br><span class="hljs-keyword">let</span> c : <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>;<br></code></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡æšä¸¾å€¼å¾—åˆ°å…¶åå­—</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<span class="hljs-title class_">Red</span> = <span class="hljs-number">1</span>, <span class="hljs-title class_">Green</span>, <span class="hljs-title class_">Blue</span>&#125;<br><span class="hljs-keyword">let</span> green_name : <span class="hljs-built_in">string</span> = <span class="hljs-title class_">Color</span>[<span class="hljs-number">2</span>]; <span class="hljs-comment">// &quot;Green&quot;</span><br></code></pre></td></tr></table></figure><h4 id="ä»»æ„å€¼">1.7 ä»»æ„å€¼</h4><p>ä»»æ„å€¼(any)å…¶å®å°±åƒæ˜¯JavaScriptä¸­çš„å˜é‡ä¸€æ ·ï¼Œå¯ä»¥è¢«èµ‹äºˆä»»ä½•ç±»å‹çš„å€¼ï¼Œç¼–è¯‘å™¨ä¸ä¼šè¿›è¡Œæ£€æŸ¥ã€‚</p><p>å¯¹äºObjectç±»å‹çš„å˜é‡ï¼Œä½ å¯ä»¥èµ‹ä»»ä½•å€¼ï¼Œä½†æ˜¯ä¸èƒ½ä»»æ„è°ƒç”¨æ–¹æ³•ï¼Œå³ä¾¿å®ƒçœŸçš„æœ‰è¿™äº›æ–¹æ³•ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Any</span> : <span class="hljs-built_in">any</span> = <span class="hljs-number">4</span>;<br><span class="hljs-title class_">Any</span> = <span class="hljs-string">&quot;Curry&quot;</span>;<br><span class="hljs-title class_">Any</span> = <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">let</span> anyObject : <span class="hljs-title class_">Object</span> = <span class="hljs-number">4</span>;<br>anyObject.<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>); <span class="hljs-comment">// Error</span><br><br><span class="hljs-keyword">let</span> list : <span class="hljs-built_in">any</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">&quot;free&quot;</span>];<br></code></pre></td></tr></table></figure><h4 id="ç©ºå€¼">1.8 ç©ºå€¼</h4><p>ç©ºå€¼ï¼ˆ<code>void</code>ï¼‰è¡¨ç¤ºæ²¡æœ‰ä»»ä½•ç±»å‹ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°æ²¡æœ‰è¿”å›å€¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>) : <span class="hljs-built_in">void</span>&#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p>å£°æ˜å˜é‡æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œåªèƒ½èµ‹å€¼<code>null</code>æˆ–<code>undefined</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> void_v : <span class="hljs-built_in">void</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// or undefined</span><br></code></pre></td></tr></table></figure><h4 id="null-undefined">1.9 Null / Undefined</h4><p>é»˜è®¤æƒ…å†µä¸‹ <code>null</code> å’Œ <code>undefined</code>æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼Œå³å¯ä»¥å°†å®ƒä»¬èµ‹å€¼ç»™å…¶ä»–ç±»å‹çš„å˜é‡ï¼Œä½†æ˜¯å¦‚æœæŒ‡å®šäº†<code>--strictNullChecks</code>ï¼Œé‚£ä¹ˆåªèƒ½èµ‹å€¼ç»™å„è‡ªç±»å‹äº†</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// without &#x27;--strictNullChecks&#x27;</span><br><span class="hljs-keyword">let</span> n : <span class="hljs-built_in">number</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">let</span> s : <span class="hljs-built_in">string</span> = <span class="hljs-literal">undefined</span>;<br><br><span class="hljs-comment">// with &#x27;--strictNullChecks&#x27;</span><br><span class="hljs-keyword">let</span> nll : <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">let</span> udfd : <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;<br></code></pre></td></tr></table></figure><h4 id="never">1.10 Never</h4><p><code>never</code>è¡¨ç¤ºæ°¸ä¸å­˜åœ¨å€¼çš„ç±»å‹ã€‚</p><p>å¯¹äºå‡½æ•°ï¼Œä¿®é¥°é‚£äº› ã€æŠ›å‡ºå¼‚å¸¸ã€‘ æˆ– ã€æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼ã€‘çš„å‡½æ•°ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">erro</span>(<span class="hljs-params">message : <span class="hljs-built_in">string</span></span>) : <span class="hljs-built_in">never</span> &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(message);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">deadLoop</span>(<span class="hljs-params"></span>) : <span class="hljs-built_in">never</span> &#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºå˜é‡ï¼Œ<code>never</code>ç±»å‹æ˜¯ä»»ä½•ç±»å‹çš„å­ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ï¼›ä½†æ˜¯<code>never</code>ç±»å‹çš„å˜é‡åªèƒ½ç”±<code>never</code>èµ‹å€¼ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> a : <span class="hljs-built_in">number</span> = <span class="hljs-built_in">never</span>; <span class="hljs-comment">// OK</span><br><br><span class="hljs-keyword">let</span> a : <span class="hljs-built_in">never</span> = <span class="hljs-built_in">any</span>; <span class="hljs-comment">// Error</span><br></code></pre></td></tr></table></figure><h4 id="ç±»å‹æ–­è¨€">1.11 ç±»å‹æ–­è¨€</h4><p>å‘Šè¯‰ç¼–è¯‘å™¨æŸä¸ªå˜é‡çš„ç±»å‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> s : <span class="hljs-built_in">any</span> = <span class="hljs-string">&quot;i am a string&quot;</span>;<br><br><span class="hljs-comment">// 1. &lt;æ–­è¨€ç±»å‹&gt;å˜é‡</span><br><span class="hljs-keyword">let</span> len : <span class="hljs-built_in">number</span> = (&lt;<span class="hljs-built_in">string</span>&gt;s).<span class="hljs-property">length</span>;<br><span class="hljs-comment">// 2. å˜é‡ as æ–­è¨€ç±»å‹</span><br><span class="hljs-keyword">let</span> len : <span class="hljs-built_in">number</span> = (s <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>).<span class="hljs-property">length</span>;<br></code></pre></td></tr></table></figure><h3 id="å˜é‡å£°æ˜">2 å˜é‡å£°æ˜</h3><p><code>TypeScript</code>ä¸­æ”¯æŒ<code>let</code>å’Œ<code>const</code>ï¼ŒJSåœ¨ES6å°±æ”¯æŒäº†ï¼Œä¸»è¦æ˜¯<code>let</code>å’Œ<code>var</code>çš„åŒºåˆ«ï¼šä¸»è¦å°±æ˜¯<code>var</code>æ˜¯å‡½æ•°çº§ä½œç”¨åŸŸï¼Œä½†æ˜¯<code>let</code>æ˜¯å—çº§ä½œç”¨åŸŸã€‚</p><h3 id="æ¥å£">3 æ¥å£</h3><p>TypeScriptä¸­æœ€æ ¸å¿ƒçš„åŸåˆ™ä¹‹ä¸€å°±æ˜¯<strong>ç±»å‹</strong>ï¼Œè€Œæ¥å£å°±æ˜¯ä¸ºç±»å‹æ£€æŸ¥ å®šä¹‰å¥‘çº¦ã€‚</p><p>åƒä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œ<code>printConfig</code>å‡½æ•°æ¥å—ä¸€ä¸ªç¬¦åˆ<code>config</code>æ¥å£çš„å‚æ•°ï¼Œè€Œ<code>config</code>æ¥å£å®šä¹‰äº†éœ€è¦å«æœ‰å€¼ç±»å‹ä¸º<code>string</code>çš„<code>name</code>å±æ€§</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> config&#123;<br>    name : <span class="hljs-built_in">string</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">printConfig</span>(<span class="hljs-params">Aconfig : config</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(config.<span class="hljs-property">name</span>);<br>&#125;<br><br><span class="hljs-keyword">let</span> cfg = &#123;name : <span class="hljs-string">&quot;my config&quot;</span>, size : <span class="hljs-number">10</span>&#125;;<br><span class="hljs-title function_">printConfig</span>(cfg);<br></code></pre></td></tr></table></figure><h4 id="å¯é€‰å±æ€§">å¯é€‰å±æ€§</h4><p>è¿™é‡Œé‡ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>ä¸€æ—¦æ¥å£ä¸­å®šä¹‰äº†å¯é€‰çš„å±æ€§ï¼Œé‚£ä¹ˆè¢«ä¿®é¥°çš„å˜é‡ä¸­åªèƒ½å­˜åœ¨è¦æ±‚çš„å±æ€§å’Œå¯é€‰çš„å±æ€§ï¼Œä¸èƒ½å‡ºç°å…¶ä¸­ä¸å­˜åœ¨çš„å±æ€§ã€‚</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> config&#123;<br>    name?: <span class="hljs-built_in">string</span>;<br>    size?: <span class="hljs-built_in">number</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">printConfig</span>(<span class="hljs-params">Aconfig : config</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(config.<span class="hljs-property">name</span>);<br>&#125;<br><br><span class="hljs-comment">// case one</span><br><span class="hljs-title function_">printConfig</span>(&#123;name : <span class="hljs-string">&quot;my config&quot;</span>, siz : <span class="hljs-number">10</span>&#125;); <span class="hljs-comment">// Error</span><br><br><span class="hljs-comment">// case two</span><br><span class="hljs-title function_">printConfig</span>(&#123;name : <span class="hljs-string">&quot;my config&quot;</span>, siz : <span class="hljs-number">10</span>&#125; <span class="hljs-keyword">as</span> config)<br><br><span class="hljs-comment">// case three</span><br><span class="hljs-keyword">let</span> c = &#123;name : <span class="hljs-string">&quot;my config&quot;</span>, siz : <span class="hljs-number">10</span>&#125;<br><span class="hljs-title function_">printConfig</span>(c);<br></code></pre></td></tr></table></figure><h4 id="å‡½æ•°ç±»å‹">å‡½æ•°ç±»å‹</h4><p>ä¸‹é¢è¿™ä¸ªæ¥å£å°±å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œå‚æ•°æ˜¯ä¸¤ä¸ª<code>number</code>ç±»å‹çš„å€¼ï¼Œè¿”å›ç±»å‹æ˜¯<code>boolean</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> func_temp&#123;<br>    (<span class="hljs-attr">n1</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">n2</span>: <span class="hljs-built_in">number</span>) : <span class="hljs-built_in">boolean</span>;<br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">func1</span>: func_temp;<br>func1 = <span class="hljs-keyword">function</span>(<span class="hljs-params">n1, n2</span>)&#123;<br>    <span class="hljs-keyword">return</span> n1 &gt; n2;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="å¯ç´¢å¼•çš„ç±»å‹">å¯ç´¢å¼•çš„ç±»å‹</h4><p>1ã€æ•°å­—ç´¢å¼•=ã€‹æ•°ç»„</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> number_index&#123;<br>    [index : <span class="hljs-built_in">number</span>] : <span class="hljs-built_in">string</span>;<br>&#125;<br><br><span class="hljs-keyword">let</span> a : number_index = [<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>]; <span class="hljs-comment">// a[1]</span><br></code></pre></td></tr></table></figure><p>2ã€å­—ç¬¦ä¸²ç´¢å¼•=ã€‹å­—å…¸</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> string_index&#123;<br>    [index : <span class="hljs-built_in">string</span>] : <span class="hljs-built_in">string</span>;<br>&#125;<br><br><span class="hljs-keyword">let</span> b : string_index = &#123;x : <span class="hljs-string">&quot;x&quot;</span>, y : <span class="hljs-string">&quot;y&quot;</span>&#125;; <span class="hljs-comment">// b[&#x27;x&#x27;]</span><br></code></pre></td></tr></table></figure><p>3ã€ç”±äºå½“ä½¿ç”¨<code>number</code>æ¥ç´¢å¼•æ—¶ï¼ŒJavaScriptä¼šå°†å®ƒè½¬æ¢æˆ<code>string</code>ç„¶åå†å»ç´¢å¼•å¯¹è±¡ã€‚æ‰€ä»¥å½“ä¸¤è€…ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ<code>number</code>ç´¢å¼•è¿”å›å€¼éœ€è¦æ˜¯<code>string</code>ç´¢å¼•è¿”å›å€¼çš„å­ç±»å‹ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span>&#123;<br>    <br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span>&#123;<br>    <br>&#125;<br><br><span class="hljs-keyword">interface</span> both_index&#123;<br>    [index : <span class="hljs-built_in">number</span>] : B;<br>    [index : <span class="hljs-built_in">string</span>] : A;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç±»ç±»å‹">ç±»ç±»å‹</h4><p>è¿™ä¸€éƒ¨åˆ†å°±å’Œå…¶ä»–é¢å‘å¯¹è±¡é«˜çº§è¯­è¨€ä¸­çš„ç±»ä¼¼äº†ã€‚</p><p>è¦æ³¨æ„ç±»é™æ€éƒ¨åˆ†å’Œå®ä¾‹éƒ¨åˆ†çš„åŒºåˆ«</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ACon</span>&#123;<br>    <span class="hljs-keyword">new</span> ();<br>&#125;<br><br><span class="hljs-comment">// Error</span><br><span class="hljs-comment">// å½“ä¸€ä¸ªç±»å®ç°äº†ä¸€ä¸ªæ¥å£ï¼Œåªä¼šå¯¹å…¶å®ä¾‹éƒ¨åˆ†è¿›è¡Œæ£€æŸ¥ï¼Œè€Œæ„é€ å‡½æ•°å±äºé™æ€éƒ¨åˆ†ã€‚</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ACon</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ACon</span>&#123;<br>    <span class="hljs-keyword">new</span> () : <span class="hljs-title class_">AInter</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">AInter</span>&#123;<br>    <span class="hljs-title function_">a_func</span>();<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">createA</span>(<span class="hljs-params">acon : ACon</span>) : <span class="hljs-title class_">AInter</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">acon</span>();<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AInter</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AInter</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> a1 = <span class="hljs-title function_">createA</span>(<span class="hljs-variable constant_">A1</span>);<br><span class="hljs-keyword">let</span> a2 = <span class="hljs-title function_">createA</span>(<span class="hljs-variable constant_">A2</span>);<br></code></pre></td></tr></table></figure><h4 id="æ··åˆç±»å‹">æ··åˆç±»å‹</h4><p>ä¸€ä¸ªå¯¹è±¡å³å¯ä»¥åŒæ—¶ä½œä¸ºå‡½æ•°å’Œå¯¹è±¡ä½¿ç”¨</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Counter</span> &#123;<br>    <span class="hljs-comment">// as a function</span><br>    (<span class="hljs-attr">start</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">string</span>;<br>    <span class="hljs-comment">// as a object</span><br>    <span class="hljs-attr">interval</span>: <span class="hljs-built_in">number</span>;<br>    <span class="hljs-title function_">reset</span>(): <span class="hljs-built_in">void</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getCounter</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Counter</span> &#123;<br>    <span class="hljs-keyword">let</span> counter = &lt;<span class="hljs-title class_">Counter</span>&gt;<span class="hljs-keyword">function</span> (<span class="hljs-params">start: <span class="hljs-built_in">number</span></span>) &#123; &#125;;<br>    counter.<span class="hljs-property">interval</span> = <span class="hljs-number">123</span>;<br>    counter.<span class="hljs-property">reset</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;;<br>    <span class="hljs-keyword">return</span> counter;<br>&#125;<br><br><span class="hljs-keyword">let</span> c = <span class="hljs-title function_">getCounter</span>();<br><span class="hljs-title function_">c</span>(<span class="hljs-number">10</span>);<br>c.<span class="hljs-title function_">reset</span>();<br>c.<span class="hljs-property">interval</span> = <span class="hljs-number">5.0</span>;<br></code></pre></td></tr></table></figure><h4 id="æ¥å£ç»§æ‰¿ç±»">æ¥å£ç»§æ‰¿ç±»</h4><p>å½“ä½¿ç”¨æ¥å£<code>A</code>å»ç»§æ‰¿ç±»<code>B</code>æ—¶ï¼Œå®ƒç»§æ‰¿ç±»<code>B</code>çš„æ‰€æœ‰æˆå‘˜ä½†ä¸åŒ…æ‹¬å®ç°ã€‚æ‰€ä»¥æŸä¸ªç±»æƒ³è¦å®ç°è¿™ä¸ªæ¥å£<code>A</code>ï¼Œè¿™ä¸ªç±»å¿…é¡»æ˜¯ç±»<code>B</code>æœ¬èº«æˆ–è€…æ˜¯ç±»<code>B</code>çš„å­ç±»ï¼Œå¦åˆ™å®ƒä¸èƒ½æ‹¥æœ‰æ¥å£<code>A</code>ä¸­çš„<code>private</code>å’Œ<code>protect</code>æˆå‘˜</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Control</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">state</span>: <span class="hljs-built_in">any</span>;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectableControl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Control</span> &#123;<br>    <span class="hljs-title function_">select</span>(): <span class="hljs-built_in">void</span>;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Control</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SelectableControl</span> &#123;<br>    <span class="hljs-title function_">select</span>(<span class="hljs-params"></span>) &#123; &#125;<br>&#125;<br><br><span class="hljs-comment">// Error: Property &#x27;state&#x27; is missing in type &#x27;Image&#x27;.</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Image</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SelectableControl</span> &#123;<br>    <span class="hljs-title function_">select</span>(<span class="hljs-params"></span>) &#123; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç±»">4 ç±»</h3><p>1ã€ç±»å‹å…¼å®¹ï¼šTypeScriptä½¿ç”¨çš„æ˜¯ç»“æ„æ€§ç±»å‹ç³»ç»Ÿï¼Œå½“æ¯”è¾ƒä¸¤ç§ä¸åŒçš„ç±»å‹æ—¶ï¼Œå¹¶ä¸åœ¨ä¹å®ƒä»¬ä»ä½•å¤„è€Œæ¥ï¼Œå¦‚æœæ‰€æœ‰çš„æˆå‘˜çš„ç±»å‹éƒ½æ˜¯å…¼å®¹çš„ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬çš„ç±»å‹æ˜¯å…¼å®¹çš„ã€‚ä½†æ˜¯å¯¹äºå¸¦æœ‰<code>private</code>æˆ–è€…<code>protected</code>æˆå‘˜çš„ç±»å‹æ—¶ï¼Œå°±éœ€è¦<code>private</code>å’Œ<code>protect</code>æˆå‘˜æ¥è‡ªäºåŒä¸€å¤„å£°æ˜æ—¶ï¼Œæ‰è®¤ä¸ºè¿™ä¸¤ä¸ªç±»å‹æ˜¯å…¼å®¹çš„ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-keyword">private</span> name : <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<span class="hljs-variable language_">super</span>();&#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span>&#123;<br>    <span class="hljs-keyword">private</span> name : <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">constuctor</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();<br><span class="hljs-keyword">let</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>();<br><br>a = b; <span class="hljs-comment">// OK</span><br>a = c; <span class="hljs-comment">// Error</span><br></code></pre></td></tr></table></figure><p>2ã€å‚æ•°å±æ€§ï¼šåœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨è®¿é—®é™å®šç¬¦ä¿®é¥°å‚æ•°ï¼Œä½¿ç±»çš„å±æ€§çš„å£°æ˜å’Œèµ‹å€¼åˆå¹¶åˆ°ä¸€å¤„</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Per</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> name : <span class="hljs-built_in">string</span></span>)&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€å­˜å–å™¨</p><p>TypeScriptæ”¯æŒé€šè¿‡getterå’Œsetteræ¥æˆªè·å¯¹å¯¹è±¡æˆå‘˜çš„è®¿é—®ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-keyword">private</span> _name : <span class="hljs-built_in">string</span>;<br>    <br>    <span class="hljs-keyword">get</span> <span class="hljs-title function_">name</span>() : <span class="hljs-built_in">string</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_name</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">set</span> <span class="hljs-title function_">name</span>(<span class="hljs-params">newName : <span class="hljs-built_in">string</span></span>)&#123;<br>        <span class="hljs-comment">//...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>getterå’Œsetteræ˜¯ä¼šåœ¨è®¿é—®ç›¸å…³å±æ€§æ—¶è‡ªåŠ¨è°ƒç”¨çš„ï¼Œè€Œä¸éœ€è¦æ˜¾å¼è°ƒç”¨ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br>a.<span class="hljs-property">_name</span> = <span class="hljs-string">&quot;zhhc&quot;</span>; <span class="hljs-comment">// æ‰§è¡Œ setter å‡½æ•°</span><br><span class="hljs-title function_">console</span>(a.<span class="hljs-property">_name</span>); <span class="hljs-comment">// æ‰§è¡Œ getter å‡½æ•°</span><br></code></pre></td></tr></table></figure><p>4ã€å…¶ä»–</p><p>æŠ½è±¡ç±»ã€ç»§æ‰¿ã€è®¿é—®ä¿®é¥°ç¬¦</p><p>5ã€é«˜çº§æŠ€å·§</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Greet</span> &#123;<br>    <span class="hljs-keyword">static</span> msg = <span class="hljs-string">&quot;Hello!&quot;</span>;<br>    greeting : <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">greet</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">greeting</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">greeting</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Greet</span>.<span class="hljs-property">msg</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">GreetMaker</span> : <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Greet</span> = <span class="hljs-title class_">Greet</span>; <span class="hljs-comment">// GreetMakeræ‹¥æœ‰äº†Greetç±»çš„é™æ€éƒ¨åˆ†ï¼ˆæ„é€ å‡½æ•°å’Œæ‰€æœ‰é™æ€å˜é‡ï¼‰</span><br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°">5 å‡½æ•°</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// named function</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>)&#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-comment">// anonymous function</span><br><span class="hljs-keyword">let</span> add = <span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) &#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç±»å‹">ç±»å‹</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span>&#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-keyword">let</span> add = <span class="hljs-keyword">function</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span>&#123;<br>    retunrn x + y;<br>&#125;<br><br><span class="hljs-comment">// å®Œæ•´ç±»å‹</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span> = <br>    <span class="hljs-keyword">function</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span> &#123; <span class="hljs-keyword">return</span> x + y; &#125;<br></code></pre></td></tr></table></figure><h4 id="å¯é€‰å‚æ•°">å¯é€‰å‚æ•°</h4><p>æ³¨æ„ï¼šå¯å˜å‚æ•°æ”¾æœ€å</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span>, z?: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span>&#123;<br>    <span class="hljs-keyword">if</span>(z)&#123;<br>        <span class="hljs-keyword">return</span> x + y + z;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> x + y;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="é»˜è®¤å‚æ•°">é»˜è®¤å‚æ•°</h4><p>1ã€é»˜è®¤å‚æ•°å¯ä»¥æ”¾åœ¨å¿…é¡»å‚æ•°çš„æœ€åé¢ï¼Œè¯¥å‚æ•°å¯ä»¥çœç•¥</p><p>2ã€é»˜è®¤å‚æ•°ä¹Ÿå¯ä»¥æ”¾åœ¨å¿…é¡»å‚æ•°çš„æœ€å‰é¢ï¼Œè¯¥å‚æ•°ä¸èƒ½çœç•¥ï¼Œéœ€è¦ä¼ é€’<code>undefined</code>è·å¾—è¿™ä¸ªé»˜è®¤å€¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y = <span class="hljs-number">10</span></span>) : <span class="hljs-built_in">number</span>&#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-keyword">let</span> a = <span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// OK</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x = <span class="hljs-number">10</span>, y: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span>&#123;<br>    <span class="hljs-keyword">return</span> x + y;<br>&#125;<br><br><span class="hljs-keyword">let</span> b = <span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// Error</span><br><span class="hljs-keyword">let</span> c = <span class="hljs-title function_">add</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// OK =&gt; 12</span><br></code></pre></td></tr></table></figure><h4 id="å‰©ä½™å‚æ•°">å‰©ä½™å‚æ•°</h4><p>å‰©ä½™å‚æ•°è‚¯å®šæ˜¯éœ€è¦æ”¾åœ¨å‚æ•°åˆ—è¡¨çš„æœ€å</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span>, ...nums: <span class="hljs-built_in">number</span>[]</span>) : <span class="hljs-built_in">number</span>&#123;<br>    int sum = x + y;<br>    <span class="hljs-keyword">for</span>(int i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-property">length</span>; i++)&#123;<br>        sum += nums[i];<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="this">this</h4><p>thisæ˜¯JSä¸­çš„ä¸€ä¸ªéš¾ç‚¹ã€‚åœ¨JavaScriptä¸­ï¼Œ<strong><code>this</code>çš„å€¼åœ¨è°ƒç”¨æ—¶æ‰ä¼šç¡®å®šï¼Œ</strong>è¿™å¯¼è‡´äº†thiså€¼ä¼šéšç€è°ƒç”¨ä¸Šä¸‹æ–‡çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> per = &#123;<br>    name : <span class="hljs-string">&quot;zhhc&quot;</span>,<br>    age : <span class="hljs-number">21</span>,<br>    hello : <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>            msg = <span class="hljs-string">&quot;I am &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&quot;, &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> + <span class="hljs-string">&quot;years old!&quot;</span>;<br>            <span class="hljs-keyword">return</span> msg;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Hello</span> = per.<span class="hljs-title function_">hello</span>();<br><span class="hljs-keyword">let</span> message = <span class="hljs-title class_">Hello</span>(); <span class="hljs-comment">// this =&gt; window</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);<br></code></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ES6çš„ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œç®­å¤´å‡½æ•°ã€‚åœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œ<code>this</code>çš„å€¼åœ¨åˆ›å»ºæ—¶å°±ç¡®å®šä¸‹æ¥äº†ï¼Œç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„<code>this</code>ï¼Œå®ƒåªä¼šä»è‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿<code>this</code>ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> per = &#123;<br>    name : <span class="hljs-string">&quot;zhhc&quot;</span>,<br>    age : <span class="hljs-number">21</span>,<br>    hello : <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>            msg = <span class="hljs-string">&quot;I am &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&quot;, &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> + <span class="hljs-string">&quot;years old!&quot;</span>;<br>            <span class="hljs-keyword">return</span> msg;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Hello</span> = per.<span class="hljs-title function_">hello</span>();<br><span class="hljs-keyword">let</span> message = <span class="hljs-title class_">Hello</span>(); <span class="hljs-comment">// this =&gt; per</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);<br></code></pre></td></tr></table></figure><h4 id="thiså‚æ•°">thiså‚æ•°</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br>    <span class="hljs-title function_">hello</span>(<span class="hljs-attr">this</span>: <span class="hljs-title class_">Person</span>): <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span>;<br>&#125;<br><br><span class="hljs-keyword">let</span> per : <span class="hljs-title class_">Person</span> = &#123;<br>    name : <span class="hljs-string">&quot;zhhc&quot;</span>,<br>    age : <span class="hljs-number">21</span>,<br>    hello : <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>: Person</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>            msg = <span class="hljs-string">&quot;I am &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&quot;, &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> + <span class="hljs-string">&quot;years old!&quot;</span>;<br>            <span class="hljs-keyword">return</span> msg;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Hello</span> = per.<span class="hljs-title function_">hello</span>();<br><span class="hljs-keyword">let</span> message = <span class="hljs-title class_">Hello</span>(); <span class="hljs-comment">// this =&gt; per</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);<br></code></pre></td></tr></table></figure><p>æ˜ç¡®åœ°å‘Šè¯‰<code>typescript</code>ï¼Œ<code>this</code>çš„ç±»å‹æ˜¯<code>Person</code>ï¼Œè€Œä¸æ˜¯<code>any</code></p><h4 id="å…¶ä»–">å…¶ä»–</h4><p>å‡½æ•°é‡è½½</p><h3 id="æ³›å‹">6 æ³›å‹</h3><p>æ³›å‹æ€»çš„æ¥è¯´å’ŒJavaçš„æ¯”è¾ƒç±»ä¼¼ã€‚</p><p>1ã€æ³›å‹å‡½æ•°</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> identity&lt;T&gt;(arg : T) : T &#123;<br>    <span class="hljs-keyword">return</span> arg<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ³›å‹æ¥å£</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">GenericFunc</span>&lt;T&gt;&#123;<br>    (<span class="hljs-attr">arg</span>: T) : T;<br>&#125;<br><br><span class="hljs-keyword">let</span> fn : <span class="hljs-title class_">GenericFunc</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">function</span>(<span class="hljs-params">arg : <span class="hljs-built_in">number</span></span>)&#123; <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * arg; &#125;<br></code></pre></td></tr></table></figure><p>3ã€æ³›å‹ç±»</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Calc</span>&lt;T&gt;&#123;<br>    <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">x: T, y: T</span>) =&gt;</span> T;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€æ³›å‹çº¦æŸ</p><p>ç”±äºæ³›å‹å‚æ•°æ˜¯é’ˆå¯¹æ‰€æœ‰ç±»å‹ï¼Œå°±ä¼šå¯¼è‡´ä¸èƒ½ä½¿ç”¨ä¸€äº›åªæœ‰æŸäº›ç±»å‹æ‰å…·å¤‡çš„å±æ€§ï¼Œä¾‹å¦‚<code>length</code>ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯åŠ ä¸Šæ³›å‹çº¦æŸï¼Œå¯¹æ³›å‹å‚æ•°åŠ ä¸Šä¸€å®šçš„é™åˆ¶ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">function</span> getLen&lt;T <span class="hljs-keyword">extends</span> &#123;<span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>&#125;&gt;(<span class="hljs-attr">arg</span>: T) : T&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">return</span> arg;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> front-end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> typescript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘åŸç†-Lab1</title>
      <link href="/2022/11/10/compilation-principle/compilation-principle-lab1/"/>
      <url>/2022/11/10/compilation-principle/compilation-principle-lab1/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€å®éªŒæ€è·¯">ä¸€ã€å®éªŒæ€è·¯</h2><p>æœ¬æ¬¡å®éªŒä¸»è¦æ˜¯å†™è¯æ³•åˆ†æå™¨ï¼Œå¯¹è¯­æ³•æ²¡æœ‰è¦æ±‚ï¼Œæ‰€ä»¥åœ¨<code>.g4</code>æ–‡ä»¶ä¸­åªè¦å†™å¯¹åº”çš„è¯æ³•å³å¯ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221110105750227.png" /></p><p>ç„¶åæ˜¯åœ¨<code>Main</code>å‡½æ•°ä¸­å¤„ç†é€»è¾‘ï¼Œç›¸åº”çš„ä»£ç åœ¨æ‰‹å†Œä¸­éƒ½å·²ç»™å‡ºï¼Œä¸»è¦éœ€è¦å®ç°æ˜¯</p><ol type="1"><li>è‡ªå·±çš„<code>MyErrorListener</code></li><li>å¤„ç†<code>tokens</code>çš„è¾“å‡º</li></ol><h3 id="myerrorlistener"><code>MyErrorListener</code></h3><p>é¦–å…ˆéœ€è¦çŸ¥é“ä»£ç æ˜¯å¦‚ä½•è°ƒç”¨è¿™ä¸ªç±»çš„ï¼Œæ‰€ä»¥æˆ‘åœ¨å®ç°çš„æ—¶å€™å…ˆå°†<code>BaseErrorListener</code>ä¸­çš„å‡½æ•°å…¨éƒ¨æ‹·è´åˆ°<code>MyErrorListener</code>ä¸­ï¼Œç„¶åå¯¹æ¯ä¸ªå‡½æ•°å¢åŠ ä¸€ä¸ª<code>System.out.println(...)</code>ï¼Œè¿™æ ·å°±å¯ä»¥çŸ¥é“åœ¨å‡ºç°é”™è¯¯æ˜¯ä¼šè°ƒç”¨å“ªä¸€ä¸ªå‡½æ•°ï¼Œæœ€åå‘ç°æ˜¯<code>syntaxError</code>å‡½æ•°ï¼Œç„¶åå°±å¯ä»¥å»<code>Lexer</code>ç±»ä¸­æ‰¾åˆ°å¯¹åº”è°ƒç”¨ä½ç½®ï¼ŒæŸ¥çœ‹æ˜¯å¦‚ä½•è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæœ€åç¼–å†™è¿™ä¸ªå‡½æ•°ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221110110552598.png" /></p><h3 id="tokensè¾“å‡º"><code>tokens</code>è¾“å‡º</h3><p>é¦–å…ˆç¡®å®š<code>getAllTokens</code>å‡½æ•°è¿”å›çš„ç±»å‹=&gt;<code>List&lt;? extends Token&gt;</code></p><p>åœ¨éå†<code>token</code>åˆ—è¡¨æ—¶è°ƒç”¨<code>Token</code>ç±»ä¸­å¯¹åº”å‡½æ•°æ¥è·å–è¡Œå·ã€ç±»å‹ç­‰ç›¸å…³ä¿¡æ¯ï¼Œå†åšè¾“å‡ºã€‚</p><blockquote><p>æ³¨æ„ï¼šå‡ºç°é”™è¯¯æ—¶ï¼Œåªè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221110110925468.png" /></p><h2 id="äºŒç¢°åˆ°çš„é—®é¢˜">äºŒã€ç¢°åˆ°çš„é—®é¢˜</h2><h3 id="è¾“å‡ºæ ¼å¼">1ã€è¾“å‡ºæ ¼å¼</h3><p>æ³¨æ„è¾“å‡ºæ ¼å¼è¦ä¸¥æ ¼æŒ‰ç…§æ‰‹å†Œè¦æ±‚ã€‚</p><h3 id="integr_constçš„å¤„ç†">2ã€<code>INTEGR_CONST</code>çš„å¤„ç†</h3><p>æ³¨æ„å…«è¿›åˆ¶æ•°å’Œåå…­è¿›åˆ¶æ•°çš„å¤„ç†ï¼Œè¾“å‡º<code>token</code>æ—¶æ˜¯éœ€è¦è¾“å‡ºå…¶åè¿›åˆ¶å€¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–è¯‘åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–è¯‘åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pointer networks</title>
      <link href="/2022/11/07/machine-learning/pointer-networks/"/>
      <url>/2022/11/07/machine-learning/pointer-networks/</url>
      
        <content type="html"><![CDATA[<p><a href="https://arxiv.org/abs/1506.03134">PointerNetworks</a>æå‡ºäº†ä¸€ç§æ–°çš„ neuralarchitectureï¼Œå¯ä»¥è§£å†³è¾“å‡ºåºåˆ—çš„å¤§å°éšç€è¾“å…¥åºåˆ—çš„å¤§å°è€Œå˜åŒ–çš„é—®é¢˜ã€‚æ–‡ç« å¼€å¤´è®²åˆ°ï¼Œä¼ ç»Ÿçš„seq2seqæ¨¡å‹ä»¥åŠAttentionMechanismï¼Œéƒ½åªèƒ½å¤„ç†å›ºå®šsizeçš„è¾“å…¥åºåˆ—ã€‚ä¸‹é¢ä¸»è¦å›´ç»•è¿™PointerNetworkå±•å¼€å­¦ä¹ ã€‚</p><p>é¦–å…ˆéœ€è¦å›é¡¾ seq2seq æ¨¡å‹ å’Œ Attention æœºåˆ¶</p><h2 id="seq2seq-model">1 Seq2Seq Model</h2><p>ä¼ ç»Ÿçš„ seq2seq model æ˜¯ç”±ä¸¤ä¸ª RNN æ„æˆï¼Œä¸€ä¸ªä½œä¸º Encoder ï¼Œå¦ä¸€ä¸ªä½œä¸ºDecoderã€‚åœ¨è¾“å…¥ input sequenceåï¼Œç”±Encoderè¿›è¡Œå¤„ç†ï¼Œå½¢æˆä¸€ä¸ª EncoderVector é€åˆ° Decoderï¼Œç”± Decoder äº§ç”Ÿæœ€ç»ˆç»“æœã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151535807.png" /></p><blockquote><p><ahref="https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346">UnderstandingEncoder-Decoder Sequence to Sequence Model</a></p></blockquote><ol type="1"><li>Encoder éƒ¨åˆ†ç”± è‹¥å¹²ä¸ª RNN å•å…ƒæ„æˆï¼Œæ¯ä¸ªå•å…ƒæ¥å—å‰ä¸€ä¸ªå•å…ƒçš„ hiddenstate å’Œå½“å‰ input sequence ä¸­çš„è¾“å…¥å…ƒç´ ï¼Œç”Ÿæˆæ–°çš„ hidden stateå¹¶ä¸”å‘å‰ä¼ é€’ã€‚<spanclass="math inline">\(h_{i}\)</span>è¡¨ç¤ºå‰é¢æ‰€æœ‰è¾“å…¥ä¿¡æ¯çš„ hiddenstateï¼Œè®¡ç®—å…¬å¼ä¸º <span class="math inline">\(h_{t} = f(W^{hh}h_{t-1} +W^{hx}x_{t})\)</span></li><li>Encoder Vectoræ˜¯Encoderéƒ¨åˆ†çš„è¾“å‡ºï¼Œä¹Ÿæ˜¯æœ€åä¸€ä¸ª hiddenstateï¼Œå¹¶ä½œä¸ºDecoderéƒ¨åˆ†çš„åˆå§‹hidden stateè¾“å…¥Decoderã€‚</li><li>Decoder éƒ¨åˆ†åŒæ ·ç”±è‹¥å¹²ä¸ª RNN å•å…ƒæ„æˆï¼Œæ¯ä¸ªå•å…ƒæ¥å—å‰ä¸€ä¸ªå•å…ƒçš„hidden stateï¼Œç”Ÿæˆå½“å‰çŠ¶æ€ä¸‹çš„ hidden stateï¼Œå¹¶é¢„æµ‹å½“å‰çš„è¾“å‡ºã€‚hiddenstateçš„å…¬å¼ä¸ºï¼š<span class="math inline">\(h_{t} =f(W^{hh}h_{t-1})\)</span>ï¼Œé¢„æµ‹è¾“å‡ºçš„å…¬å¼ä¸ºï¼š<spanclass="math inline">\(y_{t} = softmax(W^{s}h_{t})\)</span></li></ol><p>seq2seqæ¨¡å‹çš„ä¸€ä¸ªå¾ˆé‡è¦çš„å¥½å¤„åœ¨äº input sequence å’Œ output sequenceçš„å¤§å°å¯ä»¥ä¸ä¸€è‡´ã€‚</p><p>ä½†æ˜¯seq2seqä¸èƒ½å¤„ç† output dictionaryçš„å¤§å°ä¼šå‘ç”Ÿå˜åŒ–çš„ä»»åŠ¡ï¼Œå› ä¸ºseq2seqå¤„ç†ä¸€é¡¹ç‰¹å®šçš„ä»»åŠ¡æ—¶ï¼Œå…¶ outputdictionary æ˜¯ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹å›ºå®šçš„åŸŸï¼Œä½†æ˜¯åœ¨<ahref="https://arxiv.org/abs/1506.03134">PointerNetworks</a>æ–‡ç« ä¸­æ‰€æåˆ°çš„é—­åŒ…é—®é¢˜ç­‰ç»„åˆç›¸å…³é—®é¢˜ï¼Œå®ƒä»¬çš„ outputdictionary æ˜¯å’Œ input sequence å¯†åˆ‡ç›¸å…³çš„ã€‚æ¯”å¦‚ï¼Œç»™å®š10ä¸ªç‚¹ {<spanclass="math inline">\(P_{1}, P_{2}, ...,P_{10}\)</span>}ï¼Œè¦æ‰¾åˆ°ä¸€ä¸ªé—­åŒ…ï¼Œé‚£ç»“æœè‚¯å®šæ˜¯è¿™10ä¸ªç‚¹çš„å­é›†ï¼›å¦‚æœæ¢10ä¸ªç‚¹ï¼Œé‚£ç»“æœå°±åº”è¯¥æ˜¯æ–°çš„10ä¸ªç‚¹çš„å­é›†ã€‚</p><blockquote><p><ahref="https://kierszbaumsamuel.medium.com/pointer-networks-what-are-they-c3cb68fae076">Pointernetworks : What are they?</a></p></blockquote><h2 id="with-attention">2 with Attention</h2><p>ä¸Šé¢æåˆ°äº†ï¼Œseq2seqæ¨¡å‹çš„Encoderéƒ¨åˆ†å°†inputsequenceè½¬æ¢æˆä¸€ä¸ªvectorï¼Œä¹Ÿå«contextï¼ŒDecoderæ ¹æ®è¿™ä¸ªcontextåšè¾“å‡ºé¢„æµ‹ã€‚è¿™æ ·çš„è¯ï¼Œè¿™ä¸ªcontextvectorå°±æˆä¸ºæ¨¡å‹æ€§èƒ½çš„ç“¶é¢ˆäº†ï¼Œæ¨¡å‹è¾“å‡ºç»“æœçš„æ­£ç¡®æ€§å–å†³äºè¿™ä¸ªcontextvectorèƒ½å¤šå¥½åœ°è¡¨è¾¾input sequenceã€‚</p><p>å¼•å…¥Attentionæœºåˆ¶ï¼Œä½¿å¾—æ¨¡å‹ä¸“æ³¨åœ¨input sequenceçš„ç›¸å…³éƒ¨åˆ†ã€‚</p><p>Attentionæœºåˆ¶ä¸»è¦åœ¨ä¸¤ä¸ªåœ°æ–¹åšäº†æ”¹è¿›</p><ol type="1"><li><p>ç»™Decoderéƒ¨åˆ†ä¼ é€’<strong>æ‰€æœ‰çš„ hidden state</strong>ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªcontext vectorã€‚</p></li><li><p>åœ¨Decoderçš„æ¯ä¸€æ­¥ï¼Œä¸ºæ‰€æœ‰çš„ hidden state æ‰“åˆ†ï¼Œç”¨ softmaxåçš„åˆ†æ•°ä¹˜ä¸Šå¯¹åº”çš„ hidden stateï¼Œç„¶ååŠ å’Œå½¢æˆ<strong>è¿™ä¸€æ­¥çš„ contextvector</strong>ã€‚ä¹‹åï¼Œå¾—åˆ°çš„ context vector å’Œ Decoder hidden stateåšè¿æ¥ï¼Œå¾—åˆ°æ–°çš„ vector ä¼ é€’ç»™ <strong>feedforward neuralnetwork</strong>ï¼Œæœ€åå¾—åˆ°è¯¥æ­¥çš„è¾“å‡ºã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151644271.png" /></p></li></ol><p><strong>å®Œæ•´æ­¥éª¤</strong></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151605426.png" /></p><blockquote><p><ahref="http://jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/">VisualizingA Neural Machine Translation Model (Mechanics of Seq2seq Models WithAttention)</a></p></blockquote><p>ç„¶åæˆ‘ä»¬çœ‹çœ‹è®ºæ–‡ä¸­å¯¹äºAttentionæœºåˆ¶ç»™çš„å…¬å¼</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151703767.png" /></p><ol type="1"><li>ç¬¬â‘ ä¸ªå…¬å¼ç›¸å½“äºå°±æ˜¯ä¸Šé¢è¯´çš„æ‰“åˆ†ï¼Œå¾—åˆ°çš„<spanclass="math inline">\(u_{j}^{i}\)</span>è¡¨ç¤ºçš„æ˜¯åœ¨ time-step 'i'æ—¶ï¼Œå¯¹Encoderçš„ç¬¬ j ä¸ª hidden state çš„æ‰“åˆ†ã€‚</li><li>ç¬¬â‘¡ä¸ªå…¬å¼ï¼šä½¿ç”¨ <span class="math inline">\(softmax\)</span>å‡½æ•°å¯¹æ‰“åˆ†è¿›è¡Œå¤„ç†ã€‚</li><li>ç¬¬â‘¢ä¸ªå…¬å¼ï¼šå°† <span class="math inline">\(softmax\)</span> åçš„åˆ†æ•°<span class="math inline">\(\times\)</span> Encoderçš„å¯¹åº” hiddenstateï¼Œå¹¶åŠ å’Œç®—å‡ºè¿™ä¸€æ­¥çš„ context vectorã€‚</li></ol><h2 id="pointer-networks">3 Pointer Networks</h2><p>è€Œ Pointer Network æ‰€åšçš„æ”¹å˜å°±æ˜¯ï¼Œ<strong>åœ¨ <spanclass="math inline">\(softmax\)</span> å‡½æ•°å¤„ç†å®Œæ‰“åˆ†åï¼Œé€‰æ‹©å…¶ä¸­æœ€å¤§æƒé‡ çš„å…ƒç´ ç›´æ¥ä½œä¸ºè¯¥æ­¥çš„è¾“å‡º</strong>ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151722007.png" /></p><p>å¦‚å›¾ï¼Œç¬¬ä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºæ˜¯ "1"ï¼Œé‚£ä¹ˆåœ¨ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œè¾“å…¥<spanclass="math inline">\([x_1,y_1]\)</span>çš„ç›¸åº”tokenå’Œä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„hidden state ä¼šè¢«ä¼ é€’ç»™ç½‘ç»œä»¥è®¡ç®—å½“å‰çš„ hidden stateã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230223151744258.png" /></p><p>è¿™æ ·å°±ä½¿å¾—è¾“å‡ºåºåˆ—å®Œå…¨å–å†³äºè¾“å…¥åºåˆ—ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆå¥½é€‚åº”è¾“å…¥åºåˆ—å¤§å°çš„å˜åŒ–ã€‚</p><h2 id="ptrçš„åº”ç”¨">4 Ptrçš„åº”ç”¨</h2><h3 id="abstractive-text-summarization">abstractive textsummarization</h3><p>é¦–å…ˆ<code>text summarization</code>åˆ†ä¸º<code>extractive</code>å’Œ<code>abstractive</code>ä¸¤ç§ï¼Œ<code>extractive</code>æ˜¯æŒ‡é€šè¿‡é€‰æ‹©å’Œé‡ç»„åŸæ–‡ä¸­çš„å¥å­æˆ–çŸ­è¯­å½¢æˆçš„<code>summarization</code>ï¼Œè€Œ<code>abstractive</code>æ˜¯æŒ‡æ›´é«˜çº§çš„æ¦‚æ‹¬ï¼Œä¼šäº§ç”Ÿå…¨æ–°çš„è¯è¯­ï¼Œåƒäººå†™<code>abstract</code>é‚£æ ·ã€‚</p><p><a href="https://arxiv.org/abs/1704.04368">Get To The Point:Summarization with Pointer-GeneratorNetworks</a>ä»‹ç»äº†ä¸€ç§<code>hybrid pointer-generator network</code>+<code>coverage mechanism</code>çš„æ¶æ„æ¥å¤„ç†è¿™ä¸€ä»»åŠ¡ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³ï¼šâ‘ ä¸èƒ½å‡†ç¡®å†ç°ç»†èŠ‚ï¼›â‘¡ä¸èƒ½å¤„ç†è¶…å‡ºè¯æ±‡è¡¨ä»¥å¤–çš„å•è¯ï¼›â‘¢å‡ºç°é‡å¤ã€‚å…¶ä¸­<code>hybrid pointer-generator network</code>ä¸»è¦è§£å†³â‘ â‘¡ï¼Œè€Œ<code>coverage mechanism</code>è§£å†³â‘¢ã€‚</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221118003614644.png" /></p><p>ä¸Šå›¾ä¸»è¦æ˜¯<code>hybrid pointer-generator network</code>çš„ç»“æ„ã€‚ä¹‹æ‰€ä»¥æ˜¯<code>hybrid</code>ï¼Œæ˜¯å› ä¸ºè¿™é‡Œä¸æ˜¯å•çº¯ä½¿ç”¨<code>pointer</code>ï¼Œè€Œæ˜¯å°†<code>pointer</code>å’ŒåŸå…ˆ<code>seq2seq-with-attention</code>ç»“åˆèµ·æ¥çš„ã€‚ä»å›¾ä¸­æˆ‘ä»¬å¯çœ‹åˆ°æœ‰ä¸¤ä¸ª<code>distribution</code>ï¼Œä¸€ä¸ªæ˜¯<code>attention distribution</code>ï¼Œå®ƒå°±æ˜¯<code>pointer network</code>ä¸­çš„<code>pointer</code>ï¼Œååº”çš„æ˜¯<code>source text</code>ä¸­çš„åˆ†å¸ƒï¼›å¦ä¸€ä¸ªæ˜¯<code>vocabulary distribution</code>ï¼Œè¿™ä¸ªå°±æ˜¯æ­£å¸¸<code>seq2seq</code>æ¨¡å‹ä¼šäº§ç”Ÿçš„é’ˆå¯¹<code>output dictionary</code>çš„åˆ†å¸ƒã€‚è¿™ä¸¤ä¸ªåˆ†å¸ƒæ˜¯é€šè¿‡<spanclass="math inline">\(p_{gen}\)</span>ç»“åˆèµ·æ¥çš„ï¼Œæœ€åå½¢æˆä¸€ä¸ªæ€»çš„<code>distribution</code>ï¼Œç”±æ­¤äº§ç”Ÿç»“æœã€‚</p><p>è€Œ<code>coverage mechanism</code>åˆ™æ˜¯æ’å…¥åœ¨äº§ç”Ÿ<code>attention distribution</code>çš„æ­¥éª¤ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯ç”¨æ¥åæ˜ <code>source text</code>ä¸­å•è¯åœ¨ç»“æœä¸­çš„è¦†ç›–ç¨‹åº¦ï¼Œé€šè¿‡å°†å®ƒåŠ å…¥<code>attention distribution</code>çš„è®¡ç®—ä¸­ï¼Œèµ·åˆ°ä¸€ä¸ªåé¦ˆçš„ä½œç”¨ï¼Œä»è€Œæœ‰æ•ˆå‡å°‘é‡å¤é—®é¢˜ã€‚ï¼ˆä¸‹å¼çº¢æ¡†éƒ¨åˆ†å°±æ˜¯<code>coverage vector</code>ä½œä¸ºé¢å¤–è¾“å…¥ä¼ é€’ç»™<code>attention</code>æœºåˆ¶çš„è®¡ç®—ä¸­ï¼‰</p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221118004630172.png" /></p>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NLP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€è§„åˆ’åº”ç”¨</title>
      <link href="/2022/10/31/leetcode/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E5%BA%94%E7%94%A8%E9%A2%98/"/>
      <url>/2022/10/31/leetcode/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E5%BA%94%E7%94%A8%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€è‚¡ç¥¨é—®é¢˜">ä¸€ã€è‚¡ç¥¨é—®é¢˜(*)</h2><blockquote><p><ahref="https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/">188.ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV</a></p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ prices ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´  prices[i]æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ k ç¬”äº¤æ˜“ã€‚</p><p>æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p></blockquote><p>labuladongç®—æ³•ç§˜ç±ä¸­ä½¿ç”¨äº†ã€ä¸‰ä¸ª<strong>çŠ¶æ€</strong>ã€‘ï¼ˆä¸‰ç»´dpæ•°ç»„ï¼‰</p><ol type="1"><li>ç¬¬å‡ å¤©</li><li>æ‰‹ä¸­æ˜¯å¦æŒæœ‰è‚¡ç¥¨</li><li>æœ€å¤§äº¤æ˜“é™åˆ¶ï¼ˆæœ€å¤§äº¤æ˜“é™åˆ¶åªåœ¨ä¹°å…¥è‚¡ç¥¨æ—¶å‡ä¸€ï¼‰</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// dp[i][j][k] æ„å‘³ç€åœ¨ç¬¬iå¤©ï¼Œæ‰‹ä¸­æŒæœ‰(j=1)æˆ–ä¸æŒæœ‰(j=0)è‚¡ç¥¨ï¼Œæœ€å¤§äº¤æ˜“é™åˆ¶ä¸ºkæƒ…å†µä¸‹çš„æœ€å¤§åˆ©æ¶¦</span><br></code></pre></td></tr></table></figure><p><strong>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][<span class="hljs-number">0</span>][k] = Math.max(<br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][k],  <span class="hljs-comment">// ç¬¬iå¤© ä¸ä¹°å…¥ä¸å–å‡º: ç¬¬i-1å¤©ä¹Ÿæ²¡æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶è¿˜æ˜¯k</span><br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][k]+prices[i-<span class="hljs-number">1</span>] <span class="hljs-comment">// ç¬¬iå¤© å–å‡º: ç¬¬i-1å¤©æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶è¿˜æ˜¯k</span><br>);<br>dp[i][<span class="hljs-number">1</span>][k] = Math.max(<br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][k], <span class="hljs-comment">// ç¬¬iå¤© ä¸ä¹°å…¥ä¸å–å‡º: ç¬¬i-1å¤©æœ‰è‚¡ç¥¨ï¼Œäº¤æ˜“é™åˆ¶ä¸ºk</span><br>    dp[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>][k-<span class="hljs-number">1</span>]-prices[i-<span class="hljs-number">1</span>] <span class="hljs-comment">// ç¬¬iå¤© ä¹°å…¥: ç¬¬i-1å¤©æ²¡æœ‰è‚¡ç¥¨ï¼Œæœ€å¤§äº¤æ˜“æ¬¡æ•°ä¸èƒ½è¶…è¿‡k-1</span><br>);<br></code></pre></td></tr></table></figure><p><strong>base case</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>][...] = <span class="hljs-number">0</span>; dp[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>][...] = Integer.MIN_VALUE;<br>dp[...][<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; dp[...][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = Integer.MIN_VALUE;<br></code></pre></td></tr></table></figure><h2 id="äºŒæ‰“åŠ«å®¶èˆé—®é¢˜">äºŒã€æ‰“åŠ«å®¶èˆé—®é¢˜</h2><blockquote><p><ahref="%5B198.%20æ‰“å®¶åŠ«èˆ%20-%20åŠ›æ‰£ï¼ˆLeetCodeï¼‰%5D(https://leetcode.cn/problems/house-robber/)">198.æ‰“åŠ«å®¶èˆ</a></p><p><a href="https://leetcode.cn/problems/house-robber-ii/">213. æ‰“å®¶åŠ«èˆII</a></p><p><a href="https://leetcode.cn/problems/house-robber-iii/">337.æ‰“å®¶åŠ«èˆ III</a></p></blockquote><h3 id="æ‰“åŠ«å®¶èˆ">1ã€æ‰“åŠ«å®¶èˆ</h3><p>ã€çŠ¶æ€ã€‘æ˜¯ <u>æŠ¢åŠ«ç¬¬iå®¶æ—¶èƒ½è·å¾—çš„æœ€å¤§é‡‘é¢</u></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// çŠ¶æ€è½¬ç§»æ–¹ç¨‹</span><br>dp[i] = Math.max(dp[i-<span class="hljs-number">2</span>], dp[i-<span class="hljs-number">3</span>]) + nums[i];<br></code></pre></td></tr></table></figure><h3 id="æ‰“åŠ«å®¶èˆâ…±">2ã€æ‰“åŠ«å®¶èˆâ…¡</h3><blockquote><p>ç‰¹åˆ«ä¹‹å¤„åœ¨äº nums æ¢æˆäº†ç¯å½¢æ•°ç»„</p></blockquote><p>åº”å¯¹ç­–ç•¥ä¹Ÿååˆ†å·§å¦™</p><p><span class="math inline">\(f([x_{1}, x_{2}, ... , x_{n}]) = max(f([x_{1}, x_{2}, ..., x_{n-1}]), f([x_{2}, ..., x_{n}]) )\)</span></p><p><u><strong>æ—¢ç„¶é¦–å°¾ç›¸è¿äº†ï¼Œé‚£ä¹ˆè‚¯å®šæœ€å¤šåªèƒ½æŠ¢åŠ«ä¸€å®¶ï¼ŒæŠŠå¦å¤–ä¸€å®¶é™¤å»</strong></u>ï¼Œå°±æŠŠç¯å½¢æ•°ç»„åˆå˜æˆäº†æ™®é€šæ•°ç»„äº†ã€‚</p><h3 id="æ‰“åŠ«å®¶èˆâ…²">3ã€æ‰“åŠ«å®¶èˆâ…¢</h3><blockquote><p>æŠŠå®¶èˆçš„å½¢çŠ¶å˜æˆäº†äºŒå‰æ ‘</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">rob</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-type">int</span>[] res = dp(root);<br>        <span class="hljs-keyword">return</span> Math.max(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>]);<br>    &#125;<br><br>    <span class="hljs-comment">// return &#123;x, y&#125; </span><br>    <span class="hljs-comment">// x: åŒ…æ‹¬rootèŠ‚ç‚¹çš„æœ€é«˜é‡‘é¢ </span><br>    <span class="hljs-comment">// y: ä¸åŒ…å«rootèŠ‚ç‚¹çš„æœ€é«˜é‡‘é¢</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] dp(TreeNode root)&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br>        <span class="hljs-type">int</span>[] left = dp(root.left);<br>        <span class="hljs-type">int</span>[] right = dp(root.right);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> left[<span class="hljs-number">1</span>] + right[<span class="hljs-number">1</span>] + root.val;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> Math.max(left[<span class="hljs-number">1</span>], left[<span class="hljs-number">0</span>]) + Math.max(right[<span class="hljs-number">1</span>], right[<span class="hljs-number">0</span>]);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;x, y&#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä¸‰åšå¼ˆé—®é¢˜">ä¸‰ã€åšå¼ˆé—®é¢˜</h2><blockquote><p><a href="https://leetcode.cn/problems/predict-the-winner/">486.é¢„æµ‹èµ¢å®¶</a></p></blockquote><p>æœ€æ ¸å¿ƒæœ€å…³é”®çš„è¿˜æ˜¯åœ¨ã€æ‰¾çŠ¶æ€ã€‘ï¼Œç†è§£ï¼ï¼ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç¬¬ä¸€ç§æ¯”è¾ƒå®¹æ˜“ç†è§£çš„ï¼Œä¸‰ç»´æ•°ç»„</span><br><span class="hljs-comment">// dp[i][j][0] è¡¨ç¤ºåœ¨[xi...xj]åŒºé—´æ—¶ï¼Œå…ˆæ‰‹çš„æœ€å¤§å¾—åˆ†</span><br>dp[i][j][<span class="hljs-number">0</span>] = Math.max(nums[i]+dp[i+<span class="hljs-number">1</span>][j][<span class="hljs-number">1</span>], nums[j]+dp[i][j-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]);<br><span class="hljs-comment">// [i...j] å…ˆæ‰‹å¯ä»¥é€‰æ‹©iä¹Ÿå¯ä»¥é€‰æ‹©j</span><br><span class="hljs-comment">// é€‰æ‹©iåï¼Œåœ¨[i+1...j]åŒºé—´å°±å˜æˆäº†åæ‰‹ï¼Œå°±æ˜¯dp[i+1][j][1]</span><br><span class="hljs-comment">// é€‰æ‹©jåï¼Œåœ¨[i...j+1]åŒºé—´å°±å˜æˆäº†åæ‰‹ï¼Œå°±æ˜¯dp[i][j-1][1]</span><br><span class="hljs-keyword">if</span> å…ˆæ‰‹é€‰æ‹©äº†i: dp[i][j][<span class="hljs-number">1</span>] = dp[i+<span class="hljs-number">1</span>][j][<span class="hljs-number">0</span>];<br><span class="hljs-keyword">if</span> å…ˆæ‰‹é€‰æ‹©äº†j: dp[i][j][<span class="hljs-number">1</span>] = dp[i][j-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>];<br><br><br><span class="hljs-comment">// ç¬¬äºŒç§ç¨å¾®æ”¹è¿›ä¸€ç‚¹ï¼ŒäºŒç»´æ•°ç»„</span><br><span class="hljs-comment">// dp[i][j][1] è¡¨ç¤ºåœ¨[xi...xj]åŒºé—´æ—¶ï¼Œå…ˆæ‰‹çš„æœ€å¤§å¾—åˆ†-åæ‰‹çš„æœ€å¤§å¾—åˆ†</span><br>dp[i][j] = Math.max(nums[i] - dp[i+<span class="hljs-number">1</span>][j], nums[j] - dp[i][j-<span class="hljs-number">1</span>]);<br><span class="hljs-comment">// åœ¨[i...j]å…ˆæ‰‹åšå‡ºé€‰æ‹©åï¼Œå°±å˜æˆäº†åæ‰‹ï¼Œæ‰€ä»¥æ˜¯&lt;å‡&gt;</span><br></code></pre></td></tr></table></figure><h2 id="å››æ‰”é¸¡è›‹">å››ã€æ‰”é¸¡è›‹ï¼ˆ***ï¼‰</h2><blockquote><p><ahref="https://leetcode.cn/problems/super-egg-drop/">887.é¸¡è›‹æ‰è½</a></p><p>è¿™é“é¢˜ç†è§£ä¸Šéš¾åº¦å¾ˆé«˜...</p></blockquote><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221104212852347.png" /></p><p>è¿™é‡Œè®²ä¸€ä¸ªé€†å‘æ€ç»´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] è¡¨ç¤ºæœ‰jä¸ªé¸¡è›‹ï¼Œå¯ä»¥æ“ä½œiæ¬¡ï¼Œå¯ä»¥åœ¨æœ€é«˜dp[i][j]çš„å»ºç­‘é‡Œä¿è¯æ‰¾åˆ°f<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚<code>dp[2][1]=2</code>ï¼Œè¡¨ç¤ºæœ‰1ä¸ªé¸¡è›‹ï¼Œå¯ä»¥æ“ä½œ2æ¬¡ï¼Œå¯ä»¥åœ¨æœ€é«˜2æ¥¼çš„å»ºç­‘é‡Œä¿è¯æ‰¾åˆ°<code>f</code>ã€‚æ„æ€å°±æ˜¯å¦‚æœæ¥¼<code>&gt;=</code>3ï¼Œå°±ä¸èƒ½ä¿è¯åœ¨1ä¸ªé¸¡è›‹2æ¬¡æ“ä½œçš„æƒ…å†µä¸‹æ‰¾åˆ°fã€‚è¿™é‡Œçš„ä¿è¯æ˜¯æŒ‡ä¸ç®¡åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éƒ½å¯ä»¥æˆåŠŸæ‰¾åˆ°fï¼Œè€Œä¸æ˜¯è¯´æœ‰ä¸€å®šæ¦‚ç‡å¯ä»¥æ‰¾åˆ°ã€‚å¾ˆå¥½ç†è§£ï¼Œä¸ç®¡å¤šé«˜çš„æ¥¼å±‚ï¼Œå³ä½¿ç»™1ä¸ªé¸¡è›‹1æ¬¡æ“ä½œï¼Œä¹Ÿæœ‰ä¸€å®šæ¦‚ç‡å¯ä»¥æ‰¾åˆ°fï¼ˆç¬¬1å±‚å°±ç¢äº†ï¼Œæ‰€ä»¥<code>f=0</code>ï¼‰</p><p>ç†è§£å®ŒçŠ¶æ€ä¹‹åï¼Œå°±éœ€è¦æ‰¾åˆ°çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚å…ˆç»™å‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] = <span class="hljs-number">1</span> + dp[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>] + dp[i][j-<span class="hljs-number">1</span>];<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåº”è¯¥æ˜¯è¿™é“é¢˜æœ€éš¾ç†è§£çš„åœ°æ–¹ã€‚</p><h2 id="äº”è‡ªç”±ä¹‹è·¯">äº”ã€è‡ªç”±ä¹‹è·¯</h2><blockquote><p><a href="https://leetcode.cn/problems/freedom-trail/">514.è‡ªç”±ä¹‹è·¯</a><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221109163239286.png" /></p></blockquote><p>è¿™é“é¢˜ä¸€çœ¼çœ‹å»å’Œæ™®é€šçš„åŠ¨æ€è§„åˆ’æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œ<strong>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚æŸä¸ªæœ€å€¼</strong>ã€‚</p><p>ä½†æ˜¯è¿™é‡Œçš„<code>ring</code>æ˜¯ç¯å½¢çš„ï¼Œè€Œä¸”å¯ä»¥é¡ºæ—¶é’ˆ/é€†æ—¶é’ˆæ—‹è½¬ï¼Œå°±å¯¼è‡´æ¯æ¬¡çš„å±€éƒ¨æœ€ä¼˜å¯èƒ½å¾—ä¸åˆ°å…¨å±€æœ€ä¼˜ï¼Œæœ‰ç‚¹åƒå›æº¯ç®—æ³•ï¼Œéœ€è¦èµ°åˆ°æ›´åé¢æ‰èƒ½çŸ¥é“è¿™ä¸€æ¬¡çš„é€‰æ‹©æ˜¯å¦æ˜¯æ›´ä¼˜çš„ã€‚</p><p>æ‰€ä»¥éœ€è¦åœ¨æ¯ä¸€æ­¥éƒ½è¦åˆ—å‡ºæ‰€æœ‰æƒ…å†µï¼Œåœ¨æœ€åå†é€‰å‡ºæœ€å°çš„ã€‚</p><p>å¯ä»¥è¿™ä¹ˆå®šä¹‰<code>dp</code>æ•°ç»„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] è¡¨ç¤º åŒ¹é…keyçš„ç¬¬iä¸ªå­—ç¬¦æ—¶ ringçš„ç¬¬jä¸ªå­—ç¬¦æŒ‡å‘<span class="hljs-number">12</span>:<span class="hljs-number">00</span> (å½“ç„¶äº†ringçš„ç¬¬jä¸ªå­—ç¬¦å’Œkeyçš„ç¬¬iä¸ªå­—ç¬¦æ˜¯ç›¸åŒçš„) æ‰€éœ€è¦çš„æœ€å°æ­¥æ•°<br></code></pre></td></tr></table></figure><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] = Math.min( dp[i-<span class="hljs-number">1</span>][k] + Math.min( Math.abs(j-k), n - Math.abs(j-k) ) ) kæ˜¯ringä¸­æ‰€æœ‰å­—ç¬¦ç­‰äºkey[i-<span class="hljs-number">1</span>]çš„ä¸‹æ ‡é›†åˆ<br></code></pre></td></tr></table></figure><p>å«ä¹‰æ˜¯ï¼šå½“ç”¨ringçš„ç¬¬jä¸ªå­—ç¬¦å»åŒ¹é…keyçš„ç¬¬iä¸ªå­—ç¬¦æ—¶ï¼Œæ‰€éœ€è¦çš„æœ€å°æ­¥æ•°åº”è¯¥è¿™ä¹ˆæ±‚</p><p>åˆ—ä¸¾å‡ºå‰ä¸€æ¬¡åŒ¹é…çš„æ‰€æœ‰æƒ…å†µ<span class="math inline">\(dp[i-1][k], k\in[keyçš„ç¬¬i-1ä¸ªå­—ç¬¦åœ¨ringä¸­çš„ä¸‹æ ‡é›†åˆ]\)</span>ï¼Œè®¡ç®—ä»æ¯ä¸€æ¬¡çš„æƒ…å†µèµ°åˆ°å½“å‰æƒ…å†µéœ€è¦çš„æ›´å°çš„æ­¥æ•°ï¼ˆå› ä¸ºå¯ä»¥é¡ºæ—¶é’ˆè½¬ä¹Ÿå¯ä»¥é€†æ—¶é’ˆè½¬ï¼‰ï¼Œæœ€åå–è¿™äº›æƒ…å†µçš„æœ€å°å€¼ã€‚</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findRotateSteps</span><span class="hljs-params">(String ring, String key)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> ring.length(); <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> key.length();<br>    <span class="hljs-comment">// å°†ringä¸­çš„å­—ç¬¦è½¬æ¢ä¸ºå¯¹åº”ä¸‹æ ‡</span><br>    List&lt;Integer&gt;[] char2idx = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>[<span class="hljs-number">26</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">26</span>; i++)&#123;<br>        char2idx[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        char2idx[ring.charAt(i) - <span class="hljs-string">&#x27;a&#x27;</span>].add(i);<br>    &#125;<br>    <span class="hljs-comment">// å®šä¹‰å¹¶åˆå§‹åŒ–dpæ•°ç»„</span><br>    <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n][m];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i ++) Arrays.fill(dp[i], <span class="hljs-number">0x3f3f3f</span>);<br>    <span class="hljs-comment">// base case: dp[0][...]</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i : char2idx[key.charAt(<span class="hljs-number">0</span>) - <span class="hljs-string">&#x27;a&#x27;</span>])&#123;<br>        dp[<span class="hljs-number">0</span>][i] = Math.min( i, m-i ) + <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-comment">// é€’æ¨è¿‡ç¨‹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j : char2idx[key.charAt(i) - <span class="hljs-string">&#x27;a&#x27;</span>])&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k : char2idx[key.charAt(i-<span class="hljs-number">1</span>) - <span class="hljs-string">&#x27;a&#x27;</span>])&#123;<br>                dp[i][j] = Math.min(<br>                    dp[i][j],<br>                dp[i-<span class="hljs-number">1</span>][k] <br>                    + Math.min( <br>                    Math.abs(j-k),<br>                        m-Math.abs(j-k)<br>                      ) <br>                    + <span class="hljs-number">1</span><br>                );<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> Arrays.stream(dp[n-<span class="hljs-number">1</span>]).min().getAsInt();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…­k-ç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­">å…­ã€K ç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­</h2><blockquote><p><ahref="https://leetcode.cn/problems/cheapest-flights-within-k-stops/">787.Kç«™ä¸­è½¬å†…æœ€ä¾¿å®œçš„èˆªç­</a></p><p><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221112013321045.png" /></p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221112013403828.png"alt="image-20221112013403828" /><figcaption aria-hidden="true">image-20221112013403828</figcaption></figure></blockquote><p>è¿™é“é¢˜æ—¢å¯ä»¥ä½¿ç”¨Dijkstraç®—æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ¥è§£å†³ã€‚</p><p>è¿™é“é¢˜çš„èµ·ç‚¹å’Œç»ˆç‚¹æ˜¯ç¡®å®šçš„ï¼Œåœ¨çŠ¶æ€è½¬ç§»è¿‡ç¨‹ä¸­é€‰å®šä¸€ä¸ªä¸å˜ï¼Œå°†å¦ä¸€ä¸ªä½œä¸ºçŠ¶æ€ï¼Œç„¶åå¦å¤–ä¸€ä¸ªçŠ¶æ€å°±æ˜¯ä¸­è½¬ç«™æ•°k(æˆ–è€…ä½¿ç”¨è¾¹æ•°æ¥è¡¨ç¤º)</p><p>è¿™é‡Œå°†<code>src</code>å›ºå®šï¼Œå°†ç»ˆç‚¹å’Œä¸­è½¬ç«™æ•°ä½œä¸ºçŠ¶æ€ï¼Œå¯ä»¥å†™å‡ºå¦‚ä¸‹è½¬ç§»æ–¹ç¨‹</p><p><span class="math inline">\(price(k,dst) = min(price(k-1, v) +val(v,dst))\)</span><code>v</code>æ˜¯è·ç¦»<code>dst</code>è¿˜æœ‰ä¸€æ­¥çš„èŠ‚ç‚¹ï¼Œ<spanclass="math inline">\(val(v,dst)\)</span>æŒ‡è¾¹çš„ä»·å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;<span class="hljs-type">int</span>[]&gt;[] graph;<br><span class="hljs-type">int</span> <span class="hljs-variable">inf</span> <span class="hljs-operator">=</span> <span class="hljs-number">999999</span>;<br><span class="hljs-type">int</span> src;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findCheapestPrice</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span>[][] flights, <span class="hljs-type">int</span> src, <span class="hljs-type">int</span> dst, <span class="hljs-type">int</span> k)</span> &#123;<br>    <span class="hljs-built_in">this</span>.src = src;<br>    graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>[];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) graph[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] flight : flights)&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">1</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">2</span>];<br>        graph[to].add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;from, price&#125;);<br>    &#125;<br>    <br>    <span class="hljs-type">int</span>[][] mem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[k+<span class="hljs-number">2</span>][n];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; k+<span class="hljs-number">2</span>; i++) Arrays.fill(mem[i], inf);<br>    <br>    <span class="hljs-type">int</span> <span class="hljs-variable">ans</span> <span class="hljs-operator">=</span> dp(dst, k+<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> ans == inf ? -<span class="hljs-number">1</span> : ans;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">dp</span><span class="hljs-params">(<span class="hljs-type">int</span> d, <span class="hljs-type">int</span> k)</span>&#123;<br>    <span class="hljs-keyword">if</span>(d == src) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span>(k == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> inf;<br>    <br>    <span class="hljs-keyword">if</span>(mem[k][d] != inf)&#123;<br>        <span class="hljs-keyword">return</span> mem[k][d];<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] prev : graph[d])&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">sub_ans</span> <span class="hljs-operator">=</span> dp(prev[<span class="hljs-number">0</span>], k-<span class="hljs-number">1</span>);<br>        mem[k][d] = Math.min(mem[k][d], sub_ans + prev[<span class="hljs-number">1</span>]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> mem[k][d];<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ›´åŠ ç®€ä¾¿çš„ï¼Œå»æ±‚æ‰€æœ‰ä»srcå¼€å§‹èµ°1æ­¥ã€2æ­¥ã€...ã€k+1æ­¥åˆ°è¾¾æŸèŠ‚ç‚¹çš„æœ€å°ä»£ä»·ï¼šä½¿ç”¨<code>dp[i][j]</code>è¡¨ç¤ºä»<code>src</code>èµ°<code>i</code>æ­¥åˆ°<code>j</code>èŠ‚ç‚¹æ‰€éœ€è¦çš„æœ€å°ä»£ä»·ã€‚æœ€ååªè¦æ±‚<spanclass="math inline">\(min(dp[1][dst],dp[2][dst],...,dp[k+1][dst])\)</span>å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findCheapestPrice</span><span class="hljs-params">(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span>[][] flights, <span class="hljs-type">int</span> src, <span class="hljs-type">int</span> dst, <span class="hljs-type">int</span> k)</span> &#123;<br>    <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[k+<span class="hljs-number">2</span>][n];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= k+<span class="hljs-number">1</span>; i++) Arrays.fill(dp[i], <span class="hljs-number">999999</span>);<br>    dp[<span class="hljs-number">0</span>][src] = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= k+<span class="hljs-number">1</span>; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] flight : flights)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">0</span>];<br>            <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">1</span>];<br>            <span class="hljs-type">int</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> flight[<span class="hljs-number">2</span>];<br>            dp[i][to] = Math.min(dp[i][to], dp[i-<span class="hljs-number">1</span>][from]+price);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">999999</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= k+<span class="hljs-number">1</span>; i++)&#123;<br>        <span class="hljs-keyword">if</span>(res &gt; dp[i][dst])&#123;<br>            res = dp[i][dst];<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res == <span class="hljs-number">999999</span> ? -<span class="hljs-number">1</span> : res;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°6-å›¾è®º</title>
      <link href="/2022/10/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B06%EF%BC%88%E5%9B%BE%E8%AE%BA%EF%BC%89/"/>
      <url>/2022/10/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B06%EF%BC%88%E5%9B%BE%E8%AE%BA%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€å›¾è®ºåŸºç¡€">ä¸€ã€å›¾è®ºåŸºç¡€</h2><h3 id="å›¾çš„è¡¨ç¤º">1ã€å›¾çš„è¡¨ç¤º</h3><p>å›¾å¯ä»¥åˆ†ä¸ºï¼š</p><ul><li>æœ‰å‘æ— æƒå›¾</li><li>æœ‰å‘æœ‰æƒå›¾</li><li>æ— å‘æ— æƒå›¾</li><li>æ— å‘æœ‰æƒå›¾</li></ul><h4 id="é‚»æ¥è¡¨">1.1ã€é‚»æ¥è¡¨</h4><p>å¯¹äºé‚»æ¥è¡¨æ¥è¯´</p><ul><li><p>æœ‰å‘/æ— å‘ï¼šæ²¡æœ‰å½±å“ï¼Œåœ¨ç›¸åº”ç»“ç‚¹çš„é‚»å±…ç»“ç‚¹è¡¨ä¸­å¢å‡å³å¯</p></li><li><p>æœ‰æƒ/æ— æƒï¼šå¯¹ç»“æ„æœ‰ä¸€å®šå½±å“ã€‚</p><p>æœ‰æƒï¼š<code>List&lt;int[]&gt;[] graph</code>å…¶ä¸­<code>List</code>ä¸­çš„<code>int[]</code>æ”¾ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯ç»“ç‚¹å€¼ï¼Œä¸€ä¸ªæ˜¯æƒé‡</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;Integer&gt;[] graph; <span class="hljs-comment">// int[][] ç»“æ„ä¹Ÿå¯</span><br><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; graph.length; i++)&#123; <span class="hljs-comment">// éå†ç»“ç‚¹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; graph[i].length; j++)&#123; <span class="hljs-comment">// éå†æ¯ä¸ªç»“ç‚¹çš„é‚»å±…ç»“ç‚¹</span><br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="é‚»æ¥çŸ©é˜µ">1.2ã€é‚»æ¥çŸ©é˜µ</h4><p>å¯¹äºä¸´ç•ŒçŸ©é˜µæ¥è¯´</p><ul><li>æœ‰å‘/æ— å‘ï¼šéå†çŸ©é˜µçš„ã€å³ä¸Šè§’ã€‘å’Œã€å…¨éƒ¨ã€‘çš„åŒºåˆ«</li><li>æœ‰æƒ/æ— æƒï¼šçŸ©é˜µä¸­çš„å€¼æ˜¯<code>0/int</code>å’Œ<code>0/1</code>çš„åŒºåˆ«</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[][] graph; <span class="hljs-comment">// n*nçš„çŸ©é˜µ</span><br><br><span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> graph.length;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123; <span class="hljs-comment">// éå†èµ·å§‹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; n; j++)&#123; <span class="hljs-comment">// éå†ç»ˆæ­¢ç»“ç‚¹</span><br>        graph[i][j] <span class="hljs-comment">// 1è¡¨ç¤ºå­˜åœ¨ä»iç»“ç‚¹åˆ°jç»“ç‚¹çš„è·¯å¾„</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å›¾çš„éå†">2ã€å›¾çš„éå†</h3><p>å›¾çš„éå†ä¸€èˆ¬ç¨‹åº¦ä¸Šå¯ä»¥ç†è§£ä¸ºå¤šå‰æ ‘çš„éå†ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ã€ç¯çš„å­˜åœ¨ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span> visited; <span class="hljs-comment">// è®°å½•ç»“ç‚¹æ˜¯å¦å·²ç»è®¿é—®è¿‡</span><br>List&lt;Integer&gt; path; <span class="hljs-comment">// è®°å½•ä¸€æ¡è·¯å¾„</span><br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(Graph graph, <span class="hljs-type">int</span> s)</span>&#123;<br>    <span class="hljs-keyword">if</span>(visited[s])&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    visited[s] = <span class="hljs-literal">true</span>;<br>    path.add(s);<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> neighbor : graph.neighbors(s))&#123;<br>        traversal(graph, neighbor);<br>    &#125;<br>    <span class="hljs-comment">// å›æº¯</span><br>    path.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(s));<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜">3ã€ä¾‹é¢˜</h3><p>ã€797. æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ã€‘</p><blockquote><p>ç»™ä½ ä¸€ä¸ªæœ‰ n ä¸ªèŠ‚ç‚¹çš„ æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰ä»èŠ‚ç‚¹ 0 åˆ°èŠ‚ç‚¹n-1 çš„è·¯å¾„å¹¶è¾“å‡ºï¼ˆä¸è¦æ±‚æŒ‰ç‰¹å®šé¡ºåºï¼‰</p><p>graph[i] æ˜¯ä¸€ä¸ªä»èŠ‚ç‚¹ i å¯ä»¥è®¿é—®çš„æ‰€æœ‰èŠ‚ç‚¹çš„åˆ—è¡¨ï¼ˆå³ä»èŠ‚ç‚¹ i åˆ°èŠ‚ç‚¹graph[i][j]å­˜åœ¨ä¸€æ¡æœ‰å‘è¾¹ï¼‰ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;List&lt;Integer&gt;&gt; paths;<br>List&lt;Integer&gt; path;<br><span class="hljs-keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="hljs-title function_">allPathsSourceTarget</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph)</span> &#123;<br>    paths = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    path = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <br>    traversal(graph, <span class="hljs-number">0</span>, graph.length - <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">return</span> paths;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> begin, <span class="hljs-type">int</span> end)</span>&#123;<br>    path.add(begin);<br>    <span class="hljs-keyword">if</span>(begin == end) &#123;<br>        paths.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(path));<br>        path.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(begin));<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; graph[begin].length; i++)&#123;<br>        traversal(graph, graph[begin][i], end);<br>    &#125;<br>    path.remove(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(begin));<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒæ‹“æ‰‘æ’åº">äºŒã€æ‹“æ‰‘æ’åº</h2><h3 id="å›¾çš„ç”Ÿæˆä¸éå†">0ã€å›¾çš„ç”Ÿæˆä¸éå†</h3><p>ç»™å®šå›¾çš„ç»“ç‚¹æ•°<code>n</code>ï¼Œä»¥åŠç»“ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»<code>dependency</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">n(int) èŠ‚ç‚¹æ•°</span><br><span class="hljs-comment">dependency(int[][]) ç»“ç‚¹ä¹‹é—´ä¾èµ–å…³ç³» dependency[i]æ˜¯ä¸€ä¸ª[from, to]çš„äºŒå…ƒæ•°ç»„</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">private</span> List&lt;Integer&gt;[] buildGraph(<span class="hljs-type">int</span> n, <span class="hljs-type">int</span>[][] dependency)&#123;<br>    List&lt;Integer&gt;[] graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">List</span>[n];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        graph[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] pair : dependency)&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">from</span> <span class="hljs-operator">=</span> pair[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> pair[<span class="hljs-number">1</span>];<br>        graph[from].add(to);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> graph;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯">1ã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span>[] visited;<br><span class="hljs-type">boolean</span>[] onPath;<br><span class="hljs-type">boolean</span> isCycle;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> s)</span>&#123;<br>    <span class="hljs-keyword">if</span>(onPath[s])&#123;<br>        isCycle = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(visited[s])&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    visited[s] = <span class="hljs-literal">true</span>;<br>    onPath[s] = <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> neighbor : graph[s])&#123;<br>        traversal(graph, neighbor);<br>    &#125;<br>    <br>    onPath[s] = <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ‹“æ‰‘åºåˆ—">2ã€æ‹“æ‰‘åºåˆ—</h3><blockquote><p><a href="https://leetcode.cn/problems/course-schedule/">207.è¯¾ç¨‹è¡¨</a></p></blockquote><p>å¦‚æœå›¾Gä¸­ä¸å­˜åœ¨ç¯ï¼ŒGä¸­æ‰€æœ‰é¡¶ç‚¹æ’æˆä¸€ä¸ªçº¿æ€§åºåˆ—ï¼Œä½¿å¾—å›¾ä¸­ä»»æ„ä¸€å¯¹é¡¶ç‚¹uå’Œvï¼Œè‹¥è¾¹&lt;u,v&gt;âˆˆE(G)ï¼Œåˆ™uåœ¨çº¿æ€§åºåˆ—ä¸­å‡ºç°åœ¨vä¹‹å‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ”¹é€ ä¸€ä¸‹traversalå‡½æ•°</span><br><span class="hljs-type">boolean</span>[] visited;<br><span class="hljs-type">boolean</span>[] onPath;<br><span class="hljs-type">boolean</span> isCycle;<br><br>List&lt;Integer&gt; postOrder;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> s)</span>&#123;<br>    <span class="hljs-keyword">if</span>(onPath[s])&#123;<br>        isCycle = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(visited[s])&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    onPath[s] = <span class="hljs-literal">true</span>;<br>    visited[s] = <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] neighbor : graph[s])&#123;<br>        traversal(graph, s);<br>    &#125;<br>    <br>    onPath[s] = <span class="hljs-literal">false</span>;<br>    postOrder.add(s);<br>&#125;<br><br><span class="hljs-comment">// æœ€åå†å°†postOrderé€†åºå¾—åˆ°å°±æ˜¯ç»“æœ</span><br></code></pre></td></tr></table></figure><p>ã€é‡ç‚¹ç†è§£ï¼šä¸ºä»€ä¹ˆå›¾çš„ååºéå†å°±æ˜¯æ‹“æ‰‘æ’åºã€‘</p><p>å¦‚æœå›¾ä¸­ä¸å­˜åœ¨ç¯ï¼Œé‚£ä¹ˆå›¾å°±å¯ä»¥çœ‹æˆæ˜¯ä¸€é¢—å¤šå‰æ ‘ï¼Œå¦‚å›¾ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20221029210620536.png"alt="image-20221029210620536" /><figcaption aria-hidden="true">image-20221029210620536</figcaption></figure><p>é‚£ä¹ˆä»ç»“ç‚¹<code>0</code>å¼€å§‹çš„ååºéå†çš„åºåˆ—ä¹‹ä¸€å°±æ˜¯<code>[7,9,16,11, |  6,10,8,19,2, |  3,4,5, |  0]</code></p><p>å…¶å®å°±æ˜¯ä»æœ€åº•å±‚åˆ°æœ€é«˜å±‚çš„æ’åˆ—ã€‚</p><p><strong>å®ƒæ»¡è¶³äº†<code>from</code>ç»“ç‚¹éƒ½åœ¨<code>to</code>ç»“ç‚¹çš„åé¢</strong>ï¼ˆæ‰€ä»¥æœ€åç»“æœéœ€è¦é€†åºï¼Œä½¿fromç»“ç‚¹åœ¨å‰é¢ï¼‰</p><p>ã€å±€éƒ¨ ==ã€‹å…¨å±€ã€‘</p><p>è€Œè¿™åªæ˜¯è¿™ä¸ªå›¾çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æŠŠè¿™éƒ¨åˆ†æŠ½è±¡æˆä¸€ä¸ªç»“ç‚¹<strong><code>S</code></strong>ï¼Œé‚£ä¹ˆåŒæ ·ä½¿ç”¨å‰é¢çš„å‡½æ•°ï¼Œåœ¨å¾—åˆ°çš„éå†ç»“æœä¸­ï¼Œå›¾ä¸­ç›´æ¥æŒ‡å‘æˆ–è€…é—´æ¥æŒ‡å‘<strong><code>S</code></strong>çš„ç»“ç‚¹éƒ½ä¼šåœ¨å…¶åé¢ï¼Œé€†åºä¹‹åå°±åœ¨å‰é¢ï¼Œæ‰€ä»¥å¾—å‡ºçš„ç»“æœå°±æ˜¯æ­£ç¡®çš„ã€‚</p><p>ï¼ˆåŒæ—¶åœ¨ç»†èŠ‚ä¸Š<code>visited</code>å’Œ<code>onPath</code>æ•°ç»„ä¿è¯ç»“ç‚¹åªè¢«éå†ä¸€æ¬¡ä»¥åŠä¸ä¼šå‡ºç°ç¯ï¼‰</p><h2 id="ä¸‰äºŒåˆ†å›¾">ä¸‰ã€äºŒåˆ†å›¾</h2><blockquote><p>äºŒåˆ†å›¾ï¼šç›´è§‚çš„ç†è§£å°±æ˜¯èƒ½å¤Ÿç”¨ä¸¤ç§é¢œè‰²ç»™ä¸€å¼ å›¾ä¸Šè‰²ï¼Œä½¿å¾—æ¯æ¡è¾¹ä¸¤ç«¯çš„ç»“ç‚¹é¢œè‰²ä¸åŒ</p></blockquote><h3 id="åˆ¤æ–­äºŒåˆ†å›¾">ã€åˆ¤æ–­äºŒåˆ†å›¾ã€‘</h3><p>æ€è·¯ï¼šä¸€è¾¹éå†ï¼Œä¸€è¾¹ç»™å›¾ä¸Šè‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">boolean</span>[] visited; <span class="hljs-comment">// è®°å½•ç»“ç‚¹æ˜¯å¦è¢«è®¿é—®</span><br><span class="hljs-type">boolean</span>[] color; <span class="hljs-comment">// è®°å½•ç»“ç‚¹çš„é¢œè‰² true å’Œ false ä¸¤ç§</span><br><span class="hljs-type">boolean</span> <span class="hljs-variable">isBinary</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBipartite</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> graph.length; <span class="hljs-comment">// ç»“ç‚¹æ•°</span><br>    visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];<br>    color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[n];<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        <span class="hljs-keyword">if</span>(!visited[i])<br>        traversal(graph, i); <span class="hljs-comment">// éå†ä¸åŒçš„liang</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> isBinary;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* è¿™é‡Œçš„ color è¢«newäº†ä¹‹åæ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ false ä¹Ÿå°±æˆäº†é»˜è®¤çš„é¢œè‰²ï¼Œåªéœ€è¦å»æ”¹å˜å¯¹åº”ç»“ç‚¹çš„é¢œè‰²å³å¯</span><br><span class="hljs-comment">* ç”±äºè¿™é‡Œçš„å›¾æ˜¯æ— å‘å›¾ï¼Œæ‰€ä»¥traversalä¸€ä¸ªç»“ç‚¹å°±æ˜¯éå†è¿™ä¸ªè¿é€šåˆ†æ”¯</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] graph, <span class="hljs-type">int</span> v)</span>&#123;<br>    <span class="hljs-keyword">if</span>(!isBinary) <span class="hljs-keyword">return</span>;<br>    <br>    visited[v] = <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> w : graph[v])&#123;<br>        <span class="hljs-keyword">if</span>(!visited[w])&#123;<br>            color[w] = !color[v];<br>            traversal(graph, w);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span>(color[w] == color[v])&#123;<br>                isBinary = <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å››union-find-ç®—æ³•">å››ã€Union-Find ç®—æ³•</h2><h3 id="union-findçš„ç®—æ³•æ€æƒ³">1ã€union-findçš„ç®—æ³•æ€æƒ³</h3><ul><li>åŸºæœ¬æ€æƒ³ï¼šç”¨ä¸‹æ ‡ä»£æ›¿å®é™…çš„ç»“ç‚¹ï¼Œparentæ•°ç»„å­˜å‚¨çˆ¶ç»“ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥è¾ƒä¸ºå¿«é€Ÿçš„å®ç°ã€åˆå¹¶ã€‘å’Œã€åˆ¤æ–­æ˜¯å¦ç›¸è¿ã€‘çš„æ“ä½œ</li><li>è¿›é˜¶æ€æƒ³ï¼šæ— è®ºæ˜¯ union æ“ä½œè¿˜æ˜¯ connected æ“ä½œï¼Œå…¶å¤æ‚åº¦çš„å±€é™éƒ½åœ¨äºfindå‡½æ•°ï¼Œå³ä»ä¸€ä¸ªç»“ç‚¹æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå¦‚æœè¿™ä¸ªç»“ç‚¹è·ç¦»ç»“ç‚¹è¶Šè¿‘ï¼Œå¤æ‚åº¦è¶Šä½ã€‚è€Œç»“ç‚¹ä¸æ ¹èŠ‚ç‚¹çš„è·ç¦»ä¸€æ–¹é¢å–å†³äºunionæ—¶çš„æ’å…¥æ–¹å¼ï¼Œå¦‚æœæ’å…¥ä¸å½“ï¼Œå°±å¯èƒ½å½¢æˆé“¾å¼çš„è¿é€šåˆ†é‡ï¼Œå¤æ‚åº¦æ˜¯æœ€é«˜çš„ï¼Œæˆ‘ä»¬å¸Œæœ›å°½é‡é™ä½æ ‘çš„é«˜åº¦ï¼Œå¯ä»¥åœ¨union ä¸­é‡‡å– ã€å°æ ‘æ’å¤§æ ‘ã€‘çš„æ–¹å¼ï¼Œä½¿å¾—æ ‘çš„é«˜åº¦å°½å¯èƒ½çš„å°ã€‚</li><li>è·¯å¾„å‹ç¼©ï¼šåœ¨ findè¿‡ç¨‹ä¸­ï¼Œåœ¨ä»å½“å‰ç»“ç‚¹å‘ä¸Šå¯»æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­çš„å‹ç¼©è·¯å¾„ï¼ˆå°†è¯¥ç»“ç‚¹è¿åˆ°å…¶çˆ¶ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ä¸Šï¼‰ï¼Œä½¿å¾—æ ‘çš„é«˜åº¦å§‹ç»ˆç»´æŒåœ¨å¸¸æ•°å¤æ‚åº¦ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UnionFind</span> &#123;<br>    <span class="hljs-type">int</span> count; <span class="hljs-comment">// è¿é€šåˆ†é‡ä¸ªæ•°</span><br>    <span class="hljs-type">int</span>[] parent; <span class="hljs-comment">// ç»“ç‚¹çš„çˆ¶èŠ‚ç‚¹</span><br>    <span class="hljs-type">int</span>[] size; <span class="hljs-comment">// è¯¥èŠ‚ç‚¹æ‰€å¤„è¿é€šåˆ†é‡çš„ç»“ç‚¹æ•°</span><br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UnionFind</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span>&#123;<br>        <span class="hljs-built_in">this</span>.count = n;<br>        parent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>        size = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>            parent[i] = i;<br>            size[i] = <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);<br>        <span class="hljs-keyword">if</span>(rootP == rootQ)&#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        * å°æ ‘æ’åˆ°å¤§æ ‘ä¸Šï¼Œä¿æŒæ ‘çš„å¹³è¡¡ ç»´æŒ logN çš„æ—¶é—´å¤æ‚åº¦</span><br><span class="hljs-comment">        * */</span><br>        <span class="hljs-keyword">if</span>(size[rootP] &gt; size[rootQ])&#123;<br>            parent[rootQ] = rootP;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            parent[rootP] = rootQ;<br>        &#125;<br>        size[rootP] += size[rootQ];<br>        size[rootQ] += size[rootP];<br>        count--;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">connected</span><span class="hljs-params">(<span class="hljs-type">int</span> p, <span class="hljs-type">int</span> q)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">rootP</span> <span class="hljs-operator">=</span> find(p);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">rootQ</span> <span class="hljs-operator">=</span> find(q);<br>        <span class="hljs-keyword">return</span> rootP == rootQ;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> p)</span>&#123;<br>        <span class="hljs-keyword">if</span>(p &gt;= parent.length) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (parent[p] != p)&#123;<br>            parent[p] = parent[parent[p]]; <span class="hljs-comment">// è·¯å¾„å‹ç¼© ä½¿å¾—æ‰€æœ‰éæ ¹ç»“ç‚¹éƒ½ç›´æ¥è¿æ¥åœ¨æ ¹ä¸Š ä½¿æ ‘é«˜ç»´æŒåœ¨2</span><br>            p = parent[p];<br>        &#125;<br>        <span class="hljs-keyword">return</span> p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">count</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> count;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="union-findç®—æ³•çš„åº”ç”¨">2ã€Union-Findç®—æ³•çš„åº”ç”¨</h3><h4 id="è¢«å›´ç»•çš„åŒºåŸŸ">2.1ã€130. è¢«å›´ç»•çš„åŒºåŸŸ</h4><blockquote><p>ç»™ä½ ä¸€ä¸ª <code>m x n</code> çš„çŸ©é˜µ <code>board</code> ï¼Œç”±è‹¥å¹²å­—ç¬¦<code>'X'</code> å’Œ <code>'O'</code> ï¼Œæ‰¾åˆ°æ‰€æœ‰è¢« <code>'X'</code>å›´ç»•çš„åŒºåŸŸï¼Œå¹¶å°†è¿™äº›åŒºåŸŸé‡Œæ‰€æœ‰çš„ <code>'O'</code> ç”¨ <code>'X'</code>å¡«å……ã€‚</p></blockquote><p>è¿™é“é¢˜å…¶å®ä½¿ç”¨DFSç®—æ³•å¯ä»¥å¾ˆå¥½åœ°è§£å†³ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å¯ä»¥ä½“ç°Union-Findç®—æ³•æ€æƒ³çš„ä¸€é“é¢˜ç›®</p><p><strong>åŠ æ·±å¯¹äºDFSç®—æ³•çš„ç†è§£</strong></p><p>DFSç®—æ³•æ˜¯æ·±åº¦ä¼˜å…ˆï¼Œåœ¨äºŒå‰æ ‘ä¸­ä½“ç°ä¸ºä»æ ¹èŠ‚ç‚¹ä¸æ–­åœ°å‘å¶èŠ‚ç‚¹å‰è¿›ï¼Œåœ¨å›¾ä¸­æ˜¯ä½“ç°ä¸ºä»ä¸€ä¸ªç»“ç‚¹ä¸æ–­åœ°å‘å…¶é‚»å±…ç»“ç‚¹å‰è¿›ã€‚</p><p>å…¶å®åœ¨è¿™é“é¢˜ä¸­ï¼ŒæŠŠè¿™ä¸ªçŸ©é˜µç†è§£ä¸ºä¸€å‰¯å›¾çš„è¯ï¼ŒDFSå°±æ˜¾å¾—æ¯”è¾ƒè‡ªç„¶äº†</p><p>1ã€éå†çŸ©é˜µçš„å››å‘¨ï¼Œå¦‚æœæ˜¯<code>'O'</code>ï¼Œåˆ™è¿›å…¥<code>dfs</code>ï¼Œå°†æ‰€æœ‰ä¸å…¶ç›¸è¿çš„<code>'O'</code>å˜æˆç‰¹æ®Šç¬¦å·</p><p>2ã€éå†çŸ©é˜µï¼Œå°†ç‰¹æ®Šç¬¦å·å˜å›<code>'O'</code>ï¼ŒæŠŠ<code>'O'</code>å˜æˆ<code>'X'</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä½¿ç”¨ DFS è§£å†³</span><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    x x x x</span><br><span class="hljs-comment">    x o x o</span><br><span class="hljs-comment">    x o o x</span><br><span class="hljs-comment">    o x x o</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    [è¦æ·±å…¥ç†è§£ dfs çš„å†…æ¶µ]</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    è¾¹ç•Œåæ ‡çš„ç‰¹ç‚¹: [0/m-1][0/n-1]</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">int</span> m;<br>    <span class="hljs-type">int</span> n;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] board)</span>&#123;<br>        m = board.length;<br>        n = board[<span class="hljs-number">0</span>].length;<br><br>        <span class="hljs-comment">// éå†boardçš„å››æ¡è¾¹</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-keyword">if</span>(board[i][j] == <span class="hljs-string">&#x27;O&#x27;</span>)&#123;<br>                dfsHelper(board, i, j);<br>            &#125;<br>            <span class="hljs-type">int</span>[] next = forward(i,j);<br>            i = next[<span class="hljs-number">0</span>];<br>            j = next[<span class="hljs-number">1</span>];<br>        &#125; <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>  || j &gt; <span class="hljs-number">0</span>); <span class="hljs-comment">// â‘  è€ƒè™‘åˆ° forward å‡½æ•°ä¼šè¿”å› &#123;-1, -1&#125; æ‰€ä»¥è¦æ”¹æˆ &gt;0</span><br><br>        <span class="hljs-comment">// éå†æ•´ä¸ªboard æŠŠ &#x27;O&#x27; æ¢æˆ &#x27;X&#x27; æŠŠ &#x27;#&#x27; æ¢æˆ &#x27;O&#x27;</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; a &lt; m; a++)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; b &lt; n; b++)&#123;<br>                <span class="hljs-keyword">if</span> (board[a][b] == <span class="hljs-string">&#x27;O&#x27;</span>) board[a][b] = <span class="hljs-string">&#x27;X&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (board[a][b] == <span class="hljs-string">&#x27;#&#x27;</span>) board[a][b] = <span class="hljs-string">&#x27;O&#x27;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    * è¿™é‡Œçš„ DFS å°±æœ‰äº›ä¸åŒäº æ ‘çš„ DFS</span><br><span class="hljs-comment">    * DFS: åªå¤„ç†ä¸€ä¸ªç»“ç‚¹ï¼Œç„¶åç”¨é€’å½’å‘å››å‘¨æ‰©æ•£æ·±å…¥</span><br><span class="hljs-comment">    * */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfsHelper</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] board, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span>&#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        è¿™é‡Œè¦æ”¹æˆ != &#x27;O&#x27; è€Œä¸æ˜¯ == &#x27;X&#x27;</span><br><span class="hljs-comment">        != &#x27;O&#x27; é’ˆå¯¹çš„æ˜¯ä¸¤ç§æƒ…å†µ == &#x27;X&#x27; å’Œ == &#x27;#&#x27;</span><br><span class="hljs-comment">        == &#x27;X&#x27; è‚¯å®šæ˜¯ç›´æ¥ return</span><br><span class="hljs-comment">        == &#x27;#&#x27; çš„æƒ…å†µï¼Œå…¶å®ä¹Ÿå¯ä»¥return å› ä¸ºè¿™ä¸ª &#x27;#&#x27; å‘¨å›´çš„æ ¼å­å·²ç»è¢«éå†è¿‡äº† (åœ¨å…¶ä»&#x27;O&#x27;å˜æˆ&#x27;#&#x27;ä¹‹å)</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">if</span>(board[x][y] != <span class="hljs-string">&#x27;O&#x27;</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">if</span>(board[x][y] == <span class="hljs-string">&#x27;O&#x27;</span>) board[x][y] = <span class="hljs-string">&#x27;#&#x27;</span>;<br><br>        <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) dfsHelper(board, x - <span class="hljs-number">1</span>, y); <span class="hljs-comment">// ä¸Š</span><br>        <span class="hljs-keyword">if</span> (x &lt; m - <span class="hljs-number">1</span>) dfsHelper(board, x + <span class="hljs-number">1</span>, y); <span class="hljs-comment">// ä¸‹</span><br>        <span class="hljs-keyword">if</span> (y &gt; <span class="hljs-number">0</span>) dfsHelper(board, x, y - <span class="hljs-number">1</span>); <span class="hljs-comment">// å·¦</span><br>        <span class="hljs-keyword">if</span> (y &lt; n - <span class="hljs-number">1</span>) dfsHelper(board, x, y + <span class="hljs-number">1</span>); <span class="hljs-comment">// å³</span><br>    &#125;<br><br>    <span class="hljs-comment">// åœ¨boardçš„å››ä¸ªè¾¹ä¸Šå‰è¿›</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] forward(<span class="hljs-type">int</span> i , <span class="hljs-type">int</span> j)&#123;<br>        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span> &amp;&amp; j &lt; n - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i, j + <span class="hljs-number">1</span>&#125;; <span class="hljs-comment">// ä¸Š å‘å³èµ°</span><br>        <span class="hljs-keyword">if</span> (j == n - <span class="hljs-number">1</span> &amp;&amp; i &lt; m - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i + <span class="hljs-number">1</span>, j&#125;; <span class="hljs-comment">// å³ å‘ä¸‹èµ°</span><br>        <span class="hljs-keyword">if</span> (i == m - <span class="hljs-number">1</span> &amp;&amp; j &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i, j - <span class="hljs-number">1</span>&#125;; <span class="hljs-comment">// ä¸‹ å‘å·¦èµ°</span><br>        <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span> &amp;&amp; i &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i - <span class="hljs-number">1</span>, j&#125;; <span class="hljs-comment">// å·¦ å‘ä¸Šèµ°</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>&#125;;<br>    &#125;<br></code></pre></td></tr></table></figure><p><strong>è¿™é“é¢˜ä¹Ÿæ˜¯å¾ˆå¥½çš„ä½“ç°ï¼ŒUnion-Findçš„æ€æƒ³åœ¨äºŒä½æ•°ç»„ï¼ˆçŸ©é˜µï¼‰ä¸­åˆ¤æ–­è¿é€šæ€§çš„ä¾‹å­</strong></p><ul><li>æ ¹æ®é¢˜æ„çŸ¥é“ï¼šåœ¨çŸ©é˜µçš„<code>'O'</code>åŠä¸å…¶ç›¸è¿çš„<code>'O'</code>æ˜¯å±äºä¸è¢«æ›¿æ¢çš„<code>'O'</code>ï¼Œå¯ä»¥ç®—ä½œä¸€ä¸ªè¿é€šåˆ†é‡ã€‚<strong>ã€åˆ©ç”¨ä¸€ä¸ªdummyç»“ç‚¹å’Œå®ƒä»¬ç›¸è¿ã€‘</strong>ï¼Œä¸ºä»€ä¹ˆå†æ‰¾ä¸€ä¸ªdummyç»“ç‚¹å‘¢ï¼Ÿæ–¹ä¾¿æŸ¥æ‰¾ã€‚åœ¨åç»­åˆ¤æ–­è¿™ä¸ª<code>'O'</code>æ˜¯å¦éœ€è¦è¢«æ›¿æ¢æ—¶ï¼Œåªéœ€è¦åˆ¤æ–­æ˜¯å¦å’Œè¿™ä¸ªdummyç»“ç‚¹è¿é€šå³å¯ã€‚</li><li>éå†å®Œå››å‘¨ä¹‹åï¼Œå†æ¬¡éå†å³å¯å®Œæˆæ›¿æ¢ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä½¿ç”¨ union-find è§£å†³</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uf</span><span class="hljs-params">(<span class="hljs-type">char</span>[][] board)</span>&#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> board.length;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> board[<span class="hljs-number">0</span>].length;<br>    <br>    <span class="hljs-comment">// æœ€åä¸€ä¸ªdummyä½œä¸º ä¸è¢« &#x27;X&#x27; æ›¿æ¢çš„&#x27;O&#x27; çš„è”é€šåˆ†é‡ä¸­çš„ä¸€ä¸ªç»“ç‚¹ æ¥å¯»æ‰¾è¯¥è¿é€šåˆ†é‡ä¸­çš„å…¶ä»–ç»“ç‚¹</span><br>    <span class="hljs-type">UnionFind</span> <span class="hljs-variable">uf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnionFind</span>(n*m+<span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <br>            <span class="hljs-type">int</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> i * n + j; <span class="hljs-comment">// äºŒç»´æ•°ç»„è½¬åŒ–ä¸ºä¸€ç»´</span><br>            <br>            <span class="hljs-comment">// å°†çŸ©é˜µå››å‘¨çš„&#x27;O&#x27;å’Œdummyè¿é€š</span><br>            <span class="hljs-keyword">if</span>( (i == <span class="hljs-number">0</span> || i == m - <span class="hljs-number">1</span> || j == <span class="hljs-number">0</span> || j == n - <span class="hljs-number">1</span>) &amp;&amp;<br>                        board[i][j] == <span class="hljs-string">&#x27;O&#x27;</span> )&#123;<br>                uf.union(val, n*m);<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (board[i][j] == <span class="hljs-string">&#x27;O&#x27;</span>)&#123;<br>                <span class="hljs-comment">// ä¸Š</span><br>                <span class="hljs-keyword">if</span>(i &gt; <span class="hljs-number">0</span> &amp;&amp; board[i-<span class="hljs-number">1</span>][j] == <span class="hljs-string">&#x27;O&#x27;</span>) uf.union((i-<span class="hljs-number">1</span>)*n+j, val);<br>                <span class="hljs-comment">// ä¸‹</span><br>                <span class="hljs-keyword">if</span> (i &lt; m - <span class="hljs-number">1</span> &amp;&amp; board[i+<span class="hljs-number">1</span>][j] == <span class="hljs-string">&#x27;O&#x27;</span>) uf.union((i+<span class="hljs-number">1</span>)*n+j, val);<br>                <span class="hljs-comment">// å·¦</span><br>                <span class="hljs-keyword">if</span> (j &gt; <span class="hljs-number">0</span> &amp;&amp; board[i][j-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;O&#x27;</span>) uf.union(i*n+(j-<span class="hljs-number">1</span>), val);<br>                <span class="hljs-comment">// å³</span><br>                <span class="hljs-keyword">if</span> (j &lt; n - <span class="hljs-number">1</span> &amp;&amp; board[i][j+<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;O&#x27;</span>) uf.union(i*n+(j+<span class="hljs-number">1</span>), val);<br>                <span class="hljs-comment">/* </span><br><span class="hljs-comment">                // å¦‚æœä¸åœ¨èƒ½å¤Ÿè¿é€šåˆ†é‡ä¸­ åˆ™æ”¹æˆ X</span><br><span class="hljs-comment">                if (!uf.connected(val, n*m))&#123;</span><br><span class="hljs-comment">                    board[i][j] = &#x27;X&#x27;;</span><br><span class="hljs-comment">                &#125;</span><br><span class="hljs-comment">                 */</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-keyword">if</span>(board[i][j] == <span class="hljs-string">&#x27;O&#x27;</span> &amp;&amp; !uf.connected(i*n+j, n*m))&#123;<br>                board[i][j] = <span class="hljs-string">&#x27;X&#x27;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="ç­‰å¼æ–¹ç¨‹çš„å¯æ»¡è¶³æ€§">2.2ã€990. ç­‰å¼æ–¹ç¨‹çš„å¯æ»¡è¶³æ€§</h4><p>è¿™é“é¢˜å°±æ˜¯å…¸å‹éœ€è¦åˆ©ç”¨Union-Findè§£å†³ã€‚ç›¸ç­‰å’Œä¸ç›¸ç­‰å°±ç›¸å½“äºè¿é€šå’Œä¸è¿é€šï¼Œæ ¸å¿ƒå°±æ˜¯<code>union</code> å’Œ åˆ¤æ–­æ˜¯å¦ <code>connected</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equationsPossible</span><span class="hljs-params">(String[] equations)</span> &#123;<br>    <span class="hljs-type">UnionFind</span> <span class="hljs-variable">uf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnionFind</span>(<span class="hljs-number">26</span>);<br>    <span class="hljs-keyword">for</span> (String equation : equations) &#123;<br>        <span class="hljs-keyword">if</span>(equation.charAt(<span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;!&#x27;</span>) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> equation.charAt(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> equation.charAt(<span class="hljs-number">3</span>);<br>        uf.union(c1-<span class="hljs-string">&#x27;a&#x27;</span>, c2-<span class="hljs-string">&#x27;a&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (String equation : equations) &#123;<br>        <span class="hljs-keyword">if</span> (equation.charAt(<span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;=&#x27;</span>) <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> equation.charAt(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> equation.charAt(<span class="hljs-number">3</span>);<br>        <span class="hljs-keyword">if</span>(uf.connected(c1-<span class="hljs-string">&#x27;a&#x27;</span>, c2-<span class="hljs-string">&#x27;a&#x27;</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äº”æœ€å°ç”Ÿæˆæ ‘ç®—æ³•">äº”ã€æœ€å°ç”Ÿæˆæ ‘ç®—æ³•</h2><h3 id="kruskalç®—æ³•">Kruskalç®—æ³•</h3><ol type="1"><li>å¯¹æ‰€æœ‰è¾¹è¿›è¡Œæ’åº</li><li>ä»æƒé‡æœ€å°çš„è¾¹å¼€å§‹ï¼Œä¾æ¬¡å°†è¾¹åŠ å…¥åˆ°ç»“ç‚¹é›†ä¸­</li><li>æ£€æŸ¥æ˜¯å¦äº§ç”Ÿç¯ï¼ˆå¹¶æŸ¥é›†ï¼‰ï¼Œå¦‚æœæœ‰å°±å‰”é™¤</li></ol><blockquote><p><ahref="https://leetcode.cn/problems/min-cost-to-connect-all-points/">1584.è¿æ¥æ‰€æœ‰ç‚¹çš„æœ€å°è´¹ç”¨</a></p><p>ç»™ä½ ä¸€ä¸ªpoints æ•°ç»„ï¼Œè¡¨ç¤º 2D å¹³é¢ä¸Šçš„ä¸€äº›ç‚¹ï¼Œå…¶ä¸­ points[i] = [xi,yi] ã€‚</p><p>è¿æ¥ç‚¹ [xi, yi] å’Œç‚¹ [xj, yj] çš„è´¹ç”¨ä¸ºå®ƒä»¬ä¹‹é—´çš„ æ›¼å“ˆé¡¿è·ç¦» ï¼š|xi -xj| + |yi - yj| ï¼Œå…¶ä¸­ |val| è¡¨ç¤º val çš„ç»å¯¹å€¼ã€‚</p><p>è¯·ä½ è¿”å›å°†æ‰€æœ‰ç‚¹è¿æ¥çš„æœ€å°æ€»è´¹ç”¨ã€‚åªæœ‰ä»»æ„ä¸¤ç‚¹ä¹‹é—´ æœ‰ä¸”ä»…æœ‰ä¸€æ¡ç®€å•è·¯å¾„æ—¶ï¼Œæ‰è®¤ä¸ºæ‰€æœ‰ç‚¹éƒ½å·²è¿æ¥ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Kruskal æœ€å°ç”Ÿæˆæ ‘ç®—æ³•</span><br><span class="hljs-comment"> * 1584. è¿æ¥æ‰€æœ‰ç‚¹çš„æœ€å°è´¹ç”¨</span><br><span class="hljs-comment"> * https://leetcode.cn/problems/min-cost-to-connect-all-points/</span><br><span class="hljs-comment"> */</span><br><span class="hljs-type">int</span>[] parent;<br><span class="hljs-type">int</span>[] size;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">minCostConnectPoints</span><span class="hljs-params">(<span class="hljs-type">int</span>[][] points)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> points.length; <span class="hljs-comment">// èŠ‚ç‚¹ä¸ªæ•°</span><br>    List&lt;<span class="hljs-type">int</span>[]&gt; edges = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i ++)&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; n; j++)&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">cost</span> <span class="hljs-operator">=</span> Math.abs(points[i][<span class="hljs-number">0</span>] - points[j][<span class="hljs-number">0</span>]) +<br>                               Math.abs(points[i][<span class="hljs-number">1</span>] - points[j][<span class="hljs-number">1</span>]);<br>            edges.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123;i, j, cost&#125;);<br>        &#125;<br>    &#125;<br>    edges.sort(Comparator.comparingInt(a -&gt; a[<span class="hljs-number">2</span>])); <span class="hljs-comment">// å‡åºæ’åˆ—</span><br>    <br>    parent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>    size = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>        parent[i] = i;<br>        size[i] = <span class="hljs-number">1</span>;<br>    &#125;<br>    <br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] edge : edges) &#123;<br>        <span class="hljs-keyword">if</span>(union(edge[<span class="hljs-number">0</span>], edge[<span class="hljs-number">1</span>]))&#123;<br>            sum += edge[<span class="hljs-number">2</span>];<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br><br><span class="hljs-type">boolean</span> <span class="hljs-title function_">union</span><span class="hljs-params">(<span class="hljs-type">int</span> v, <span class="hljs-type">int</span> w)</span> &#123;<br>    <span class="hljs-keyword">while</span> (parent[v] != v) &#123;<br>        parent[v] = parent[parent[v]];<br>        v = parent[v];<br>    &#125;<br>    <span class="hljs-keyword">while</span> (parent[w] != w) &#123;<br>        parent[w] = parent[parent[w]];<br>        w = parent[w];<br>    &#125;<br>    <span class="hljs-keyword">if</span> (w == v) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å¤„åœ¨ä¸€ä¸ªè¿é€šåˆ†é‡ä¸­</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (size[w] &gt; size[v]) &#123;<br>            parent[v] = w;<br>            size[w] += size[v];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            parent[w] = v;<br>            size[v] += size[w];<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å…­dijstraç®—æ³•">å…­ã€Dijstraç®—æ³•</h2><h3 id="æ¡†æ¶">1ã€æ¡†æ¶</h3><ol type="1"><li>å»ºå›¾ï¼šå°†é¢˜ç›®ä¸­å¯¹åº”çš„å›¾æ¨¡å‹å»ºç«‹èµ·æ¥ï¼ˆä»¥é‚»æ¥è¡¨çš„å½¢å¼ï¼‰</li><li>å°è£…æ¯ä¸ªå›¾èŠ‚ç‚¹ Nodeï¼šèŠ‚ç‚¹id å’Œ "ä»£ä»·"(ä» startèŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„æœ€å€¼)</li><li>ä½¿ç”¨ä¸€ä¸ª cost æ•°ç»„ï¼šcost[i] è®°å½•ä» start èŠ‚ç‚¹å¼€å§‹åˆ° i èŠ‚ç‚¹çš„"<strong>ä»£ä»·</strong>" <strong>æœ€å€¼</strong></li><li>ä½¿ç”¨ ä¼˜å…ˆé˜Ÿåˆ— queueï¼šç›®çš„æ˜¯æ¯æ¬¡èƒ½å¤Ÿå–å‡ºæœ€å°ï¼ˆæœ€å¤§ï¼‰çš„èŠ‚ç‚¹ï¼ŒåŠ é€ŸBFS</li><li>ä» start èŠ‚ç‚¹å¼€å§‹ BFS</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] dijstra(..args)&#123;<br>    <span class="hljs-comment">// å»ºå›¾</span><br>    List&lt;<span class="hljs-type">int</span>[]&gt;[] graph = buildGraph();<br>    <br>    <span class="hljs-comment">// startèŠ‚ç‚¹åˆ°ç›¸åº”èŠ‚ç‚¹çš„&quot;ä»£ä»·&quot;æœ€å€¼</span><br>    <span class="hljs-type">int</span>[] costTo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br>    initialize the array;<br>    costTo[start] = init_value;<br>    <br>    <span class="hljs-comment">// ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå¯¹æ‰€æœ‰å°è£…èµ·æ¥çš„å›¾èŠ‚ç‚¹æŒ‰ç…§&quot;cost&quot;æ’åº</span><br>    Queue&lt;Node&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();<br>    queue.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">a</span> start node);<br>    <br>    <span class="hljs-keyword">while</span>(!queue.isEmpty())&#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> node.id;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">cost</span> <span class="hljs-operator">=</span> node.costFromStart;<br>        <br>        <span class="hljs-keyword">if</span>(cost &gt; costTo[id])&#123; <span class="hljs-comment">// å·²ç»æœ‰æ›´ä¼˜çš„</span><br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br>        <br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span>[] next : graph[id])&#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">nextId</span> <span class="hljs-operator">=</span> next[<span class="hljs-number">0</span>];<br>            <span class="hljs-comment">// è¿™ä¸ªåœ°æ–¹å¯ä»¥è¡ç”Ÿå‡ºå¾ˆå¤šçš„å˜å¼ï¼Œå¯¹äºä»£ä»·æ˜¯ç›¸åŠ ï¼Œå¯¹äºæ¦‚ç‡æ˜¯ç›¸ä¹˜ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ±‚æœ€å¤§å€¼</span><br>            <span class="hljs-type">int</span> <span class="hljs-variable">nextCost</span> <span class="hljs-operator">=</span> func(next[<span class="hljs-number">1</span>], costTo[id]);<br>            <br>            <span class="hljs-keyword">if</span>(nextCost &lt; costTo(nextId))&#123;<br>                <span class="hljs-comment">// æ›´æ–°</span><br>                costTo[nextId] = nextCost;<br>                queue.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">this</span> node);<br>            &#125;<br>            <br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> costTo;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°1-æ•°ç»„/é“¾è¡¨</title>
      <link href="/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B01%EF%BC%88%E6%95%B0%E7%BB%84%E9%93%BE%E8%A1%A8%EF%BC%89/"/>
      <url>/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B01%EF%BC%88%E6%95%B0%E7%BB%84%E9%93%BE%E8%A1%A8%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç¼€å’Œ">å‰ç¼€å’Œ</h2><p><font color='blue'>ä½¿ç”¨äº æ•°ç»„å›ºå®šä¸å˜Â è€Œä¸”éœ€è¦é¢‘ç¹æ±‚å’Œçš„æƒ…å†µ</font></p><blockquote><p>ç›¸å…³é¢˜ç›®ï¼š</p><p>1ã€ä¸€ç»´æ•°ç»„çš„åŒºåŸŸå’Œæ£€ç´¢ 303</p><p>2ã€äºŒç»´æ•°ç»„çš„åŒºåŸŸå’Œæ£€ç´¢ 304</p><p>3ã€å’Œä¸ºkçš„å­æ•°ç»„ä¸ªæ•° 560</p></blockquote><p>åœ¨æ±‚è§£æ•°ç»„å’Œçš„æ—¶å€™ï¼Œæœ€æ™®é€šçš„æ–¹æ³•å°±æ˜¯forå¾ªç¯éå†ï¼Œå¤æ‚åº¦ä¸º<spanclass="math inline">\(O(N)\)</span>ã€‚</p><p>ä½†æ˜¯å½“éœ€è¦å¤šæ¬¡è°ƒç”¨æ±‚è§£æ•°ç»„å’Œçš„æ–¹æ³•æ—¶ï¼Œå°±éœ€è¦é™ä½å…¶å¤æ‚åº¦</p><p>ä½¿ç”¨å‰ç¼€å’Œå¯ä»¥å°†å¤æ‚åº¦é™ä¸º<spanclass="math inline">\(O(1)\)</span></p><p>ä½¿ç”¨æ¡ä»¶ï¼š<strong>è°ƒç”¨æ•°ç»„æ±‚å’Œæ–¹æ³•å‰æ•°ç»„å·²ç»åˆå§‹åŒ– +ä¼šè°ƒç”¨å¤§é‡çš„æ•°ç»„æ±‚å’Œæ–¹æ³•</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ„å»ºå‰ç¼€å’Œæ•°ç»„</span><br><span class="hljs-type">int</span> *preSum = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[len + <span class="hljs-number">1</span>]&#123;<span class="hljs-number">0</span>&#125;;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>    preSum[i+<span class="hljs-number">1</span>] = preSum[i] + nums[i];<br>&#125;<br><br><span class="hljs-comment">// è¿”å›æ•°ç»„æŸä¸ªèŒƒå›´çš„å’Œåªéœ€è¦ç”¨ç›¸åº”å‰ç¼€å’Œæ•°ç»„è¿›è¡Œç›¸å‡å³å¯</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">sunRange</span><span class="hljs-params">(<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> preSum[right+<span class="hljs-number">1</span>] - preSum[left+<span class="hljs-number">1</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨äºŒç»´æ•°ç»„ï¼ˆçŸ©é˜µï¼‰ä¸­åº”ç”¨æ—¶ï¼Œ"å‰ç¼€å’Œ" å°±æ˜¯ æŸç‚¹<spanclass="math inline">\((row, col)\)</span> åˆ° <spanclass="math inline">\((0,0)\)</span>æˆ–è€…å…¶ä»–å®šç‚¹æ‰€å›´æˆçš„åŒºåŸŸçš„å’Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* æ±‚è§£ row1, col1, row2, col2 æ‰€å›´æˆçš„åŒºåŸŸçš„å’Œ</span><br><span class="hljs-comment">* Sum(row2, col2) - Sum(row2, col1) - Sum(row1, col2) + Su(row1, col1)</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">sumRegion</span><span class="hljs-params">(<span class="hljs-type">int</span> row1, <span class="hljs-type">int</span> col1, <span class="hljs-type">int</span> row2, <span class="hljs-type">int</span> col2)</span></span>&#123;<br>    preMatrix[row2][col2] -<br>               (col1 &gt; <span class="hljs-number">0</span> ? preMatrix[row2][col1 - <span class="hljs-number">1</span>] : <span class="hljs-number">0</span>) -<br>               (row1 &gt; <span class="hljs-number">0</span> ? preMatrix[row1 - <span class="hljs-number">1</span>][col2] : <span class="hljs-number">0</span>) +<br>               (row1 &gt; <span class="hljs-number">0</span> &amp;&amp; col1 &gt; <span class="hljs-number">0</span> ? preMatrix[row1 - <span class="hljs-number">1</span>][col1 - <span class="hljs-number">1</span>] : <span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><font color='red'>å’Œä¸ºkçš„å­æ•°ç»„ä¸ªæ•°</font></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// æœ€æ™®é€šçš„æ€è·¯ O(N^3)</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = i; j &lt; len; j++)&#123;<br>        <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> k = i; k &lt;= j; k++)&#123;<br>            sum += nums[k];<br>        &#125;<br>        <span class="hljs-keyword">if</span>(sum == k)&#123;<br>            cnt++;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ©ç”¨å‰ç¼€å’Œæ•°ç»„ =&gt; O(N^2)</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; i; j++)&#123;<br>        <span class="hljs-keyword">if</span>(preSum[i] - preSum[j] == k)&#123;<br>            cnt ++;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ã€O(N)ã€‘</span><br><span class="hljs-comment">// preSum[j] = preSum[i] - k Â·Â·Â·Â·Â·Â·Â·Â·Â·Â· (1)</span><br>unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; preSum;<br>preSum[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// è€ƒè™‘æœ‰å‰ç¼€å’Œ=kçš„qing</span><br><span class="hljs-type">int</span> len = nums.<span class="hljs-built_in">size</span>();<br><span class="hljs-type">int</span> sum_i = <span class="hljs-number">0</span>, sum_j = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)&#123;<br>    sum_i += nums[i];<br>    sum_j = sum_i - k;<br>    <span class="hljs-keyword">if</span>(preSum.<span class="hljs-built_in">find</span>(sum_j) != preSum.<span class="hljs-built_in">end</span>())&#123; <span class="hljs-comment">// å­˜åœ¨å‰ç¼€å’Œä½¿å¾— (1) æˆç«‹</span><br>        cnt += preSum[sum_j];<br>    &#125;<br>    <span class="hljs-keyword">if</span>(preSum.<span class="hljs-built_in">find</span>(sum_i) != preSum.<span class="hljs-built_in">end</span>())&#123;<br>        preSum[sum_i] ++;<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        preSum[sum_i] = <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å·®åˆ†æ•°ç»„">å·®åˆ†æ•°ç»„</h2><p><font color='blue'>å·®åˆ†æ•°ç»„é€‚ç”¨äºéœ€è¦é¢‘ç¹å¯¹æ•°ç»„çš„<strong>æŸä¸ªåŒºé—´åšå¢å‡</strong>çš„æƒ…å†µ</font></p><blockquote><p>åŒºé—´åŠ æ³• 370</p><p>èˆªç­é¢„å®šç»Ÿè®¡ 1109</p><p>æ‹¼è½¦ 1094</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Difference</span><br>&#123;<br><span class="hljs-keyword">private</span>:<br>    vector&lt;<span class="hljs-type">int</span>&gt; diff;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// åˆå§‹åŒ–å·®åˆ†æ•°ç»„</span><br>    <span class="hljs-built_in">Difference</span>(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums)<br>    &#123;<br>        diff.<span class="hljs-built_in">push_back</span>(nums[<span class="hljs-number">0</span>]);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; nums.<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            diff.<span class="hljs-built_in">push_back</span>(nums[i] - nums[i - <span class="hljs-number">1</span>]);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// [startIndex, endIndex]åŒºé—´ åŠ å’Œ</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">increment</span><span class="hljs-params">(<span class="hljs-type">int</span> startIndex, <span class="hljs-type">int</span> endIndex, <span class="hljs-type">int</span> inc)</span></span><br><span class="hljs-function">    </span>&#123;<br>        diff[startIndex] += inc;<br>        <span class="hljs-keyword">if</span> (endIndex &lt; diff.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>)&#123;<br>            diff[endIndex + <span class="hljs-number">1</span>] -= inc;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// ç”±å·®åˆ†æ•°ç»„å¾—åˆ°åŸæ•°ç»„å¹¶è¿”å›</span><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">getResult</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nums</span><span class="hljs-params">(diff.size())</span></span>;<br>        nums[<span class="hljs-number">0</span>] = diff[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; diff.<span class="hljs-built_in">size</span>(); i++)<br>        &#123;<br>            nums[i] += nums[i - <span class="hljs-number">1</span>] + diff[i];<br>        &#125;<br>        <span class="hljs-keyword">return</span> nums;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>åœ¨ã€èˆªç­é¢„å®šç»Ÿè®¡ã€‘ä¸­ï¼Œå¯¹èˆªç­äººæ•°å½¢æˆçš„æ•°ç»„åšå·®åˆ†</p><p>åœ¨ã€æ‹¼è½¦ã€‘ä¸­ï¼Œå¯¹æ¯ä¸ªä½ç½®è½¦ä¸Šçš„äººæ•°å½¢æˆçš„æ•°ç»„åšå·®åˆ†</p><h2 id="æ»‘åŠ¨çª—å£">æ»‘åŠ¨çª—å£</h2><p><font color='blue'>ä¸€èˆ¬è§£å†³ åœ¨å­—ç¬¦ä¸²ä¸­å¯»æ‰¾å­ä¸² çš„é—®é¢˜</font></p><blockquote><p>æœ€å°è¦†ç›–å­ä¸² 76</p><p>å­—ç¬¦ä¸²çš„æ’åˆ— 567</p><p>æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ 438</p><p>æ— é‡å¤å­—ç¬¦æœ€é•¿å­ä¸² 3</p></blockquote><p>æ€è·¯ï¼š</p><p>1ã€å…ˆç”¨ä¸€ä¸ªmapè®°å½•æ»¡è¶³è¦æ±‚çš„æƒ…å†µï¼ˆæ¯”å¦‚å­ä¸²ä¸­å­—ç¬¦ç±»å‹å’Œæ•°ç›®ï¼‰</p><p>2ã€ç”¨å¦ä¸€ä¸ªmapè®°å½•çª—å£å†…çš„æƒ…å†µï¼ˆwindowï¼‰[ left, right )</p><p>3ã€ã€ä¸æ–­ç§»åŠ¨å³è¾¹ç•Œï¼Œå¹¶å¯¹windowå†…å®¹<strong>åšæ›´æ–°</strong>ã€‘ =&gt;ã€åœ¨æ»¡è¶³<strong>æŸç§æƒ…å†µ</strong>æ—¶ï¼Œéœ€è¦ç¼©å‡çª—å£ï¼ˆå³ç§»åŠ¨å·¦è¾¹ç•Œï¼‰ï¼Œå¹¶<strong>åšæ›´æ–°</strong>ã€‘ï¼ˆå¾ªç¯è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å³è¾¹ç•Œåˆ°è¾¾å­—ç¬¦ä¸²è¾¹ç•Œï¼‰</p><p>4ã€<strong>æˆ‘ä»¬éœ€è¦çš„ç»“æœåœ¨å“ªé‡Œæ›´æ–°ï¼Ÿ</strong>ï¼ˆç§»åŠ¨å³è¾¹ç•Œè¿‡ç¨‹ä¸­ï¼Œè¿˜æ˜¯ç§»åŠ¨å·¦è¾¹ç•Œè¿‡ç¨‹ä¸­ï¼‰</p><p><strong><font color='red'>ç†è§£çª—å£ç¼©å°èƒŒåçš„å«ä¹‰</font></strong></p><blockquote><p>ä¸ªäººçš„ç†è§£ï¼š</p><p>æ»‘åŠ¨çª—å£çš„æ ¸å¿ƒå½“ç„¶åœ¨äºã€çª—å£ã€‘çš„å«ä¹‰å’Œã€æ»‘åŠ¨ã€‘çš„å«ä¹‰</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œçª—å£æ˜¯å¸®åŠ©æˆ‘ä»¬å¯»æ‰¾ç­”æ¡ˆçš„ç»“æ„ï¼›æ»‘åŠ¨æ˜¯æˆ‘ä»¬å¯»æ‰¾çš„ç­”æ¡ˆçš„è¿‡ç¨‹ä»¥åŠæŠ€å·§ã€‚</p><p>æ‰€ä»¥ï¼Œçª—å£çš„å®šä¹‰éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚</p><p>çœŸæ­£çµæ´»çš„æ˜¯çª—å£çš„æ»‘åŠ¨ã€‚æ»‘åŠ¨é¿å…äº†å†—ä½™çš„å¾ªç¯ï¼Œå¤§å¤§é™ä½äº†é—®é¢˜çš„å¤æ‚åº¦</p><p>æˆ‘ä»¬å¦‚æœä½¿ç”¨æœ€ä¸€èˆ¬çš„æ–¹æ³•å¤„ç†æ­¤ç±»é—®é¢˜ï¼Œé¦–å…ˆè¦ç¡®å®šå°±æ˜¯ å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼Œä¹‹å‰æˆ‘ä»¬ä½¿ç”¨å¾ªç¯æ˜¯O(N^2)çš„å¤æ‚åº¦ï¼›è€Œä½¿ç”¨çª—å£çš„æ»‘åŠ¨ï¼Œå³è¾¹ç•Œæ»‘åŠ¨æ˜¯ç¡®å®šå¼€å§‹ä½ç½®ä¸æ–­æ”¹å˜ç»“æŸä½ç½®ï¼Œè€Œå·¦è¾¹ç•Œæ»‘åŠ¨æ˜¯ç¡®å®šç»“æŸä½ç½®ä¸æ–­æ”¹å˜å¼€å§‹ä½ç½®ï¼Œæœ€å¤šåªéœ€è¦å¯¹å­—ç¬¦ä¸²åšä¸¤æ¬¡éå†ï¼Œæ˜¯O(N)å¤æ‚åº¦ï¼Œå½“ç„¶å…¶ä¸­è¿˜æ¶‰åŠä¸€äº›å…¶ä»–çš„æŠ€å·§ï¼Œå¸®åŠ©ç­›é€‰æ‰ä¸€äº›æƒ…å†µã€‚</p><p>æ»‘åŠ¨åˆ†ä¸ºå³è¾¹ç•Œæ»‘åŠ¨ï¼ˆçª—å£æ‰©å¤§ï¼‰å’Œå·¦è¾¹ç•Œæ»‘åŠ¨ï¼ˆçª—å£ç¼©å°ï¼‰</p><p>åˆ†åˆ«å¯¹åº”ç€ä»€ä¹ˆæ—¶å€™çª—å£æ‰©å¤§ï¼›çª—å£æ‰©å¤§ä¹‹åå¹²ä»€ä¹ˆï¼›ä»€ä¹ˆæ—¶å€™çª—å£ç¼©å°ï¼›çª—å£ç¼©å°ä¹‹åå¹²ä»€ä¹ˆ</p><p>ä¸€èˆ¬æˆ‘ä»¬éƒ½å°†çª—å£åˆå§‹åŒ–ä¸º [ 0, 0 )</p><p>çª—å£æ‰©å¤§æ˜¯å¯¹åº”äºã€å¯»æ‰¾è§£ã€‘çš„è¿‡ç¨‹ï¼›çª—å£ç¼©å°æ˜¯å¯¹åº”äºã€ä¼˜åŒ–è§£ã€‘çš„è¿‡ç¨‹</p><p>å¯»æ‰¾è§£çš„è¿‡ç¨‹ç›¸å¯¹ç®€å•ï¼Œæ ¹æ®é—®é¢˜çš„ç±»å‹å¾ˆå®¹æ˜“å¯ä»¥å†™å‡ºç›¸åº”çš„ä»£ç </p><p>ã€æœ€éš¾çš„æ˜¯ã€‘ ä»€ä¹ˆæ—¶å€™è¿›è¡Œè§£çš„ä¼˜åŒ–ï¼Œä»¥åŠæ€ä¹ˆåšï¼Ÿå…ˆæ ¹æ®é¢˜ç›®æ¥çœ‹çœ‹</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// æ»‘åŠ¨çª—å£çš„æ¡†æ¶</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">slideWindow</span><span class="hljs-params">(string s1, string s2)</span></span>&#123;<br>    unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; need;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">char</span> c : s1) need[c]++;<br>    <br>    unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; window;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> valid = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">while</span>(right &lt; s2.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">char</span> c = s2[right];<br>        right++;<br>        <br>        <span class="hljs-comment">// ... çª—å£æ‰©å¤§æ—¶åšçš„æ›´æ–°</span><br>        <br>        <span class="hljs-keyword">while</span>( condition )&#123; <span class="hljs-comment">// ä»€ä¹ˆæ—¶å€™åœæ­¢çª—å£æ‰©å¤§ï¼Œå¼€å§‹ç¼©å‡çª—å£</span><br>            <span class="hljs-type">char</span> d = s2[left];<br>            left++;<br>            <span class="hljs-comment">// ... çª—å£ç¼©å‡æ—¶åšçš„æ“ä½œ</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é’ˆå¯¹ä¸Šé¢çš„å››ä¸ªä¾‹å­ï¼Œå…·ä½“åœ°é˜è¿°ä¸€ä¸‹æ¡†æ¶çš„ä½¿ç”¨ï¼Œä»¥åŠå¯¹äºé‚£å‡ ä¸ªé—®é¢˜çš„æ€è€ƒ</p><ul><li>ã€æœ€å°è¦†ç›–å­ä¸²ã€‘</li></ul><blockquote><p>åœ¨ s ä¸­æ‰¾åˆ° åŒ…å« t ä¸­æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²</p></blockquote><p>1ã€ç§»åŠ¨å³è¾¹ç•Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp">...<br><span class="hljs-type">char</span> c = s2[right];<br>right++;<br><span class="hljs-comment">// çª—å£å¢å¤§æ—¶çš„æ›´æ–°æ“ä½œ</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">å¦‚æœåŠ å…¥çª—å£çš„è¿™ä¸ªå­—ç¬¦ æ˜¯needä¸­çš„å­—ç¬¦ (ä¹Ÿå°±æ˜¯è¯´æ˜¯ t ä¸­çš„å­—ç¬¦)</span><br><span class="hljs-comment">å°±å°†è¯¥å­—ç¬¦åœ¨çª—å£ä¸­çš„æ•°é‡+1</span><br><span class="hljs-comment">å¦‚æœè¯¥å­—ç¬¦åœ¨çª—å£ä¸­çš„æ•°é‡ å’Œ åœ¨needä¸­çš„æ•°é‡ä¸€æ · (ä¹Ÿå°±æ˜¯è¯´çª—å£ä¸­è¯¥å­—ç¬¦æ»¡è¶³äº†tä¸­çš„è¦æ±‚)</span><br><span class="hljs-comment">valid +1 è¡¨ç¤ºæœ‰æ•ˆçš„å­—ç¬¦æ•°å¢åŠ  å½“æœ‰æ•ˆå­—ç¬¦æ•°å’Œtä¸­çš„å­—ç¬¦ç±»å‹æ•°ä¸€æ ·çš„æ—¶å€™ è¯´æ˜æ­¤æ—¶çª—å£ä¸­æ»¡è¶³äº†è¦æ±‚ åŒ…å«äº†tä¸­æ‰€æœ‰å­—ç¬¦</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">if</span>(need.<span class="hljs-built_in">count</span>(c))&#123;<br>    window[c]++;<br>    <span class="hljs-keyword">if</span>(window[c] == need[c])&#123;<br>        valid++;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ã€çª—å£ä¸­æ»¡è¶³è¦æ±‚æ—¶ã€‘ï¼Œç¼©å‡çª—å£</p><p><font color='red'>ä¸ºä»€ä¹ˆè¦ç¼©å‡çª—å£ï¼Ÿä¸ºä»€ä¹ˆè¦åœ¨çª—å£æ»¡è¶³è¦æ±‚çš„æ—¶å€™ç¼©å‡çª—å£ï¼Ÿç¼©å‡æ—¶å¹²ä»€ä¹ˆï¼Ÿ</font></p><p>é—®é¢˜æ˜¯æ±‚è§£ã€æœ€å°å­ä¸²ã€‘</p><p>åœ¨å³è¾¹ç•Œä¸æ–­ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ä¸å¿…è¦çš„å­—ç¬¦è¢«åŠ å…¥çª—å£ä¸­ï¼Œå°±ä¼šå¯¼è‡´çª—å£ä¸­çš„ç­”æ¡ˆå¯èƒ½ä¸æ˜¯æœ€å°çš„ã€‚æ¯”å¦‚ï¼ˆ"adbc"ä¸­åŒ…å« "bcd"ï¼Œä½†æ˜¯ "a"æ˜¯æ— å…³ç´§è¦çš„ï¼Œå¯ä»¥ä»çª—å£ä¸­ç§»é™¤çš„ï¼Œåº”è¯¥å˜ä¸º"dbc"ï¼‰å°±éœ€è¦å¯¹çª—å£è¿›è¡Œç¼©å‡æ‰èƒ½ä½¿å¾—ç­”æ¡ˆæ›´ä¼˜ï¼ˆå±€éƒ¨æœ€ä¼˜ï¼‰ã€‚</p><p>å› ä¸ºè¦å¯¹è§£è¿›è¡Œä¼˜åŒ–ï¼Œé¦–å…ˆéœ€è¦åœ¨çª—å£ä¸­å‡ºç°è§£ï¼Œæˆ–åŒ…å«è§£ï¼Œæ‰èƒ½ç»§ç»­ä¼˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦åœ¨çª—å£æ»¡è¶³è¦æ±‚æ—¶è¿›è¡Œç¼©å‡ã€‚</p><p>æ ¹æ®å‰é¢æˆ‘ä»¬è¦ç¼©å‡çª—å£çš„åŸå› ï¼Œåœ¨ç¼©å‡çª—å£æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    å°†å­—ç¬¦ä»å·¦è¾¹ç•Œç§»å‡ºï¼Œç›´åˆ°çª—å£ä¸­åˆšå¥½ä¸æ»¡è¶³è¦æ±‚ï¼Œæ­¤æ—¶çª—å£å†…çš„è§£ä¸ºå±€éƒ¨æœ€ä¼˜</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">while</span>( valid == need.<span class="hljs-built_in">size</span>() )&#123;<br>    <span class="hljs-type">char</span> d = s2[left];<br>    left++;<br>    <br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    å¦‚æœç§»å‡ºçš„å­—ç¬¦åœ¨needä¸­ï¼Œè€Œä¸”ç§»å‡ºå‰è¯¥å­—ç¬¦åœ¨çª—å£ä¸­çš„æ•°é‡åˆšå¥½æ»¡è¶³è¦æ±‚</span><br><span class="hljs-comment">    ç§»å‡ºåï¼Œvalid --</span><br><span class="hljs-comment">    window[d] --</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-keyword">if</span>(need.<span class="hljs-built_in">count</span>(d))&#123;<br>        <span class="hljs-keyword">if</span>(window[d] == need[d])&#123;<br>            valid--;<br>        &#125;<br>        window[d]--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç”±äºæˆ‘ä»¬éœ€è¦çš„æœ€å°å­ä¸²ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦å¯¹è§£è¿›è¡Œåˆ¤æ–­å’Œæ›´æ–°ï¼Œåœ¨å“ªï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦çš„å…¨å±€æœ€ä¼˜è§£ï¼Œæ›´æ–°çš„æ—¶å€™è‚¯å®šæ˜¯è€ƒè™‘å±€éƒ¨æœ€ä¼˜è§£ï¼Œæ‰€ä»¥è‡ªç„¶å°±åº”è¯¥å°†ç­”æ¡ˆçš„æ›´æ–°æ”¾åœ¨çª—å£ç¼©å°ä¸­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">while</span>( valid == need.<span class="hljs-built_in">size</span>() )&#123;<br>    <span class="hljs-comment">// å¯¹ç­”æ¡ˆè¿›è¡Œæ›´æ–°</span><br>    <span class="hljs-keyword">if</span>(right - left &lt; len)&#123;<br>        start = left; <br>        len = right - left;<br>    &#125;<br>    <br>    <span class="hljs-type">char</span> d = s2[left];<br>    left++;<br>    <br>    <span class="hljs-keyword">if</span>(need.<span class="hljs-built_in">count</span>(d))&#123;<br>        <span class="hljs-keyword">if</span>(window[d] == need[d])&#123;<br>            valid--;<br>        &#125;<br>        window[d]--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€å­—ç¬¦ä¸²çš„æ’åˆ—ã€‘ã€æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯ã€‘</li></ul><blockquote><p>åˆ¤æ–­å­—ç¬¦ä¸² s1 ä¸­æ˜¯å¦åŒ…å« s2 çš„æ’åˆ—</p><p>æ‰¾åˆ°å­—ç¬¦ä¸² s1 ä¸­ s2 æ‰€æœ‰æ’åˆ—çš„èµ·å§‹ä½ç½®</p></blockquote><p>è¿™ä¸¤ä¸ªé—®é¢˜çš„æ ¸å¿ƒæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æŸ¥æ‰¾å­—ç¬¦ä¸²çš„æ’åˆ—</p><p>åº”ç”¨ä¸Šé¢çš„æ¡†æ¶ï¼Œç§»åŠ¨å³è¾¹ç•Œå¯»æ‰¾è§£çš„è¿‡ç¨‹æ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«å’Œéš¾ç‚¹åœ¨äºã€ç¼©å‡çª—å£çš„æ—¶æœºã€‘å’Œã€ç¼©å‡çª—å£çš„æ“ä½œã€‘</p><p><font color='red'>ä»€ä¹ˆæ—¶å€™ç¼©å‡çª—å£</font></p><p>ç¼©å‡çª—å£çš„ç›®çš„æ˜¯ ä¼˜åŒ–è§£ã€‚</p><p>æ‰€ä»¥ï¼Œå¯ä»¥å¾—å‡ºç¼©å‡çª—å£çš„ä¸¤ä¸ªæ—¶æœºå°±æ˜¯ 1ã€çª—å£ä¸­åŒ…å«äº†è§£2ã€æ˜æ˜¾çŸ¥é“çª—å£ä¸­çš„å†…å®¹ä¸èƒ½æ»¡è¶³è§£ï¼Œéœ€è¦å¯¹çª—å£ä¸­çš„å†…å®¹è¿›è¡Œä¿®æ­£ã€‚</p><p>è¿™ä¸¤ä¸ªæ—¶æœºå¯ä»¥ä»»é€‰ä¸€ä¸ªï¼Œå°±çœ‹ä¸åŒçš„é—®é¢˜ä¸­ï¼Œå“ªä¸ªæ—¶æœºæ›´åŠ æ˜æ˜¾ã€‚</p><p>å¯¹äºä¸Šä¸€ä¸ªé—®é¢˜ï¼šæœ€å°è¦†ç›–å­ä¸²ä¸­ï¼Œæ—¶æœº1æ˜¯æ›´åŠ æ˜æ˜¾çš„ï¼Œåªè¦çª—å£ä¸­åŒ…å«äº†å’Œneedä¸­ä¸€æ ·çš„å­—ç¬¦å’Œæ•°é‡ï¼ˆ<code>valid == need.size()</code>ï¼‰ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ—¶æœº2æ˜¯ä¸æ˜æ˜¾çš„ï¼Œã€ä¿®æ­£è§£ã€‘åœ¨è¿™ä¸ªé—®é¢˜ä¸­æ˜¯éœ€è¦è§£å…ˆå‡ºç°çš„ï¼Œå› ä¸ºå­ä¸²å¯ä»¥åŒ…å«å…¶ä»–å­—ç¬¦ï¼Œåœ¨è§£å‡ºç°ä¹‹é—´éƒ½ä¸èƒ½çŸ¥é“è¿™ä¸ªè§£éœ€ä¸éœ€è¦è¢«ä¿®æ­£ã€‚</p><p>è€Œè¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½çŸ¥é“ä»€ä¹ˆæ—¶å€™è§£éœ€è¦ä¿®æ­£ï¼š1ã€å‡ºç°äº†å…¶ä»–å­—ç¬¦ï¼›ï¼ˆ<code>need.count(c) == 0</code>ï¼‰2ã€å­—ç¬¦æ•°é‡è¿‡å¤šäº†ï¼ˆçª—å£çš„sizeå¤§äºs2çš„sizeï¼š<code>right - left &gt; s2.size()</code>ï¼‰ã€‚å¯¹äºä»€ä¹ˆæ—¶å€™çª—å£ä¸­åŒ…å«è§£ï¼Œæˆ‘ä»¬æ˜¯æ›´éš¾ä»¥çŸ¥é“çš„ï¼Œæˆ‘ä»¬è¦éªŒè¯çª—å£è¿™ä¸€å—åŒºåŸŸï¼Œéš¾åº¦æ›´å¤§ï¼Œä¹Ÿä¸åˆé€‚ã€‚</p><p>è‡³äºç¼©å‡çª—å£çš„æ“ä½œï¼Œç»è¿‡æ€è€ƒå¾ˆå®¹æ˜“èƒ½å¤Ÿå¾—åˆ°ï¼Œå°±æ˜¯å°†å­—ç¬¦ä»å·¦è¾¹ç•Œç§»å‡ºï¼Œå¹¶æ›´æ–°windowå’Œvalid</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">å‡ºç°äº†å…¶ä»–å­—ç¬¦å¦‚æœæ²¡æœ‰å¤„ç†ä¼šå¯¼è‡´å­—ç¬¦æ•°é‡è¿‡å¤š, æ‰€ä»¥é€‰æ‹©ç”¨ rigth - left &gt; s2.size() æ¥åˆ¤æ–­</span><br><span class="hljs-comment">æˆ‘ä»¬éœ€è¦åˆ¤æ–­ç»“æœçš„å‡ºç°ï¼Œæ‰€ä»¥å°† = æ”¾è¿›äº†åˆ¤æ–­ä¸­</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">while</span>( right - left &gt;= s2.<span class="hljs-built_in">size</span>() )&#123;<br>    <span class="hljs-keyword">if</span>(valid == need.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-comment">// æ»¡è¶³æƒ…å†µ</span><br>    &#125;<br>    <br>    <span class="hljs-type">char</span> d = s1[left];<br>    left++;<br>    <span class="hljs-keyword">if</span>(need.<span class="hljs-built_in">count</span>(d))&#123;<br>        <span class="hljs-keyword">if</span>(window[d] == need[d])&#123;<br>            valid --;<br>        &#125;<br>        window[d]--;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€æ— é‡å¤å­—ç¬¦æœ€é•¿å­ä¸²ã€‘</li></ul><blockquote><p>æ‰¾åˆ° s ä¸­æ²¡æœ‰é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²ã€‚</p><p>"pwwkew" =&gt; "wke"</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// è¿™é“é¢˜åœ¨æ¡†æ¶ä¸Šæ›´ä¸ºç®€å•ï¼Œæ˜¯ä¸€ä¸ªå˜ç§ï¼Œä½†æ˜¯åœ¨è€ƒè™‘ç¼©å‡çª—å£ä¸Šè¿˜æ˜¯å€¼å¾—æ€è€ƒä¸€ç•ª</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">lengthOfLongestSubstring</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    unordered_map&lt;<span class="hljs-type">char</span>, <span class="hljs-type">int</span>&gt; window;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> len = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">while</span>(right &lt; s.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-type">char</span> c = s[right];<br>        right++;<br>        window[c]++;<br>        <span class="hljs-comment">/* </span><br><span class="hljs-comment">        ç¼©å‡çª—å£çš„æ—¶æœº: å­˜åœ¨é‡å¤å­—ç¬¦</span><br><span class="hljs-comment">        */</span><br>        <span class="hljs-keyword">while</span>(window[c] &gt; <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-type">char</span> d = s[left];<br>            left++;<br>            window[d]--;<br>        &#125;<br>        len = <span class="hljs-built_in">max</span>(len, right-left);<br>    &#125;<br>    <span class="hljs-keyword">return</span> len;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒåˆ†æœç´¢">äºŒåˆ†æœç´¢</h2><p>ã€äºŒåˆ†æœç´¢ã€‘æ˜¯ååˆ†å¸¸è§çš„ç®—æ³•ï¼Œå…¶æ€æƒ³ååˆ†ç®€å•ï¼Œä½†æ˜¯åœ¨ç»†èŠ‚ä¸Šçš„å¤„ç†è¾ƒä¸ºç¹çå’Œå¤æ‚ã€‚</p><p>ä¸‹é¢é’ˆå¯¹ä¸åŒçš„åœºæ™¯å’Œé—®é¢˜æ¥æ¢ç©¶ä¸€ä¸‹äºŒåˆ†æœç´¢çš„ç»†èŠ‚</p><h3 id="äºŒåˆ†æœç´¢æ¡†æ¶">äºŒåˆ†æœç´¢æ¡†æ¶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">binarySearchFramework</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = ...<br>    <span class="hljs-built_in">whilie</span>(...)&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target) &#123;<br>            ...<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &gt; target)&#123;<br>            right = ...<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &lt; target)&#123;<br>            left = ...<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ...<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>...</code> å¤„å°±æ˜¯ä¹‹åè¦è€ƒè™‘çš„ç»†èŠ‚</li><li><code>left + (right - left) / 2</code> é˜²æ­¢æº¢å‡ºé—®é¢˜</li></ul><h3 id="æ™®é€šäºŒåˆ†æœç´¢">æ™®é€šäºŒåˆ†æœç´¢</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ä½¿ç”¨ [left, right] å‹çš„æœç´¢åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">whilie</span>( left &lt;= right )&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target) &#123;<br>            <span class="hljs-keyword">return</span> mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &gt; target)&#123;<br>            right = mid - <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>right = nums.size() - 1</code> è¡¨ç¤ºæ˜¯åœ¨<code>[left, right]</code> è¿™æ ·çš„é—­åŒºé—´ä¸­æœç´¢çš„ =&gt; æ‰€ä»¥ whileä¸­çš„å¾ªç¯æ¡ä»¶æ˜¯ <code>left &lt;= right</code> è€Œä¸æ˜¯<code>left &lt; right</code> å› ä¸º <code>left == right</code>æ—¶ï¼Œ<code>[left, right]</code>è¿™ä¸ªåŒºé—´ä»ç„¶æ˜¯å¯ç”¨çš„ã€‚</li><li>åœ¨ <code>if-else</code>ç»“æ„ä¸­çš„æ“ä½œï¼Œå’Œæœç´¢åŒºé—´æ˜¯ç»Ÿä¸€çš„ã€‚ã€æœç´¢åŒºé—´ã€‘å…¶å®å°±æ˜¯å¯èƒ½å‡ºç°è§£çš„åŒºé—´ï¼Œé—®é¢˜åœ¨äºåŒºé—´çš„å¼€é—­éœ€è¦ç»Ÿä¸€ã€‚æ¯”å¦‚å¦‚æœè¦ä½¿ç”¨é—­åŒºé—´ï¼Œå°±è¦<code>right = nums.size() - 1</code>ï¼Œåœ¨æ›´æ–°<code>left</code> å’Œ <code>right</code>çš„æ—¶å€™ä¹Ÿè¦ä¿è¯æ›´æ–°åæœç´¢åŒºé—´æ˜¯é—­åŒºé—´ã€‚ç›¸åï¼Œå¦‚æœè¦ä½¿ç”¨å¼€åŒºé—´ï¼Œå°±è¦<code>right = nums.size()</code> ï¼Œåœ¨æ›´æ–° <code>left</code> å’Œ<code>right</code> æ—¶ä¹Ÿè¦ä¿è¯æ›´æ–°åæœç´¢åŒºé—´æ˜¯å¼€åŒºé—´ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// [left, right) å‹æœç´¢åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>(); <span class="hljs-comment">// æ³¨æ„</span><br>    <span class="hljs-keyword">while</span>( left &lt; right )&#123; <span class="hljs-comment">// æ³¨æ„</span><br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target) &#123;<br>            <span class="hljs-keyword">return</span> mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &gt; target)&#123;<br>            right = mid; <span class="hljs-comment">// æ³¨æ„</span><br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¯»æ‰¾å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾">å¯»æ‰¾å·¦ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// [left, right] æœç´¢åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">searchLeftBound</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; <span class="hljs-comment">// [1]</span><br>    <span class="hljs-keyword">while</span>(left &lt;= right)&#123; <span class="hljs-comment">// [2]</span><br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target)&#123;<br>            right = mid - <span class="hljs-number">1</span>; <span class="hljs-comment">// [3]</span><br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &gt; target)&#123;<br>            right = mid - <span class="hljs-number">1</span>; <span class="hljs-comment">// [4]</span><br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> (left &lt; nums.<span class="hljs-built_in">size</span>() &amp;&amp; nums[left] == target) ? left : <span class="hljs-number">-1</span>; <span class="hljs-comment">// [5]</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>[1]ï¼š<code>right = nums.size() - 1</code> æ„å‘³ç€é€‰æ‹© é—­åŒºé—´ä½œä¸ºæœç´¢åŒºé—´ <code>[left, right]</code></li><li>[2]ï¼šé—­åŒºé—´ï¼Œæœ‰æ•ˆçš„å¾ªç¯èŒƒå›´æ˜¯ <code>left &lt;= right</code>æˆ–è€…è¯´ç»ˆæ­¢æ¡ä»¶æ˜¯ <code>left = right + 1</code></li><li>[3]ã€[4]ï¼šä¿è¯æœç´¢åŒºé—´æ˜¯é—­åŒºé—´ï¼ˆä¿è¯æœç´¢åŒºé—´ä¹‹é—´æ²¡æœ‰é‡å ï¼‰</li><li>[5]ï¼šè€ƒè™‘ç»ˆæ­¢æ¡ä»¶æ—¶ï¼Œ<code>left</code>å’Œ<code>right</code>çš„æƒ…å†µï¼š1ã€å¦‚æœ<code>nums</code>ä¸­å­˜åœ¨<code>target</code>ï¼Œ<code>nums[left] == target</code>ï¼›2ã€å¦‚æœ<code>nums</code>ä¸­ä¸å­˜åœ¨<code>target</code>ï¼Œ<code>left == nums.size() || left == 0</code>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// [left, right) æœç´¢åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">searchLeftBound</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">while</span>(left &lt; right)&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target)&#123;<br>            right = mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &gt; target)&#123;<br>            right = mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> (left &lt; nums.<span class="hljs-built_in">size</span>() &amp;&amp; nums[left] == target) ? left : <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¯»æ‰¾å³ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾">å¯»æ‰¾å³ä¾§è¾¹ç•Œçš„äºŒåˆ†æŸ¥æ‰¾</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ä½¿ç”¨ [left, right] é—­åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">searchRightBound</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span>(left &lt;= right)&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &gt; target)&#123;<br>            right = mid - <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> (right &gt;= <span class="hljs-number">0</span> &amp;&amp; nums[right] == target) ? right : <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>é‡ç‚¹è¯´ä¸€ä¸‹<code>return</code>ï¼šæŸ¥æ‰¾å³è¾¹ç•Œçš„æƒ…å†µè¦äº›è®¸å¤æ‚ä¸€ç‚¹ï¼Œå’Œæœç´¢åŒºé—´çš„å¼€é—­æœ‰ä¸€å®šçš„å…³ç³»ã€‚å¯¹äºé—­åŒºé—´ï¼Œç»ˆæ­¢æ¡ä»¶æ˜¯<code>left == right + 1</code>ï¼Œç»è¿‡ç®€å•çš„æ¨ç†å¯ä»¥çŸ¥é“å¦‚æœnumsä¸­å­˜åœ¨targetçš„è¯ï¼Œnums[right]==targetï¼›å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œ<code>right == -1 || right = nums.size() - 1</code>ï¼Œåˆ†åˆ«å¯¹åº”äº<code>target</code>å°äºå…¨éƒ¨<code>nums</code>å…ƒç´ å’Œå¤§äºå…¨éƒ¨<code>nums</code>å…ƒç´ ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// ä½¿ç”¨ [left, right) å¼€åŒºé—´</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">searchRightBound</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">while</span>(left &lt; right)&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span>(nums[mid] == target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &gt; target)&#123;<br>            right = mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(nums[mid] &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> (right &gt; <span class="hljs-number">0</span> &amp;&amp; nums[right - <span class="hljs-number">1</span>] == target) ? right - <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>è€Œå¯¹äºå¼€åŒºé—´ï¼Œå¦‚æœ<code>nums</code>ä¸­å­˜åœ¨<code>target</code>ï¼Œ<code>nums[right - 1] == target</code>ï¼ˆå› ä¸ºæ˜¯å¼€åŒºé—´ï¼Œ<code>right</code>ä½ç½®çš„å€¼æ˜¯å–ä¸åˆ°çš„ï¼Œæ‰€ä»¥éœ€è¦å‡ä¸€ï¼‰ï¼›å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œ<code>right == 0 || right == nums.size()</code>ï¼ŒåŒæ ·åˆ†åˆ«å¯¹åº”äº<code>target</code>å°äºå…¨éƒ¨<code>nums</code>å…ƒç´ å’Œå¤§äºå…¨éƒ¨<code>nums</code>å…ƒç´ ã€‚</li></ul><h3 id="äºŒåˆ†æœç´¢çš„é¢˜å‹è§£æ">äºŒåˆ†æœç´¢çš„é¢˜å‹è§£æ</h3><p>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ä½¿ç”¨äºŒåˆ†æœç´¢çš„æƒ…æ™¯ä¸€èˆ¬å¦‚ä¸‹ï¼šã€æœ‰åºæ•°ç»„ã€‘ã€ã€æŸ¥æ‰¾å…ƒç´ æˆ–å…ƒç´ è¾¹ç•Œã€‘</p><p>ä½†æ˜¯è¿™å¤§å¤§é™åˆ¶äº†äºŒåˆ†æœç´¢çš„ä½¿ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å¯¹äºŒåˆ†æœç´¢ä½¿ç”¨çš„åœºæ™¯åšä¸€ä¸‹æŠ½è±¡å’Œæ€»ç»“ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯æŠŠçœ¼å…‰æ”¾åˆ°äºŒåˆ†æœç´¢çš„æœ€æ™®é€šçš„åœºæ™¯ä¸Šã€‚å…¶å®å¯¹äºŒåˆ†æœç´¢æœ€é‡è¦çš„æ˜¯ã€æœ‰åºæ•°ç»„ã€‘ï¼Œåªæœ‰æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬æ‰èƒ½æ ¹æ®ä¸­é—´ä½ç½®çš„æƒ…å†µä¸€æ¬¡ç­›é™¤æ‰ä¸€åŠçš„å…ƒç´ ï¼Œä»¥è¾¾åˆ°<spanclass="math inline">\(lg(n)\)</span>çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p>å…¶å®ï¼Œã€æœ‰åºæ•°ç»„ã€‘æœ¬è´¨ä¸Šæ˜¯ã€å•è°ƒã€‘ï¼ŒäºŒåˆ†æœç´¢ä¹‹æ‰€ä»¥å¯ä»¥è¾¾åˆ°<spanclass="math inline">\(lg(n)\)</span>çš„å¤æ‚åº¦ï¼Œå°±æ˜¯åˆ©ç”¨äº†ã€å•è°ƒã€‘çš„æ€§è´¨ã€‚</p><p>è¿›ä¸€æ­¥æ³›åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°æƒ…æ™¯æŠ½è±¡æˆ</p><blockquote><p>å­˜åœ¨ä¸€ä¸ªå•è°ƒå‡½æ•° f(x) ï¼Œç»™å®š ä¸€ä¸ªå€¼ target ï¼Œè¿”å› ä»¤ f(x) = targetæˆç«‹çš„ x</p><p>ï¼ˆè¿™ä¸ªå•è°ƒå‡½æ•°å…¶å®å°±æ˜¯è¿”å›ä¸‹æ ‡xå¯¹åº”çš„numsæ•°ç»„ä¸­çš„å€¼ï¼‰</p></blockquote><p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ä»é¢˜ç›®ä¸­æŠ½è±¡å‡º</p><p>1ã€è‡ªå˜é‡ x</p><p>2ã€å»ºç«‹åœ¨ x ä¸Šçš„å•è°ƒå‡½æ•°</p><p>3ã€ä¸€ä¸ªtarget</p><p>æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æœç´¢</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">f</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> nums[x];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">binarySearch</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums, <span class="hljs-type">int</span> target)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">whilie</span>(left &lt;= right)&#123;<br>        <span class="hljs-type">int</span> mid = left + (right - left) / <span class="hljs-number">2</span>;<br>        <span class="hljs-type">int</span> res = <span class="hljs-built_in">f</span>(nums, mid);<br>        <span class="hljs-keyword">if</span>(res == target) &#123;<br>            <span class="hljs-keyword">return</span> mid;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (res &gt; target)&#123;<br>            right = mid - <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (res &lt; target)&#123;<br>            left = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹é¢é€šè¿‡ä¸‰ä¸ªé¢˜ç›®æ¥å…·ä½“è®²è§£ä¸€ä¸‹</p><ul><li>ã€875.çˆ±åƒé¦™è•‰çš„ç‚ç‚ã€‘</li></ul><blockquote><p>ç‚ç‚å–œæ¬¢åƒé¦™è•‰ã€‚è¿™é‡Œæœ‰ <code>n</code> å †é¦™è•‰ï¼Œç¬¬ <code>i</code>å †ä¸­æœ‰ <code>piles[i]</code> æ ¹é¦™è•‰ã€‚è­¦å«å·²ç»ç¦»å¼€äº†ï¼Œå°†åœ¨ <code>h</code>å°æ—¶åå›æ¥ã€‚</p><p>ç‚ç‚å¯ä»¥å†³å®šå¥¹åƒé¦™è•‰çš„é€Ÿåº¦ <code>k</code>ï¼ˆå•ä½ï¼šæ ¹/å°æ—¶ï¼‰ã€‚æ¯ä¸ªå°æ—¶ï¼Œå¥¹å°†ä¼šé€‰æ‹©ä¸€å †é¦™è•‰ï¼Œä»ä¸­åƒæ‰ <code>k</code>æ ¹ã€‚å¦‚æœè¿™å †é¦™è•‰å°‘äº <code>k</code>æ ¹ï¼Œå¥¹å°†åƒæ‰è¿™å †çš„æ‰€æœ‰é¦™è•‰ï¼Œç„¶åè¿™ä¸€å°æ—¶å†…ä¸ä¼šå†åƒæ›´å¤šçš„é¦™è•‰ã€‚</p><p>ç‚ç‚å–œæ¬¢æ…¢æ…¢åƒï¼Œä½†ä»ç„¶æƒ³åœ¨è­¦å«å›æ¥å‰åƒæ‰æ‰€æœ‰çš„é¦™è•‰ã€‚</p><p>è¿”å›å¥¹å¯ä»¥åœ¨ <code>h</code> å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦<code>k</code>ï¼ˆ<code>k</code> ä¸ºæ•´æ•°ï¼‰ã€‚</p></blockquote><p>åˆ†æï¼š</p><ol type="1"><li><p>xï¼šåƒé¦™è•‰çš„é€Ÿåº¦ k</p></li><li><p>f(x)ï¼šåœ¨kçš„åƒé¦™è•‰é€Ÿåº¦ä¸‹ï¼Œéœ€è¦çš„æ—¶é—´</p><p><strong><span class="math inline">\(f(x) = \sum_{i=1}^{n} \lceil\frac{piles[i]}{x} \rceil\)</span></strong></p><p>å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªå•è°ƒå‡½æ•°</p></li><li><p>targetï¼šf(x) &lt;= h</p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minEatingSpeed</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; piles, <span class="hljs-type">int</span> h)</span> </span>&#123;<br>        <span class="hljs-comment">// 1 ç¡®å®š åƒé¦™è•‰é€Ÿåº¦ x çš„åŒºé—´ [low, high]</span><br>        <span class="hljs-type">int</span> low = <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> max = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> pile : piles) &#123;<br>            <span class="hljs-keyword">if</span> (max &lt; pile) &#123;<br>                max = pile;<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">int</span> high = max;<br>        <br>        <span class="hljs-comment">// 2 äºŒåˆ†æœç´¢</span><br>        <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>            <span class="hljs-type">int</span> mid = low + (high - low) / <span class="hljs-number">2</span>;<br>            <span class="hljs-type">long</span> hours = <span class="hljs-built_in">timeCost</span>(piles, mid);<br>            <span class="hljs-keyword">if</span> (hours &lt;= h) &#123;<br>                high = mid - <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (hours &gt; h) &#123;<br>                low = mid + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> low;<br>    &#125;<br><br>    <span class="hljs-comment">// f(x)</span><br>    <span class="hljs-function"><span class="hljs-type">long</span> <span class="hljs-title">timeCost</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>        <span class="hljs-type">long</span> hours = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">double</span> speed = k;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            hours += <span class="hljs-built_in">ceil</span>(nums[i] / speed);<br>        &#125;<br>        <span class="hljs-keyword">return</span> hours;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>ã€1011.åœ¨-d-å¤©å†…é€è¾¾åŒ…è£¹çš„èƒ½åŠ›ã€‘</li></ul><blockquote><p>ä¼ é€å¸¦ä¸Šçš„åŒ…è£¹å¿…é¡»åœ¨ <code>days</code>å¤©å†…ä»ä¸€ä¸ªæ¸¯å£è¿é€åˆ°å¦ä¸€ä¸ªæ¸¯å£ã€‚</p><p>ä¼ é€å¸¦ä¸Šçš„ç¬¬ <code>i</code> ä¸ªåŒ…è£¹çš„é‡é‡ä¸º<code>weights[i]</code>ã€‚æ¯ä¸€å¤©ï¼Œæˆ‘ä»¬éƒ½ä¼šæŒ‰ç»™å‡ºé‡é‡ï¼ˆ<code>weights</code>ï¼‰çš„é¡ºåºå¾€ä¼ é€å¸¦ä¸Šè£…è½½åŒ…è£¹ã€‚æˆ‘ä»¬è£…è½½çš„é‡é‡ä¸ä¼šè¶…è¿‡èˆ¹çš„æœ€å¤§è¿è½½é‡é‡ã€‚</p><p>è¿”å›èƒ½åœ¨ <code>days</code>å¤©å†…å°†ä¼ é€å¸¦ä¸Šçš„æ‰€æœ‰åŒ…è£¹é€è¾¾çš„èˆ¹çš„æœ€ä½è¿è½½èƒ½åŠ›ã€‚</p></blockquote><p>åˆ†æï¼š</p><ol type="1"><li><p>xï¼šèˆ¹çš„è¿è½½èƒ½åŠ›</p></li><li><p>f(x)ï¼šèˆ¹çš„è¿è½½èƒ½åŠ›å¯¹åº”çš„éœ€è¦çš„å¤©æ•°</p><p>è¿™ä¸ªæ¯”è¾ƒæ˜æ˜¾ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œèˆ¹çš„è¿è½½èƒ½åŠ›è¶Šå¤§ï¼Œéœ€è¦çš„å¤©æ•°è‚¯å®šä¸ä¼šè¶Šå¤šï¼Œåº”è¯¥æ˜¯éé€’å¢å‡½æ•°ã€‚</p></li><li><p>targetï¼šf(x) &lt;= days</p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">shipWithinDays</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; weights, <span class="hljs-type">int</span> days)</span> </span>&#123;<br>        <span class="hljs-comment">// èˆ¹çš„æœ€ä½æ‰¿è½½èƒ½åŠ›ä¸èƒ½å°äºweightsæ•°ç»„ä¸­æœ€å¤§çš„å…ƒç´ </span><br>        <span class="hljs-comment">// æœ€é«˜æ‰¿è½½èƒ½åŠ›åªè¦æ˜¯weightsæ•°ç»„å…ƒç´ ä¹‹å’Œå³å¯</span><br>        <span class="hljs-type">int</span> low = <span class="hljs-number">0</span>, high = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> weight : weights) &#123;<br>            low = <span class="hljs-built_in">max</span>(weight, low);<br>            high += weight;<br>        &#125;<br>        <br>        <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>            <span class="hljs-type">int</span> mid = low + (high - low) / <span class="hljs-number">2</span>;<br>            <span class="hljs-type">int</span> day = <span class="hljs-built_in">daysNeeded</span>(weights, mid);<br>            <span class="hljs-keyword">if</span> (day &lt;= days) &#123;<br>                high = mid - <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (day &gt; days) &#123;<br>                low = mid + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> low;<br>    &#125;<br><br>    <span class="hljs-comment">// f(x) æŸè¿è½½èƒ½åŠ›ä¸‹ï¼Œéœ€è¦çš„å¤©æ•°</span><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">daysNeeded</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; weights, <span class="hljs-type">int</span> capacity)</span> </span>&#123;<br>        <span class="hljs-type">int</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> days = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> weight : weights) &#123;<br>            <span class="hljs-keyword">if</span> (sum + weight &gt; capacity) &#123;<br>                days++;<br>                sum = weight;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                sum += weight;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (sum &gt; <span class="hljs-number">0</span>) days++;<br>        <span class="hljs-keyword">return</span> days;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>ã€410.åˆ†å‰²æ•°ç»„çš„æœ€å¤§å€¼ã€‘</li></ul><blockquote><p>ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ <code>nums</code> å’Œä¸€ä¸ªæ•´æ•° <code>m</code>ï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ•°ç»„åˆ†æˆ <code>m</code> ä¸ªéç©ºçš„è¿ç»­å­æ•°ç»„ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•ä½¿å¾—è¿™ <code>m</code> ä¸ªå­æ•°ç»„å„è‡ªå’Œçš„æœ€å¤§å€¼æœ€å°ã€‚</p></blockquote><p>è¿™é“é¢˜åœ¨f(x)çš„é€‰æ‹©ä¸Šæ¯”è¾ƒå·§å¦™</p><p>ã€åˆ†æã€‘</p><p>é¦–å…ˆï¼Œåˆ’åˆ†æˆå¤šå°‘ä¸ªå­æ•°ç»„ï¼ˆmï¼‰æ˜¯ç¡®å®šçš„ï¼Œå­æ•°ç»„å’Œçš„æœ€å¤§å€¼åªæ˜¯è·Ÿåˆ’åˆ†æ–¹å¼æœ‰å…³ã€‚ä½†æ˜¯åˆ’åˆ†æ–¹å¼åˆä¸å¥½ç”¨æ•°è¡¨ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æƒ³å†™æˆå­æ•°ç»„å’Œçš„æœ€å¤§å€¼å…³äºåˆ’åˆ†æ–¹å¼çš„å‡½æ•° è‚¯å®šæ˜¯è¡Œä¸é€šçš„ã€‚</p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬è¦å†™æˆ f(x) çš„å½¢å¼ï¼Œå…¶ä¸­ xè‚¯å®šæ˜¯æ•°ã€‚åœ¨è¿™é“é¢˜ä¸­ï¼Œå”¯ä¸€ä¼šå˜åŒ–çš„æ•°å°±æ˜¯å­æ•°ç»„çš„å’Œçš„æœ€å¤§å€¼ã€‚æ‰€ä»¥å¤§æ¦‚å¯ä»¥ç¡®å®šï¼Œxå°±æ˜¯å­æ•°ç»„å’Œçš„æœ€å¤§å€¼ã€‚</p><p>é‚£ f(x)æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ ¹æ®é¢˜æ„å¤§æ¦‚å°±æ˜¯ã€æ˜¯å¦å­˜åœ¨æŸç§åˆ’åˆ†æ–¹å¼ä½¿å¾—å­æ•°ç»„å’Œçš„æœ€å¤§å€¼=xã€‘è¿™æ ·çš„å‡½æ•°ï¼Œå¾—åˆ°çš„æ˜¯0 å’Œ 1ã€‚åªè¦è¿™ä¸ªå‡½æ•°ä»¥æŸä¸ªåˆ†ç•Œç‚¹ä¸€è¾¹æ˜¯0ä¸€è¾¹æ˜¯1ï¼Œä¹Ÿæ˜¯ä¸€ç§å•è°ƒå‡½æ•°ã€‚</p><p>ä½†æ˜¯å¾ˆé—æ†¾ï¼Œã€æ˜¯å¦å­˜åœ¨æŸç§åˆ’åˆ†æ–¹å¼ä½¿å¾—å­æ•°ç»„å’Œçš„æœ€å¤§å€¼=xã€‘è¿™ä¸ªå‡½æ•°å¾—åˆ°çš„0/1åˆ†å¸ƒæ˜¯æ•£ä¹±çš„ã€‚</p><p>ä¸‹é¢è¿™ä¸ªå°±æ˜¯æœ€æœ‰æŠ€å·§çš„ä¸€æ­¥äº†ï¼š<font color='red'>ã€æ˜¯å¦å­˜åœ¨æŸç§åˆ’åˆ†æ–¹å¼ä½¿å¾—å­æ•°ç»„å’Œçš„æœ€å¤§å€¼&lt;= xã€‘</font></p><p>è¿™ä¸ªå‡½æ•°å¾—åˆ°çš„0/1åˆ†å¸ƒå°±æ˜¯ä»¥æŸä¸ªç‚¹ä¸ºåˆ†ç•Œçº¿çš„ï¼Œæ˜¯å•è°ƒçš„ã€‚</p><ol type="1"><li>xï¼šå­æ•°ç»„å’Œçš„æœ€å¤§å€¼</li><li>f(x)ï¼šæ˜¯å¦å­˜åœ¨æŸç§åˆ’åˆ†æ–¹å¼ä½¿å¾—å­æ•°ç»„å’Œçš„æœ€å¤§å€¼ &lt;= x</li><li>targetï¼šf(x) == 1</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">splitArray</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> m)</span> </span>&#123;<br>        <span class="hljs-comment">// 1 åˆ¤æ–­ x çš„èŒƒå›´: æ•°ç»„numsçš„æœ€å¤§å€¼ - æ•°ç»„numsçš„å…ƒç´ ä¹‹å’Œ</span><br>        <span class="hljs-type">int</span> low = <span class="hljs-number">0</span>, high = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            low = <span class="hljs-built_in">max</span>(num, low);<br>            high += num;<br>        &#125;<br>        <br>        <span class="hljs-comment">// 2 äºŒåˆ†æœç´¢</span><br>        <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>            <span class="hljs-type">int</span> mid = low + (high - low) / <span class="hljs-number">2</span>;<br>            <span class="hljs-type">bool</span> res = <span class="hljs-built_in">isExist</span>(nums, m, mid);<br>            <span class="hljs-keyword">if</span> (res == <span class="hljs-literal">true</span>) &#123;<br>                high = mid - <span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (res == <span class="hljs-literal">false</span>) &#123;<br>                low = mid + <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> low;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ç§åˆ†å‰²æ–¹å¼ä½¿å¾—å­æ•°ç»„çš„å’Œçš„æœ€å¤§å€¼&lt;=x</span><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç›¸åçš„æ€è·¯: å°†æ•°ç»„å°½å¯èƒ½å°‘çš„åˆ†æˆå’Œå°äºxçš„å­æ•°ç»„ï¼Œå¦‚æœæœ€ç»ˆå¾—åˆ°çš„å­æ•°ç»„æ•° &lt;= m(è¦æ±‚åˆ’åˆ†çš„å­æ•°ç»„ä¸ªæ•°), é‚£ä¹ˆå°±æ˜¯c</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isExist</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> m, <span class="hljs-type">int</span> max)</span> </span>&#123;<br>        <span class="hljs-type">long</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;<br>            <span class="hljs-keyword">if</span> (sum + num &gt; max) &#123;<br>                cnt++;<br>                sum = num;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                sum += num;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (sum &gt; <span class="hljs-number">0</span>) cnt++;<br>        <span class="hljs-keyword">return</span> cnt &lt;= m;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­å¯»æ‰¾ç¬¬kä¸ªå…ƒç´ ">åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­å¯»æ‰¾ç¬¬kä¸ªå…ƒç´ </h3><blockquote><p><ahref="https://leetcode.cn/problems/median-of-two-sorted-arrays/">4.å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°</a></p></blockquote><p>è¿™é“é¢˜ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„è¯ï¼Œå¯ä»¥å°†é—®é¢˜è½¬åŒ–æˆã€åœ¨ä¸¤ä¸ªæœ‰åºæ•°ç»„ä¸­å¯»æ‰¾ç¬¬kå°çš„å…ƒç´ ã€‘</p><p>ã€æ€è·¯ã€‘æ˜¯å¯¹<code>k</code>åšäºŒåˆ†ã€‚æ¯æ¬¡å‘å‰èµ°<code>k/2-1</code>ä¸ªå…ƒç´ ï¼Œç›´åˆ°æ•°ç»„æœ«å°¾ï¼Œè¿™æ ·ä¸€æ¬¡æ¯”è¾ƒå°±å¯ä»¥æ’é™¤<code>k/2</code>ä¸ªå…ƒç´ ï¼Œå°±æ˜¯æ›´å°çš„é‚£ä¸ªå…ƒç´ å¯¹åº”æ•°ç»„èµ°çš„é‚£<code>k/2</code>ä¸ªå…ƒç´ ã€‚</p><figure><imgsrc="https://my-pictures-repo.obs.cn-east-3.myhuaweicloud.com/my-blog-imgs/image-20230304120343432.png"alt="è¿‡ç¨‹" /><figcaption aria-hidden="true">è¿‡ç¨‹</figcaption></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">// nums1å’Œnums2ä¸ºä¸¤ä¸ªæœ‰åºæ•°ç»„</span><br><span class="hljs-comment">// éœ€è¦æ‰¾åˆ°ä¸¤ä¸ªæ•°ç»„ä¸­ç¬¬kå°çš„å…ƒç´  æ³¨æ„ç¬¬1å°çš„å…ƒç´ åº”è¯¥æ˜¯0ä¸ºä¸‹æ ‡</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">findKthElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-type">int</span> m = nums1.<span class="hljs-built_in">size</span>(), n = nums2.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-type">int</span> index1 = <span class="hljs-number">0</span>, index2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-comment">// ä¸€ä¸ªæ•°ç»„å·²ç»éå†å®Œï¼Œç›´æ¥å»å¦ä¸€ä¸ªæ•°ç»„çš„å¯¹åº”åŒºé—´ä¸­æ‰¾</span><br>        <span class="hljs-keyword">if</span> (index1 &gt;= m) <span class="hljs-keyword">return</span> nums[index2+k<span class="hljs-number">-1</span>];<br>        <span class="hljs-keyword">if</span> (index2 &gt;= n) <span class="hljs-keyword">return</span> nums[index1+k<span class="hljs-number">-1</span>];<br>        <span class="hljs-comment">// base case é€‰æ‹©ä¸¤ä¸ªæ•°ç»„å½“å‰èµ°åˆ°ä½ç½®é‡Œæ›´å°çš„ä¸€ä¸ª</span><br>        <span class="hljs-keyword">if</span> (k == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(nums1[index1], nums2[index2]);<br>        <br>        <span class="hljs-comment">// éœ€è¦è€ƒè™‘æ˜¯å¦ä¼šè¶…å‡ºæ•°ç»„é•¿åº¦</span><br>        <span class="hljs-type">int</span> newIndex1 = <span class="hljs-built_in">min</span>(index1+k/<span class="hljs-number">2</span>, m) - <span class="hljs-number">1</span>;<br>        <span class="hljs-type">int</span> newIndex2 = <span class="hljs-built_in">min</span>(index2+k/<span class="hljs-number">2</span>, n) - <span class="hljs-number">1</span>;<br>        <br>        <span class="hljs-keyword">if</span> (nums1[newIndex1] &gt;= nums2[newIndex2]) &#123;<br>            k -= (newIndex2 - index2 + <span class="hljs-number">1</span>);<br>            index2 = newIndex2 + <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            k -= (newIndex1 - index1 + <span class="hljs-number">1</span>);<br>            index1 = newIndex1 + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç”°å¿Œèµ›é©¬">ç”°å¿Œèµ›é©¬</h2><blockquote><p>ä¼˜åŠ¿æ´—ç‰Œ 870</p></blockquote><p>ç®—æ³•æ€æƒ³ï¼š<font color='red'><strong>å¦‚æœæ²¡åŠæ³•èµ¢å°±ç”¨æœ€å·®çš„å»è¾“</strong></font></p><blockquote><p>ç»™å®šä¸¤ä¸ªå¤§å°ç›¸ç­‰çš„æ•°ç»„ <code>nums1</code> å’Œ<code>nums2</code>ï¼Œ<code>nums1</code> ç›¸å¯¹äº <code>nums</code>çš„<em>ä¼˜åŠ¿</em>å¯ä»¥ç”¨æ»¡è¶³ <code>nums1[i] &gt; nums2[i]</code> çš„ç´¢å¼•<code>i</code> çš„æ•°ç›®æ¥æè¿°ã€‚</p><p>è¿”å› nums1 çš„<strong>ä»»æ„</strong>æ’åˆ—ï¼Œä½¿å…¶ç›¸å¯¹äº <code>nums2</code>çš„ä¼˜åŠ¿æœ€å¤§åŒ–ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-type">const</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&amp; p1, <span class="hljs-type">const</span> pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&amp; p2)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> p1.second &lt; p2.second;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">advantageCount</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2)</span> </span>&#123;<br>        <span class="hljs-comment">// 1 ç”±äºæœ€ç»ˆçš„ç»“æœæ˜¯æ ¹æ®nums2çš„åŸå§‹é¡ºåºçš„ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å¯¹nums2è¿›è¡Œæ’åºï¼Œéœ€è¦ä½¿ç”¨priority_queueè¿›è¡Œæ’åº</span><br>        vector&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; v;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums2.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            v.<span class="hljs-built_in">push_back</span>(&#123;i, nums2[i]&#125;);<br>        &#125;<br>        <span class="hljs-built_in">sort</span>(v.<span class="hljs-built_in">begin</span>(), v.<span class="hljs-built_in">end</span>(), cmp);<br>        <span class="hljs-comment">// 2 æ’åºnums1</span><br>        <span class="hljs-built_in">sort</span>(nums1.<span class="hljs-built_in">begin</span>(), nums1.<span class="hljs-built_in">end</span>());<br>        <span class="hljs-comment">// 3 ä½¿ç”¨åŒæŒ‡é’ˆè¿›è¡Œéå†</span><br>        <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(nums1.size())</span></span>;<br>        <span class="hljs-type">int</span> right = nums1.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>, left = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> index = right;<br><br>        <span class="hljs-keyword">while</span> (index &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// æœ‰ä¼˜åŠ¿</span><br>            <span class="hljs-keyword">if</span> (nums1[right] &gt; v[index].second) &#123;<br>                res[v[index].first] = nums1[right];<br>                right--;<br>            &#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// æ²¡æœ‰ä¼˜åŠ¿</span><br>                res[v[index].first] = nums1[left];<br>                left++;<br>            &#125;<br>            index--;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="åŸåœ°ä¿®æ”¹æ•°ç»„">åŸåœ°ä¿®æ”¹æ•°ç»„</h2><blockquote><p>åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹ 26</p><p>åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  83</p><p>ç§»é™¤å…ƒç´  27</p><p>ç§»åŠ¨é›¶ 283</p></blockquote><h3 id="å¿«æ…¢æŒ‡é’ˆ">å¿«æ…¢æŒ‡é’ˆ</h3><blockquote><p>è®©å¿«æŒ‡é’ˆåœ¨å‰é¢æ¢è·¯ï¼Œå½“å¿«æŒ‡é’ˆæ‰€æŒ‡å‘çš„å€¼å’Œæ…¢æŒ‡é’ˆä¸åŒæ—¶ï¼Œåˆ™å°†æ…¢æŒ‡é’ˆå‘å‰ç§»åŠ¨å¹¶æ›´æ–°å…¶å€¼ä¸ºå¿«æŒ‡é’ˆæ‰€æŒ‡å‘çš„å€¼</p></blockquote><ul><li>ã€åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">removeDuplicates</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>    <span class="hljs-type">int</span> slow = <span class="hljs-number">0</span>, fast = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(fast != nums.<span class="hljs-built_in">size</span>())&#123;<br>        <span class="hljs-keyword">if</span>(nums[slow] != nums[fast])&#123;<br>            slow ++;<br>            nums[slow] = nums[fast];<br>        &#125;<br>        fast++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> slow + <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode* <span class="hljs-title">deleteDuplicates</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(head == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    ListNode* slow = head, * fast = head;<br>    <span class="hljs-keyword">while</span>(fast != <span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">if</span>(fast-&gt;val != slow-&gt;val)&#123;<br>            slow-&gt;next = fast;<br>            slow = slow-&gt;next;<br>        &#125;<br>        fast = fast-&gt;next;<br>    &#125;<br>    slow-&gt;next = <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">return</span> head;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ç§»é™¤å…ƒç´ ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">removeElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> val)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>, right = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (left &lt;= right) &#123;<br>        <span class="hljs-keyword">if</span> (nums[left] == val) &#123;<br>            nums[left] = nums[right];<br>            right--;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            left++;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> left;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">removeElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> val)</span> </span>&#123;<br>    <span class="hljs-type">int</span> slow = <span class="hljs-number">0</span>, fast = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (fast != nums.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">if</span> (nums[fast] != val) &#123;<br>            nums[slow] = nums[fast];<br>            slow++;<br>        &#125;<br>        fast++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> slow;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ç§»é™¤é›¶ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">ç§»é™¤0å…ƒç´  + æœ«å°¾ä¿®æ”¹æˆ0</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">moveZeroes</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">removeElement</span>(nums, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">for</span>(; len &lt; nums.<span class="hljs-built_in">size</span>(); len++)&#123;<br>        nums[len] = <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ku&#x27;ao</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">moveZeroes</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>    <span class="hljs-type">int</span> slow = <span class="hljs-number">0</span>, fast = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (fast != nums.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">if</span> (nums[fast] != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-comment">// swap</span><br>            <span class="hljs-type">int</span> tmp = nums[slow];<br>            nums[slow] = nums[fast];<br>            nums[fast] = tmp;<br>            <br>            slow++;<br>        &#125;<br>        fast++;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å•é“¾è¡¨é—®é¢˜">å•é“¾è¡¨é—®é¢˜</h2><blockquote><p>åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ 21</p><p>åˆå¹¶Kä¸ªå‡åºé“¾è¡¨ 23</p><p>ç¯å½¢é“¾è¡¨ 141</p><p>ç¯å½¢é“¾è¡¨â…¡ 142</p><p>é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ 876 =&gt; å¿«æ…¢æŒ‡é’ˆ fastæŒ‡é’ˆèµ°2æ­¥ï¼ŒslowæŒ‡é’ˆèµ°1æ­¥</p><p>ç›¸äº¤é“¾è¡¨ 160</p><p>åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ 19 =&gt; åŒæŒ‡é’ˆä¸€ä¸ªæŒ‡é’ˆå…ˆèµ°næ­¥ï¼Œå†ä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶èµ°</p></blockquote><ul><li>ã€åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ã€‘</li></ul><p>é‡‡ç”¨åŒæŒ‡é’ˆ + <font color='red'><strong>dummyå¤´ç»“ç‚¹</strong></font></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode* <span class="hljs-title">mergeTwoLists</span><span class="hljs-params">(ListNode* list1, ListNode* list2)</span> </span>&#123;<br>    ListNode* dummy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ListNode</span>(<span class="hljs-number">-1</span>);<br>    ListNode *p = dummy, *p1 = list1, *p2 = list2;<br>    <span class="hljs-keyword">while</span> (p1 != <span class="hljs-literal">nullptr</span> &amp;&amp; p2 != <span class="hljs-literal">nullptr</span>) &#123;<br>        <span class="hljs-keyword">if</span> (p1-&gt;val &gt; p2-&gt;val) &#123;<br>            p-&gt;next = p2;<br>            p2 = p2-&gt;next;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            p-&gt;next = p1;<br>            p1 = p1-&gt;next;<br>        &#125;<br>        p = p-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (p1 != <span class="hljs-literal">nullptr</span>) &#123;<br>        p-&gt;next = p1;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (p2 != <span class="hljs-literal">nullptr</span>) &#123;<br>        p-&gt;next = p2;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> dummy-&gt;next;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€åˆå¹¶kä¸ªå‡åºé“¾è¡¨ã€‘</li></ul><p>å‰ä¸€é“é¢˜çš„å‡çº§ç‰ˆã€‚éš¾åº¦åœ¨äºå¦‚ä½•å¿«é€Ÿæ‰¾åˆ° k ä¸ª ListNode ä¸­çš„æœ€å°ç»“ç‚¹=&gt; ä½¿ç”¨ priority_queue æœ€å°å †</p><p>ç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="math inline">\(O(NlgK)\)</span></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">cmp</span> &#123;<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(ListNode* p1, ListNode* p2)</span> </span>&#123; <span class="hljs-keyword">return</span> p1-&gt;val &gt; p2-&gt;val; &#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode* <span class="hljs-title">mergeKLists</span><span class="hljs-params">(vector&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;<br>        <span class="hljs-comment">// æœ€å°å †</span><br>        priority_queue&lt;ListNode*, vector&lt;ListNode*&gt;, cmp&gt; q;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; lists.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-keyword">if</span> (lists[i] != <span class="hljs-literal">nullptr</span>) q.<span class="hljs-built_in">push</span>(lists[i]);<br>        &#125;<br><br>        ListNode* dummy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ListNode</span>(<span class="hljs-number">-1</span>);<br>        ListNode* p = dummy;<br>        <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>()) &#123;<br>            ListNode* t = q.<span class="hljs-built_in">top</span>();<br>            q.<span class="hljs-built_in">pop</span>();<br>            p-&gt;next = t;<br>            p = p-&gt;next;<br>            <span class="hljs-comment">// è¯¥é“¾è¡¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ŒåŠ å…¥å †ä¸­</span><br>            <span class="hljs-keyword">if</span> (t-&gt;next != <span class="hljs-literal">nullptr</span>) &#123;<br>                t = t-&gt;next;<br>                q.<span class="hljs-built_in">push</span>(t);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dummy-&gt;next;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>ã€åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode* <span class="hljs-title">removeNthFromEnd</span><span class="hljs-params">(ListNode* head, <span class="hljs-type">int</span> n)</span> </span>&#123;<br>    ListNode* dummy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ListNode</span>(<span class="hljs-number">-1</span>);<br>    dummy-&gt;next = head;<br>    ListNode *p1 = head, *p2 = dummy;<br>    <span class="hljs-comment">// p1å…ˆå‘å‰èµ°næ­¥</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>        p1 = p1-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// p1å’Œp2ä¸€èµ·å‘å‰èµ° ç›´åˆ°p1èµ°åˆ°é“¾è¡¨æœ«å°¾</span><br>    <span class="hljs-keyword">while</span> (p1 != <span class="hljs-literal">nullptr</span>) &#123;<br>        p1 = p1-&gt;next;<br>        p2 = p2-&gt;next;<br>    &#125;<br>    p2-&gt;next = p2-&gt;next-&gt;next;<br>    <span class="hljs-keyword">return</span> dummy-&gt;next;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€é“¾è¡¨çš„ä¸­é—´èŠ‚ç‚¹ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// å¿«æ…¢æŒ‡é’ˆ</span><br><span class="hljs-function">ListNode* <span class="hljs-title">middleNode</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>    ListNode *fast = head, *slow = head;<br>    <span class="hljs-comment">// fastä¸€æ¬¡èµ°ä¸¤æ­¥ slowä¸€æ¬¡èµ°ä¸€æ­¥</span><br>    <span class="hljs-keyword">while</span> (fast != <span class="hljs-literal">nullptr</span> &amp;&amp; fast-&gt;next != <span class="hljs-literal">nullptr</span>) &#123;<br>        slow = slow-&gt;next;<br>        fast = fast-&gt;next;<br>        fast = fast-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> slow;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ç¯å½¢é“¾è¡¨ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">hasCycle</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>    ListNode *fast = head, *slow = head;<br>    <span class="hljs-comment">// fast ä¸€æ¬¡èµ°ä¸¤éƒ¨ slow ä¸€æ¬¡èµ°ä¸€æ­¥</span><br>    <span class="hljs-comment">// ç”±äºfastæ›´å¿« åªè¦å­˜åœ¨ç¯ fastå’Œslowä¸€å®šä¼šç›¸é‡</span><br>    <span class="hljs-keyword">while</span> (fast != <span class="hljs-literal">nullptr</span> &amp;&amp; fast-&gt;next != <span class="hljs-literal">nullptr</span>) &#123;<br>        slow = slow-&gt;next;<br>        fast = fast-&gt;next-&gt;next;<br>        <span class="hljs-keyword">if</span> (slow == fast) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ç¯å½¢é“¾è¡¨â…¡ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode *<span class="hljs-title">detectCycle</span><span class="hljs-params">(ListNode *head)</span> </span>&#123;<br>    <span class="hljs-type">bool</span> hasCycle = <span class="hljs-literal">false</span>;<br>    ListNode *fast = head, *slow = head;<br>    <span class="hljs-keyword">while</span> (fast != <span class="hljs-literal">nullptr</span> &amp;&amp; fast-&gt;next != <span class="hljs-literal">nullptr</span>) &#123;<br>        slow = slow-&gt;next;<br>        fast = fast-&gt;next-&gt;next;<br>        <span class="hljs-keyword">if</span> (slow == fast) &#123;<br>            hasCycle = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!hasCycle) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    <br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    è®¾ s æ˜¯ç¯çš„èµ·ç‚¹åˆ°é“¾è¡¨èµ·ç‚¹çš„è·ç¦» l æ˜¯ç›¸é‡ç‚¹åˆ°ç¯çš„èµ·ç‚¹çš„è·ç¦»</span><br><span class="hljs-comment">    æ˜“çŸ¥ æ…¢æŒ‡é’ˆèµ°è¿‡çš„è·ç¦»ä¸º s + l å¿«æŒ‡é’ˆèµ°è¿‡çš„æ˜¯ 2(s + l)</span><br><span class="hljs-comment">    åˆ å¿«æŒ‡é’ˆæ¯”æ…¢æŒ‡é’ˆå¤šèµ°ä¸€ä¸ªç¯çš„é•¿åº¦</span><br><span class="hljs-comment">    æ‰€ä»¥ 2(s+l) - (s+l) = n</span><br><span class="hljs-comment">    s + l = n</span><br><span class="hljs-comment">    =&gt; s = n - l</span><br><span class="hljs-comment">    æ‰€ä»¥ è®©æ…¢æŒ‡é’ˆå›åˆ°é“¾è¡¨èµ·ç‚¹ å¿«æŒ‡é’ˆç»§ç»­å‘å‰ ä»¥ç›¸åŒçš„é€Ÿåº¦èµ° æœ€åä¼šåœ¨ç¯çš„èµ·ç‚¹ç›¸é‡</span><br><span class="hljs-comment">    */</span><br>    slow = head;<br>    <span class="hljs-keyword">while</span> (slow != fast) &#123;<br>        slow = slow-&gt;next;<br>        fast = fast-&gt;next;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> slow;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ç›¸äº¤é“¾è¡¨ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">è®¾Aé“¾è¡¨ä¸Bé“¾è¡¨ç›¸äº¤çš„éƒ¨åˆ†é•¿åº¦ä¸º m</span><br><span class="hljs-comment">Aé“¾è¡¨å‰©ä½™éƒ¨åˆ†é•¿åº¦ä¸º x Bé“¾è¡¨å‰©ä½™éƒ¨åˆ†é•¿åº¦ä¸º y</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">è®© p1 å…ˆèµ°Aé“¾è¡¨ èµ°å®Œå†èµ°Bé“¾è¡¨</span><br><span class="hljs-comment">p2 å…ˆèµ°Bé“¾è¡¨ èµ°å®Œå†èµ°Aé“¾è¡¨</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">å¦‚æœå­˜åœ¨ç›¸äº¤éƒ¨åˆ† é‚£ä¹ˆå°±ä¼šåœ¨ç›¸äº¤çš„èµ·ç‚¹ç›¸é‡ å› ä¸ºèµ°çš„è·ç¦»éƒ½ä¸º x + y + m</span><br><span class="hljs-comment">å¦‚æœä¸å­˜åœ¨ç›¸äº¤éƒ¨åˆ† é‚£ä¹ˆå°±ä¼šä½¿å¾— p1 p2 éƒ½ä¸º nullptr</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function">ListNode *<span class="hljs-title">getIntersectionNode</span><span class="hljs-params">(ListNode *headA, ListNode *headB)</span> </span>&#123;<br>    ListNode *p1 = headA, *p2 = headB;<br>    <span class="hljs-keyword">while</span> (p1 != p2) &#123;<br>        <span class="hljs-keyword">if</span> (p1 == <span class="hljs-literal">nullptr</span>)<br>            p1 = headB;<br>        <span class="hljs-keyword">else</span><br>            p1 = p1-&gt;next;<br><br>        <span class="hljs-keyword">if</span> (p2 == <span class="hljs-literal">nullptr</span>)<br>            p2 = headA;<br>        <span class="hljs-keyword">else</span><br>            p2 = p2-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p1;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é“¾è¡¨æ“ä½œé€’å½’æ€æƒ³">é“¾è¡¨æ“ä½œé€’å½’æ€æƒ³</h2><blockquote><p>åè½¬é“¾è¡¨ 206</p><p>åè½¬é“¾è¡¨ â…¡ 92</p></blockquote><ul><li>åè½¬æ•´ä¸ªé“¾è¡¨</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode* <span class="hljs-title">reverse</span><span class="hljs-params">(ListNode* head)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(head == <span class="hljs-literal">nullptr</span> || head-&gt;next == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> head;<br>    ListNode* p = <span class="hljs-built_in">reverse</span>(head-&gt;next);<br>    <span class="hljs-comment">// æŠŠåä¸€ä¸ªç»“ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘å½“å‰çš„èŠ‚ç‚¹(head)</span><br>    head-&gt;next-&gt;next = head;<br>    head-&gt;next = <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">return</span> p;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>åè½¬é“¾è¡¨çš„å‰nä¸ªç»“ç‚¹</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">ListNode* successor = <span class="hljs-literal">nullptr</span>;<br><span class="hljs-function">ListNode* <span class="hljs-title">reverseN</span><span class="hljs-params">(ListNode* head, <span class="hljs-type">int</span> n)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">1</span>)&#123;<br>        successor = head-&gt;next;<br>        <span class="hljs-keyword">return</span> head;<br>    &#125;<br>    ListNode* p = <span class="hljs-built_in">reverseN</span>(head-&gt;next, --n);<br>    head-&gt;next-&gt;next = head;<br>    head-&gt;next = successor; <span class="hljs-comment">// æ”¹å˜æ¯æ¬¡çš„åç»§ ä½¿å¾—åè½¬åçš„æœ€åä¸€ä¸ªç»“ç‚¹æŒ‡å‘é“¾è¡¨å‰©ä½™éƒ¨åˆ†(n+1ä¸ªç»“ç‚¹)</span><br>    <span class="hljs-keyword">return</span> p;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>åè½¬é“¾è¡¨çš„ä¸€éƒ¨åˆ†</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">ListNode* <span class="hljs-title">reverseBetween</span><span class="hljs-params">(ListNode* head, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(left == <span class="hljs-number">1</span>)&#123; <span class="hljs-comment">// å°±æ˜¯åè½¬å‰nä¸ªç»“ç‚¹</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">reverseN</span>(head, right-left+<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-comment">// å‘å‰di&#x27;gui</span><br>    head-&gt;next = <span class="hljs-built_in">reverseBetween</span>(head-&gt;next, left<span class="hljs-number">-1</span>, right<span class="hljs-number">-1</span>);<br>    <span class="hljs-keyword">return</span> head;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°4-äºŒå‰æ ‘</title>
      <link href="/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B04%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%89/"/>
      <url>/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B04%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€">ï¼ˆä¸€ï¼‰</h2><blockquote><p>ç¿»è½¬äºŒå‰æ ‘ 226</p><p>äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨ 114</p><p>å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ 116</p></blockquote><h3 id="ç¿»è½¬äºŒå‰æ ‘">ã€ç¿»è½¬äºŒå‰æ ‘ã€‘</h3><blockquote><p>ç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code>ï¼Œç¿»è½¬è¿™æ£µäºŒå‰æ ‘ï¼Œå¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">invertTree</span><span class="hljs-params">(TreeNode* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        TreeNode* right = <span class="hljs-built_in">invertTree</span>(root-&gt;left);<br>        TreeNode* left = <span class="hljs-built_in">invertTree</span>(root-&gt;right);<br>        root-&gt;left = left;<br>        root-&gt;right = right;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3id="å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ">ã€å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆã€‘</h3><blockquote><p>ç»™å®šä¸€ä¸ª <strong>å®Œç¾äºŒå‰æ ‘</strong>ï¼Œå…¶æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚äºŒå‰æ ‘å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">struct <span class="hljs-keyword">Node</span> <span class="hljs-title">&#123;</span><br><span class="hljs-title">  int</span> val;<br>  <span class="hljs-keyword">Node</span> <span class="hljs-title">*left</span>;<br>  <span class="hljs-keyword">Node</span> <span class="hljs-title">*right</span>;<br>  <span class="hljs-keyword">Node</span> <span class="hljs-title">*next</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¡«å……å®ƒçš„æ¯ä¸ª nextæŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°†next æŒ‡é’ˆè®¾ç½®ä¸º <code>NULL</code>ã€‚</p><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º <code>NULL</code>ã€‚</p></blockquote><p>ã€åˆ†æã€‘</p><p>è¿™é“é¢˜çš„é€’å½’è§£æ³•ååˆ†å·§å¦™ï¼Œè€Œè¿­ä»£è§£æ³•æ›´ä¸ºè‡ªç„¶</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * @brief å€Ÿç”¨é˜Ÿåˆ—å®ç°çš„è¿­ä»£è§£æ³•</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param root</span><br><span class="hljs-comment">     * @return Node*</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">Node* <span class="hljs-title">connect1</span><span class="hljs-params">(Node* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        queue&lt;Node*&gt; q;<br>        q.<span class="hljs-built_in">push</span>(root);<br>        q.<span class="hljs-built_in">push</span>(<span class="hljs-literal">nullptr</span>);  <span class="hljs-comment">// ç”¨nullptræ ‡å¿—ä¸€å±‚çš„ç»“æŸ</span><br>        <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) &#123;<br>            Node* n = q.<span class="hljs-built_in">front</span>();<br>            q.<span class="hljs-built_in">pop</span>();<br>            <span class="hljs-keyword">if</span> (n != <span class="hljs-literal">nullptr</span>) &#123;<br>                n-&gt;next = q.<span class="hljs-built_in">front</span>();<br>                <span class="hljs-keyword">if</span> (n-&gt;left) q.<span class="hljs-built_in">push</span>(n-&gt;left);<br>                <span class="hljs-keyword">if</span> (n-&gt;right) q.<span class="hljs-built_in">push</span>(n-&gt;right);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                q.<span class="hljs-built_in">push</span>(<span class="hljs-literal">nullptr</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * @brief é€’å½’è§£æ³•</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param root</span><br><span class="hljs-comment">     * @return Node*</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">Node* <span class="hljs-title">connect</span><span class="hljs-params">(Node* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span> root;<br>        root-&gt;next = <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-built_in">connectionTwoNode</span>(root-&gt;left, root-&gt;right);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br><span class="hljs-comment">// é‡‡ç”¨ä¸¤ä¸ªç»“ç‚¹çš„é€’å½’</span><br>    <span class="hljs-comment">// ä½†æ˜¯è¿™ä¸ªé€’å½’ä¼šå­˜åœ¨é‡å éƒ¨åˆ†</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">connectionTwoNode</span><span class="hljs-params">(Node* node1, Node* node2)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (node1 == <span class="hljs-literal">nullptr</span> || node2 == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span>;<br>        node1-&gt;next = node2;<br>        node2-&gt;next = <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-built_in">connectionTwoNode</span>(node1-&gt;left, node1-&gt;right);<br>        <span class="hljs-built_in">connectionTwoNode</span>(node1-&gt;right, node2-&gt;left);<br>        <span class="hljs-built_in">connectionTwoNode</span>(node2-&gt;left, node2-&gt;right);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨">ã€äºŒå‰æ ‘å±•å¼€ä¸ºé“¾è¡¨ã€‘</h3><blockquote><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ <code>root</code> ï¼Œè¯·ä½ å°†å®ƒå±•å¼€ä¸ºä¸€ä¸ªå•é“¾è¡¨ï¼š</p><ul><li>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥åŒæ ·ä½¿ç”¨ <code>TreeNode</code> ï¼Œå…¶ä¸­<code>right</code> å­æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œå·¦å­æŒ‡é’ˆå§‹ç»ˆä¸º<code>null</code> ã€‚</li><li>å±•å¼€åçš„å•é“¾è¡¨åº”è¯¥ä¸äºŒå‰æ ‘ <ahref="https://baike.baidu.com/item/å…ˆåºéå†/6442839?fr=aladdin"><strong>å…ˆåºéå†</strong></a>é¡ºåºç›¸åŒã€‚</li></ul></blockquote><p>ã€æ€è·¯ã€‘</p><p>å…ˆå°†<code>root</code>çš„å·¦å­æ ‘éƒ¨åˆ†å±•å¼€ä¸ºé“¾è¡¨ï¼Œå†å°†å³å­æ ‘éƒ¨åˆ†å±•å¼€ä¸ºé“¾è¡¨ï¼Œæœ€åè¿›è¡Œè¿æ¥ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">flatten</span><span class="hljs-params">(TreeNode* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-built_in">flatten</span>(root-&gt;left);<br>        <span class="hljs-built_in">flatten</span>(root-&gt;right);<br><br>        <span class="hljs-built_in">connect</span>(root);<br>    &#125;<br><span class="hljs-comment">// å°†å·¦è¾¹çš„é“¾è¡¨ã€æ ¹èŠ‚ç‚¹ã€å³è¾¹çš„é“¾è¡¨è¿›è¡Œè¿æ¥</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">connect</span><span class="hljs-params">(TreeNode* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root-&gt;left == <span class="hljs-literal">nullptr</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-comment">// æ‰¾åˆ°å·¦å­èŠ‚ç‚¹çš„æœ€å³å­èŠ‚ç‚¹</span><br>        TreeNode* rightConnector = root-&gt;left;<br>        <span class="hljs-keyword">while</span> (rightConnector-&gt;right != <span class="hljs-literal">nullptr</span>) &#123;<br>            rightConnector = rightConnector-&gt;right;<br>        &#125;<br><br>        rightConnector-&gt;right = root-&gt;right;<br>        root-&gt;right = root-&gt;left;<br>        root-&gt;left = <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æ€»ç»“">æ€»ç»“</h3><p>äºŒå‰æ ‘çš„é€’å½’è§£æ³•éœ€è¦ä»å¤§å±€æ¥çœ‹ï¼Œå…ˆå°†æ•´ä¸ªäºŒå‰æ ‘çœ‹æˆæ˜¯å·¦å­æ ‘ã€æ ¹èŠ‚ç‚¹ã€å³å­æ ‘ä¸‰éƒ¨åˆ†ï¼Œç„¶åè€ƒè™‘åº”è¯¥å¯¹å·¦å­æ ‘å’Œå³å­æ ‘å¦‚ä½•é€’å½’æ“ä½œï¼Œä»¥åŠå’Œæ ¹èŠ‚ç‚¹å¦‚ä½•æ•´åˆã€‚ä¸è¦å±€é™äºé€’å½’çš„ç»†èŠ‚ï¼Œè€Œæ˜¯ç”¨æ•´ä½“æ¥çœ‹å¾…ã€‚ä½†æ˜¯å¯¹äºæœ€åŸºæœ¬çš„base-caseè¿˜æ˜¯è¦è€ƒè™‘æ¸…æ¥šä»¥åŠæ˜¯å¦èƒ½æ­£ç¡®æ‰§è¡Œã€‚</p><h2 id="äºŒ">ï¼ˆäºŒï¼‰</h2><blockquote><p>æœ€å¤§äºŒå‰æ ‘ 654</p><p>ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ 105</p><p>ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ 106</p></blockquote><h3 id="æœ€å¤§äºŒå‰æ ‘">ã€æœ€å¤§äºŒå‰æ ‘ã€‘</h3><blockquote><p>ç»™å®šä¸€ä¸ªä¸é‡å¤çš„æ•´æ•°æ•°ç»„ <code>nums</code> ã€‚<strong>æœ€å¤§äºŒå‰æ ‘</strong> å¯ä»¥ç”¨ä¸‹é¢çš„ç®—æ³•ä» <code>nums</code>é€’å½’åœ°æ„å»º:</p><ol type="1"><li>åˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå…¶å€¼ä¸º <code>nums</code> ä¸­çš„æœ€å¤§å€¼ã€‚</li><li>é€’å½’åœ°åœ¨æœ€å¤§å€¼ <strong>å·¦è¾¹</strong> çš„<strong>å­æ•°ç»„å‰ç¼€ä¸Š</strong> æ„å»ºå·¦å­æ ‘ã€‚</li><li>é€’å½’åœ°åœ¨æœ€å¤§å€¼ <strong>å³è¾¹</strong> çš„<strong>å­æ•°ç»„åç¼€ä¸Š</strong> æ„å»ºå³å­æ ‘ã€‚</li></ol><p>è¿”å› <em><code>nums</code> æ„å»ºçš„</em> *<strong>æœ€å¤§äºŒå‰æ ‘*</strong>ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">constructMaximumBinaryTree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">constructMaximumBinaryTreeHelper</span>(nums, <span class="hljs-number">0</span>, nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-function">TreeNode* <span class="hljs-title">constructMaximumBinaryTreeHelper</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> left,</span></span><br><span class="hljs-params"><span class="hljs-function">                                               <span class="hljs-type">int</span> right)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (left &gt; right) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-comment">// æ‰¾åˆ°[left, right]éƒ¨åˆ†çš„æœ€å¤§å…ƒç´ </span><br>        <span class="hljs-type">int</span> idx = left;<br>        <span class="hljs-type">int</span> val = nums[left];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = left; i &lt;= right; i++) &#123;<br>            <span class="hljs-keyword">if</span> (nums[i] &gt; val) &#123;<br>                val = nums[i];<br>                idx = i;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span><br>        TreeNode* root = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(val);<br>        <span class="hljs-comment">// é€’å½’</span><br>        root-&gt;left = <span class="hljs-built_in">constructMaximumBinaryTreeHelper</span>(nums, left, idx - <span class="hljs-number">1</span>);<br>        root-&gt;right = <span class="hljs-built_in">constructMaximumBinaryTreeHelper</span>(nums, idx + <span class="hljs-number">1</span>, right);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3id="ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘">ã€ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€‘</h3><blockquote><p>ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ <code>preorder</code> å’Œ <code>inorder</code> ï¼Œå…¶ä¸­<code>preorder</code> æ˜¯äºŒå‰æ ‘çš„<strong>å…ˆåºéå†</strong>ï¼Œ<code>inorder</code>æ˜¯åŒä¸€æ£µæ ‘çš„<strong>ä¸­åºéå†</strong>ï¼Œè¯·æ„é€ äºŒå‰æ ‘å¹¶è¿”å›å…¶æ ¹èŠ‚ç‚¹ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; preorder, vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder)</span> </span>&#123;<br>        <span class="hljs-comment">// é€šè¿‡å…ˆåºéå†æ•°ç»„ç¡®å®šæ ¹çš„ä½ç½®ï¼Œç„¶åé€šè¿‡ä¸­åºéå†æ•°ç»„æ„é€ äºŒå‰æ ‘</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">buildTreeHelper</span>(preorder, <span class="hljs-number">0</span>, preorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>, inorder, <span class="hljs-number">0</span>,<br>                               inorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTreeHelper</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; preorder, <span class="hljs-type">int</span> preleft, <span class="hljs-type">int</span> preright,</span></span><br><span class="hljs-params"><span class="hljs-function">                              vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder, <span class="hljs-type">int</span> inleft, <span class="hljs-type">int</span> inright)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (preleft &gt; preright || inleft &gt; inright) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-comment">// é€šè¿‡å…ˆåºéå†æ•°ç»„éƒ¨åˆ†å¾—åˆ°æ ¹èŠ‚ç‚¹</span><br>        <span class="hljs-type">int</span> root_val = preorder[preleft];<br>        <span class="hljs-comment">// åˆ°ä¸­åºéå†æ•°ç»„ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span><br>        <span class="hljs-type">int</span> idx;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = inleft; i &lt;= inright; i++) &#123;<br>            <span class="hljs-keyword">if</span> (inorder[i] == root_val) &#123;<br>                idx = i;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span><br>        TreeNode* root = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(root_val);<br>        <span class="hljs-comment">// åˆ¤æ–­è¯¥æ ¹èŠ‚ç‚¹å·¦å³å­æ ‘çš„ç»“ç‚¹æ•°</span><br>        <span class="hljs-type">int</span> left_nodes = idx - inleft;<br>        <span class="hljs-type">int</span> right_nodes = inright - idx;<br>        <span class="hljs-comment">// é€’å½’</span><br>        root-&gt;left =<br>            <span class="hljs-built_in">buildTreeHelper</span>(preorder, preleft + <span class="hljs-number">1</span>, (left_nodes + preleft),<br>                            inorder, inleft, idx - <span class="hljs-number">1</span>);<br>        root-&gt;right = <span class="hljs-built_in">buildTreeHelper</span>(preorder, (left_nodes + preleft + <span class="hljs-number">1</span>),<br>                                      preright, inorder, idx + <span class="hljs-number">1</span>, inright);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3id="ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘">ã€ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€‘</h3><blockquote><p>ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„ <code>inorder</code> å’Œ <code>postorder</code>ï¼Œå…¶ä¸­ <code>inorder</code> æ˜¯äºŒå‰æ ‘çš„ä¸­åºéå†ï¼Œ <code>postorder</code>æ˜¯åŒä¸€æ£µæ ‘çš„ååºéå†ï¼Œè¯·ä½ æ„é€ å¹¶è¿”å›è¿™é¢— <em>äºŒå‰æ ‘</em> ã€‚</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTree</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder, vector&lt;<span class="hljs-type">int</span>&gt;&amp; postorder)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">buildTreeHelper</span>(inorder, <span class="hljs-number">0</span>, inorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>, postorder, <span class="hljs-number">0</span>,<br>                               postorder.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-function">TreeNode* <span class="hljs-title">buildTreeHelper</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; inorder, <span class="hljs-type">int</span> inleft, <span class="hljs-type">int</span> inright,</span></span><br><span class="hljs-params"><span class="hljs-function">                              vector&lt;<span class="hljs-type">int</span>&gt;&amp; postorder, <span class="hljs-type">int</span> postleft,</span></span><br><span class="hljs-params"><span class="hljs-function">                              <span class="hljs-type">int</span> postright)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (inleft &gt; inright) <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-comment">// æ ¹æ®ååºéå†æ•°ç»„æ‰¾åˆ°æ ¹èŠ‚ç‚¹ æœ€åä¸€ä¸ªå°±æ˜¯æ ¹èŠ‚ç‚¹</span><br>        <span class="hljs-type">int</span> root_val = postorder[postright];<br>        <span class="hljs-comment">// æ‰¾åˆ°æ ¹èŠ‚ç‚¹åœ¨ä¸­åºéå†æ•°ç»„ä¸­çš„ä½ç½®</span><br>        <span class="hljs-type">int</span> idx;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = inleft; i &lt;= inright; i++) &#123;<br>            <span class="hljs-keyword">if</span> (inorder[i] == root_val) &#123;<br>                idx = i;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span><br>        TreeNode* root = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TreeNode</span>(root_val);<br>        <span class="hljs-comment">// ç¡®å®šå·¦å­æ ‘å’Œå³å­æ ‘ç»“ç‚¹æ•°é‡</span><br>        <span class="hljs-type">int</span> left_nodes = idx - inleft;<br>        <span class="hljs-type">int</span> right_nodes = inright - idx;<br>        <span class="hljs-comment">// é€’å½’</span><br>        root-&gt;left = <span class="hljs-built_in">buildTreeHelper</span>(inorder, inleft, idx - <span class="hljs-number">1</span>, postorder,<br>                                     postleft, postright - right_nodes - <span class="hljs-number">1</span>);<br>        root-&gt;right = <span class="hljs-built_in">buildTreeHelper</span>(inorder, idx + <span class="hljs-number">1</span>, inright, postorder,<br>                                      postleft + left_nodes - <span class="hljs-number">1</span>, postright - <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æ€»ç»“-1">ã€æ€»ç»“ã€‘</h3><p>è¿™ä¸‰é“é¢˜éƒ½æ˜¯å…³äºå¦‚ä½•æ„å»ºäºŒå‰æ ‘çš„ï¼Œè€Œæ„å»ºäºŒå‰æ ‘çš„å…³é”®åœ¨äºã€ä¸­åºéå†æ•°ç»„ã€‘+ã€å¯ä»¥ç¡®å®šæ ¹èŠ‚ç‚¹çš„æ¡ä»¶ã€‘</p><p>åœ¨ã€æœ€å¤§äºŒå‰æ ‘ã€‘ä¸­å¯ä»¥ç¡®å®šæ ¹èŠ‚ç‚¹çš„æ¡ä»¶æ˜¯æœ€å¤§å…ƒç´ ï¼Œè€Œåœ¨åä¸¤é“é¢˜ä¸­åˆ†åˆ«æ˜¯å‰åºéå†æ•°ç»„å’Œååºéå†æ•°ç»„ã€‚</p><h2 id="ä¸‰">ï¼ˆä¸‰ï¼‰</h2><blockquote><p>å¯»æ‰¾é‡å¤çš„å­æ ‘ 652</p></blockquote><h3 id="å¯»æ‰¾é‡å¤çš„å­æ ‘">ã€å¯»æ‰¾é‡å¤çš„å­æ ‘ã€‘</h3><blockquote><p>ç»™å®šä¸€æ£µäºŒå‰æ ‘<code>root</code>ï¼Œè¿”å›æ‰€æœ‰<strong>é‡å¤çš„å­æ ‘</strong>ã€‚</p><p>å¯¹äºåŒä¸€ç±»çš„é‡å¤å­æ ‘ï¼Œä½ åªéœ€è¦è¿”å›å…¶ä¸­ä»»æ„<strong>ä¸€æ£µ</strong>çš„æ ¹ç»“ç‚¹å³å¯ã€‚</p><p>å¦‚æœä¸¤æ£µæ ‘å…·æœ‰<strong>ç›¸åŒçš„ç»“æ„</strong>å’Œ<strong>ç›¸åŒçš„ç»“ç‚¹å€¼</strong>ï¼Œåˆ™å®ƒä»¬æ˜¯<strong>é‡å¤</strong>çš„ã€‚</p></blockquote><p>ã€æ€è·¯ã€‘</p><p>è¦æ‰¾é‡å¤çš„å­æ ‘ï¼Œã€å°±éœ€è¦è®°å½•ä¹‹å‰çš„å­æ ‘ï¼Œç„¶åå†å»åŒ¹é…ã€‘</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">private</span>:<br>    unordered_map&lt;string, <span class="hljs-type">int</span>&gt; memo; <span class="hljs-comment">// è®°å½•å­æ ‘å‡ºç°çš„æ¬¡æ•° stringè¡¨ç¤ºæ ‘çš„ç»“æ„ intè¡¨ç¤ºå‡ºç°æ¬¡æ•°</span><br>    vector&lt;TreeNode*&gt; res; <span class="hljs-comment">// ç»“æœé›†</span><br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">vector&lt;TreeNode*&gt; <span class="hljs-title">findDuplicateSubtrees</span><span class="hljs-params">(TreeNode* root)</span> </span>&#123;<br>        <span class="hljs-built_in">findDuplicateSubtreesHelper</span>(root);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br><br>    <span class="hljs-function">string <span class="hljs-title">findDuplicateSubtreesHelper</span><span class="hljs-params">(TreeNode* root)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;#&quot;</span>;<br>        &#125;<br><br>        string left = <span class="hljs-built_in">findDuplicateSubtreesHelper</span>(root-&gt;left);<br>        string right = <span class="hljs-built_in">findDuplicateSubtreesHelper</span>(root-&gt;right);<br><br>        <span class="hljs-comment">// </span><br>        string tree = <span class="hljs-string">&quot;&quot;</span>;<br>        tree.<span class="hljs-built_in">append</span>(left).<span class="hljs-built_in">append</span>(<span class="hljs-string">&quot;,&quot;</span>).<span class="hljs-built_in">append</span>(right).<span class="hljs-built_in">append</span>(<span class="hljs-string">&quot;,&quot;</span>).<span class="hljs-built_in">append</span>(<br>            <span class="hljs-built_in">to_string</span>(root-&gt;val));<br><br>        <span class="hljs-keyword">if</span> (memo.<span class="hljs-built_in">count</span>(tree) &amp;&amp; memo[tree] == <span class="hljs-number">1</span>) &#123;<br>            res.<span class="hljs-built_in">push_back</span>(root);<br>            memo[tree] = memo[tree] + <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!memo[tree]) &#123;<br>            memo[tree] = <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> tree;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="äºŒå‰æ ‘çš„åºåˆ—åŒ–">äºŒå‰æ ‘çš„åºåˆ—åŒ–</h2><blockquote><ol start="297" type="1"><li>äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</li></ol></blockquote><p><strong>ä½¿ç”¨Java</strong></p><blockquote><p>åºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æ„æˆ–è€…å¯¹è±¡è½¬æ¢ä¸ºè¿ç»­çš„æ¯”ç‰¹ä½çš„æ“ä½œï¼Œè¿›è€Œå¯ä»¥å°†è½¬æ¢åçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å†…å­˜ä¸­ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å¦ä¸€ä¸ªè®¡ç®—æœºç¯å¢ƒï¼Œé‡‡å–ç›¸åæ–¹å¼é‡æ„å¾—åˆ°åŸæ•°æ®ã€‚</p><p>è¯·è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥å®ç°äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚è¿™é‡Œä¸é™å®šä½ çš„åºåˆ— /ååºåˆ—åŒ–ç®—æ³•æ‰§è¡Œé€»è¾‘ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ªäºŒå‰æ ‘å¯ä»¥è¢«åºåˆ—åŒ–ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¹¶ä¸”å°†è¿™ä¸ªå­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºåŸå§‹çš„æ ‘ç»“æ„ã€‚</p><p><strong>æç¤º:</strong> è¾“å…¥è¾“å‡ºæ ¼å¼ä¸ LeetCodeç›®å‰ä½¿ç”¨çš„æ–¹å¼ä¸€è‡´ï¼Œè¯¦æƒ…è¯·å‚é˜… <ahref="vscode-webview://158f0tu0bi5btl1al2do8fjqofsbp3m18hvj94kqe2d694ac5r1p/faq/#binary-tree">LeetCodeåºåˆ—åŒ–äºŒå‰æ ‘çš„æ ¼å¼</a>ã€‚ä½ å¹¶éå¿…é¡»é‡‡å–è¿™ç§æ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨å…¶ä»–çš„æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><p>è¿™é‡Œæä¾›å››ç§æ–¹æ³•ï¼ˆä¸¤ç§æ€è·¯ï¼šé€’å½’å’Œè¿­ä»£ï¼‰</p><p>æ¯ç§æ–¹æ³•çš„åºåˆ—åŒ–è¿‡ç¨‹éƒ½ååˆ†çš„ç®€å•ï¼Œå…³é”®åœ¨äºååºåˆ—åŒ–è¿‡ç¨‹ã€‚</p><p>1ã€ã€å‰åºéå†ã€‘/ã€ååºéå†ã€‘ï¼šæŒ‰ç†è¯´ï¼Œå°†äºŒå‰æ ‘åºåˆ—åŒ–åå†å˜å›äºŒå‰æ ‘ï¼Œæ˜¯è¿˜éœ€è¦ä¸­åºéå†æ•°ç»„çš„ã€‚ä½†æ˜¯åœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå°†ç©ºæŒ‡é’ˆçš„ä¹ŸåŠ å…¥åºåˆ—åŒ–çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´äºŒå‰æ ‘åºåˆ—åŒ–åå¯ä»¥æ˜¯åŒ…å«ç©ºæŒ‡é’ˆï¼Œæœ‰äº†ç©ºæŒ‡é’ˆçš„ä½ç½®ï¼Œå°±å¯ä»¥åªä¾é å‰åºéå†æˆ–ååºéå†é‡æ„äºŒå‰æ ‘ã€‚è€Œå‰åºéå†å’Œååºéå†çš„åŒºåˆ«å°±åœ¨äºæ ¹èŠ‚ç‚¹çš„ä½ç½®ä¸åŒã€‚ã€è€Œè¿™é‡Œçš„é€’å½’æ€è·¯å’Œä¹‹å‰ä¸ä¸€æ ·ã€‘ï¼Œä¹‹å‰æ˜¯æ‰¾åˆ°åºåˆ—ä¸­è¡¨ç¤ºå·¦å­æ ‘çš„éƒ¨åˆ†è¿›è¡Œé€’å½’ï¼Œ...</p><p>2ã€ã€å±‚æ¬¡éå†ã€‘ï¼šåˆ©ç”¨é˜Ÿåˆ—å¯¹äºŒå‰æ ‘è¿›è¡ŒæŒ‰å±‚æ¬¡éå†</p><p>3ã€ã€é€’å½’å®šä¹‰ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> algorithm.tree.binaryTree;<br><br><span class="hljs-keyword">import</span> algorithm.tree.TreeNode;<br><span class="hljs-keyword">import</span> sun.font.TextRecord;<br><span class="hljs-keyword">import</span> sun.reflect.generics.tree.Tree;<br><br><span class="hljs-keyword">import</span> javax.naming.directory.SearchResult;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * äºŒå‰æ ‘çš„åºåˆ—åŒ–</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Serialization</span> &#123;<br>    <br>    List&lt;String&gt; list;<br>    <br>    <span class="hljs-comment">// å‰åºéå†</span><br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">preSerialize</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;#&quot;</span>;<br>        <br>        <span class="hljs-type">String</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> preSerialize(root.left);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> preSerialize(root.right);<br>    <br>        <span class="hljs-keyword">return</span> root.val + <span class="hljs-string">&quot;,&quot;</span> + left + <span class="hljs-string">&quot;,&quot;</span> + right;<br>    &#125;<br>    <span class="hljs-comment">// ä¸‹é¢è¿™ä¸ªè§£æ³•åœ¨æŸäº›æƒ…å†µä¸‹æ— æ³•ç»™å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œè™½ç„¶æ„Ÿè§‰å®ƒå¾ˆæ­£ç¡®</span><br>    <span class="hljs-comment">// è¿™é‡Œé‡‡ç”¨çš„é€’å½’æ€è·¯æ˜¯: æ‰¾åˆ°dataä¸­å±äºå·¦å­æ ‘å’Œå³å­æ ‘çš„éƒ¨åˆ†ï¼Œå†å»é€’å½’</span><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    private TreeNode preDeserialize(String data)&#123;</span><br><span class="hljs-comment">        if(data == null || data.length() == 0) return null;</span><br><span class="hljs-comment">        </span><br><span class="hljs-comment">        char c = data.charAt(0);</span><br><span class="hljs-comment">        if(c == &#x27;#&#x27;) return null;</span><br><span class="hljs-comment">        </span><br><span class="hljs-comment">        // å‰åºæ’åˆ—çš„ç¬¬ä¸€ä¸ªå°±æ˜¯æ ¹èŠ‚ç‚¹</span><br><span class="hljs-comment">        TreeNode root = new TreeNode(c - &#x27;0&#x27;);</span><br><span class="hljs-comment">        // æ‰¾åˆ°å·¦å­æ ‘çš„éƒ¨åˆ†</span><br><span class="hljs-comment">        int left_tree_nodes = 1; // æ— è®ºrootçš„å·¦èŠ‚ç‚¹æ˜¯ç©ºè¿˜æ˜¯å­˜åœ¨å·¦å­æ ‘ data[1]ä¸€å®šæ˜¯å±äºå·¦å­æ ‘çš„</span><br><span class="hljs-comment">        int i = 1;</span><br><span class="hljs-comment">        while(left_tree_nodes &gt; 0 &amp;&amp; i &lt; data.length())&#123;</span><br><span class="hljs-comment">            if(data.charAt(i) != &#x27;#&#x27;)&#123; // å¦‚æœå­˜åœ¨éç©ºç»“ç‚¹ï¼Œå·¦å­æ ‘åœ¨dataä¸­çš„å…ƒç´ ä¸ªæ•°å¤š2ä¸ª</span><br><span class="hljs-comment">                left_tree_nodes += 2;</span><br><span class="hljs-comment">            &#125;</span><br><span class="hljs-comment">            left_tree_nodes--;</span><br><span class="hljs-comment">            i++;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        root.left = preDeserialize(data.substring(1, i));</span><br><span class="hljs-comment">        // æ‰¾åˆ°å³å­æ ‘çš„éƒ¨åˆ†</span><br><span class="hljs-comment">        root.right = preDeserialize(data.substring(i));</span><br><span class="hljs-comment">        return root;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">     */</span><br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">preDeserialize</span><span class="hljs-params">(String data)</span>&#123;<br>        list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        Collections.addAll(list, data.split(<span class="hljs-string">&quot;,&quot;</span>));<br>        <span class="hljs-keyword">return</span> preDeserializeHelper();<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">preDeserializeHelper</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(list.isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <br>        <span class="hljs-type">String</span> <span class="hljs-variable">rootVal</span> <span class="hljs-operator">=</span> list.remove(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span>(rootVal.equals(<span class="hljs-string">&quot;#&quot;</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(Integer.parseInt(rootVal));<br>        <br>        root.left = preDeserializeHelper();<br>        root.right = preDeserializeHelper();<br>        <br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>    <br>    <span class="hljs-comment">// ååºéå†</span><br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">postSerialize</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;#&quot;</span>;<br>        <br>        <span class="hljs-type">String</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> postSerialize(root.left);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> postSerialize(root.right);<br>        <br>        <span class="hljs-keyword">return</span> left + <span class="hljs-string">&quot;,&quot;</span> + right + <span class="hljs-string">&quot;,&quot;</span> + root.val;<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">postDeserialize</span><span class="hljs-params">(String data)</span>&#123;<br>        list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        String[] split = data.split(<span class="hljs-string">&quot;,&quot;</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> split.length - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)&#123;<br>            list.add(split[i]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> postDeserializeHelper();<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">postDeserializeHelper</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(list.isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <br>        <span class="hljs-type">String</span> <span class="hljs-variable">rootVal</span> <span class="hljs-operator">=</span> list.remove(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span>(rootVal.equals(<span class="hljs-string">&quot;#&quot;</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(Integer.parseInt(rootVal));<br>        <br>        root.right = postDeserializeHelper();<br>        root.left = postDeserializeHelper();<br>        <br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>    <br>    <span class="hljs-comment">// ä¸­åºéå†</span><br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">inSerialize</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;#&quot;</span>;<br>    <br>        <span class="hljs-type">String</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> postSerialize(root.left);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> postSerialize(root.right);<br>    <br>        <span class="hljs-keyword">return</span> left + <span class="hljs-string">&quot;,&quot;</span> + root.val + <span class="hljs-string">&quot;,&quot;</span> + right;<br>    &#125;<br>    <br>    <span class="hljs-comment">// æ— æ³•è¿›è¡Œååºåˆ—åŒ–</span><br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">inDeserialize</span><span class="hljs-params">(String data)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">// ä½¿ç”¨å±‚çº§éå†</span><br>    <br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">levelSerialize</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <br>        Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <br>        queue.offer(root);<br>        <span class="hljs-keyword">while</span> (!queue.isEmpty())&#123;<br>            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>            <br>            <span class="hljs-keyword">if</span>(node == <span class="hljs-literal">null</span>) sb.append(<span class="hljs-string">&quot;#&quot;</span>);<br>            <span class="hljs-keyword">else</span> &#123;<br>                sb.append(node.val);<br>                queue.offer(node.left);<br>                queue.offer(node.right);<br>            &#125;<br>            <br>            <span class="hljs-keyword">if</span> (!queue.isEmpty()) sb.append(<span class="hljs-string">&quot;,&quot;</span>);<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> sb.toString();<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">levelDeserialize</span><span class="hljs-params">(String data)</span>&#123;<br>        <span class="hljs-keyword">if</span>(data.equals(<span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// å­˜åœ¨ä¸€ä¸ªé—®é¢˜: splitç©ºå­—ç¬¦ä¸²çš„æ—¶å€™è¿”å›çš„æ•°ç»„é•¿åº¦ä¸º1</span><br>        list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        Collections.addAll(list, data.split(<span class="hljs-string">&quot;,&quot;</span>));<br>        <span class="hljs-keyword">return</span> levelDeserializeHelper();<br>    &#125;<br>    <br>    <span class="hljs-keyword">private</span> TreeNode <span class="hljs-title function_">levelDeserializeHelper</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(list.isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        <br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(Integer.parseInt(list.remove(<span class="hljs-number">0</span>))); <span class="hljs-comment">// æ ¹èŠ‚ç‚¹</span><br>        <br>        Queue&lt;TreeNode&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>        queue.offer(root);<br>        <br>        <span class="hljs-keyword">while</span>(!queue.isEmpty())&#123;<br>            <br>            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> queue.poll();<br>            <br>            <span class="hljs-type">String</span> <span class="hljs-variable">leftVal</span> <span class="hljs-operator">=</span> list.remove(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">if</span>(leftVal.equals(<span class="hljs-string">&quot;#&quot;</span>))&#123;<br>                node.left = <span class="hljs-literal">null</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                node.left = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(Integer.parseInt(leftVal));<br>                queue.offer(node.left);<br>            &#125;<br>            <br>            <span class="hljs-type">String</span> <span class="hljs-variable">rightVal</span> <span class="hljs-operator">=</span> list.remove(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">if</span>(rightVal.equals(<span class="hljs-string">&quot;#&quot;</span>))&#123;<br>                node.right = <span class="hljs-literal">null</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                node.right = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(Integer.parseInt(rightVal));<br>                queue.offer(node.right);<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>    <br>    <br>    <span class="hljs-comment">// Encodes a tree to a single string.</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">serialize</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">return</span> levelSerialize(root);<br>    &#125;<br>    <br>    <span class="hljs-comment">// Decodes your encoded data to tree.</span><br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">deserialize</span><span class="hljs-params">(String data)</span> &#123;<br>        <span class="hljs-keyword">return</span> levelDeserialize(data);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;&quot;</span>.split(<span class="hljs-string">&quot;,&quot;</span>).length);<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Codec</span> &#123;<br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">serialize</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;X&quot;</span>;<br>        &#125;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;(&quot;</span> + serialize(root.left) + <span class="hljs-string">&quot;)&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;(&quot;</span> + serialize(root.right) + <span class="hljs-string">&quot;)&quot;</span>;<br>        <span class="hljs-keyword">return</span> left + root.val + right;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">deserialize</span><span class="hljs-params">(String data)</span> &#123;<br>        <span class="hljs-type">int</span>[] ptr = &#123;<span class="hljs-number">0</span>&#125;;<br>        <span class="hljs-keyword">return</span> parse(data, ptr);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">parse</span><span class="hljs-params">(String data, <span class="hljs-type">int</span>[] ptr)</span> &#123;<br>        <span class="hljs-keyword">if</span> (data.charAt(ptr[<span class="hljs-number">0</span>]) == <span class="hljs-string">&#x27;X&#x27;</span>) &#123;<br>            ++ptr[<span class="hljs-number">0</span>];<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(<span class="hljs-number">0</span>);<br>        cur.left = parseSubtree(data, ptr);<br>        cur.val = parseInt(data, ptr);<br>        cur.right = parseSubtree(data, ptr);<br>        <span class="hljs-keyword">return</span> cur;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">parseSubtree</span><span class="hljs-params">(String data, <span class="hljs-type">int</span>[] ptr)</span> &#123;<br>        ++ptr[<span class="hljs-number">0</span>]; <span class="hljs-comment">// è·³è¿‡å·¦æ‹¬å·</span><br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">subtree</span> <span class="hljs-operator">=</span> parse(data, ptr);<br>        ++ptr[<span class="hljs-number">0</span>]; <span class="hljs-comment">// è·³è¿‡å³æ‹¬å·</span><br>        <span class="hljs-keyword">return</span> subtree;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">parseInt</span><span class="hljs-params">(String data, <span class="hljs-type">int</span>[] ptr)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, sgn = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (!Character.isDigit(data.charAt(ptr[<span class="hljs-number">0</span>]))) &#123;<br>            sgn = -<span class="hljs-number">1</span>;<br>            ++ptr[<span class="hljs-number">0</span>];<br>        &#125;<br>        <span class="hljs-keyword">while</span> (Character.isDigit(data.charAt(ptr[<span class="hljs-number">0</span>]))) &#123;<br>            x = x * <span class="hljs-number">10</span> + data.charAt(ptr[<span class="hljs-number">0</span>]++) - <span class="hljs-string">&#x27;0&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> x * sgn;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åˆ©ç”¨ååºéå†ä¼˜åŒ–ç®—æ³•">åˆ©ç”¨ååºéå†ä¼˜åŒ–ç®—æ³•</h2><blockquote><p>äºŒå‰æœç´¢å­æ ‘çš„æœ€å¤§é”®å€¼å’Œ 1373</p><p>ç»™ä½ ä¸€æ£µä»¥ root ä¸ºæ ¹çš„ äºŒå‰æ ‘ ï¼Œè¯·ä½ è¿”å› ä»»æ„äºŒå‰æœç´¢å­æ ‘çš„æœ€å¤§é”®å€¼å’Œã€‚</p></blockquote><p>ã€æ€è·¯ã€‘</p><p>è¿™é“é¢˜æ— è®ºæ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºBSTï¼Œè¿˜æ˜¯æ±‚æ ‘çš„é”®å€¼å’Œéƒ½éœ€è¦ç”¨åˆ°å·¦å³å­æ ‘çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œåˆ¤æ–­æ ‘æ˜¯å¦ä¸ºBSTä»¥åŠæ±‚æ ‘çš„é”®å€¼å’Œæœ¬èº«åˆæ˜¯é€’å½’æ±‚è§£ï¼Œä¸€æ—¦é‡‡ç”¨å‰åºéå†çš„æ€æƒ³å°±æ˜¯é€’å½’å¥—é€’å½’ï¼Œå¤æ‚åº¦å¾ˆé«˜ã€‚åŸå› å°±åœ¨äºå‰é¢é€’å½’æ±‚è¿‡çš„åˆ°åé¢è¿˜å¾—å†é€’å½’å†æ±‚ä¸€æ¬¡ï¼Œå¤æ‚åº¦ä¼šè¾¾åˆ°æŒ‡æ•°çº§ã€‚ã€</p><p>è€Œä½¿ç”¨ååºéå†çš„æ€æƒ³ï¼Œå¯ä»¥åœ¨é€’å½’éå†çš„è¿‡ç¨‹ä¸­ç›´æ¥æ‹¿åˆ°å·¦å³å­æ ‘çš„ç›¸å…³ä¿¡æ¯ï¼Œç„¶åæ ¹æ®è¿™äº›ä¿¡æ¯æ±‚å‡ºè¯¥æ ‘æ˜¯å¦ä¸ºBSTä»¥åŠé”®å€¼å’Œï¼Œä¾æ¬¡å‘ä¸‹æ±‚è§£ï¼Œå¤æ‚åº¦å¤§å¤§é™ä½ï¼Œåªæœ‰çº¿æ€§å¤æ‚åº¦ã€‚</p><p>è¿˜æ˜¯è¦ä»å¤§å±€çœ‹èµ·ï¼Œä¸è¦ä¸€å¼€å§‹å°±é™äºç»†èŠ‚ï¼Œåº”è¯¥å†æ•´ä½“çš„é€’å½’å¸ƒå±€æƒ³æ¸…æ¥šåå†è€ƒè™‘ç»†èŠ‚é—®é¢˜ã€‚å¦åˆ™ä¸å®¹æ˜“å†™å‡ºé€’å½’çš„è§£æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NOT_BST</span> <span class="hljs-operator">=</span> Integer.MIN_VALUE;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">maxSum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ±‚äºŒå‰æ ‘ä¸­ é”®å€¼å’Œæœ€å¤§çš„äºŒå‰æœç´¢å­æ ‘</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxSumBST</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> maxSumBSTHelper(root);<br>        <span class="hljs-keyword">return</span> maxSum;<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> root æ ¹èŠ‚ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¦‚æœæ˜¯äºŒå‰æ ‘è¿”å›è¯¥æ ‘çš„é”®å€¼å’Œï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å› NOT_BST</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxSumBSTHelper</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <br>        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> maxSumBSTHelper(root.left);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> maxSumBSTHelper(root.right);<br>        <br>        <span class="hljs-keyword">if</span>(left != NOT_BST &amp;&amp; right != NOT_BST)&#123; <span class="hljs-comment">// å·¦å³å­æ ‘éƒ½æ˜¯BST</span><br>            <span class="hljs-keyword">if</span>(isBST(root))&#123; <span class="hljs-comment">// åˆ¤æ–­ä»¥rootä¸ºæ ¹çš„æ ‘æ˜¯å¦ä¸ºBST</span><br>                <span class="hljs-type">int</span> <span class="hljs-variable">tree</span> <span class="hljs-operator">=</span> left + root.val + right;<br>                <span class="hljs-keyword">if</span>(tree &gt; maxSum) maxSum = tree;<br>                <span class="hljs-keyword">return</span> tree;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> NOT_BST;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// å·¦å­æ ‘æˆ–è€…å³å­æ ‘ä¸æ˜¯BST</span><br>            <span class="hljs-keyword">return</span> NOT_BST;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“è¯¥æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘å‡ä¸ºBSTçš„å‰æä¸‹ï¼Œåˆ¤æ–­ä»¥rootä¸ºæ ¹çš„æ ‘æ˜¯å¦ä¸ºBST</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> root æ ¹èŠ‚ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ˜¯å¦æ˜¯BST</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isBST</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>        <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">is_left_satisfied</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>; <br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">is_right_satisfied</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>; <br>        <br>        <span class="hljs-comment">// åˆ¤æ–­å·¦å­æ ‘æ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> root.left;<br>        <span class="hljs-keyword">while</span> (left != <span class="hljs-literal">null</span> &amp;&amp; left.right != <span class="hljs-literal">null</span>)&#123;<br>            left = left.right;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(left == <span class="hljs-literal">null</span> || left.val &lt; root.val) is_left_satisfied = <span class="hljs-literal">true</span>;<br>        <br>        <span class="hljs-comment">// åˆ¤æ–­å³å­æ ‘æ˜¯å¦æ»¡è¶³æ¡ä»¶</span><br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> root.right;<br>        <span class="hljs-keyword">while</span> (right != <span class="hljs-literal">null</span> &amp;&amp; right.left != <span class="hljs-literal">null</span>)&#123;<br>            right = right.left;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(right == <span class="hljs-literal">null</span> || right.val &gt; root.val) is_right_satisfied = <span class="hljs-literal">true</span>;<br>        <br>        <span class="hljs-keyword">return</span> is_left_satisfied &amp; is_right_satisfied;<br>    &#125;<br>    <br>    <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“-2">æ€»ç»“</h2><h3 id="æ·±å…¥ç†è§£éå†æ–¹å¼">æ·±å…¥ç†è§£éå†æ–¹å¼</h3><h4 id="å‰ä¸­ååºéå†">å‰ä¸­ååºéå†</h4><p>ä¸€èˆ¬æˆ‘ä»¬æ±‚è§£äºŒå‰æ ‘çš„å‰ä¸­ååºéå†çš„æ¡†æ¶å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‰åºéå†æ¡†æ¶</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">preTraversal</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <br>    <span class="hljs-comment">/* å¤„ç† */</span><br>    <br>    preTraversal(root.left);<br>    preTraversal(root.right);<br>    <br>&#125;<br><br><span class="hljs-comment">// ä¸­åºéå†æ¡†æ¶</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">inTraversal</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <br>    inTraversal(root.left);<br>    <br>    <span class="hljs-comment">/* å¤„ç† */</span><br>    <br>    inTraversal(root.right);<br>    <br>&#125;<br><br><span class="hljs-comment">// ååºéå†æ¡†æ¶</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">postTraversal</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <br>    postTraversal(root.left);<br>    postTraversal(root.right);<br>    <br>    <span class="hljs-comment">/* å¤„ç† */</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>å…¶å®ï¼Œç”¨å‰ä¸­ååºéå†çš„é€’å½’æ¡†æ¶æ¥è§£å†³é—®é¢˜ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ã€æŒ‰ç…§å‰ä¸­ååºä¸‰ç§éå†é¡ºåºæ¥å¤„ç†æ¯ä¸€ä¸ªç»“ç‚¹ã€‘ï¼Œè€Œåˆ©ç”¨è¿™ç§æ¡†æ¶æ¥è§£å†³äºŒå‰æ ‘é—®é¢˜ï¼Œåªè¦è€ƒè™‘åœ¨æ¯ä¸€ä¸ªç»“ç‚¹ä½ç½®ï¼ˆ<code>/* å¤„ç† */</code>ï¼‰åº”è¯¥ç¼–å†™æ€æ ·çš„é€»è¾‘ã€‚</p><h4 id="å±‚æ¬¡éå†">å±‚æ¬¡éå†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">levelTraversal</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <br>    Queue&lt;TreeNode&gt; q = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();<br>    q.offer(root);<br>    <br>    <span class="hljs-keyword">while</span>(!q.isEmpty())&#123;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> q.poll();<br>        <span class="hljs-comment">/* å¤„ç† */</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¸¤ç§è§£é¢˜æ€è·¯">ä¸¤ç§è§£é¢˜æ€è·¯</h3><ul><li>éå†äºŒå‰æ ‘ =ã€‹ å›æº¯ç®—æ³•æ€æƒ³</li><li>åˆ†è§£é—®é¢˜ =ã€‹ åŠ¨æ€è§„åˆ’æ€æƒ³</li></ul><p>ä»¥ã€äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‘ä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åˆ†è§£é—®é¢˜: å°†åŸé—®é¢˜åˆ†è§£ä¸ºè§„æ¨¡æ›´å°çš„å­é—®é¢˜</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxDepth</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">leftMax</span> <span class="hljs-operator">=</span> maxDepth(root.left);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">rightMax</span> <span class="hljs-operator">=</span> maxDepth(root.right);<br>    <span class="hljs-keyword">return</span> Math.max(leftMax, rightMax) + <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-comment">// éå†äºŒå‰æ ‘</span><br><span class="hljs-type">int</span> <span class="hljs-variable">depth</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">maxDepth1</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    traversal(root);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">traversal</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>)&#123; <span class="hljs-comment">// åˆ°è¾¾åˆ†æ”¯çš„æœ€åº•éƒ¨</span><br>        res = Math.max(res, depth);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    depth++; <span class="hljs-comment">// è¿›å…¥å­æ ‘ï¼Œæ·±åº¦+1</span><br>    traversal(root.left);<br>    traversal(root.right);<br>    depth--; <span class="hljs-comment">// å›åˆ°æ ¹èŠ‚ç‚¹ï¼Œæ·±åº¦-1</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="äºŒå‰æ ‘çš„ç›´å¾„">ã€äºŒå‰æ ‘çš„ç›´å¾„ã€‘</h3><blockquote><p>ç»™å®šä¸€æ£µäºŒå‰æ ‘ï¼Œä½ éœ€è¦è®¡ç®—å®ƒçš„ç›´å¾„é•¿åº¦ã€‚ä¸€æ£µäºŒå‰æ ‘çš„ç›´å¾„é•¿åº¦æ˜¯ä»»æ„ä¸¤ä¸ªç»“ç‚¹è·¯å¾„é•¿åº¦ä¸­çš„æœ€å¤§å€¼ã€‚è¿™æ¡è·¯å¾„å¯èƒ½ç©¿è¿‡ä¹Ÿå¯èƒ½ä¸ç©¿è¿‡æ ¹ç»“ç‚¹ã€‚</p></blockquote><p>åˆ©ç”¨ååºéå†çš„é€’å½’æ–¹æ³•ï¼Œå¾—åˆ°å·¦å³å­æ ‘ä¸­è·ç¦»å­æ ‘æ ¹èŠ‚ç‚¹çš„æœ€å¤§è·ç¦»ï¼Œç”±æ­¤è®¡ç®—ç»è¿‡rootç»“ç‚¹çš„æœ€å¤§è·ç¦»ï¼Œå¹¶æ›´æ–°<code>diameter</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// éå†äºŒå‰æ ‘</span><br><span class="hljs-type">int</span> <span class="hljs-variable">diameter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">diameterOfBinaryTree</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    diameterOfBinaryTreeHelper(root);<br>    <span class="hljs-keyword">return</span> diameter;<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * @param root æ ¹èŠ‚ç‚¹</span><br><span class="hljs-comment"> * @return è¯¥æ ‘è·ç¦»æ ¹èŠ‚ç‚¹çš„æœ€è¿œè·ç¦»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">diameterOfBinaryTreeHelper</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>)&#123;<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> diameterOfBinaryTreeHelper(root.left);<br>    <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> diameterOfBinaryTreeHelper(root.right);<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">distance_cross_root</span> <span class="hljs-operator">=</span> left + right + <span class="hljs-number">2</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">max_distance_to_root</span> <span class="hljs-operator">=</span> Math.max(left, right) + <span class="hljs-number">1</span>;<br><br>    diameter = Math.max(diameter, distance_cross_root);<br><br>    <span class="hljs-keyword">return</span> max_distance_to_root;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°2-é˜Ÿåˆ—/æ ˆ</title>
      <link href="/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B02%EF%BC%88%E9%98%9F%E5%88%97%E6%A0%88%EF%BC%89/"/>
      <url>/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B02%EF%BC%88%E9%98%9F%E5%88%97%E6%A0%88%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‹¬å·é—®é¢˜">æ‹¬å·é—®é¢˜</h2><blockquote><p>æœ‰æ•ˆçš„æ‹¬å· 20</p><p>ä½¿æ‹¬å·æœ‰æ•ˆçš„æœ€å°æ·»åŠ  921</p><p>å¹³è¡¡æ‹¬å·ä¸²çš„æœ€å°æ’å…¥ 1541</p></blockquote><ul><li>ã€æœ‰æ•ˆæ‹¬å·ã€‘</li></ul><p>å¦‚æœåªåˆ¤æ–­ä¸€ç§æ‹¬å·ï¼Œåˆ™ä¸éœ€è¦ä½¿ç”¨æ ˆï¼Œé€šè¿‡ä¸€æ¬¡éå†å³å¯è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isValid</span><span class="hljs-params">(string s)</span></span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">char</span> c : s)&#123;<br>        <span class="hljs-keyword">if</span>(c == <span class="hljs-string">&#x27;(&#x27;</span>)&#123;<br>            left ++;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (left &gt; <span class="hljs-number">0</span>)&#123;<br>            left --;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> left == <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>éœ€è¦åŒæ—¶åˆ¤æ–­ä¸‰ç§æ‹¬å·æ˜¯å¦æ­£ç¡®ï¼š<code>() [] &#123;&#125;</code></p><p>ä½¿ç”¨ä¸Šè¿°æ–¹æ³•å°±æ˜¾å¾—ååˆ†éº»çƒ¦ï¼Œåº”è¯¥åˆ©ç”¨æ ˆç»“æ„çš„ç‰¹æ€§æ¥è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> IS_PUSH(x) (x == <span class="hljs-string">&#x27;(&#x27;</span> || x == <span class="hljs-string">&#x27;[&#x27;</span> || x == <span class="hljs-string">&#x27;&#123;&#x27;</span>)</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IS_MATCH(x, y) \</span><br><span class="hljs-meta">    ((x == <span class="hljs-string">&#x27;(&#x27;</span> &amp;&amp; y == <span class="hljs-string">&#x27;)&#x27;</span>) || (x == <span class="hljs-string">&#x27;[&#x27;</span> &amp;&amp; y == <span class="hljs-string">&#x27;]&#x27;</span>) || (x == <span class="hljs-string">&#x27;&#123;&#x27;</span> &amp;&amp; y == <span class="hljs-string">&#x27;&#125;&#x27;</span>))</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isValid</span><span class="hljs-params">(string s)</span> </span>&#123;<br>        stack&lt;<span class="hljs-type">char</span>&gt; stk;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : s) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IS_PUSH</span>(c)) &#123; <span class="hljs-comment">// å·¦åŠæ‹¬å·ï¼Œå‹æ ˆ</span><br>                stk.<span class="hljs-built_in">push</span>(c);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (stk.<span class="hljs-built_in">empty</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ç¼ºå°‘å·¦åŠæ‹¬å·</span><br>                <span class="hljs-type">char</span> c1 = stk.<span class="hljs-built_in">top</span>();<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">IS_MATCH</span>(c1, c)) &#123; <span class="hljs-comment">// åŒ¹é…</span><br>                    stk.<span class="hljs-built_in">pop</span>();<br>                &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// å·¦å³æ‹¬å·ä¸åŒ¹é…</span><br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> stk.<span class="hljs-built_in">empty</span>(); <span class="hljs-comment">// å¦‚æœæ ˆä¸ä¸ºç©ºï¼Œç¼ºå°‘å³åŠæ‹¬å·</span><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>ã€ä½¿æ‹¬å·æœ‰æ•ˆçš„æœ€å°æ·»åŠ ã€‘</li></ul><p>ç”±äºåªæ¶‰åŠä¸€ç§æ‹¬å·ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨æ ˆç»“æ„ï¼Œé€šè¿‡ä¸€æ¬¡éå†å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minAddToMakeValid</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : s) &#123;<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            left++;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (left &gt; <span class="hljs-number">0</span>) &#123;<br>            left--;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cnt++;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> left + cnt;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€å¹³è¡¡æ‹¬å·ä¸²çš„æœ€å°æ’å…¥ã€‘</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// æ¯”è¾ƒæ™®é€šçš„è§£æ³•</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minInsertions1</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    <span class="hljs-type">int</span> left = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">int</span> rightInRow = <span class="hljs-number">0</span>; <span class="hljs-comment">// è¿ç»­å³æ‹¬å·çš„æ•°ç›®</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : s) &#123;<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (rightInRow != <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">if</span> (left &gt; <span class="hljs-number">0</span>) &#123;<br>                    cnt++;  <span class="hljs-comment">//å¢åŠ ä¸€ä¸ªå³æ‹¬å·</span><br>                    left--;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    cnt += <span class="hljs-number">2</span>;  <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªå·¦æ‹¬å·å’Œå³æ‹¬å·</span><br>                &#125;<br>                rightInRow = <span class="hljs-number">0</span>;<br>            &#125;<br>            left++;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            rightInRow++;<br>            <span class="hljs-keyword">if</span> (rightInRow == <span class="hljs-number">2</span>) &#123;<br>                <span class="hljs-keyword">if</span> (left &gt; <span class="hljs-number">0</span>)<br>                    left--;<br>                <span class="hljs-keyword">else</span><br>                    cnt++;  <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªå·¦æ‹¬å·</span><br>                rightInRow = <span class="hljs-number">0</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (rightInRow != <span class="hljs-number">0</span>) &#123;  <span class="hljs-comment">// å¤šä½™çš„å³æ‹¬å·</span><br>        <span class="hljs-keyword">if</span> (left == <span class="hljs-number">0</span>) &#123;<br>            cnt += <span class="hljs-number">2</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            left--;<br>            cnt++;<br>        &#125;<br>        rightInRow = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> left * <span class="hljs-number">2</span> + cnt;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// æ›´åŠ ç®€æ´çš„jie&#x27;fa</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">minInsertions</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    <span class="hljs-type">int</span> need = <span class="hljs-number">0</span>, cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : s) &#123;<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>            <span class="hljs-comment">// å½“å‡ºç°ä¸€ä¸ªå·¦æ‹¬å·æ—¶ï¼Œå…¶å‰çš„å³æ‹¬å·æ•°ç›®åº”è¯¥ä¸ºå¶æ•°ï¼Œå³needåº”è¯¥ä¸ºå¶æ•°ï¼Œè‹¥ä¸ºå¥‡æ•°éœ€è¦æ’å…¥ä¸€ä¸ªå³æ‹¬å·</span><br>            <span class="hljs-keyword">if</span> (need % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) &#123;<br>                need--;<br>                cnt++;  <span class="hljs-comment">// æ’å…¥ä¸€ä¸ªå³æ‹¬å·</span><br>            &#125;<br>            need += <span class="hljs-number">2</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            need--;<br>            <span class="hljs-keyword">if</span> (need == <span class="hljs-number">-1</span>) &#123;<br>                cnt++;  <span class="hljs-comment">// æ’å…¥ä¸€ä¸ªå·¦æ‹¬å·</span><br>                need =<br>                    <span class="hljs-number">1</span>;  <span class="hljs-comment">// ç”±äºä¸€ä¸ªå·¦æ‹¬å·éœ€è¦ä¸¤ä¸ªå³æ‹¬å·ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸€ä¸ªå³æ‹¬å·</span><br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> cnt + need;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å•è°ƒæ ˆ">å•è°ƒæ ˆ</h2><blockquote><p>å•è°ƒæ ˆå®é™…ä¸Šå°±æ˜¯æ ˆï¼Œåªæ˜¯é€šè¿‡ç®€å•çš„æŠ€å·§ä½¿å¾—å…¶ä¸­å…ƒç´ çš„å‘ˆå•è°ƒæ’åˆ—</p><p>å¯ä»¥å¾ˆå¥½è§£å†³ã€ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€‘çš„é—®é¢˜</p><p>ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â…  496</p><p>ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â…¡ 503</p><p>æ¯æ—¥æ¸©åº¦ 739</p></blockquote><ul><li>ã€base caseã€‘</li></ul><blockquote><p>ç»™å®šä¸€ä¸ªæ•°ç»„ nums è¿”å›ä¸€ä¸ªç»“æœæ•°ç»„ resï¼Œres[i] è¡¨ç¤º nums[i]çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´ ï¼Œæ²¡æœ‰è¿”å› -1</p></blockquote><p>[2, 1, 2, 4, 3]å°†æ¯ä¸€ä¸ªå…ƒç´ çœ‹æˆæ˜¯ç›¸åº”é«˜åº¦çš„æ£å­ã€‚res[i]å°±æ˜¯ä»nums[i]è¿™æ ¹æ£å­å‘åæ‰€èƒ½çœ‹åˆ°çš„é‚£ä¸ªæ£å­çš„é«˜åº¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nextGreaterElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt; &amp;nums)</span></span>&#123;<br>    stack&lt;<span class="hljs-type">int</span>&gt; stk;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(nums.size())</span></span>;<br>    <span class="hljs-comment">// ä»åå¾€å‰éå†ï¼Œå› ä¸ºæ ˆæ˜¯åè¿›å…ˆå‡ºï¼Œä»åå¼€å§‹éå†ï¼Œä¿è¯å‡ºæ ˆçš„é¡ºåºæ˜¯ä»å‰åˆ°å</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)&#123;<br>        <span class="hljs-comment">// å¦‚æœæ ˆä¸ç©º ä¾æ¬¡å–å‡ºæ ˆé¡¶å…ƒç´ å’Œå½“å‰å…ƒç´ æ¯”è¾ƒ</span><br>        <span class="hljs-comment">// ç›´åˆ°æ‰¾åˆ°æ¯”å½“å‰å…ƒç´ å¤§çš„é‚£ä¸€ä¸ª</span><br>        <span class="hljs-comment">// ã€&lt;= å½“å‰å…ƒç´ çš„å¯ä»¥ä»æ ˆé¡¶ç§»é™¤ï¼Œå› ä¸ºå½“å‰å…ƒç´ å‰é¢çš„å…ƒç´ æ˜¯çœ‹ä¸è§å®ƒä»¬çš„ã€‘</span><br>        <span class="hljs-keyword">while</span>(!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; stk.<span class="hljs-built_in">top</span>() &lt;= nums[i])&#123;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        res[i] = stk.<span class="hljs-built_in">empty</span>() ? <span class="hljs-number">-1</span> : stk.<span class="hljs-built_in">top</span>();<br>        stk.<span class="hljs-built_in">push</span>(nums[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â… ã€‘</li></ul><blockquote><p><code>nums1</code> ä¸­æ•°å­— <code>x</code> çš„<strong>ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ </strong> æ˜¯æŒ‡ <code>x</code> åœ¨<code>nums2</code> ä¸­å¯¹åº”ä½ç½® <strong>å³ä¾§</strong> çš„<strong>ç¬¬ä¸€ä¸ª</strong> æ¯” <code>x</code> å¤§çš„å…ƒç´ ã€‚</p></blockquote><p>è¿™ä¸ªé—®é¢˜æ›´éš¾äº†ä¸€äº›ï¼Œå› ä¸ºæ˜¯<code>nums1</code>ä¸­çš„<code>x</code>æ˜ å°„åˆ°<code>nums2</code>åçš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">å¯¹nums2è¿›è¡Œbase caseçš„å¤„ç†ï¼Œä½†æ˜¯å°†ç»“æœå­˜æ”¾åœ¨mapä¸­</span><br><span class="hljs-comment">å¯¹nums1è¿›è¡Œéå†ï¼Œæ ¹æ®mapå¾—åˆ°æœ€ç»ˆç»“æœ</span><br><span class="hljs-comment">*/</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nextGreaterElement</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums1, vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums2)</span> </span>&#123;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(nums1.size())</span></span>;<br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; map;<br><br>    <span class="hljs-comment">// å¯¹nums2æ±‚æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ </span><br>    stack&lt;<span class="hljs-type">int</span>&gt; stk;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = nums2.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br><br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; stk.<span class="hljs-built_in">top</span>() &lt;= nums2[i]) &#123;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br><br>        map[nums2[i]] = stk.<span class="hljs-built_in">empty</span>() ? <span class="hljs-number">-1</span> : stk.<span class="hljs-built_in">top</span>();<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">            if (stk.empty()) &#123;</span><br><span class="hljs-comment">                map[nums2[i]] = -1;</span><br><span class="hljs-comment">            &#125; else &#123;</span><br><span class="hljs-comment">                while (!stk.empty() &amp;&amp; stk.top() &lt;= nums2[i]) &#123;</span><br><span class="hljs-comment">                    stk.pop();</span><br><span class="hljs-comment">                &#125;</span><br><span class="hljs-comment">                if (stk.empty()) &#123;</span><br><span class="hljs-comment">                    map[nums2[i]] = -1;</span><br><span class="hljs-comment">                &#125; else &#123;</span><br><span class="hljs-comment">                    map[nums2[i]] = stk.top();</span><br><span class="hljs-comment">                &#125;</span><br><span class="hljs-comment">            &#125;</span><br><span class="hljs-comment">        */</span><br>        stk.<span class="hljs-built_in">push</span>(nums2[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums1.<span class="hljs-built_in">size</span>(); i++) &#123;<br>        res[i] = map[nums1[i]];<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€æ¯æ—¥æ¸©åº¦ã€‘</li></ul><p>base case çš„å˜å¼ï¼Œres[i] æ˜¯ ä¸‹ä¸€ä¸ªæœ€å¤§å…ƒç´  åˆ° nums[i] çš„è·ç¦»</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// æ ˆç»“æ„ä¸­å­˜æ”¾çš„æ˜¯ &lt;index, value&gt; çš„pair</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dailyTemperatures1</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; temperatures)</span> </span>&#123;<br>    <span class="hljs-comment">// &lt;pos, value&gt;</span><br>    stack&lt;pair&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt;&gt; stk;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(temperatures.size())</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = temperatures.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; stk.<span class="hljs-built_in">top</span>().second &lt;= temperatures[i]) &#123;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        res[i] = stk.<span class="hljs-built_in">empty</span>() ? <span class="hljs-number">0</span> : stk.<span class="hljs-built_in">top</span>().first - i;<br>        stk.<span class="hljs-built_in">push</span>(&#123;i, temperatures[i]&#125;);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-comment">// æ ˆç»“æ„å­˜æ”¾çš„index</span><br><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">dailyTemperatures</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; temperatures)</span> </span>&#123;<br>    stack&lt;<span class="hljs-type">int</span>&gt; stk;  <span class="hljs-comment">// å­˜æ”¾ç´¢å¼•</span><br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(temperatures.size())</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = temperatures.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; temperatures[stk.<span class="hljs-built_in">top</span>()] &lt;= temperatures[i]) &#123;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        res[i] = stk.<span class="hljs-built_in">empty</span>() ? <span class="hljs-number">0</span> : stk.<span class="hljs-built_in">top</span>() - i;<br>        stk.<span class="hljs-built_in">push</span>(i);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ã€ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ â…¡ã€‘</li></ul><p>å¼•å…¥äº†<strong>ç¯å½¢æ•°ç»„</strong>ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡<strong>æ¨¡è¿ç®—</strong>æ¥æ¨¡æ‹Ÿç¯å½¢æ•°ç»„çš„æ•ˆæœ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">nextGreaterElements</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums)</span> </span>&#123;<br>    stack&lt;<span class="hljs-type">int</span>&gt; stk;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(nums.size())</span></span>;<br><br>    <span class="hljs-comment">// åˆ©ç”¨å•è°ƒæ ˆæ—¶å°†æ•°ç»„é•¿åº¦ç¿»å€ï¼Œä½†æ˜¯å¾ªç¯æ•°ç»„çš„æ•ˆæœæ˜¯ç”¨æ¨¡è¿ç®—ä½“ç°å‡ºæ¥çš„</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">2</span> * nums.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        <span class="hljs-type">int</span> j = i % nums.<span class="hljs-built_in">size</span>(); <span class="hljs-comment">// å¯¹åº”çš„ä¸‹æ ‡</span><br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; stk.<span class="hljs-built_in">top</span>() &lt;= nums[j]) &#123;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        <span class="hljs-keyword">if</span> (i &lt; nums.<span class="hljs-built_in">size</span>()) &#123;<br>            res[i] = stk.<span class="hljs-built_in">empty</span>() ? <span class="hljs-number">-1</span> : stk.<span class="hljs-built_in">top</span>();<br>        &#125;<br>        stk.<span class="hljs-built_in">push</span>(nums[j]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å•è°ƒé˜Ÿåˆ—">å•è°ƒé˜Ÿåˆ—</h2><blockquote><p>æ»‘åŠ¨çª—å£æœ€å¤§å€¼ 239</p></blockquote><p>ã€é¢˜ç›®ã€‘ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œæœ‰ä¸€ä¸ªå¤§å°ä¸º<code>k</code>çš„æ»‘åŠ¨çª—å£ä»æ•°ç»„çš„æœ€å·¦ä¾§ç§»åŠ¨åˆ°æ•°ç»„çš„æœ€å³ä¾§ã€‚ä½ åªå¯ä»¥çœ‹åˆ°åœ¨æ»‘åŠ¨çª—å£å†…çš„<code>k</code> ä¸ªæ•°å­—ã€‚æ»‘åŠ¨çª—å£æ¯æ¬¡åªå‘å³ç§»åŠ¨ä¸€ä½ã€‚</p><p>è¿”å› <em>æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼</em> ã€‚</p><blockquote><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs subunit">è¾“å…¥ï¼šnums = [1,3,<span class="hljs-string">-1</span>,<span class="hljs-string">-3</span>,5,3,6,7], k = 3<br>è¾“å‡ºï¼š[3,3,5,5,6,7]<br>è§£é‡Šï¼š<br>æ»‘åŠ¨çª—å£çš„ä½ç½®                æœ€å¤§å€¼<br>---------------               -----<br>[1  3  <span class="hljs-string">-1</span>] <span class="hljs-string">-3</span>  5  3  6  7       3<br> 1 [3  <span class="hljs-string">-1</span>  <span class="hljs-string">-3</span>] 5  3  6  7       3<br> 1  3 [<span class="hljs-string">-1</span>  <span class="hljs-string">-3</span>  5] 3  6  7       5<br> 1  3  <span class="hljs-string">-1</span> [<span class="hljs-string">-3</span>  5  3] 6  7       5<br> 1  3  <span class="hljs-string">-1</span>  <span class="hljs-string">-3</span> [5  3  6] 7       6<br> 1  3  <span class="hljs-string">-1</span>  <span class="hljs-string">-3</span>  5 [3  6  7]      7<br></code></pre></td></tr></table></figure></blockquote><p><font color='red'>æœ€ä¸»è¦æ˜¯åˆ©ç”¨äº†ã€åŒç«¯é˜Ÿåˆ—ã€‘ï¼Œæˆ–è€…è¯´æ˜¯åˆ©ç”¨å¯ä»¥åœ¨å¤´éƒ¨å°¾éƒ¨å¢å‡å…ƒç´ çš„æ•°æ®ç»“æ„</font></p><p>éš¾ç‚¹åœ¨äºï¼šä¸ºä»€ä¹ˆçª—å£å’Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ å¯ä»¥ä¸åŒæ­¥ï¼Ÿ</p><p><strong>é˜Ÿåˆ—ä¸­çš„å…ƒç´ xï¼Œæ˜¯åœ¨ æ¯”å®ƒæ›´å¤§å…ƒç´ yæ’å…¥æ—¶ã€æ³¨æ„yæ˜¯åœ¨xåé¢çš„ã€‘è¢«ç§»å‡ºçš„</strong>ã€‚ç”±äºåªæ˜¯æ±‚çª—å£ä¸­çš„æœ€å¤§å€¼ï¼Œæ‰€ä»¥ç»“æœæ˜¯ä¸å—å½±å“çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">maxSlidingWindow</span><span class="hljs-params">(vector&lt;<span class="hljs-type">int</span>&gt;&amp; nums, <span class="hljs-type">int</span> k)</span> </span>&#123;<br>    <span class="hljs-function">vector&lt;<span class="hljs-type">int</span>&gt; <span class="hljs-title">res</span><span class="hljs-params">(nums.size() - k + <span class="hljs-number">1</span>)</span></span>;<br>    deque&lt;<span class="hljs-type">int</span>&gt; dq;<br>    <br>    <span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>; <span class="hljs-comment">// è®°å½•é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°</span><br>    <span class="hljs-type">int</span> index = <span class="hljs-number">0</span>; <span class="hljs-comment">// ç»“æœé›†çš„ä¸‹æ ‡</span><br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nums.<span class="hljs-built_in">size</span>(); i++)&#123;<br>        <span class="hljs-comment">// å°†é˜Ÿåˆ—ä¸­æ‰€æœ‰æ¯” nums[i] å°çš„å…ƒç´ ç§»å‡º =&gt; ä½¿å¾—é˜Ÿåˆ—ä¸­å…ƒç´ å‘ˆå•è°ƒé€’å‡æ’åˆ—</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        1ã€è¿™æ ·ä½¿å¾—é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ å°±æ˜¯é˜Ÿåˆ—ä¸­æœ€å¤§å…ƒç´ ï¼Œå³çª—å£æœ€å¤§å€¼</span><br><span class="hljs-comment">        2ã€ä¸ºä»€ä¹ˆè¦ç§»å‡ºï¼Œè€Œä¸æ˜¯è®©å®ƒä»¬æ’åˆ—</span><br><span class="hljs-comment">        2.1ã€å¦‚æœä¸å°†å®ƒä»¬ç§»å‡ºï¼Œåªæ˜¯æ’åˆ—ï¼Œå½“çª—å£éœ€è¦å®é™…ç§»å‡ºå®ƒä»¬æ—¶å°±ä¼šå˜å¾—å›°éš¾</span><br><span class="hljs-comment">        2.2ã€è€Œä¸”åœ¨æ’åˆ—æ—¶å°±ç§»å‡ºï¼Œä¸ä¼šå¯¹æ­£ç¡®æ€§äº§ç”Ÿå½±å“ï¼Œé˜Ÿåˆ—å’Œçª—å£ä¸­çš„å…ƒç´ ä¸æ˜¯åŒæ—¶ç§»å‡ºï¼Œ</span><br><span class="hljs-comment">        ä¼šå‡ºç°å››ç§æƒ…å†µ: æœ‰ä¸¤ç§æ˜¯å¯¹åº”çš„ï¼Œå³çª—å£ä¸­å’Œé˜Ÿåˆ—ä¸­éƒ½æœ‰æŸå…ƒç´ ã€éƒ½æ²¡æœ‰æŸå…ƒç´   è¿™ä¸¤ç§è‚¯å®šæ˜¯æ­£ç¡®çš„ã€‚å¦å¤–ä¸¤ç§:</span><br><span class="hljs-comment">        </span><br><span class="hljs-comment">        2.2.1ã€çª—å£ä¸­æœ‰è¯¥å…ƒç´ ï¼Œè€Œé˜Ÿåˆ—ä¸­æ²¡æœ‰ã€‚é˜Ÿåˆ—ä¸­æ²¡æœ‰ è¯´æ˜è¯¥å…ƒç´ ä¸æ˜¯é˜Ÿåˆ—ä¸­æœ€å¤§å…ƒç´ ï¼Œåœ¨æ¯”å…¶æ›´å¤§çš„å…ƒç´ æ’å…¥æ—¶è¢«ç§»å‡ºï¼Œ</span><br><span class="hljs-comment">        è¿˜è¯´æ˜è¯¥å…ƒç´ åœ¨numsä¸­çš„ä½ç½®æ˜¯å…ˆäºæ¯”å®ƒæ›´å¤§çš„å…ƒç´ çš„ï¼Œæ‰€ä»¥çª—å£ä¹Ÿæ˜¯æ›´æ—©å°†å…¶ç§»å‡ºçš„ã€‚</span><br><span class="hljs-comment">        ç”±äºåªéœ€è¦æ±‚çª—å£æœ€å¤§å…ƒç´ ï¼Œæ‰€ä»¥æ²¡æœ‰å½±å“</span><br><span class="hljs-comment">        2.2.2ã€çª—å£ä¸­æ²¡æœ‰æŸå…ƒç´ ï¼Œè€Œé˜Ÿåˆ—ä¸­æœ‰ã€‚</span><br><span class="hljs-comment">        å¦‚æœè¯¥å…ƒç´ ä¸æ˜¯æœ€å¤§å…ƒç´ çš„è¯ï¼ŒåŒ2.2.1 åœ¨çª—å£å®é™…ç§»é™¤å®ƒä¹‹å‰ï¼Œé˜Ÿåˆ—å°±å·²ç»æŠŠå®ƒç»™ç§»å‡ºäº†ï¼Œæ•…ä¸å­˜åœ¨è¯¥æƒ…å†µ</span><br><span class="hljs-comment">        å¦‚æœè¯¥å…ƒç´ æ˜¯æœ€å¤§å…ƒç´ çš„è¯ï¼Œé‚£ä¹ˆåœ¨çª—å£ç§»å‡ºå®ƒçš„åŒæ—¶ï¼Œé˜Ÿåˆ—ä¼šç§»å‡ºå®ƒï¼Œå³ä»£ç 29ã€30è¡Œæ‰€åšï¼Œä¹Ÿä¸ä¼šå­˜åœ¨è¯¥æƒ…å†µ</span><br><span class="hljs-comment">        3ã€å°†å…ƒç´ ä»å°¾éƒ¨å–å‡ºæ¯”è¾ƒçš„ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ˜¯å•è°ƒé€’å‡ =&gt; æ‰€ä»¥éœ€è¦åŒç«¯é˜Ÿåˆ—</span><br><span class="hljs-comment">        */</span><br>        <span class="hljs-keyword">while</span>(!dq.<span class="hljs-built_in">empty</span>() &amp;&amp; dq.<span class="hljs-built_in">back</span>() &lt; nums[i])&#123;<br>            dq.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br>        dq.<span class="hljs-built_in">push_back</span>(nums[i]);<br>        cnt++;<br>        <br>        <span class="hljs-comment">// çª—å£å…ƒç´ æ»¡äº†</span><br>        <span class="hljs-keyword">if</span>(cnt == k)&#123;<br>            res[index++] = dq.<span class="hljs-built_in">front</span>(); <span class="hljs-comment">// æœ€å¤§å…ƒç´ å°±æ˜¯é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ </span><br>            <span class="hljs-comment">// å¦‚æœçª—å£éœ€è¦ç§»å‡ºçš„æ˜¯æœ€å¤§å…ƒç´ ï¼Œé‚£é˜Ÿåˆ—å°±è¦ç§»å‡ºè¯¥å…ƒç´ ã€‚</span><br>            <span class="hljs-comment">// å¦åˆ™ä¸éœ€è¦ï¼Œå› ä¸ºæ›´æ—©æ—¶å€™å·²ç»ç§»å‡ºäº†</span><br>            <span class="hljs-keyword">if</span>(dq.<span class="hljs-built_in">front</span>() == nums[i - k + <span class="hljs-number">1</span>])&#123;<br>                dq.<span class="hljs-built_in">pop_front</span>();<br>            &#125;<br>            cnt --;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ•°ç»„å»é‡">æ•°ç»„å»é‡</h2><blockquote><p>å»é™¤é‡å¤å­—æ¯ 316</p><p>ä¸åŒå­—ç¬¦çš„æœ€å°å­åºåˆ— 1081</p></blockquote><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code>ï¼Œè¯·ä½ å»é™¤å­—ç¬¦ä¸²ä¸­é‡å¤çš„å­—æ¯ï¼Œä½¿å¾—æ¯ä¸ªå­—æ¯åªå‡ºç°ä¸€æ¬¡ã€‚éœ€ä¿è¯<strong>è¿”å›ç»“æœçš„å­—å…¸åºæœ€å°</strong>ï¼ˆè¦æ±‚ä¸èƒ½æ‰“ä¹±å…¶ä»–å­—ç¬¦çš„ç›¸å¯¹ä½ç½®ï¼‰ã€‚</p><blockquote><p>ä¾‹å¦‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">è¾“å…¥ï¼šs <span class="hljs-operator">=</span> <span class="hljs-string">&quot;bcabc&quot;</span><br>è¾“å‡ºï¼š<span class="hljs-string">&quot;abc&quot;</span><br></code></pre></td></tr></table></figure></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// åˆ©ç”¨æ ˆç»“æ„</span><br><span class="hljs-function">string <span class="hljs-title">removeDuplicateLetters</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    <span class="hljs-type">int</span>* cnts = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">26</span>]&#123;<span class="hljs-number">0</span>&#125;;  <span class="hljs-comment">// è®°å½•å­—ç¬¦ä¸²ä¸­æ¯ç§å­—ç¬¦çš„æ•°é‡</span><br>    <span class="hljs-type">bool</span>* isInStk = <span class="hljs-keyword">new</span> <span class="hljs-type">bool</span>[<span class="hljs-number">26</span>]&#123;<span class="hljs-literal">false</span>&#125;; <span class="hljs-comment">// è®°å½•å¯¹åº”å­—ç¬¦åœ¨æ ˆä¸­æ˜¯å¦å‡ºç°</span><br><br>    <span class="hljs-comment">// ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­æ¯ç§å­—ç¬¦çš„æ•°é‡</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>        cnts[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]++;<br>    &#125;<br><br>    stack&lt;<span class="hljs-type">char</span>&gt; stk;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>        <br>        cnts[stk.<span class="hljs-built_in">top</span>() - <span class="hljs-string">&#x27;a&#x27;</span>]--;<br>        <br>        <span class="hljs-keyword">if</span> (isInStk[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]) &#123; <span class="hljs-comment">// æ ˆä¸­å·²ç»å­˜åœ¨è¯¥å­—ç¬¦</span><br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp;<br>               stk.<span class="hljs-built_in">top</span>() &gt;= s[i] &amp;&amp; <span class="hljs-comment">// å‰é¢çš„å­—ç¬¦å­—å…¸åºæ›´å¤§</span><br>               cnts[stk.<span class="hljs-built_in">top</span>() - <span class="hljs-string">&#x27;a&#x27;</span>] &gt; <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// è€Œä¸”åé¢è¿˜å­˜åœ¨è¯¥å­—ç¬¦ å°±å¯ä»¥å°†è¯¥å­—ç¬¦ç§»é™¤</span><br>            isInStk[stk.<span class="hljs-built_in">top</span>() - <span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-literal">false</span>;<br>            stk.<span class="hljs-built_in">pop</span>();<br>        &#125;<br><br>        stk.<span class="hljs-built_in">push</span>(s[i]);<br>        isInStk[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    string ans = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>()) &#123;<br>        ans += stk.<span class="hljs-built_in">top</span>();<br>        stk.<span class="hljs-built_in">pop</span>();<br>    &#125;<br><br>    <span class="hljs-built_in">reverse</span>(ans.<span class="hljs-built_in">begin</span>(), ans.<span class="hljs-built_in">end</span>());<br><br>    <span class="hljs-keyword">return</span> ans;<br>&#125;<br><br><br><span class="hljs-comment">// ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²</span><br><span class="hljs-function">string <span class="hljs-title">smallestSubsequence</span><span class="hljs-params">(string s)</span> </span>&#123;<br>    <span class="hljs-type">int</span>* cnts = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>[<span class="hljs-number">26</span>]&#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-type">bool</span>* isInStk = <span class="hljs-keyword">new</span> <span class="hljs-type">bool</span>[<span class="hljs-number">26</span>]&#123;<span class="hljs-literal">false</span>&#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>        cnts[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]++;<br>    &#125;<br><br>    string stk;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; s.<span class="hljs-built_in">size</span>(); i++) &#123;<br>        <span class="hljs-keyword">if</span> (isInStk[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]) &#123;<br>            cnts[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>]--;<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">while</span> (!stk.<span class="hljs-built_in">empty</span>() &amp;&amp; stk.<span class="hljs-built_in">back</span>() &gt;= s[i] &amp;&amp;<br>               cnts[stk.<span class="hljs-built_in">back</span>() - <span class="hljs-string">&#x27;a&#x27;</span>] &gt; <span class="hljs-number">1</span>) &#123;<br>            isInStk[stk.<span class="hljs-built_in">back</span>() - <span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-literal">false</span>;<br>            cnts[stk.<span class="hljs-built_in">back</span>() - <span class="hljs-string">&#x27;a&#x27;</span>]--;<br>            stk.<span class="hljs-built_in">pop_back</span>();<br>        &#125;<br><br>        stk.<span class="hljs-built_in">push_back</span>(s[i]);<br>        isInStk[s[i] - <span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> stk;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°5-äºŒå‰æœç´¢æ ‘</title>
      <link href="/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B05%EF%BC%88%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%EF%BC%89/"/>
      <url>/2022/09/15/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B05%EF%BC%88%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€">ï¼ˆä¸€ï¼‰</h2><blockquote><p>230ã€äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ </p><p>538ã€æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</p></blockquote><h3 id="äºŒå‰æœç´¢æ ‘ä¸­ç¬¬kå°çš„å…ƒç´ ">ã€äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ ã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// éå†äºŒå‰æ ‘çš„æ–¹å¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">kthSmallest</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> k)</span> &#123;<br>    kthSmallestTraversal(root, k);<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-type">int</span> <span class="hljs-variable">rank</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">kthSmallestTraversal</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> k)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    kthSmallestTraversal(root.left, k);<br>    rank++;<br>    <span class="hljs-keyword">if</span>(rank == k)&#123;<br>        res = root.val;<br>    &#125;<br>    kthSmallestTraversal(root.right, k);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘">ã€æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">convertBST</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>    convertBSTHelper(root);<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// å…³é”®!! ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨å˜é‡æ¥è®°å½•å’Œ å¤§å¤§é™ä½äº†å¤æ‚åº¦</span><br><span class="hljs-comment">/* ç‰¹æ®Šçš„ä¸­åºéå† */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">convertBSTHelper</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    convertBSTHelper(root.right);<br>    root.val += sum;<br>    sum = root.val;<br>    convertBSTHelper(root.left);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="äºŒ">ï¼ˆäºŒï¼‰</h2><h3 id="åˆ¤æ–­bstçš„åˆæ³•æ€§">1ã€åˆ¤æ–­BSTçš„åˆæ³•æ€§</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* é‡‡ç”¨ååºéå†çš„æ–¹å¼ */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidBST</span><span class="hljs-params">(TreeNode root)</span> &#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> isValidBST(root.left);<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> isValidBST(root.right);<br><br>    <span class="hljs-keyword">if</span>(left &amp;&amp; right)&#123; <span class="hljs-comment">// å·¦å³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘</span><br>        <span class="hljs-keyword">return</span> isValidBSTHelper(root);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//å½“å·¦å³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘æ—¶ï¼Œåˆ¤æ–­åŠ ä¸Šæ ¹åæ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘</span><br><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidBSTHelper</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">is_left_satisfied</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">is_right_satisfied</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-comment">// å·¦è¾¹æ˜¯å¦æ»¡è¶³æƒ…å†µ</span><br>    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left_max</span> <span class="hljs-operator">=</span> root.left;<br>    <span class="hljs-keyword">while</span> (left_max != <span class="hljs-literal">null</span> &amp;&amp; left_max.right != <span class="hljs-literal">null</span>)&#123;<br>        left_max = left_max.right;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (left_max == <span class="hljs-literal">null</span> || left_max.val &lt; root.val)&#123;<br>        is_left_satisfied = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// å³è¾¹æ˜¯å¦æ»¡è¶³æƒ…å†µ</span><br>    <span class="hljs-type">TreeNode</span> <span class="hljs-variable">right_min</span> <span class="hljs-operator">=</span> root.right;<br>    <span class="hljs-keyword">while</span> (right_min != <span class="hljs-literal">null</span> &amp;&amp; right_min.left != <span class="hljs-literal">null</span>)&#123;<br>        right_min = right_min.left;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(right_min == <span class="hljs-literal">null</span> || right_min.val &gt; root.val)&#123;<br>        is_right_satisfied = <span class="hljs-literal">true</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> is_left_satisfied &amp; is_right_satisfied;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * åˆ†è§£é—®é¢˜</span><br><span class="hljs-comment"> * ä½†æ˜¯ç”±äºåœ¨åŸå‡½æ•°ä¸Šä¸å¥½ç›´æ¥åˆ†è§£ï¼Œæ‰€ä»¥éœ€è¦æ‰©å±•å‡½æ•°å‚æ•°</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidBST</span><span class="hljs-params">(TreeNode root)</span>&#123;<br>    <span class="hljs-keyword">return</span> isValidBST1Helper(root, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidBSTHelper</span><span class="hljs-params">(TreeNode root, TreeNode min, TreeNode max)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">if</span>( (min != <span class="hljs-literal">null</span> &amp;&amp; root.val &lt;= min.val) ||<br>                (max != <span class="hljs-literal">null</span> &amp;&amp; root.val &gt;= max.val))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> isValidBST1Helper(root.left, min, root) &amp;&amp;<br>                   isValidBST1Helper(root.right, root, max);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨bstä¸­æœç´¢å…ƒç´ ">2ã€åœ¨BSTä¸­æœç´¢å…ƒç´ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">searchBST</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span>(root.val == val) &#123;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(root.val &gt; val) &#123;<br>        <span class="hljs-keyword">return</span> searchBST1(root.left, val);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> searchBST1(root.right, val);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨bstä¸­æ’å…¥å…ƒç´ ">3ã€åœ¨BSTä¸­æ’å…¥å…ƒç´ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">insertIntoBST</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span> &#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(val);<br>    <span class="hljs-keyword">if</span> (root.val &gt; val)&#123;<br>        root.left = insertIntoBST(root.left, val);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        root.right = insertIntoBST(root.right, val);<br>    &#125;<br>    <span class="hljs-keyword">return</span> root;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åœ¨bstä¸­åˆ é™¤å…ƒç´ ">4ã€åœ¨BSTä¸­åˆ é™¤å…ƒç´ </h3><p>åˆ é™¤å…ƒç´ ç›¸å¯¹æ¥è¯´è¦å¤æ‚ä¸€äº›ã€‚</p><p>å› ä¸ºåšé€’å½’çš„æ—¶å€™æ˜¯å°†æ‰€æœ‰èŠ‚ç‚¹éƒ½å½“ä½œæ ¹èŠ‚ç‚¹ï¼ˆä¸€é¢—å­æ ‘çš„æ ¹ï¼‰æ¥çœ‹çš„ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦åˆ é™¤ï¼Œé‚£ä¹ˆå°±è¦æ‰¾åˆ°å…¶å·¦å­æ ‘çš„æœ€å¤§ç»“ç‚¹æˆ–è€…å³å­æ ‘çš„æœ€å°ç»“ç‚¹æ¥æ›¿æ¢æ ¹èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> TreeNode <span class="hljs-title function_">deleteNode</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> key)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span>(root.val == key)&#123;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">left_min</span> <span class="hljs-operator">=</span> root.left;<br>        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">min_parent</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">while</span>(left_min != <span class="hljs-literal">null</span> &amp;&amp; left_min.right != <span class="hljs-literal">null</span>)&#123;<br>            min_parent = left_min;<br>            left_min = left_min.right;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(left_min == <span class="hljs-literal">null</span>)&#123; <span class="hljs-comment">// æ²¡æœ‰å·¦å­æ ‘</span><br>            <span class="hljs-keyword">return</span> root.right;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">            * è¿™é‡Œæ˜¯é‡‡ç”¨äº†äº¤æ¢ä¸¤ä¸ªç»“ç‚¹çš„å€¼æ¥å®ç°åˆ é™¤ç»“ç‚¹çš„äº¤æ¢</span><br><span class="hljs-comment">            * ä¹Ÿå¯ä»¥å®é™…äº¤æ¢ä¸¤ä¸ªç»“ç‚¹</span><br><span class="hljs-comment">            * */</span><br>            root.val = left_min.val;<br>            <span class="hljs-keyword">if</span>(min_parent == <span class="hljs-literal">null</span>)&#123; <span class="hljs-comment">// å·¦å­æ ‘çš„æ ¹èŠ‚ç‚¹å°±æ˜¯æœ€å¤§ï¼Œæ²¡æœ‰å³èŠ‚ç‚¹</span><br>                root.left = left_min.left;<br>            &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// å³è¾¹æ²¡æœ‰ç»“ç‚¹ï¼Œå·¦è¾¹å¯èƒ½æœ‰</span><br>                min_parent.right = left_min.left;<br>            &#125;<br>            <span class="hljs-keyword">return</span> root;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(root.val &gt; key) &#123;<br>        root.left = deleteNode(root.left, key);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        root.right = deleteNode(root.right, key);<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ€»ç»“">5ã€æ€»ç»“</h3><ul><li><p>BST çš„æ¡†æ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">BST</span><span class="hljs-params">(TreeNode root, <span class="hljs-type">int</span> val)</span>&#123;<br>    <span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span>(root.val == val)&#123;<br>        <span class="hljs-comment">// å…·ä½“æ“ä½œ</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(root.val &gt; val)&#123;<br>        BST(root.left, val);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        BST(root.right, val);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨è§£å†³é€’å½’é—®é¢˜æ—¶ï¼Œå¦‚æœå‘ç°åœ¨åŸå‡½æ•°ä¸Šéš¾ä»¥æ­£ç¡®æ‰§è¡Œï¼Œå¯ä»¥è€ƒè™‘</p><ul><li>å€ŸåŠ©å¤–éƒ¨å˜é‡</li><li>å€ŸåŠ©å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œå¢åŠ å‡½æ•°å‚æ•°</li></ul></li></ul><h2 id="ä¸‰">ï¼ˆä¸‰ï¼‰</h2><blockquote><p>96ã€ä¸åŒçš„äºŒå‰æœç´¢æ ‘</p><p>95ã€ä¸åŒçš„äºŒå‰æœç´¢æ ‘ â…¡</p></blockquote><h3 id="äºŒå‰æ ‘æ•°é‡">ã€äºŒå‰æ ‘æ•°é‡ã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é€’å½’æ±‚è§£</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">* å…¶å®å°±æ˜¯nä¸ªæ•°èƒ½å½¢æˆå¤šå°‘ä¸ªåˆæ³•äºŒå‰æœç´¢æ ‘: i, i+1, i+2, ... , i+n-1</span><br><span class="hljs-comment">* numTrees(n) = numTrees(j-1) + numTrees(n-j) å…¶ä¸­ j åœ¨ [1,n] ä¹‹é—´</span><br><span class="hljs-comment">* */</span><br><span class="hljs-comment">// é€’å½’ =&gt; å¾ˆæ…¢ é€’å½’+å¾ªç¯ å­˜åœ¨é‡å çš„éƒ¨åˆ†</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">numTrees</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-keyword">if</span>(n == <span class="hljs-number">0</span> || n == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= n; i++)&#123; <span class="hljs-comment">// åˆ†åˆ«ä»¥iä¸ºæ ¹èŠ‚ç‚¹</span><br>        sum += numTrees(i-<span class="hljs-number">1</span>) * numTrees(n-i);<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¿­ä»£ åŠ¨æ€è§„åˆ’ å¤§å¤§é™ä½äº†æ—¶é—´å¤æ‚åº¦</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">numTrees1</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-type">int</span>[] tmp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n+<span class="hljs-number">1</span>];<br>    tmp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; tmp[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>; i &lt;= n; i++)&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= i; j++)&#123;<br>            tmp[i] += (tmp[j-<span class="hljs-number">1</span>] * tmp[i-j]);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> tmp[n];<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ç”ŸæˆäºŒå‰æ ‘">ã€ç”ŸæˆäºŒå‰æ ‘ã€‘</h3><blockquote><p>ç»™ä½ ä¸€ä¸ªæ•´æ•° <code>n</code> ï¼Œè¯·ä½ ç”Ÿæˆå¹¶è¿”å›æ‰€æœ‰ç”± <code>n</code>ä¸ªèŠ‚ç‚¹ç»„æˆä¸”èŠ‚ç‚¹å€¼ä» <code>1</code> åˆ° <code>n</code> äº’ä¸ç›¸åŒçš„ä¸åŒ<strong>äºŒå‰æœç´¢æ ‘</strong> ã€‚å¯ä»¥æŒ‰ <strong>ä»»æ„é¡ºåº</strong>è¿”å›ç­”æ¡ˆã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é€’å½’</span><br><span class="hljs-keyword">public</span> List&lt;TreeNode&gt; <span class="hljs-title function_">generateTrees</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> &#123;<br>    <span class="hljs-keyword">return</span> generateTree(<span class="hljs-number">1</span>, n);<br>&#125;<br><br><span class="hljs-keyword">private</span> List&lt;TreeNode&gt; <span class="hljs-title function_">generateTree</span><span class="hljs-params">(<span class="hljs-type">int</span> l, <span class="hljs-type">int</span> h)</span>&#123;<br>    <span class="hljs-keyword">if</span>(l &gt; h)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    &#125;<br>    List&lt;TreeNode&gt; res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> l; i &lt;= h; i++)&#123;<br><br>        List&lt;TreeNode&gt; lefts = generateTree(l, i-<span class="hljs-number">1</span>);<br>        List&lt;TreeNode&gt; rights = generateTree(i+<span class="hljs-number">1</span>, h);<br><br><br>        <span class="hljs-keyword">for</span>(TreeNode left : lefts)&#123;<br>            <span class="hljs-keyword">for</span> (TreeNode right : rights) &#123;<br>                <span class="hljs-type">TreeNode</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(i);<br>                root.left = left;<br>                root.right = right;<br>                res.add(root);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åŠ¨æ€è§„åˆ’ ä¸å¦‚é€’å½’ä¼˜é›… è€Œä¸” ä¼˜åŒ–ä¸äº†å¤šå°‘</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·é¢˜ç¬”è®°3-è®¾è®¡æ•°æ®ç»“æ„</title>
      <link href="/2022/09/07/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B03%EF%BC%88%E8%AE%BE%E8%AE%A1%EF%BC%89/"/>
      <url>/2022/09/07/leetcode/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B03%EF%BC%88%E8%AE%BE%E8%AE%A1%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="lru">1 LRU</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * @lc app=leetcode.cn id=146 lang=cpp</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * [146] LRU ç¼“å­˜</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * è¯¥æ•°æ®ç»“æ„éœ€è¦æ»¡è¶³æ»¡è¶³çš„è¦æ±‚:</span><br><span class="hljs-comment"> * 1ã€getæ–¹æ³•éœ€è¦æ ¹æ®keyå€¼å¿«é€Ÿè·å–åˆ°value =&gt; å“ˆå¸Œè¡¨</span><br><span class="hljs-comment"> * 2ã€æ•°æ®ç»“æ„ä¸­ key-value éœ€è¦æŒ‰ç…§æ˜¯ä½¿ç”¨æ—¶é—´æ’åº =&gt;</span><br><span class="hljs-comment"> * è¿™æ ·å¯ä»¥åœ¨éœ€è¦é€å‡ºæœ€ä¹…æ²¡ä½¿ç”¨çš„å…³é”®å­—æ—¶ç›´æ¥ç§»é™¤æœ€å¤´éƒ¨æˆ–æœ€å°¾éƒ¨å…ƒç´ </span><br><span class="hljs-comment"> * 3ã€getæˆ–è€…putçš„ key åï¼Œéœ€è¦æ”¹å˜å…¶ä½ç½®ï¼Œå› ä¸ºå…¶æ˜¯æœ€è¿‘è¢«ä½¿ç”¨çš„å…³é”®å­—</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * å“ˆå¸Œ + shuaé“¾è¡¨</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// @lc code=start</span><br><br><span class="hljs-comment">// é“¾è¡¨ç»“ç‚¹ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">int</span> key&#123;<span class="hljs-number">-1</span>&#125;;<br>    <span class="hljs-type">int</span> value&#123;<span class="hljs-number">-1</span>&#125;;<br>    Node* next&#123;<span class="hljs-literal">nullptr</span>&#125;;<br>    Node* prev&#123;<span class="hljs-literal">nullptr</span>&#125;;<br><br>    <span class="hljs-built_in">Node</span>(<span class="hljs-type">int</span> key, <span class="hljs-type">int</span> value) &#123;<br>        <span class="hljs-keyword">this</span>-&gt;key = key;<br>        <span class="hljs-keyword">this</span>-&gt;value = value;<br>    &#125;<br>    <span class="hljs-built_in">Node</span>() &#123;&#125;<br>&#125;;<br><br><span class="hljs-comment">// åŒå‘é“¾è¡¨ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DoubleLinkedList</span> &#123;<br>   <span class="hljs-keyword">private</span>:<br>    Node *head, *tail;<br>    <span class="hljs-type">int</span> size;<br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">DoubleLinkedList</span>() &#123;<br>        size = <span class="hljs-number">0</span>;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>();<br>        tail = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>();<br>        head-&gt;next = tail;<br>        tail-&gt;prev = head;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Node* n)</span> </span>&#123;  <span class="hljs-comment">// ä»é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªç»“ç‚¹</span><br>        n-&gt;prev-&gt;next = n-&gt;next;<br>        n-&gt;next-&gt;prev = n-&gt;prev;<br>        n-&gt;next = <span class="hljs-literal">nullptr</span>;<br>        n-&gt;prev = <span class="hljs-literal">nullptr</span>;<br>        size--;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addInLast</span><span class="hljs-params">(Node* n)</span> </span>&#123;  <span class="hljs-comment">// æŠŠä¸€ä¸ªç»“ç‚¹æ’åœ¨å°¾éƒ¨</span><br>        tail-&gt;prev-&gt;next = n;<br>        n-&gt;prev = tail-&gt;prev;<br>        tail-&gt;prev = n;<br>        n-&gt;next = tail;<br>        size++;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ªå®¹é‡å†…</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isWithinCap</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> </span>&#123; <span class="hljs-keyword">return</span> size &lt; capacity; &#125;<br><br>    <span class="hljs-comment">// è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ </span><br>    <span class="hljs-function">Node* <span class="hljs-title">first</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> head-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// LRUcacheç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LRUCache</span> &#123;<br>   <span class="hljs-keyword">private</span>:<br>    unordered_map&lt;<span class="hljs-type">int</span>, Node*&gt; um;  <span class="hljs-comment">// å“ˆå¸Œè¡¨</span><br>    DoubleLinkedList list;         <span class="hljs-comment">// åŒå‘é“¾è¡¨</span><br>    <span class="hljs-type">int</span> _cap;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">makeRecently</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> </span>&#123;  <span class="hljs-comment">// æŠŠæŸä¸ªå…³é”®å­—å˜æˆæœ€è¿‘ä½¿ç”¨</span><br>        Node* p = um[key];<br>        list.<span class="hljs-built_in">remove</span>(p);<br>        list.<span class="hljs-built_in">addInLast</span>(p);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">removeLeastRecentlyUsed</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">// é€å‡ºæœ€ä¸å¸¸ä½¿ç”¨çš„å…³é”®å­—</span><br>        Node* p = list.<span class="hljs-built_in">first</span>();<br>        list.<span class="hljs-built_in">remove</span>(p);<br>        um.<span class="hljs-built_in">erase</span>(p-&gt;key);<br>        <span class="hljs-keyword">delete</span> p;<br>    &#125;<br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LRUCache</span>(<span class="hljs-type">int</span> capacity) &#123; _cap = capacity; &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!um.<span class="hljs-built_in">count</span>(key)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>        &#125;<br>        <span class="hljs-built_in">makeRecently</span>(key);<br>        <span class="hljs-keyword">return</span> um[key]-&gt;value;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-type">int</span> key, <span class="hljs-type">int</span> value)</span> </span>&#123;<br>        <span class="hljs-comment">// å·²ç»å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> (um.<span class="hljs-built_in">count</span>(key)) &#123;<br>            um[key]-&gt;value = value;  <span class="hljs-comment">// æ›´æ–°å€¼</span><br>            <span class="hljs-built_in">makeRecently</span>(key);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-comment">// ä¸å­˜åœ¨ï¼Œéœ€è¦æ’å…¥</span><br>        <span class="hljs-keyword">if</span> (!list.<span class="hljs-built_in">isWithinCap</span>(_cap)) &#123;  <span class="hljs-comment">// æ»¡äº†</span><br>            <span class="hljs-built_in">removeLeastRecentlyUsed</span>();<br>        &#125;<br>        <span class="hljs-comment">// åŠ åœ¨å°¾éƒ¨</span><br>        Node* n = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(key, value);<br>        list.<span class="hljs-built_in">addInLast</span>(n);<br>        um[key] = n;  <span class="hljs-comment">// åŠ åœ¨mapä¸­</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Your LRUCache object will be instantiated and called as such:</span><br><span class="hljs-comment"> * LRUCache* obj = new LRUCache(capacity);</span><br><span class="hljs-comment"> * int param_1 = obj-&gt;get(key);</span><br><span class="hljs-comment"> * obj-&gt;put(key,value);</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// @lc code=end</span><br><br></code></pre></td></tr></table></figure><h2 id="lfu">2 LFU</h2><p><code>lfu</code> ç®—æ³•çš„éš¾åº¦æ›´å¤§ï¼Œå…¶è¦æ±‚å¦‚ä¸‹ï¼š</p><p>1ã€ä½¿ç”¨<code>get</code>å‡½æ•°æ ¹æ®<code>key</code>å¾—åˆ°<code>value</code>ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(1)</code></p><p>2ã€<code>put</code>å‡½æ•°ï¼ˆéœ€è¦<code>O(1)</code>æ—¶é—´å¤æ‚åº¦ï¼‰</p><p>â€‹2.1ã€å¦‚æœ<code>key</code>å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆä¿®æ”¹å¯¹åº”çš„<code>value</code></p><p>â€‹2.2ã€å¦‚æœå®¹é‡å¤Ÿï¼Œé‚£ä¹ˆæ’å…¥ä¸€ä¸ª<code>key-value</code>ï¼Œä¸”å…¶ä½¿ç”¨é¢‘ç‡ï¼ˆ<code>freq</code>ï¼‰ä¸º1</p><p>â€‹2.3ã€å¦‚æœå®¹é‡ä¸å¤Ÿï¼Œé‚£ä¹ˆé€å‡ºä½¿ç”¨é¢‘ç‡æœ€å°‘çš„ä¸€ä¸ª<code>key-value</code>ï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªä½¿ç”¨é¢‘ç‡æœ€å°‘çš„<code>key-value</code>ï¼Œé‚£ä¹ˆé€å‡ºæœ€è¿‘æœ€ä¸å¸¸ä½¿ç”¨çš„é‚£ä¸€ä¸ª</p><p>3ã€æ‰€æœ‰<code>key-value</code>åœ¨è¢«è®¿é—®åå…¶ä½¿ç”¨é¢‘ç‡<code>freq</code>éƒ½åº”è¯¥åŠ ä¸€</p><p>åˆ†æï¼š</p><p>å¾ˆæ˜æ˜¾ï¼Œéœ€è¦<code>O(1)</code>çš„æ—¶é—´å¤æ‚åº¦ï¼Œè‚¯å®šè¿˜æ˜¯ç¦»ä¸å¼€ã€å“ˆå¸Œè¡¨ã€‘å’Œã€é“¾è¡¨ã€‘</p><p>å¯¹ä¸Šé¢çš„è¦æ±‚æ¥é€ä¸ªåˆ†æ</p><p>1å’Œ3ã€å»ºç«‹ä¸€ä¸ª <code>key</code> åˆ° <code>value</code> å’Œ<code>freq</code> çš„å“ˆå¸Œæ˜ å°„ï¼ˆ<font color='red'>å»ºç«‹keyåˆ°Nodeçš„å“ˆå¸Œæ˜ å°„</font>ï¼‰</p><p>2.1ã€å»ºç«‹å’Œå“ˆå¸Œæ˜ å°„ä¹‹åå¯ä»¥å¾ˆå¥½è§£å†³</p><p>2.2ã€å»ºç«‹ä¸€ä¸ªæ–°çš„key-Nodeæ˜ å°„å³å¯</p><p>2.3ã€å­˜åœ¨ä¸¤å±‚çš„æ’åºã€ä½¿ç”¨é¢‘ç‡ã€‘å’Œã€ä½¿ç”¨æ—¶é—´ã€‘ã€‚å…¶ä¸­ã€ä½¿ç”¨æ—¶é—´ã€‘å…¶å®å°±æ˜¯<code>lru</code>ç®—æ³•ä¸­çš„æ’åºï¼Œä½¿ç”¨åŒå‘é“¾è¡¨å³å¯è§£å†³ã€‚ä½†æ˜¯æ³¨æ„ï¼Œæ˜¯å…ˆæ ¹æ®ä½¿ç”¨ã€é¢‘ç‡æ’åºã€‘ï¼Œå½“ä½¿ç”¨ã€é¢‘ç‡ç›¸åŒã€‘çš„æƒ…å†µä¸‹å†æ ¹æ®ã€ä½¿ç”¨æ—¶é—´ã€‘æ’åºï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä¸€ä¸ªfreqå€¼å¯¹åº”è¿™ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œè¿™ä¸ªåŒå‘é“¾è¡¨è®°å½•ã€ä½¿ç”¨æ—¶é—´ã€‘çš„è¿œè¿‘ï¼Œæ‰€ä»¥å†å»ºç«‹ä¸€ä¸ªfreqåˆ°åŒå‘é“¾è¡¨çš„æ˜ å°„ï¼Œå°±å¯ä»¥å¾ˆå¥½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// åŒå‘é“¾è¡¨çš„ç»“ç‚¹ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-type">int</span> key&#123;<span class="hljs-number">-1</span>&#125;;<br>    <span class="hljs-type">int</span> val&#123;<span class="hljs-number">-1</span>&#125;;<br>    <span class="hljs-type">int</span> freq&#123;<span class="hljs-number">-1</span>&#125;;<br>    Node* next&#123;<span class="hljs-literal">nullptr</span>&#125;;<br>    Node* prev&#123;<span class="hljs-literal">nullptr</span>&#125;;<br><br>    <span class="hljs-built_in">Node</span>(<span class="hljs-type">int</span> k, <span class="hljs-type">int</span> v, <span class="hljs-type">int</span> f) &#123;<br>        key = k;<br>        val = v;<br>        freq = f;<br>    &#125;<br><br>    <span class="hljs-built_in">Node</span>() &#123;&#125;<br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DoubleLinkedList</span> &#123;<br>   <span class="hljs-keyword">public</span>:<br>    Node *head, *tail;<br>    <span class="hljs-type">int</span> size;<br>    <span class="hljs-built_in">DoubleLinkedList</span>() &#123;<br>        head = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>();<br>        tail = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>();<br>        head-&gt;next = tail;<br>        tail-&gt;prev = head;<br>        size = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Node* n)</span> </span>&#123;  <span class="hljs-comment">// ä»é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªç»“ç‚¹</span><br>        n-&gt;prev-&gt;next = n-&gt;next;<br>        n-&gt;next-&gt;prev = n-&gt;prev;<br>        n-&gt;next = <span class="hljs-literal">nullptr</span>;<br>        n-&gt;prev = <span class="hljs-literal">nullptr</span>;<br>        size--;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addInLast</span><span class="hljs-params">(Node* n)</span> </span>&#123;  <span class="hljs-comment">// æŠŠä¸€ä¸ªç»“ç‚¹æ’åœ¨å°¾éƒ¨</span><br>        tail-&gt;prev-&gt;next = n;<br>        n-&gt;prev = tail-&gt;prev;<br>        tail-&gt;prev = n;<br>        n-&gt;next = tail;<br>        size++;<br>    &#125;<br><br>    <span class="hljs-function">Node* <span class="hljs-title">first</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">// è¿”å›ç¬¬ä¸€ä¸ªç»“ç‚¹</span><br>        <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> head-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> size == <span class="hljs-number">0</span>; &#125; <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span><br>&#125;;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LFUCache</span> &#123;<br>   <span class="hljs-keyword">private</span>:<br>    <span class="hljs-comment">// å»ºç«‹key-&gt;Nodeçš„æ˜ å°„ï¼Œå› ä¸ºNodeä¸­åŒ…å«äº†valueå’Œfreqç­‰ä¿¡æ¯ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥é€šè¿‡keyè·å–åˆ°</span><br>    <span class="hljs-comment">// Nodeä¹Ÿæ˜¯DoubleLinkedListçš„ç»“ç‚¹ï¼Œè¿™æ ·å»ºç«‹æ˜ å°„å°±å¯ä»¥ä½¿å¾—ä¸¤ä¸ªmapä¹‹é—´å…³è”èµ·æ¥äº†</span><br>    unordered_map&lt;<span class="hljs-type">int</span>, Node*&gt; keyTonode;<br>    unordered_map&lt;<span class="hljs-type">int</span>, DoubleLinkedList&gt; freqTokeys;<br>    <span class="hljs-type">int</span> _cap;<br>    <span class="hljs-type">int</span> minFreq; <span class="hljs-comment">// è®°å½•æœ€å°çš„freq</span><br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> </span>&#123;  <span class="hljs-comment">// å°†keyå¯¹åº”çš„Nodeä»ç›¸åº”freqå¯¹åº”çš„åŒå‘é“¾è¡¨ä¸­ç§»é™¤</span><br>        Node* n = keyTonode[key];<br>        freqTokeys[n-&gt;freq].<span class="hljs-built_in">remove</span>(n);<br>        <span class="hljs-comment">// åˆ¤æ–­æ›´æ–°minFreq</span><br>        <span class="hljs-keyword">if</span> (n-&gt;freq == minFreq &amp;&amp; freqTokeys[n-&gt;freq].<span class="hljs-built_in">empty</span>()) &#123;<br>            minFreq++;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">increaseFreq</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> </span>&#123;  <span class="hljs-comment">// å¢åŠ keyå¯¹åº”çš„freqï¼Œå¹¶ä¸”å°†å…¶æ’å…¥åˆ°å¯¹åº”çš„åŒå‘é“¾è¡¨ä¸­</span><br>        Node* n = keyTonode[key];<br>        n-&gt;freq++;<br>        <span class="hljs-type">int</span> freq = n-&gt;freq;<br>        <span class="hljs-keyword">if</span> (freqTokeys.<span class="hljs-built_in">count</span>(freq) == <span class="hljs-number">0</span>) &#123;<br>            DoubleLinkedList dl;<br>            freqTokeys[freq] = dl;<br>        &#125;<br>        freqTokeys[freq].<span class="hljs-built_in">addInLast</span>(n);<br>    &#125;<br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LFUCache</span>(<span class="hljs-type">int</span> capacity) &#123; _cap = capacity; &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (keyTonode.<span class="hljs-built_in">count</span>(key) == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>        &#125;<br>        <span class="hljs-built_in">remove</span>(key);<br>        <span class="hljs-built_in">increaseFreq</span>(key);<br>        <span class="hljs-keyword">return</span> keyTonode[key]-&gt;val;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">put</span><span class="hljs-params">(<span class="hljs-type">int</span> key, <span class="hljs-type">int</span> value)</span> </span>&#123;<br>        <span class="hljs-comment">// å­˜åœ¨key</span><br>        <span class="hljs-keyword">if</span> (keyTonode.<span class="hljs-built_in">count</span>(key)) &#123;<br>            keyTonode[key]-&gt;val = value;<br>            <span class="hljs-built_in">remove</span>(key);<br>            <span class="hljs-built_in">increaseFreq</span>(key);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (_cap == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br>        <span class="hljs-comment">// ä¸å­˜åœ¨key</span><br>        <span class="hljs-keyword">if</span> (keyTonode.<span class="hljs-built_in">size</span>() == _cap) &#123;  <span class="hljs-comment">// å®¹é‡ä¸è¶³</span><br>            Node* node = freqTokeys[minFreq].<span class="hljs-built_in">first</span>();<br>            keyTonode.<span class="hljs-built_in">erase</span>(node-&gt;key);<br>            freqTokeys[minFreq].<span class="hljs-built_in">remove</span>(node);<br>            <span class="hljs-keyword">delete</span> node;<br>        &#125;<br>        Node* n = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Node</span>(key, value, <span class="hljs-number">0</span>);<br>        keyTonode[key] = n;<br>        <span class="hljs-built_in">increaseFreq</span>(key);<br>        minFreq = <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="å¸¸æ•°æ—¶é—´æŸ¥æ‰¾åˆ é™¤æ•°ç»„å…ƒç´ ">3 å¸¸æ•°æ—¶é—´æŸ¥æ‰¾/åˆ é™¤æ•°ç»„å…ƒç´ </h2><blockquote><p>å¸¸æ•°æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  380</p><p>é»‘åå•ä¸­çš„éšæœºæ•° 710</p></blockquote><p>ã€è¦æ±‚ã€‘</p><p>å®ç°<code>RandomizedSet</code> ç±»ï¼š</p><ul><li><code>RandomizedSet()</code> åˆå§‹åŒ– <code>RandomizedSet</code>å¯¹è±¡</li><li><code>bool insert(int val)</code> å½“å…ƒç´  <code>val</code>ä¸å­˜åœ¨æ—¶ï¼Œå‘é›†åˆä¸­æ’å…¥è¯¥é¡¹ï¼Œå¹¶è¿”å› <code>true</code> ï¼›å¦åˆ™ï¼Œè¿”å›<code>false</code> ã€‚</li><li><code>bool remove(int val)</code> å½“å…ƒç´  <code>val</code>å­˜åœ¨æ—¶ï¼Œä»é›†åˆä¸­ç§»é™¤è¯¥é¡¹ï¼Œå¹¶è¿”å› <code>true</code> ï¼›å¦åˆ™ï¼Œè¿”å›<code>false</code> ã€‚</li><li><code>int getRandom()</code>éšæœºè¿”å›ç°æœ‰é›†åˆä¸­çš„ä¸€é¡¹ï¼ˆæµ‹è¯•ç”¨ä¾‹ä¿è¯è°ƒç”¨æ­¤æ–¹æ³•æ—¶é›†åˆä¸­è‡³å°‘å­˜åœ¨ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚æ¯ä¸ªå…ƒç´ åº”è¯¥æœ‰<strong>ç›¸åŒçš„æ¦‚ç‡</strong> è¢«è¿”å›ã€‚</li></ul><p>ä½ å¿…é¡»å®ç°ç±»çš„æ‰€æœ‰å‡½æ•°ï¼Œå¹¶æ»¡è¶³æ¯ä¸ªå‡½æ•°çš„ <strong>å¹³å‡</strong>æ—¶é—´å¤æ‚åº¦ä¸º <code>O(1)</code> ã€‚</p><p>åˆ†æï¼š</p><p>1ã€éœ€è¦åˆ¤æ–­<code>val</code>æ˜¯å¦å­˜åœ¨ï¼Œè‚¯å®šè¦ç”¨åˆ°å“ˆå¸Œè¡¨</p><p>2ã€<code>getRandom</code>å‡½æ•°ï¼šç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œè¿”å›è¯¥éšæœºæ•°ä¸ºä¸‹æ ‡çš„æ•°ç»„å…ƒç´ </p><p>3ã€<code>remove</code>å‡½æ•°çš„å®ç°éœ€è¦ä¸€äº›æŠ€å·§ï¼šå°†éœ€è¦<code>remove</code>çš„å…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ æ¢ä½ç½®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RandomizedSet</span> &#123;<br>    vector&lt;<span class="hljs-type">int</span>&gt; arr;<br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; valToidx;<br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">RandomizedSet</span>() &#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (valToidx.<span class="hljs-built_in">count</span>(val) == <span class="hljs-number">0</span>) &#123;<br>            arr.<span class="hljs-built_in">push_back</span>(val);<br>            valToidx[val] = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼šç›´æ¥ä»æ•°ç»„ä¸­é—´earseæ‰çš„è¯ï¼Œä¼šå½±å“åé¢å…ƒç´ çš„ä¸‹æ ‡ï¼Œå³mapä¸­å¯¹åº”çš„ä¸‹æ ‡å°±å¤±æ•ˆäº†</span><br><span class="hljs-comment">        bool remove1(int val) &#123;</span><br><span class="hljs-comment">            if (valToidx.count(val) == 1) &#123;</span><br><span class="hljs-comment">                int idx = valToidx[val];</span><br><span class="hljs-comment">                arr.erase(arr.begin() + idx);</span><br><span class="hljs-comment">                valToidx.erase(val);</span><br><span class="hljs-comment">                return true;</span><br><span class="hljs-comment">            &#125;</span><br><span class="hljs-comment">            return false;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-comment">// å°†éœ€è¦popçš„å…ƒç´ å’Œæ•°ç»„æœ«å°¾çš„å…ƒç´ æ¢ä¸ªä½ç½®å°±å¯ä»¥å¾ˆå¥½è§£å†³äº†</span><br>    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (valToidx.<span class="hljs-built_in">count</span>(val) == <span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-type">int</span> idx = valToidx[val];<br>            <span class="hljs-type">int</span> lastIdx = arr.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>            <span class="hljs-type">int</span> lastVal = arr[lastIdx];<br>            <span class="hljs-comment">// swap</span><br>            arr[idx] = lastVal;<br>            arr[lastIdx] = val;<br>            <span class="hljs-comment">// update map</span><br>            valToidx[val] = lastIdx;<br>            valToidx[lastVal] = idx;<br><br>            arr.<span class="hljs-built_in">pop_back</span>();<br>            valToidx.<span class="hljs-built_in">erase</span>(val);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">getRandom</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-type">int</span> idx = <span class="hljs-built_in">rand</span>() % arr.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-keyword">return</span> arr[idx];<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ã€è¦æ±‚ã€‘</p><p>ç»™å®šä¸€ä¸ªæ•´æ•° <code>n</code> å’Œä¸€ä¸ª <strong>æ— é‡å¤</strong>é»‘åå•æ•´æ•°æ•°ç»„ <code>blacklist</code> ã€‚è®¾è®¡ä¸€ç§ç®—æ³•ï¼Œä»<code>[0, n - 1]</code> èŒƒå›´å†…çš„ä»»æ„æ•´æ•°ä¸­é€‰å–ä¸€ä¸ª<strong>æœªåŠ å…¥</strong> é»‘åå• <code>blacklist</code>çš„æ•´æ•°ã€‚ä»»ä½•åœ¨ä¸Šè¿°èŒƒå›´å†…ä¸”ä¸åœ¨é»‘åå• <code>blacklist</code>ä¸­çš„æ•´æ•°éƒ½åº”è¯¥æœ‰ <strong>åŒç­‰çš„å¯èƒ½æ€§</strong> è¢«è¿”å›ã€‚</p><p>ä¼˜åŒ–ä½ çš„ç®—æ³•ï¼Œä½¿å®ƒæœ€å°åŒ–è°ƒç”¨è¯­è¨€ <strong>å†…ç½®</strong>éšæœºå‡½æ•°çš„æ¬¡æ•°ã€‚</p><p>å®ç° <code>Solution</code> ç±»:</p><ul><li><code>Solution(int n, int[] blacklist)</code> åˆå§‹åŒ–æ•´æ•°<code>n</code> å’Œè¢«åŠ å…¥é»‘åå• <code>blacklist</code> çš„æ•´æ•°</li><li><code>int pick()</code> è¿”å›ä¸€ä¸ªèŒƒå›´ä¸º <code>[0, n - 1]</code>ä¸”ä¸åœ¨é»‘åå• <code>blacklist</code> ä¸­çš„éšæœºæ•´æ•°</li></ul><p>ã€åˆ†æã€‘</p><p>1ã€å¦‚æœä½¿ç”¨ä¸€èˆ¬çš„æ€è·¯ï¼Œå°†<code>[0,n-1]</code>ä¸­çš„å…ƒç´ é™¤å»<code>blacklist</code>ä¸­çš„æ”¾åˆ°æ•°ç»„é‡Œï¼Œç„¶åå†ç”Ÿæˆéšæœºæ•°è¿”å›ã€‚è¿™æ ·ä¼šå‡ºç°è¶…æ—¶ï¼ˆæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code>ï¼Œè€Œ<code>n</code>æ¯”è¾ƒå¤§ï¼‰</p><p>2ã€å¯ä»¥æŠŠ<code>[0,n-1]</code>æƒ³è±¡æˆä¸€ä¸ªä¸‹æ ‡å’Œå€¼å¯¹åº”çš„æ•°ç»„ï¼ˆå®é™…ä¸å­˜åœ¨ï¼‰ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰<code>blacklist</code>ä¸­çš„å…ƒç´ å…¨éƒ¨ç§»åˆ°æ•°ç»„æœ«å°¾ï¼Œç„¶åå†æ ¹æ®å®é™…çš„é•¿åº¦ç”Ÿæˆéšæœºæ•°è¿”å›å³å¯ã€‚</p><p>3ã€<strong>éš¾ç‚¹åœ¨äº</strong>ï¼šå¦‚ä½•æ­£ç¡®åœ°å°†æ‰€æœ‰<code>blacklist</code>å…ƒç´ ç§»åˆ°æ•°ç»„æœ«å°¾ï¼ˆæ³¨æ„æ•°ç»„å¹¶ä¸çœŸå®å­˜åœ¨ï¼‰</p><p>â€‹ 3.1ã€å·²ç»åœ¨æ•°ç»„æœ«å°¾çš„å…ƒç´ ä¸ç”¨ç§»åŠ¨</p><p>â€‹3.2ã€<code>blacklist</code>ä¸­çš„ä¸€ä¸ªå…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªå…ƒç´ æ—¶æ€ä¹ˆå¤„ç†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    unordered_map&lt;<span class="hljs-type">int</span>, <span class="hljs-type">int</span>&gt; mapping; <span class="hljs-comment">// å¤„ç†&quot;ç§»åŠ¨&quot;: tong&#x27;gå°†blacklistä¸­çš„å…ƒç´ æ˜ å°„åˆ°ç›¸åº”ä½ç½®</span><br>    <span class="hljs-type">int</span> sz;<br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Solution</span>(<span class="hljs-type">int</span> n, vector&lt;<span class="hljs-type">int</span>&gt;&amp; blacklist) &#123;<br>        sz = n - blacklist.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-type">int</span> last = n - <span class="hljs-number">1</span>;<br><span class="hljs-comment">// å…ˆå°†æ‰€æœ‰blacklistä¸­çš„å€¼åŠ å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œæ–¹ä¾¿åç»­çš„åˆ¤æ–­</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i : blacklist) &#123;<br>            mapping[i] = <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; blacklist.<span class="hljs-built_in">size</span>(); i++) &#123;<br>            <span class="hljs-keyword">if</span> (blacklist[i] &gt;= sz) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å…ƒç´ æœ¬èº«å°±åœ¨æ•°ç»„æœ«å°¾</span><br>            <span class="hljs-keyword">while</span> (mapping.<span class="hljs-built_in">count</span>(last)) &#123; <span class="hljs-comment">// blacklistä¸­çš„å…ƒç´ æ˜ å°„åˆ°äº†å¦ä¸€ä¸ªå…ƒç´ ï¼Œlastå°±è¦å˜å°</span><br>                last--;<br>            &#125;<br>            mapping[blacklist[i]] = last;<br>            last--;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">pick</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-type">int</span> idx = <span class="hljs-built_in">rand</span>() % sz;<br>        <span class="hljs-keyword">if</span> (mapping.<span class="hljs-built_in">count</span>(idx)) &#123;<br>            <span class="hljs-keyword">return</span> mapping[idx];<br>        &#125;<br>        <span class="hljs-keyword">return</span> idx;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="æ±‚ä¸­ä½æ•°">4 æ±‚ä¸­ä½æ•°</h2><blockquote><p>æ•°æ®æµçš„ä¸­ä½æ•° 295</p></blockquote><p>ã€è¦æ±‚ã€‘</p><p>ä¸­ä½æ•°æ˜¯æœ‰åºåˆ—è¡¨ä¸­é—´çš„æ•°ã€‚å¦‚æœåˆ—è¡¨é•¿åº¦æ˜¯å¶æ•°ï¼Œä¸­ä½æ•°åˆ™æ˜¯ä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œ</p><p>[2,3,4] çš„ä¸­ä½æ•°æ˜¯ 3</p><p>[2,3] çš„ä¸­ä½æ•°æ˜¯ (2 + 3) / 2 = 2.5</p><p>è®¾è®¡ä¸€ä¸ªæ”¯æŒä»¥ä¸‹ä¸¤ç§æ“ä½œçš„æ•°æ®ç»“æ„ï¼š</p><ul><li>void addNum(int num) - ä»æ•°æ®æµä¸­æ·»åŠ ä¸€ä¸ªæ•´æ•°åˆ°æ•°æ®ç»“æ„ä¸­ã€‚</li><li>double findMedian() - è¿”å›ç›®å‰æ‰€æœ‰å…ƒç´ çš„ä¸­ä½æ•°ã€‚</li></ul><p>ä½¿ç”¨ä¸¤ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼šä¸€ä¸ªå¤§é¡¶å †ã€ä¸€ä¸ªå°é¡¶å †</p><p>ç›¸å½“äºå°†ä¸€ä¸ªæ•°ç»„åœ¨ä¸­é—´åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œè¿™æ ·é€šè¿‡ä¸¤ä¸ªå †çš„å †é¡¶å…ƒç´ å°±å¯ä»¥æ±‚å‡ºä¸­ä½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MedianFinder</span> &#123;<br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;&gt; small;                <span class="hljs-comment">// å¤§é¡¶å †</span><br>    priority_queue&lt;<span class="hljs-type">int</span>, vector&lt;<span class="hljs-type">int</span>&gt;, greater&lt;<span class="hljs-type">int</span>&gt;&gt; large;  <span class="hljs-comment">// å°é¡¶å †</span><br><br>   <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">MedianFinder</span>() &#123;&#125;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</span><br><span class="hljs-comment">        1ã€smallå’Œlargeçš„å¤§å°æœ€å¤šç›¸å·®ä¸€</span><br><span class="hljs-comment">        2ã€small.top() &lt;= large.top()</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">addNum</span><span class="hljs-params">(<span class="hljs-type">int</span> num)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (small.<span class="hljs-built_in">size</span>() &gt;= large.<span class="hljs-built_in">size</span>()) &#123;<br>            <span class="hljs-comment">// æ’å…¥large</span><br>            small.<span class="hljs-built_in">push</span>(num);<br>            large.<span class="hljs-built_in">push</span>(small.<span class="hljs-built_in">top</span>());<br>            small.<span class="hljs-built_in">pop</span>();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// æ’å…¥samll</span><br>            large.<span class="hljs-built_in">push</span>(num);<br>            small.<span class="hljs-built_in">push</span>(large.<span class="hljs-built_in">top</span>());<br>            large.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">findMedian</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (small.<span class="hljs-built_in">size</span>() == large.<span class="hljs-built_in">size</span>()) &#123;<br>            <span class="hljs-keyword">return</span> (small.<span class="hljs-built_in">top</span>() + large.<span class="hljs-built_in">top</span>()) / <span class="hljs-number">2.0</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (small.<span class="hljs-built_in">size</span>() &gt; large.<span class="hljs-built_in">size</span>()) &#123;<br>            <span class="hljs-keyword">return</span> small.<span class="hljs-built_in">top</span>();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> large.<span class="hljs-built_in">top</span>();<br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> leetcodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
